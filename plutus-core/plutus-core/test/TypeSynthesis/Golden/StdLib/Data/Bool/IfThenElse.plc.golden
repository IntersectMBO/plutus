all a. bool -> (unit -> a) -> (unit -> a) -> a
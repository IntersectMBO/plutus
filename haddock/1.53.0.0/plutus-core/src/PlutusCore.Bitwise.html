<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-comment"
      >-- editorconfig-checker-disable-file</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE BangPatterns      #-}</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE MagicHash         #-}</span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE OverloadedStrings #-}</span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span class="hs-comment"
      >-- | Implementations for CIP-121, CIP-122 and CIP-123. Grouped because they all operate on</span
      ><span
      >
</span
      ><span id="line-8"
      ></span
      ><span class="hs-comment"
      >-- 'ByteString's, and require similar functionality.</span
      ><span
      >
</span
      ><span id="line-9"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusCore.Bitwise</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span
      >
</span
      ><span id="line-10"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#integerToByteString"
	><span class="hs-identifier"
	  >integerToByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#byteStringToInteger"
	><span class="hs-identifier"
	  >byteStringToInteger</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#andByteString"
	><span class="hs-identifier"
	  >andByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#orByteString"
	><span class="hs-identifier"
	  >orByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#xorByteString"
	><span class="hs-identifier"
	  >xorByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-15"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#complementByteString"
	><span class="hs-identifier"
	  >complementByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-16"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#shiftByteString"
	><span class="hs-identifier"
	  >shiftByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-17"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#rotateByteString"
	><span class="hs-identifier"
	  >rotateByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-18"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#readBit"
	><span class="hs-identifier"
	  >readBit</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-19"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#writeBits"
	><span class="hs-identifier"
	  >writeBits</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-20"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#replicateByte"
	><span class="hs-identifier"
	  >replicateByte</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-21"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#countSetBits"
	><span class="hs-identifier"
	  >countSetBits</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-22"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#findFirstSetBit"
	><span class="hs-identifier"
	  >findFirstSetBit</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-23"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#IntegerToByteStringError"
	><span class="hs-identifier"
	  >IntegerToByteStringError</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-24"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-25"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-26"
      ></span
      ><span
      >
</span
      ><span id="line-27"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.html"
	><span class="hs-identifier"
	  >PlutusCore.Builtin</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#BuiltinResult"
	><span class="hs-identifier"
	  >BuiltinResult</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier"
	  >emit</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-28"
      ></span
      ><span
      >
</span
      ><span id="line-29"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html"
	><span class="hs-identifier"
	  >ByteString.StrictBuilder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier"
	  >Builder</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-30"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html"
	><span class="hs-identifier"
	  >ByteString.StrictBuilder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Builder</span
	></span
      ><span
      >
</span
      ><span id="line-31"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Exception.html"
	><span class="hs-identifier"
	  >Control.Exception</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Exception.Type.html#Exception"
	><span class="hs-identifier"
	  >Exception</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.html#throwIO"
	><span class="hs-identifier"
	  >throwIO</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Exception.Base.html#try"
	><span class="hs-identifier"
	  >try</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-32"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html"
	><span class="hs-identifier"
	  >Control.Monad</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#guard"
	><span class="hs-identifier"
	  >guard</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#unless"
	><span class="hs-identifier"
	  >unless</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#when"
	><span class="hs-identifier"
	  >when</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-33"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Bits.html"
	><span class="hs-identifier"
	  >Data.Bits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-identifier"
	  >unsafeShiftL</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-identifier"
	  >unsafeShiftR</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator"
	  >(.|.)</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-34"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Bits.html"
	><span class="hs-identifier"
	  >Data.Bits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Bits</span
	></span
      ><span
      >
</span
      ><span id="line-35"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html"
	><span class="hs-identifier"
	  >Data.ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier"
	  >ByteString</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-36"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html"
	><span class="hs-identifier"
	  >Data.ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>BS</span
	></span
      ><span
      >
</span
      ><span id="line-37"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.html"
	><span class="hs-identifier"
	  >Data.ByteString.Internal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>BSI</span
	></span
      ><span
      >
</span
      ><span id="line-38"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html"
	><span class="hs-identifier"
	  >Data.Foldable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier"
	  >for_</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-39"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.html"
	><span class="hs-identifier"
	  >Data.Text</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier"
	  >pack</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-40"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Word.html"
	><span class="hs-identifier"
	  >Data.Word</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier"
	  >Word64</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-41"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html"
	><span class="hs-identifier"
	  >Foreign.Marshal.Utils</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier"
	  >copyBytes</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#fillBytes"
	><span class="hs-identifier"
	  >fillBytes</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-42"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Ptr.html"
	><span class="hs-identifier"
	  >Foreign.Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier"
	  >Ptr</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier"
	  >castPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier"
	  >plusPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-43"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html"
	><span class="hs-identifier"
	  >Foreign.Storable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier"
	  >peekByteOff</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier"
	  >peekElemOff</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier"
	  >pokeByteOff</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier"
	  >pokeElemOff</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-44"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html"
	><span class="hs-identifier"
	  >GHC.ByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#ByteOrder"
	><span class="hs-identifier"
	  >ByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#BigEndian"
	><span class="hs-identifier"
	  >BigEndian</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#LittleEndian"
	><span class="hs-identifier"
	  >LittleEndian</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-45"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html"
	><span class="hs-identifier"
	  >GHC.IO.Unsafe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-46"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html"
	><span class="hs-identifier"
	  >GHC.Num.Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#integerLog2"
	><span class="hs-identifier"
	  >integerLog2</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-47"
      ></span
      ><span
      >
</span
      ><span id="line-48"
      ></span
      ><span class="hs-comment"
      >{- Note [Input length limitation for IntegerToByteString].
We make `integerToByteString` and `replicateByte` fail if they're called with arguments which would
cause the length of the result to exceed about 8K bytes because the execution time becomes difficult
to predict accurately beyond this point (benchmarks on a number of different machines show that the
CPU time increases smoothly for inputs up to about 8K then increases sharply, becoming chaotic after
about 14K).  This restriction may be removed once a more efficient implementation becomes available.-}</span
      ><span
      >
</span
      ><span id="line-54"
      ></span
      ><span class="hs-comment"
      >{- NB: if we do relax the length restriction then we will need two variants of integerToByteString in
   Plutus Core so that we can continue to support the current behaviour for old scripts.-}</span
      ><span
      >
</span
      ><span id="line-56"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-type"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-57"
      ></span
      ><span id="maximumOutputLength"
      ><span class="annot"
	><span class="annottext"
	  >maximumOutputLength :: Integer
</span
	  ><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	  ><span class="hs-identifier hs-var hs-var"
	    >maximumOutputLength</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>8192</span
	></span
      ><span
      >
</span
      ><span id="line-58"
      ></span
      ><span
      >
</span
      ><span id="line-59"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Wrapper for 'unsafeIntegerToByteString' to make it more convenient to define as a builtin.</span
	></span
      ><span
      >
</span
      ><span id="line-60"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#integerToByteString"
	><span class="hs-identifier hs-type"
	  >integerToByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#BuiltinResult"
	><span class="hs-identifier hs-type"
	  >BuiltinResult</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-61"
      ></span
      ><span id="integerToByteString"
      ><span class="annot"
	><span class="annottext"
	  >integerToByteString :: Bool -&gt; Integer -&gt; Integer -&gt; BuiltinResult ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#integerToByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >integerToByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920252"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920252"
	  ><span class="hs-identifier hs-var"
	    >endiannessArg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920253"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920253"
	  ><span class="hs-identifier hs-var"
	    >lengthArg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920254"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920254"
	  ><span class="hs-identifier hs-var"
	    >input</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-62"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- Check that the length is non-negative.</span
      ><span
      >
</span
      ><span id="line-63"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-64"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;integerToByteString: negative length argument&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-65"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Length requested: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-66"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-67"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- Check that the requested length does not exceed the limit.  *NB*: if we remove the limit we'll</span
      ><span
      >
</span
      ><span id="line-68"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- still have to make sure that the length fits into an Int.</span
      ><span
      >
</span
      ><span id="line-69"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-70"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ())
-&gt; ([Char] -&gt; Text) -&gt; [Char] -&gt; BuiltinResult ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; BuiltinResult ()) -&gt; [Char] -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot;integerToByteString: requested length is too long (maximum is &quot;</span
	></span
      ><span
      >
</span
      ><span id="line-71"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-72"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot; bytes)&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-73"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Length requested: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-74"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-75"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- If the requested length is zero (ie, an explicit output size is not</span
      ><span
      >
</span
      ><span id="line-76"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- specified) we still have to make sure that the output won't exceed the size</span
      ><span
      >
</span
      ><span id="line-77"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- limit.  If the requested length is nonzero and less than the limit,</span
      ><span
      >
</span
      ><span id="line-78"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- integerToByteString checks that the input fits.</span
      ><span
      >
</span
      ><span id="line-79"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- integerLog2 n is one less than the number of significant bits in n</span
      ><span
      >
</span
      ><span id="line-80"
      ></span
      ><span
      >       </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Bool -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%26%26"
	><span class="hs-operator hs-var"
	  >&amp;&amp;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word
</span
	><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#integerLog2"
	><span class="hs-identifier hs-var"
	  >integerLog2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-81"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920266"
      ><span class="annot"
	><span class="annottext"
	  >bytesRequiredFor :: Integer -&gt; Word
</span
	  ><a href="#local-6989586621681920266"
	  ><span class="hs-identifier hs-var hs-var"
	    >bytesRequiredFor</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920267"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920267"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word
</span
	><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#integerLog2"
	><span class="hs-identifier hs-var"
	  >integerLog2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920267"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word -&gt; Word -&gt; Word
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#div"
	><span class="hs-operator hs-var"
	  >`div`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-82"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ This gives 1 instead of 0 for n=0, but we'll never get that.</span
      ><span
      >
</span
      ><span id="line-83"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-84"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ())
-&gt; ([Char] -&gt; Text) -&gt; [Char] -&gt; BuiltinResult ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; BuiltinResult ()) -&gt; [Char] -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot;integerToByteString: input too long (maximum is 2^&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-85"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-86"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot;-1)&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-87"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Length required: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Word -&gt; [Char]) -&gt; Word -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word -&gt; Text) -&gt; Word -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word
</span
	><a href="#local-6989586621681920266"
	><span class="hs-identifier hs-var"
	  >bytesRequiredFor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-88"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-89"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920270"
      ><span class="annot"
	><span class="annottext"
	  >endianness :: ByteOrder
</span
	  ><a href="#local-6989586621681920270"
	  ><span class="hs-identifier hs-var hs-var"
	    >endianness</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; ByteOrder
</span
	><a href="PlutusCore.Bitwise.html#endiannessArgToByteOrder"
	><span class="hs-identifier hs-var"
	  >endiannessArgToByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920252"
	><span class="hs-identifier hs-var"
	  >endiannessArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >in</span
      ><span
      >
</span
      ><span id="line-90"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We use fromIntegral here, despite advice to the contrary in general when defining builtin</span
      ><span
      >
</span
      ><span id="line-91"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- denotations. This is because, if we've made it this far, we know that overflow or truncation</span
      ><span
      >
</span
      ><span id="line-92"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- are impossible: we've checked that whatever we got given fits inside a (non-negative) Int.</span
      ><span
      >
</span
      ><span id="line-93"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
-&gt; Int -&gt; Integer -&gt; Either IntegerToByteStringError ByteString
</span
	><a href="PlutusCore.Bitwise.html#unsafeIntegerToByteString"
	><span class="hs-identifier hs-var"
	  >unsafeIntegerToByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="#local-6989586621681920270"
	><span class="hs-identifier hs-var"
	  >endianness</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-94"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Left"
	><span class="hs-identifier hs-type"
	  >Left</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920272"
      ><span class="annot"
	><span class="annottext"
	  >IntegerToByteStringError
</span
	  ><a href="#local-6989586621681920272"
	  ><span class="hs-identifier hs-var"
	    >err</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
</span
	><a href="#local-6989586621681920272"
	><span class="hs-identifier hs-var"
	  >err</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-95"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
</span
	><a href="PlutusCore.Bitwise.html#NegativeInput"
	><span class="hs-identifier hs-var"
	  >NegativeInput</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-96"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;integerToByteString: cannot convert negative Integer&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-97"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- This does work proportional to the size of input. However, we're in a failing case</span
      ><span
      >
</span
      ><span id="line-98"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- anyway, and the user's paid for work proportional to this size in any case.</span
      ><span
      >
</span
      ><span id="line-99"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Input: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-100"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-101"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
</span
	><a href="PlutusCore.Bitwise.html#NotEnoughDigits"
	><span class="hs-identifier hs-var"
	  >NotEnoughDigits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-102"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;integerToByteString: cannot represent Integer in given number of bytes&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-103"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- This does work proportional to the size of input. However, we're in a failing case</span
      ><span
      >
</span
      ><span id="line-104"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- anyway, and the user's paid for work proportional to this size in any case.</span
      ><span
      >
</span
      ><span id="line-105"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Input: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920254"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-106"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Bytes requested: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920253"
	><span class="hs-identifier hs-var"
	  >lengthArg</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-107"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-108"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Right"
	><span class="hs-identifier hs-type"
	  >Right</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920275"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920275"
	  ><span class="hs-identifier hs-var"
	    >result</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; BuiltinResult ByteString
forall a. a -&gt; BuiltinResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920275"
	><span class="hs-identifier hs-var"
	  >result</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-109"
      ></span
      ><span
      >
</span
      ><span id="line-110"
      ></span
      ><span class="hs-comment"
      >-- | Conversion from 'Integer' to 'ByteString', as per</span
      ><span
      >
</span
      ><span id="line-111"
      ></span
      ><span class="hs-comment"
      >-- [CIP-121](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0121).</span
      ><span
      >
</span
      ><span id="line-112"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-113"
      ></span
      ><span
      >
</span
      ><span id="line-114"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Structured type to help indicate conversion errors.</span
	></span
      ><span
      >
</span
      ><span id="line-115"
      ></span
      ><span class="hs-keyword"
      >data</span
      ><span
      > </span
      ><span id="IntegerToByteStringError"
      ><span class="annot"
	><a href="PlutusCore.Bitwise.html#IntegerToByteStringError"
	  ><span class="hs-identifier hs-var"
	    >IntegerToByteStringError</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-116"
      ></span
      ><span
      >  </span
      ><span id="NegativeInput"
      ><span class="annot"
	><a href="PlutusCore.Bitwise.html#NegativeInput"
	  ><span class="hs-identifier hs-var"
	    >NegativeInput</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      >
</span
      ><span id="line-117"
      ></span
      ><span
      >  </span
      ><span id="NotEnoughDigits"
      ><span class="annot"
	><a href="PlutusCore.Bitwise.html#NotEnoughDigits"
	  ><span class="hs-identifier hs-var"
	    >NotEnoughDigits</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-118"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >deriving</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-keyword"
	>stock</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920277"
      ><span id="local-6989586621681920279"
	><span class="annot"
	  ><span class="annottext"
	    >IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool
(IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool)
-&gt; (IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool)
-&gt; Eq IntegerToByteStringError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool
== :: IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool
$c/= :: IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool
/= :: IntegerToByteStringError -&gt; IntegerToByteStringError -&gt; Bool
</span
	    ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#Eq"
	    ><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var"
	      >Eq</span
	      ></a
	    ></span
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920284"
      ><span id="local-6989586621681920286"
	><span id="local-6989586621681920290"
	  ><span class="annot"
	    ><span class="annottext"
	      >Int -&gt; IntegerToByteStringError -&gt; [Char] -&gt; [Char]
[IntegerToByteStringError] -&gt; [Char] -&gt; [Char]
IntegerToByteStringError -&gt; [Char]
(Int -&gt; IntegerToByteStringError -&gt; [Char] -&gt; [Char])
-&gt; (IntegerToByteStringError -&gt; [Char])
-&gt; ([IntegerToByteStringError] -&gt; [Char] -&gt; [Char])
-&gt; Show IntegerToByteStringError
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; IntegerToByteStringError -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; IntegerToByteStringError -&gt; [Char] -&gt; [Char]
$cshow :: IntegerToByteStringError -&gt; [Char]
show :: IntegerToByteStringError -&gt; [Char]
$cshowList :: [IntegerToByteStringError] -&gt; [Char] -&gt; [Char]
showList :: [IntegerToByteStringError] -&gt; [Char] -&gt; [Char]
</span
	      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#Show"
	      ><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var"
		>Show</span
		></a
	      ></span
	    ></span
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-119"
      ></span
      ><span
      >
</span
      ><span id="line-120"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#endiannessArgToByteOrder"
	><span class="hs-identifier hs-type"
	  >endiannessArgToByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#ByteOrder"
	><span class="hs-identifier hs-type"
	  >ByteOrder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-121"
      ></span
      ><span id="endiannessArgToByteOrder"
      ><span class="annot"
	><span class="annottext"
	  >endiannessArgToByteOrder :: Bool -&gt; ByteOrder
</span
	  ><a href="PlutusCore.Bitwise.html#endiannessArgToByteOrder"
	  ><span class="hs-identifier hs-var hs-var"
	    >endiannessArgToByteOrder</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920293"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920293"
	  ><span class="hs-identifier hs-var"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920293"
	><span class="hs-identifier hs-var"
	  >b</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#BigEndian"
	><span class="hs-identifier hs-var"
	  >BigEndian</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#LittleEndian"
	><span class="hs-identifier hs-var"
	  >LittleEndian</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-122"
      ></span
      ><span
      >
</span
      ><span id="line-123"
      ></span
      ><span class="hs-comment"
      >-- For performance and clarity, the endianness argument uses</span
      ><span
      >
</span
      ><span id="line-124"
      ></span
      ><span class="hs-comment"
      >-- 'ByteOrder', and the length argument is an 'Int'.</span
      ><span
      >
</span
      ><span id="line-125"
      ></span
      ><span class="hs-comment"
      >-- This may not actually be unsafe, but it shouldn't be used outside this module.</span
      ><span
      >
</span
      ><span id="line-126"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#unsafeIntegerToByteString"
	><span class="hs-identifier hs-type"
	  >unsafeIntegerToByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#ByteOrder"
	><span class="hs-identifier hs-type"
	  >ByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Either"
	><span class="hs-identifier hs-type"
	  >Either</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#IntegerToByteStringError"
	><span class="hs-identifier hs-type"
	  >IntegerToByteStringError</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-127"
      ></span
      ><span id="unsafeIntegerToByteString"
      ><span class="annot"
	><span class="annottext"
	  >unsafeIntegerToByteString :: ByteOrder
-&gt; Int -&gt; Integer -&gt; Either IntegerToByteStringError ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#unsafeIntegerToByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >unsafeIntegerToByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920294"
      ><span class="annot"
	><span class="annottext"
	  >ByteOrder
</span
	  ><a href="#local-6989586621681920294"
	  ><span class="hs-identifier hs-var"
	    >requestedByteOrder</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920295"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920295"
	  ><span class="hs-identifier hs-var"
	    >requestedLength</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920296"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920296"
	  ><span class="hs-identifier hs-var"
	    >input</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-128"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
-&gt; Either IntegerToByteStringError ByteString
forall a b. a -&gt; Either a b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Left"
	><span class="hs-identifier hs-var"
	  >Left</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
</span
	><a href="PlutusCore.Bitwise.html#NegativeInput"
	><span class="hs-identifier hs-var"
	  >NegativeInput</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-129"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Either IntegerToByteStringError ByteString
forall a b. b -&gt; Either a b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Right"
	><span class="hs-identifier hs-var"
	  >Right</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ByteString -&gt; Either IntegerToByteStringError ByteString)
-&gt; (Word8 -&gt; ByteString)
-&gt; Word8
-&gt; Either IntegerToByteStringError ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word8 -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#replicate"
	><span class="hs-identifier hs-var"
	  >BS.replicate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; Either IntegerToByteStringError ByteString)
-&gt; Word8 -&gt; Either IntegerToByteStringError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x00</span
	></span
      ><span
      >
</span
      ><span id="line-130"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- We use manual specialization to ensure as few branches in loop bodies as</span
      ><span
      >
</span
      ><span id="line-131"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- we can. See Note [Manual specialization] for details.</span
      ><span
      >
</span
      ><span id="line-132"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Either IntegerToByteStringError ByteString
forall a b. b -&gt; Either a b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Right"
	><span class="hs-identifier hs-var"
	  >Right</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ByteString -&gt; Either IntegerToByteStringError ByteString)
-&gt; (Builder -&gt; ByteString)
-&gt; Builder
-&gt; Either IntegerToByteStringError ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderBytes"
	><span class="hs-identifier hs-var"
	  >Builder.builderBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Either IntegerToByteStringError ByteString)
-&gt; Builder -&gt; Either IntegerToByteStringError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="#local-6989586621681920294"
	><span class="hs-identifier hs-var"
	  >requestedByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-133"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#LittleEndian"
	><span class="hs-identifier hs-var"
	  >LittleEndian</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Builder
</span
	><a href="#local-6989586621681920299"
	><span class="hs-identifier hs-var"
	  >goLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
forall a. Monoid a =&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#mempty"
	><span class="hs-identifier hs-var"
	  >mempty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-134"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#BigEndian"
	><span class="hs-identifier hs-var"
	  >BigEndian</span
	  ></a
	></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Builder
</span
	><a href="#local-6989586621681920300"
	><span class="hs-identifier hs-var"
	  >goBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
forall a. Monoid a =&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#mempty"
	><span class="hs-identifier hs-var"
	  >mempty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-135"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-136"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920303"
      ><span class="annot"
	><span class="annottext"
	  >result :: Maybe Builder
</span
	  ><a href="#local-6989586621681920303"
	  ><span class="hs-identifier hs-var hs-var"
	    >result</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="#local-6989586621681920294"
	><span class="hs-identifier hs-var"
	  >requestedByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-137"
      ></span
      ><span
      >                    </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#LittleEndian"
	><span class="hs-identifier hs-var"
	  >LittleEndian</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920304"
	><span class="hs-identifier hs-var"
	  >goLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
forall a. Monoid a =&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#mempty"
	><span class="hs-identifier hs-var"
	  >mempty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-138"
      ></span
      ><span
      >                    </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#BigEndian"
	><span class="hs-identifier hs-var"
	  >BigEndian</span
	  ></a
	></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920305"
	><span class="hs-identifier hs-var"
	  >goBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
forall a. Monoid a =&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#mempty"
	><span class="hs-identifier hs-var"
	  >mempty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920296"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-139"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe Builder
</span
	><a href="#local-6989586621681920303"
	><span class="hs-identifier hs-var"
	  >result</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-140"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe Builder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
-&gt; Either IntegerToByteStringError ByteString
forall a b. a -&gt; Either a b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Left"
	><span class="hs-identifier hs-var"
	  >Left</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IntegerToByteStringError
</span
	><a href="PlutusCore.Bitwise.html#NotEnoughDigits"
	><span class="hs-identifier hs-var"
	  >NotEnoughDigits</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-141"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920306"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920306"
	  ><span class="hs-identifier hs-var"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Either IntegerToByteStringError ByteString
forall a b. b -&gt; Either a b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Right"
	><span class="hs-identifier hs-var"
	  >Right</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ByteString -&gt; Either IntegerToByteStringError ByteString)
-&gt; (Builder -&gt; ByteString)
-&gt; Builder
-&gt; Either IntegerToByteStringError ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderBytes"
	><span class="hs-identifier hs-var"
	  >Builder.builderBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Either IntegerToByteStringError ByteString)
-&gt; Builder -&gt; Either IntegerToByteStringError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920306"
	><span class="hs-identifier hs-var"
	  >b</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-142"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-143"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920304"
	><span class="hs-identifier hs-type"
	  >goLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-144"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920304"
      ><span class="annot"
	><span class="annottext"
	  >goLELimit :: Builder -&gt; Integer -&gt; Maybe Builder
</span
	  ><a href="#local-6989586621681920304"
	  ><span class="hs-identifier hs-var hs-var"
	    >goLELimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920307"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920307"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920308"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920308"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-145"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920308"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Maybe Builder
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Maybe Builder) -&gt; Builder -&gt; Maybe Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder
</span
	><a href="#local-6989586621681920309"
	><span class="hs-identifier hs-var"
	  >padLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920307"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-146"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-147"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- builderLength is constant time, so we don't track the length ourselves</span
      ><span
      >
</span
      ><span id="line-148"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#guard"
	><span class="hs-identifier hs-var"
	  >guard</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920307"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-149"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- This allows extracting eight digits at once. See Note [Loop sectioning] for details on</span
      ><span
      >
</span
      ><span id="line-150"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- why we do this. We also duplicate this code in several places: see Note [Manual</span
      ><span
      >
</span
      ><span id="line-151"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- specialization] for why.</span
      ><span
      >
</span
      ><span id="line-152"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-153"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- The code is basically equivalent to remaining `quotRem` 2^64, but more efficient. This</span
      ><span
      >
</span
      ><span id="line-154"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- is for two reasons: firstly, GHC does not optimize divisions into shifts for Integer</span
      ><span
      >
</span
      ><span id="line-155"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- (even if the divisor is constant), and secondly, the pair generated by `quotRem` costs</span
      ><span
      >
</span
      ><span id="line-156"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- us as much as 15% peformance, and GHC seems unable to eliminate it. Thus, we have to do</span
      ><span
      >
</span
      ><span id="line-157"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- it like this instead.</span
      ><span
      >
</span
      ><span id="line-158"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920313"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Integer
</span
	  ><a href="#local-6989586621681920313"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920308"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span
      >
</span
      ><span id="line-159"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Given that remaining must be non-negative, fromInteger here effectively truncates to a</span
      ><span
      >
</span
      ><span id="line-160"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Word64, by retaining only the least-significant 8 bytes.</span
      ><span
      >
</span
      ><span id="line-161"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920315"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920315"
	  ><span class="hs-identifier hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#fromInteger"
	><span class="hs-identifier hs-var"
	  >fromInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920308"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-162"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920313"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-163"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920316"
	><span class="hs-identifier hs-var"
	  >finishLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920307"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920315"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-164"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920304"
	><span class="hs-identifier hs-var"
	  >goLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920307"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Builder
forall a. Storable a =&gt; a -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#storable"
	><span class="hs-identifier hs-var"
	  >Builder.storable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920315"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920313"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-165"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920316"
	><span class="hs-identifier hs-type"
	  >finishLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-166"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920316"
      ><span class="annot"
	><span class="annottext"
	  >finishLELimit :: Builder -&gt; Word64 -&gt; Maybe Builder
</span
	  ><a href="#local-6989586621681920316"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishLELimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920318"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920318"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920319"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920319"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-167"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920319"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Maybe Builder
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Maybe Builder) -&gt; Builder -&gt; Maybe Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder
</span
	><a href="#local-6989586621681920309"
	><span class="hs-identifier hs-var"
	  >padLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920318"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-168"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-169"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#guard"
	><span class="hs-identifier hs-var"
	  >guard</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920318"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-170"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- This is equivalent to 'remaining `quotRem` 256' followed by a conversion of the</span
      ><span
      >
</span
      ><span id="line-171"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- remainder, but faster. This is similar to the larger example above, and we do it for</span
      ><span
      >
</span
      ><span id="line-172"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- the same reasons.</span
      ><span
      >
</span
      ><span id="line-173"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920321"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Word64
</span
	  ><a href="#local-6989586621681920321"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920319"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-174"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920325"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920325"
	  ><span class="hs-identifier hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920319"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-175"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920316"
	><span class="hs-identifier hs-var"
	  >finishLELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920318"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word8"
	><span class="hs-identifier hs-var"
	  >Builder.word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920325"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920321"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-176"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- By separating the case where we don't need to concern ourselves with a</span
      ><span
      >
</span
      ><span id="line-177"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- user-specified limit, we can avoid branching needlessly, or doing a</span
      ><span
      >
</span
      ><span id="line-178"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- complex expression check on every loop. See Note [Manual specialization]</span
      ><span
      >
</span
      ><span id="line-179"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- for why this matters.</span
      ><span
      >
</span
      ><span id="line-180"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920299"
	><span class="hs-identifier hs-type"
	  >goLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-181"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920299"
      ><span class="annot"
	><span class="annottext"
	  >goLENoLimit :: Builder -&gt; Integer -&gt; Builder
</span
	  ><a href="#local-6989586621681920299"
	  ><span class="hs-identifier hs-var hs-var"
	    >goLENoLimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920327"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920327"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920328"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920328"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-182"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920328"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920327"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-183"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920330"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Integer
</span
	  ><a href="#local-6989586621681920330"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920328"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span
      >
</span
      ><span id="line-184"
      ></span
      ><span
      >                        </span
      ><span id="local-6989586621681920332"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920332"
	  ><span class="hs-identifier hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#fromInteger"
	><span class="hs-identifier hs-var"
	  >fromInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920328"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-185"
      ></span
      ><span
      >                      </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920330"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-186"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Builder
</span
	><a href="#local-6989586621681920333"
	><span class="hs-identifier hs-var"
	  >finishLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920327"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920332"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-187"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Builder
</span
	><a href="#local-6989586621681920299"
	><span class="hs-identifier hs-var"
	  >goLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920327"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Builder
forall a. Storable a =&gt; a -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#storable"
	><span class="hs-identifier hs-var"
	  >Builder.storable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920332"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920330"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-188"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920333"
	><span class="hs-identifier hs-type"
	  >finishLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-189"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920333"
      ><span class="annot"
	><span class="annottext"
	  >finishLENoLimit :: Builder -&gt; Word64 -&gt; Builder
</span
	  ><a href="#local-6989586621681920333"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishLENoLimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920334"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920334"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920335"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920335"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-190"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920335"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920334"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-191"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-192"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920337"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Word64
</span
	  ><a href="#local-6989586621681920337"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920335"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-193"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920340"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920340"
	  ><span class="hs-identifier hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920335"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-194"
      ></span
      ><span
      >           </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Builder
</span
	><a href="#local-6989586621681920333"
	><span class="hs-identifier hs-var"
	  >finishLENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920334"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word8"
	><span class="hs-identifier hs-var"
	  >Builder.word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920340"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920337"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-195"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920309"
	><span class="hs-identifier hs-type"
	  >padLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-196"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920309"
      ><span class="annot"
	><span class="annottext"
	  >padLE :: Builder -&gt; Builder
</span
	  ><a href="#local-6989586621681920309"
	  ><span class="hs-identifier hs-var hs-var"
	    >padLE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920341"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920341"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920343"
      ><span class="annot"
	><span class="annottext"
	  >paddingLength :: Int
</span
	  ><a href="#local-6989586621681920343"
	  ><span class="hs-identifier hs-var hs-var"
	    >paddingLength</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920341"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-197"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920341"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#bytes"
	><span class="hs-identifier hs-var"
	  >Builder.bytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word8 -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#replicate"
	><span class="hs-identifier hs-var"
	  >BS.replicate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920343"
	><span class="hs-identifier hs-var"
	  >paddingLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x0</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-198"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We manually specialize the big-endian case: see Note [Manual specialization] for why.</span
      ><span
      >
</span
      ><span id="line-199"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920305"
	><span class="hs-identifier hs-type"
	  >goBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-200"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920305"
      ><span class="annot"
	><span class="annottext"
	  >goBELimit :: Builder -&gt; Integer -&gt; Maybe Builder
</span
	  ><a href="#local-6989586621681920305"
	  ><span class="hs-identifier hs-var hs-var"
	    >goBELimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920345"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920345"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920346"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920346"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-201"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920346"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Maybe Builder
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Maybe Builder) -&gt; Builder -&gt; Maybe Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder
</span
	><a href="#local-6989586621681920347"
	><span class="hs-identifier hs-var"
	  >padBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920345"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-202"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-203"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#guard"
	><span class="hs-identifier hs-var"
	  >guard</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920345"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-204"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920349"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Integer
</span
	  ><a href="#local-6989586621681920349"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920346"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span
      >
</span
      ><span id="line-205"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920351"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920351"
	  ><span class="hs-identifier hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#fromInteger"
	><span class="hs-identifier hs-var"
	  >fromInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920346"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-206"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920349"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-207"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920352"
	><span class="hs-identifier hs-var"
	  >finishBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920345"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920351"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-208"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920305"
	><span class="hs-identifier hs-var"
	  >goBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word64BE"
	><span class="hs-identifier hs-var"
	  >Builder.word64BE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920351"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920345"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920349"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-209"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920352"
	><span class="hs-identifier hs-type"
	  >finishBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-210"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920352"
      ><span class="annot"
	><span class="annottext"
	  >finishBELimit :: Builder -&gt; Word64 -&gt; Maybe Builder
</span
	  ><a href="#local-6989586621681920352"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishBELimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920354"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920354"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920355"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920355"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-211"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920355"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Maybe Builder
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Builder -&gt; Maybe Builder) -&gt; Builder -&gt; Maybe Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder
</span
	><a href="#local-6989586621681920347"
	><span class="hs-identifier hs-var"
	  >padBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920354"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-212"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-213"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#guard"
	><span class="hs-identifier hs-var"
	  >guard</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920354"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-214"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920357"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Word64
</span
	  ><a href="#local-6989586621681920357"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920355"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-215"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920360"
      ><span class="annot"
	><span class="annottext"
	  >digit :: Word8
</span
	  ><a href="#local-6989586621681920360"
	  ><span class="hs-identifier hs-var hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920355"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-216"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Maybe Builder
</span
	><a href="#local-6989586621681920352"
	><span class="hs-identifier hs-var"
	  >finishBELimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word8"
	><span class="hs-identifier hs-var"
	  >Builder.word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920360"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920354"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920357"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-217"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920300"
	><span class="hs-identifier hs-type"
	  >goBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-218"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920300"
      ><span class="annot"
	><span class="annottext"
	  >goBENoLimit :: Builder -&gt; Integer -&gt; Builder
</span
	  ><a href="#local-6989586621681920300"
	  ><span class="hs-identifier hs-var hs-var"
	    >goBENoLimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920361"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920361"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920362"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920362"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-219"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920362"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920361"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-220"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920364"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Integer
</span
	  ><a href="#local-6989586621681920364"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920362"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span
      >
</span
      ><span id="line-221"
      ></span
      ><span
      >                        </span
      ><span id="local-6989586621681920366"
      ><span class="annot"
	><span class="annottext"
	  >digitGroup :: Word64
</span
	  ><a href="#local-6989586621681920366"
	  ><span class="hs-identifier hs-var hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#fromInteger"
	><span class="hs-identifier hs-var"
	  >fromInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920362"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-222"
      ></span
      ><span
      >                      </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920364"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-223"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Builder
</span
	><a href="#local-6989586621681920367"
	><span class="hs-identifier hs-var"
	  >finishBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920361"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920366"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-224"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Integer -&gt; Builder
</span
	><a href="#local-6989586621681920300"
	><span class="hs-identifier hs-var"
	  >goBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word64BE"
	><span class="hs-identifier hs-var"
	  >Builder.word64BE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920366"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920361"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920364"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-225"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920367"
	><span class="hs-identifier hs-type"
	  >finishBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-226"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920367"
      ><span class="annot"
	><span class="annottext"
	  >finishBENoLimit :: Builder -&gt; Word64 -&gt; Builder
</span
	  ><a href="#local-6989586621681920367"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishBENoLimit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920368"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920368"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920369"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920369"
	  ><span class="hs-identifier hs-var"
	    >remaining</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-227"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920369"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920368"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-228"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920371"
      ><span class="annot"
	><span class="annottext"
	  >newRemaining :: Word64
</span
	  ><a href="#local-6989586621681920371"
	  ><span class="hs-identifier hs-var hs-var"
	    >newRemaining</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920369"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-229"
      ></span
      ><span
      >                        </span
      ><span id="local-6989586621681920374"
      ><span class="annot"
	><span class="annottext"
	  >digit :: Word8
</span
	  ><a href="#local-6989586621681920374"
	  ><span class="hs-identifier hs-var hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920369"
	><span class="hs-identifier hs-var"
	  >remaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-230"
      ></span
      ><span
      >                      </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Word64 -&gt; Builder
</span
	><a href="#local-6989586621681920367"
	><span class="hs-identifier hs-var"
	  >finishBENoLimit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#word8"
	><span class="hs-identifier hs-var"
	  >Builder.word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920374"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920368"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920371"
	><span class="hs-identifier hs-var"
	  >newRemaining</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-231"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920347"
	><span class="hs-identifier hs-type"
	  >padBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#Builder"
	><span class="hs-identifier hs-type"
	  >Builder</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-232"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920347"
      ><span class="annot"
	><span class="annottext"
	  >padBE :: Builder -&gt; Builder
</span
	  ><a href="#local-6989586621681920347"
	  ><span class="hs-identifier hs-var hs-var"
	    >padBE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920375"
      ><span class="annot"
	><span class="annottext"
	  >Builder
</span
	  ><a href="#local-6989586621681920375"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920377"
      ><span class="annot"
	><span class="annottext"
	  >paddingLength :: Int
</span
	  ><a href="#local-6989586621681920377"
	  ><span class="hs-identifier hs-var hs-var"
	    >paddingLength</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920295"
	><span class="hs-identifier hs-var"
	  >requestedLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#builderLength"
	><span class="hs-identifier hs-var"
	  >Builder.builderLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920375"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >in</span
      ><span
      >
</span
      ><span id="line-233"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Builder
</span
	><a href="https://hackage.haskell.org/package/bytestring-strict-builder-0.4.5.8/docs/src/ByteString.StrictBuilder.html#bytes"
	><span class="hs-identifier hs-var"
	  >Builder.bytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word8 -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#replicate"
	><span class="hs-identifier hs-var"
	  >BS.replicate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920377"
	><span class="hs-identifier hs-var"
	  >paddingLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x0</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Builder
</span
	><a href="#local-6989586621681920375"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-234"
      ></span
      ><span
      >
</span
      ><span id="line-235"
      ></span
      ><span class="hs-comment"
      >-- | Conversion from 'ByteString' to 'Integer', as per</span
      ><span
      >
</span
      ><span id="line-236"
      ></span
      ><span class="hs-comment"
      >-- [CIP-121](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0121).</span
      ><span
      >
</span
      ><span id="line-237"
      ></span
      ><span
      >
</span
      ><span id="line-238"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Wrapper for 'unsafeByteStringToInteger' to make it more convenient to define as a builtin.</span
	></span
      ><span
      >
</span
      ><span id="line-239"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#byteStringToInteger"
	><span class="hs-identifier hs-type"
	  >byteStringToInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-240"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-241"
      ></span
      ><span id="byteStringToInteger"
      ><span class="annot"
	><span class="annottext"
	  >byteStringToInteger :: Bool -&gt; ByteString -&gt; Integer
</span
	  ><a href="PlutusCore.Bitwise.html#byteStringToInteger"
	  ><span class="hs-identifier hs-var hs-var"
	    >byteStringToInteger</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920379"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920379"
	  ><span class="hs-identifier hs-var"
	    >statedEndiannessArg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920380"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920380"
	  ><span class="hs-identifier hs-var"
	    >input</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-242"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920381"
      ><span class="annot"
	><span class="annottext"
	  >endianness :: ByteOrder
</span
	  ><a href="#local-6989586621681920381"
	  ><span class="hs-identifier hs-var hs-var"
	    >endianness</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; ByteOrder
</span
	><a href="PlutusCore.Bitwise.html#endiannessArgToByteOrder"
	><span class="hs-identifier hs-var"
	  >endiannessArgToByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920379"
	><span class="hs-identifier hs-var"
	  >statedEndiannessArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >in</span
      ><span
      >
</span
      ><span id="line-243"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder -&gt; ByteString -&gt; Integer
</span
	><a href="PlutusCore.Bitwise.html#unsafeByteStringToInteger"
	><span class="hs-identifier hs-var"
	  >unsafeByteStringToInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="#local-6989586621681920381"
	><span class="hs-identifier hs-var"
	  >endianness</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920380"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-244"
      ></span
      ><span
      >
</span
      ><span id="line-245"
      ></span
      ><span class="hs-comment"
      >-- For clarity, the stated endianness argument uses 'ByteOrder'.</span
      ><span
      >
</span
      ><span id="line-246"
      ></span
      ><span class="hs-comment"
      >-- This function may not actually be unsafe, but it shouldn't be used outside this module.</span
      ><span
      >
</span
      ><span id="line-247"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#unsafeByteStringToInteger"
	><span class="hs-identifier hs-type"
	  >unsafeByteStringToInteger</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#ByteOrder"
	><span class="hs-identifier hs-type"
	  >ByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-248"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- We use manual specialization to ensure as few branches in loop bodies as we can. See Note</span
      ><span
      >
</span
      ><span id="line-249"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- [Manual specialization] for details.</span
      ><span
      >
</span
      ><span id="line-250"
      ></span
      ><span id="unsafeByteStringToInteger"
      ><span class="annot"
	><span class="annottext"
	  >unsafeByteStringToInteger :: ByteOrder -&gt; ByteString -&gt; Integer
</span
	  ><a href="PlutusCore.Bitwise.html#unsafeByteStringToInteger"
	  ><span class="hs-identifier hs-var hs-var"
	    >unsafeByteStringToInteger</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920382"
      ><span class="annot"
	><span class="annottext"
	  >ByteOrder
</span
	  ><a href="#local-6989586621681920382"
	  ><span class="hs-identifier hs-var"
	    >statedByteOrder</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920383"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920383"
	  ><span class="hs-identifier hs-var"
	    >input</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="#local-6989586621681920382"
	><span class="hs-identifier hs-var"
	  >statedByteOrder</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-251"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Since padding bytes in the most-significant-last representation go at</span
      ><span
      >
</span
      ><span id="line-252"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- the end of the input, we can skip decoding them, as they won't affect</span
      ><span
      >
</span
      ><span id="line-253"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- the result in any way.</span
      ><span
      >
</span
      ><span id="line-254"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#LittleEndian"
	><span class="hs-identifier hs-var"
	  >LittleEndian</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#findIndexEnd"
	><span class="hs-identifier hs-var"
	  >BS.findIndexEnd</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%2F%3D"
	><span class="hs-operator hs-var"
	  >/=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x00</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-255"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- If there are no nonzero bytes, it must be zero.</span
      ><span
      >
</span
      ><span id="line-256"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-257"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920386"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920386"
	  ><span class="hs-identifier hs-var"
	    >end</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920387"
	><span class="hs-identifier hs-var"
	  >goLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920386"
	><span class="hs-identifier hs-var"
	  >end</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-258"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Since padding bytes in the most-significant-first representation go at</span
      ><span
      >
</span
      ><span id="line-259"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- the beginning of the input, we can skip decoding them, as they won't</span
      ><span
      >
</span
      ><span id="line-260"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- affect the result in any way.</span
      ><span
      >
</span
      ><span id="line-261"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>ByteOrder
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.ByteOrder.html#BigEndian"
	><span class="hs-identifier hs-var"
	  >BigEndian</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#findIndex"
	><span class="hs-identifier hs-var"
	  >BS.findIndex</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%2F%3D"
	><span class="hs-operator hs-var"
	  >/=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x00</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-262"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-263"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920389"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920389"
	  ><span class="hs-identifier hs-var"
	    >end</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920390"
	><span class="hs-identifier hs-var"
	  >goBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920389"
	><span class="hs-identifier hs-var"
	  >end</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-264"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-265"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Like with toByteString, we use loop sectioning to decode eight digits at once. See Note [Loop</span
      ><span
      >
</span
      ><span id="line-266"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- sectioning] for why we do this.</span
      ><span
      >
</span
      ><span id="line-267"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920387"
	><span class="hs-identifier hs-type"
	  >goLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-268"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920387"
      ><span class="annot"
	><span class="annottext"
	  >goLE :: Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	  ><a href="#local-6989586621681920387"
	  ><span class="hs-identifier hs-var hs-var"
	    >goLE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920392"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920392"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920393"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920393"
	  ><span class="hs-identifier hs-var"
	    >limit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920394"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920394"
	  ><span class="hs-identifier hs-var"
	    >ix</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-269"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920394"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920393"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>7</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-270"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920396"
      ><span class="annot"
	><span class="annottext"
	  >digitGroup :: Word64
</span
	  ><a href="#local-6989586621681920396"
	  ><span class="hs-identifier hs-var hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word64
</span
	><a href="#local-6989586621681920397"
	><span class="hs-identifier hs-var"
	  >read64LE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920394"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-271"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- Same as ix * 8, but faster. GHC might already do this optimization, but we may as</span
      ><span
      >
</span
      ><span id="line-272"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- well be sure.</span
      ><span
      >
</span
      ><span id="line-273"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920400"
      ><span class="annot"
	><span class="annottext"
	  >shift :: Int
</span
	  ><a href="#local-6989586621681920400"
	  ><span class="hs-identifier hs-var hs-var"
	    >shift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920394"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>3</span
	></span
      ><span
      >
</span
      ><span id="line-274"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920403"
      ><span class="annot"
	><span class="annottext"
	  >newIx :: Int
</span
	  ><a href="#local-6989586621681920403"
	  ><span class="hs-identifier hs-var hs-var"
	    >newIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920394"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-275"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- We use unsafeShiftL to move a group of eight digits into the right position in</span
      ><span
      >
</span
      ><span id="line-276"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- the result, then combine with the accumulator. This is equivalent to a</span
      ><span
      >
</span
      ><span id="line-277"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- multiplication by 2^64*k, but significantly faster, as GHC doesn't optimize</span
      ><span
      >
</span
      ><span id="line-278"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- such multiplications into shifts for Integers.</span
      ><span
      >
</span
      ><span id="line-279"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920408"
      ><span class="annot"
	><span class="annottext"
	  >newAcc :: Integer
</span
	  ><a href="#local-6989586621681920408"
	  ><span class="hs-identifier hs-var hs-var"
	    >newAcc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920392"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920396"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920400"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-280"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920387"
	><span class="hs-identifier hs-var"
	  >goLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920408"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920393"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920403"
	><span class="hs-identifier hs-var"
	  >newIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-281"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920409"
	><span class="hs-identifier hs-var"
	  >finishLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920392"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920393"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920394"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-282"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920409"
	><span class="hs-identifier hs-type"
	  >finishLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-283"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920409"
      ><span class="annot"
	><span class="annottext"
	  >finishLE :: Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	  ><a href="#local-6989586621681920409"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishLE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920410"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920410"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920411"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920411"
	  ><span class="hs-identifier hs-var"
	    >limit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920412"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920412"
	  ><span class="hs-identifier hs-var"
	    >ix</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-284"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920412"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920411"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920410"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-285"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-286"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920415"
      ><span class="annot"
	><span class="annottext"
	  >digit :: Word8
</span
	  ><a href="#local-6989586621681920415"
	  ><span class="hs-identifier hs-var hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920412"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-287"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920418"
      ><span class="annot"
	><span class="annottext"
	  >shift :: Int
</span
	  ><a href="#local-6989586621681920418"
	  ><span class="hs-identifier hs-var hs-var"
	    >shift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920412"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>3</span
	></span
      ><span
      >
</span
      ><span id="line-288"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920421"
      ><span class="annot"
	><span class="annottext"
	  >newIx :: Int
</span
	  ><a href="#local-6989586621681920421"
	  ><span class="hs-identifier hs-var hs-var"
	    >newIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920412"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-289"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- Similarly to before, we use unsafeShiftL to move a single digit into the right</span
      ><span
      >
</span
      ><span id="line-290"
      ></span
      ><span
      >              </span
      ><span class="hs-comment"
      >-- position in the result.</span
      ><span
      >
</span
      ><span id="line-291"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920426"
      ><span class="annot"
	><span class="annottext"
	  >newAcc :: Integer
</span
	  ><a href="#local-6989586621681920426"
	  ><span class="hs-identifier hs-var hs-var"
	    >newAcc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920410"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920415"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920418"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-292"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920409"
	><span class="hs-identifier hs-var"
	  >finishLE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920426"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920411"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920421"
	><span class="hs-identifier hs-var"
	  >newIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-293"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Technically, ByteString does not allow reading of anything bigger than a single byte.</span
      ><span
      >
</span
      ><span id="line-294"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- However, because ByteStrings are counted arrays, caching already brings in adjacent bytes,</span
      ><span
      >
</span
      ><span id="line-295"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- which makes fetching them quite cheap. Additionally, GHC appears to optimize this into a</span
      ><span
      >
</span
      ><span id="line-296"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- block read of 64 bits at once, which saves memory movement. See Note [Superscalarity and</span
      ><span
      >
</span
      ><span id="line-297"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- caching] for details of why this matters.</span
      ><span
      >
</span
      ><span id="line-298"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920397"
	><span class="hs-identifier hs-type"
	  >read64LE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-299"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920397"
      ><span class="annot"
	><span class="annottext"
	  >read64LE :: Int -&gt; Word64
</span
	  ><a href="#local-6989586621681920397"
	  ><span class="hs-identifier hs-var hs-var"
	    >read64LE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920427"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920427"
	  ><span class="hs-identifier hs-var"
	    >startIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-300"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-301"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-302"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>16</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-303"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>3</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>24</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-304"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>4</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>32</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-305"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>5</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>40</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-306"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>6</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>48</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-307"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920427"
	><span class="hs-identifier hs-var"
	  >startIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>7</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>56</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-308"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We manually specialize the big-endian cases: see Note [Manual specialization] for why.</span
      ><span
      >
</span
      ><span id="line-309"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-310"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- In the big-endian case, shifts and indexes change in different ways: indexes start _high_</span
      ><span
      >
</span
      ><span id="line-311"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- and _reduce_, but shifts start _low_ and rise. This is different to the little-endian case,</span
      ><span
      >
</span
      ><span id="line-312"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- where both start low and rise. Thus, we track the index and shift separately in the</span
      ><span
      >
</span
      ><span id="line-313"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- big-endian case: it makes the adjustments easier, and doesn't really change anything, as if</span
      ><span
      >
</span
      ><span id="line-314"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- we wanted to compute the shift, we'd have to pass an offset argument anyway.</span
      ><span
      >
</span
      ><span id="line-315"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920390"
	><span class="hs-identifier hs-type"
	  >goBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-316"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920390"
      ><span class="annot"
	><span class="annottext"
	  >goBE :: Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	  ><a href="#local-6989586621681920390"
	  ><span class="hs-identifier hs-var hs-var"
	    >goBE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920428"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920428"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920429"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920429"
	  ><span class="hs-identifier hs-var"
	    >limit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920430"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920430"
	  ><span class="hs-identifier hs-var"
	    >shift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920431"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920431"
	  ><span class="hs-identifier hs-var"
	    >ix</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-317"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920431"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920429"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>7</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-318"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920432"
      ><span class="annot"
	><span class="annottext"
	  >digitGroup :: Word64
</span
	  ><a href="#local-6989586621681920432"
	  ><span class="hs-identifier hs-var hs-var"
	    >digitGroup</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word64
</span
	><a href="#local-6989586621681920433"
	><span class="hs-identifier hs-var"
	  >read64BE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920431"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-319"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920436"
      ><span class="annot"
	><span class="annottext"
	  >newShift :: Int
</span
	  ><a href="#local-6989586621681920436"
	  ><span class="hs-identifier hs-var hs-var"
	    >newShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920430"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span
      >
</span
      ><span id="line-320"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920439"
      ><span class="annot"
	><span class="annottext"
	  >newIx :: Int
</span
	  ><a href="#local-6989586621681920439"
	  ><span class="hs-identifier hs-var hs-var"
	    >newIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920431"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-321"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920444"
      ><span class="annot"
	><span class="annottext"
	  >newAcc :: Integer
</span
	  ><a href="#local-6989586621681920444"
	  ><span class="hs-identifier hs-var hs-var"
	    >newAcc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920428"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920432"
	><span class="hs-identifier hs-var"
	  >digitGroup</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920430"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-322"
      ></span
      ><span
      >           </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920390"
	><span class="hs-identifier hs-var"
	  >goBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920444"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920429"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920436"
	><span class="hs-identifier hs-var"
	  >newShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920439"
	><span class="hs-identifier hs-var"
	  >newIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-323"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920445"
	><span class="hs-identifier hs-var"
	  >finishBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920428"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920429"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920430"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920431"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-324"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920445"
	><span class="hs-identifier hs-type"
	  >finishBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-325"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920445"
      ><span class="annot"
	><span class="annottext"
	  >finishBE :: Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	  ><a href="#local-6989586621681920445"
	  ><span class="hs-identifier hs-var hs-var"
	    >finishBE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920446"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920446"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920447"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920447"
	  ><span class="hs-identifier hs-var"
	    >limit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920448"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920448"
	  ><span class="hs-identifier hs-var"
	    >shift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920449"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920449"
	  ><span class="hs-identifier hs-var"
	    >ix</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-326"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920449"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920447"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920446"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-327"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-328"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920452"
      ><span class="annot"
	><span class="annottext"
	  >digit :: Word8
</span
	  ><a href="#local-6989586621681920452"
	  ><span class="hs-identifier hs-var hs-var"
	    >digit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920449"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-329"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920455"
      ><span class="annot"
	><span class="annottext"
	  >newShift :: Int
</span
	  ><a href="#local-6989586621681920455"
	  ><span class="hs-identifier hs-var hs-var"
	    >newShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920448"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-330"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920458"
      ><span class="annot"
	><span class="annottext"
	  >newIx :: Int
</span
	  ><a href="#local-6989586621681920458"
	  ><span class="hs-identifier hs-var hs-var"
	    >newIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920449"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-331"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920463"
      ><span class="annot"
	><span class="annottext"
	  >newAcc :: Integer
</span
	  ><a href="#local-6989586621681920463"
	  ><span class="hs-identifier hs-var hs-var"
	    >newAcc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920446"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920452"
	><span class="hs-identifier hs-var"
	  >digit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920448"
	><span class="hs-identifier hs-var"
	  >shift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-332"
      ></span
      ><span
      >           </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Integer
</span
	><a href="#local-6989586621681920445"
	><span class="hs-identifier hs-var"
	  >finishBE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920463"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920447"
	><span class="hs-identifier hs-var"
	  >limit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920455"
	><span class="hs-identifier hs-var"
	  >newShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920458"
	><span class="hs-identifier hs-var"
	  >newIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-333"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920433"
	><span class="hs-identifier hs-type"
	  >read64BE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-334"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920433"
      ><span class="annot"
	><span class="annottext"
	  >read64BE :: Int -&gt; Word64
</span
	  ><a href="#local-6989586621681920433"
	  ><span class="hs-identifier hs-var hs-var"
	    >read64BE</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920464"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920464"
	  ><span class="hs-identifier hs-var"
	    >endIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-335"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-336"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-337"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>16</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-338"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>3</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>24</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-339"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>4</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>32</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-340"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>5</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>40</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-341"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>6</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>48</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-342"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >.|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920383"
	><span class="hs-identifier hs-var"
	  >input</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920464"
	><span class="hs-identifier hs-var"
	  >endIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>7</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>56</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-343"
      ></span
      ><span
      >
</span
      ><span id="line-344"
      ></span
      ><span class="hs-comment"
      >{- Note [Binary bitwise operation implementation and manual specialization]

   All of the 'binary' bitwise operations (namely `andByteString`,
   `orByteString` and `xorByteString`) operate similarly:

   1. Decide which of their two `ByteString` arguments determines the length
      of the result. For padding semantics, this is the _longer_ argument,
      whereas for truncation semantics, it's the _shorter_ one. If both
      `ByteString` arguments have identical length, it doesn't matter which we
      choose.
   2. Copy the choice made in step 1 into a fresh mutable buffer.
   3. Traverse over each byte of the argument _not_ chosen in step 1, and
      combine each of those bytes with the byte at the corresponding index of
      the fresh mutable buffer from step 2 (`.&amp;.` for `andByteString`,
      `.|.` for `orByteString`, `xor` for `xorByteString`).

  We also make use of loop sectioning to optimize this operation: see Note
  [Loop sectioning] explaining why we do this. Fundamentally, this doesn't
  change the logic of the operation, but means that step 3 is split into
  two smaller sub-steps: we first word 8 bytes at a time, then one byte at a
  time to finish up if necessary. Other than the choice of 'combining
  operation', the structure of the computation is the same, which suggests that
  we want a helper function with a signature like

  helper1 ::
    (Word64 -&gt; Word64 -&gt; Word64) -&gt;
    (Word8 -&gt; Word8 -&gt; Word8) -&gt;
    ByteString -&gt;
    ByteString -&gt;
    Int -&gt;
    ByteString

  or possibly (to avoid duplicate argument passing) like

  helper2 ::
    (forall (a :: Type) . Bits a =&gt; a -&gt; a -&gt; a) -&gt;
    ByteString -&gt;
    ByteString -&gt;
    Int -&gt;
    ByteString

  This would allow us to share all this logic, and have each of the 'top-level'
  operations just dispatch to either of the helpers with the appropriate
  function argument(s). Instead, we chose to write a manual copy of this logic
  for each of the 'top-level' operations, substituting only the 'combining
  operation'.

  We made this choice as any design based on either `helper1` or `helper2` is
  significantly slower (at least 50% worse, and the penalty _percentage_ grows
  with argument size). While `helper2` is significantly more penalizing than
  `helper1`, even `helper1` reaches an almost threefold slowdown at the higher
  input sizes we are interested in relative the manual version we use here.
  Due to the 'low-level' nature of Plutus Core primops, we consider these costs
  unacceptable relative the (small) benefits to code clarity and maintainability
  any solution using either style of helper would provide.

  The reason for `helper2` under-performing is unsurprising: any argument whose
  type is rank-2 polymorphic with a dictionary constraint essentially acts as
  a 'program template', which gets interpreted at runtime given some dictionary
  for a `Bits` instance. GHC can do practically nothing to optimize this, as
  there is no way to tell, for any given argument, _which_ definitions of an
  instance would be required here, even if the set of operations we use is
  finite, since any instance can make use of the full power of Haskell, which
  essentially lands us in Rice's Theorem territory. For `helper1`, the reasons
  are similar: it _must_ be able to work regardless of what functions (assuming
  appropriate types) it is given, which means in general, GHC is forced to
  compile mother-may-I-style code involving pointer chasing those arguments at
  runtime. This explains why the 'blowup' becomes worse with argument length.

  While in theory inlining could help with at least the `helper1` case (
  `helper2` is beyond that technique), it doesn't seem like GHC is able to
  figure this out, even with `INLINE` is placed on `helper1`.
  -}</span
      ><span
      >
</span
      ><span id="line-417"
      ></span
      ><span
      >
</span
      ><span id="line-418"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bitwise logical AND, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122).</span
	></span
      ><span
      >
</span
      ><span id="line-419"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#andByteString"
	><span class="hs-identifier hs-type"
	  >andByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-420"
      ></span
      ><span id="andByteString"
      ><span class="annot"
	><span class="annottext"
	  >andByteString :: Bool -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#andByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >andByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920465"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920465"
	  ><span class="hs-identifier hs-var"
	    >shouldPad</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920466"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920466"
	  ><span class="hs-identifier hs-var"
	    >bs1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920467"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920467"
	  ><span class="hs-identifier hs-var"
	    >bs2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-421"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920469"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920469"
	  ><span class="hs-identifier hs-var"
	    >shorter</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920470"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920470"
	  ><span class="hs-identifier hs-var"
	    >longer</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920466"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920467"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920466"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920467"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920467"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920466"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-422"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920471"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920471"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920472"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920472"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920465"
	><span class="hs-identifier hs-var"
	  >shouldPad</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920470"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920469"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920469"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920470"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-423"
      ></span
      ><span
      >   </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	><a href="#local-6989586621681920473"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920471"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920472"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920469"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-424"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-425"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920473"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-426"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920473"
      ><span class="annot"
	><span class="annottext"
	  >go :: ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	  ><a href="#local-6989586621681920473"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920474"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920474"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920475"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920475"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920476"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920476"
	  ><span class="hs-identifier hs-var"
	    >traverseLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-427"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCStringLen"
	><span class="hs-identifier hs-var"
	  >BS.useAsCStringLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920474"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((CStringLen -&gt; IO ByteString) -&gt; ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920478"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920478"
	  ><span class="hs-identifier hs-var"
	    >copyPtr</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920479"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920479"
	  ><span class="hs-identifier hs-var"
	    >copyLen</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-428"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920475"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920481"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920481"
	  ><span class="hs-identifier hs-var"
	    >traversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-429"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920479"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920483"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920483"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-430"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920483"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920478"
	><span class="hs-identifier hs-var"
	  >copyPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920479"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-431"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920486"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920486"
	  ><span class="hs-identifier hs-var"
	    >bigStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920487"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920487"
	  ><span class="hs-identifier hs-var"
	    >littleStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920476"
	><span class="hs-identifier hs-var"
	  >traverseLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-432"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920491"
      ><span class="annot"
	><span class="annottext"
	  >offset :: Int
</span
	  ><a href="#local-6989586621681920491"
	  ><span class="hs-identifier hs-var hs-var"
	    >offset</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920486"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-433"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920492"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920492"
	  ><span class="hs-identifier hs-var"
	    >bigDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920483"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-434"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920493"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920493"
	  ><span class="hs-identifier hs-var"
	    >bigTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920481"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-435"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920486"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920494"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920494"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-436"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920495"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920495"
	  ><span class="hs-identifier hs-var"
	    >w64_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920492"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920494"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-437"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920496"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920496"
	  ><span class="hs-identifier hs-var"
	    >w64_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920493"
	><span class="hs-identifier hs-var"
	  >bigTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920494"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-438"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Word64 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920492"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920494"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word64 -&gt; IO ()) -&gt; Word64 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920495"
	><span class="hs-identifier hs-var"
	  >w64_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920496"
	><span class="hs-identifier hs-var"
	  >w64_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-439"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920498"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920498"
	  ><span class="hs-identifier hs-var"
	    >smallDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920483"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920491"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-440"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920499"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920499"
	  ><span class="hs-identifier hs-var"
	    >smallTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920481"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920491"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-441"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920487"
	><span class="hs-identifier hs-var"
	  >littleStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920500"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920500"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-442"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920501"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920501"
	  ><span class="hs-identifier hs-var"
	    >w8_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920498"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920500"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-443"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920502"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920502"
	  ><span class="hs-identifier hs-var"
	    >w8_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920499"
	><span class="hs-identifier hs-var"
	  >smallTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920500"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-444"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920498"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920500"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; IO ()) -&gt; Word8 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920501"
	><span class="hs-identifier hs-var"
	  >w8_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920502"
	><span class="hs-identifier hs-var"
	  >w8_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-445"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#andByteString"
	><span class="hs-pragma hs-type"
	  >andByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-446"
      ></span
      ><span
      >
</span
      ><span id="line-447"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bitwise logical OR, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122).</span
	></span
      ><span
      >
</span
      ><span id="line-448"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#orByteString"
	><span class="hs-identifier hs-type"
	  >orByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-449"
      ></span
      ><span id="orByteString"
      ><span class="annot"
	><span class="annottext"
	  >orByteString :: Bool -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#orByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >orByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920503"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920503"
	  ><span class="hs-identifier hs-var"
	    >shouldPad</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920504"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920504"
	  ><span class="hs-identifier hs-var"
	    >bs1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920505"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920505"
	  ><span class="hs-identifier hs-var"
	    >bs2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-450"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920507"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920507"
	  ><span class="hs-identifier hs-var"
	    >shorter</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920508"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920508"
	  ><span class="hs-identifier hs-var"
	    >longer</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920504"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920505"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920504"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920505"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920505"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920504"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-451"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920509"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920509"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920510"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920510"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920503"
	><span class="hs-identifier hs-var"
	  >shouldPad</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920508"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920507"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920507"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920508"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-452"
      ></span
      ><span
      >   </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	><a href="#local-6989586621681920511"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920509"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920510"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920507"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-453"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-454"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920511"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-455"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920511"
      ><span class="annot"
	><span class="annottext"
	  >go :: ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	  ><a href="#local-6989586621681920511"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920512"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920512"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920513"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920513"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920514"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920514"
	  ><span class="hs-identifier hs-var"
	    >traverseLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-456"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCStringLen"
	><span class="hs-identifier hs-var"
	  >BS.useAsCStringLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920512"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((CStringLen -&gt; IO ByteString) -&gt; ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920515"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920515"
	  ><span class="hs-identifier hs-var"
	    >copyPtr</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920516"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920516"
	  ><span class="hs-identifier hs-var"
	    >copyLen</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-457"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920513"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920517"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920517"
	  ><span class="hs-identifier hs-var"
	    >traversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-458"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920516"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920518"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920518"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-459"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920518"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920515"
	><span class="hs-identifier hs-var"
	  >copyPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920516"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-460"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920521"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920521"
	  ><span class="hs-identifier hs-var"
	    >bigStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920522"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920522"
	  ><span class="hs-identifier hs-var"
	    >littleStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920514"
	><span class="hs-identifier hs-var"
	  >traverseLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-461"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920525"
      ><span class="annot"
	><span class="annottext"
	  >offset :: Int
</span
	  ><a href="#local-6989586621681920525"
	  ><span class="hs-identifier hs-var hs-var"
	    >offset</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920521"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-462"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920526"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920526"
	  ><span class="hs-identifier hs-var"
	    >bigDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920518"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-463"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920527"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920527"
	  ><span class="hs-identifier hs-var"
	    >bigTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920517"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-464"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920521"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920528"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920528"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-465"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920529"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920529"
	  ><span class="hs-identifier hs-var"
	    >w64_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920526"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920528"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-466"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920530"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920530"
	  ><span class="hs-identifier hs-var"
	    >w64_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920527"
	><span class="hs-identifier hs-var"
	  >bigTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920528"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-467"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Word64 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920526"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920528"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word64 -&gt; IO ()) -&gt; Word64 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920529"
	><span class="hs-identifier hs-var"
	  >w64_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920530"
	><span class="hs-identifier hs-var"
	  >w64_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-468"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920531"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920531"
	  ><span class="hs-identifier hs-var"
	    >smallDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920518"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920525"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-469"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920532"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920532"
	  ><span class="hs-identifier hs-var"
	    >smallTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920517"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920525"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-470"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920522"
	><span class="hs-identifier hs-var"
	  >littleStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920533"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920533"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-471"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920534"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920534"
	  ><span class="hs-identifier hs-var"
	    >w8_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920531"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920533"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-472"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920535"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920535"
	  ><span class="hs-identifier hs-var"
	    >w8_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920532"
	><span class="hs-identifier hs-var"
	  >smallTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920533"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-473"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920531"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920533"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; IO ()) -&gt; Word8 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920534"
	><span class="hs-identifier hs-var"
	  >w8_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920535"
	><span class="hs-identifier hs-var"
	  >w8_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-474"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#orByteString"
	><span class="hs-pragma hs-type"
	  >orByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-475"
      ></span
      ><span
      >
</span
      ><span id="line-476"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bitwise logical XOR, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122).</span
	></span
      ><span
      >
</span
      ><span id="line-477"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#xorByteString"
	><span class="hs-identifier hs-type"
	  >xorByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-478"
      ></span
      ><span id="xorByteString"
      ><span class="annot"
	><span class="annottext"
	  >xorByteString :: Bool -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#xorByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >xorByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920536"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920536"
	  ><span class="hs-identifier hs-var"
	    >shouldPad</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920537"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920537"
	  ><span class="hs-identifier hs-var"
	    >bs1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920538"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920538"
	  ><span class="hs-identifier hs-var"
	    >bs2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-479"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920540"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920540"
	  ><span class="hs-identifier hs-var"
	    >shorter</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920541"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920541"
	  ><span class="hs-identifier hs-var"
	    >longer</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920537"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920538"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920537"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920538"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920538"
	><span class="hs-identifier hs-var"
	  >bs2</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920537"
	><span class="hs-identifier hs-var"
	  >bs1</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-480"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920542"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920542"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920543"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920543"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920536"
	><span class="hs-identifier hs-var"
	  >shouldPad</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920541"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920540"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920540"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920541"
	><span class="hs-identifier hs-var"
	  >longer</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-481"
      ></span
      ><span
      >   </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	><a href="#local-6989586621681920544"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920542"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920543"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920540"
	><span class="hs-identifier hs-var"
	  >shorter</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-482"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-483"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920544"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-484"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920544"
      ><span class="annot"
	><span class="annottext"
	  >go :: ByteString -&gt; ByteString -&gt; Int -&gt; ByteString
</span
	  ><a href="#local-6989586621681920544"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920545"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920545"
	  ><span class="hs-identifier hs-var"
	    >toCopy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920546"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920546"
	  ><span class="hs-identifier hs-var"
	    >toTraverse</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920547"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920547"
	  ><span class="hs-identifier hs-var"
	    >traverseLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-485"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCStringLen"
	><span class="hs-identifier hs-var"
	  >BS.useAsCStringLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920545"
	><span class="hs-identifier hs-var"
	  >toCopy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((CStringLen -&gt; IO ByteString) -&gt; ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920548"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920548"
	  ><span class="hs-identifier hs-var"
	    >copyPtr</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920549"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920549"
	  ><span class="hs-identifier hs-var"
	    >copyLen</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-486"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920546"
	><span class="hs-identifier hs-var"
	  >toTraverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920550"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920550"
	  ><span class="hs-identifier hs-var"
	    >traversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-487"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920549"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920551"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920551"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-488"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920551"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920548"
	><span class="hs-identifier hs-var"
	  >copyPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920549"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-489"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920554"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920554"
	  ><span class="hs-identifier hs-var"
	    >bigStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920555"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920555"
	  ><span class="hs-identifier hs-var"
	    >littleStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920547"
	><span class="hs-identifier hs-var"
	  >traverseLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-490"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920558"
      ><span class="annot"
	><span class="annottext"
	  >offset :: Int
</span
	  ><a href="#local-6989586621681920558"
	  ><span class="hs-identifier hs-var hs-var"
	    >offset</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920554"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-491"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920559"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920559"
	  ><span class="hs-identifier hs-var"
	    >bigDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920551"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-492"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920560"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920560"
	  ><span class="hs-identifier hs-var"
	    >bigTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920550"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-493"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920554"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920561"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920561"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-494"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920562"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920562"
	  ><span class="hs-identifier hs-var"
	    >w64_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920559"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920561"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-495"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920563"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920563"
	  ><span class="hs-identifier hs-var"
	    >w64_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920560"
	><span class="hs-identifier hs-var"
	  >bigTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920561"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-496"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Word64 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920559"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920561"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word64 -&gt; IO ()) -&gt; Word64 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#xor"
	><span class="hs-identifier hs-var"
	  >Bits.xor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920562"
	><span class="hs-identifier hs-var"
	  >w64_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920563"
	><span class="hs-identifier hs-var"
	  >w64_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-497"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920565"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920565"
	  ><span class="hs-identifier hs-var"
	    >smallDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920551"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920558"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-498"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920566"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920566"
	  ><span class="hs-identifier hs-var"
	    >smallTraversePtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920550"
	><span class="hs-identifier hs-var"
	  >traversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920558"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-499"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920555"
	><span class="hs-identifier hs-var"
	  >littleStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920567"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920567"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-500"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920568"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920568"
	  ><span class="hs-identifier hs-var"
	    >w8_1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920565"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920567"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-501"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621681920569"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920569"
	  ><span class="hs-identifier hs-var"
	    >w8_2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920566"
	><span class="hs-identifier hs-var"
	  >smallTraversePtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920567"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-502"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920565"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920567"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; IO ()) -&gt; Word8 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#xor"
	><span class="hs-identifier hs-var"
	  >Bits.xor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920568"
	><span class="hs-identifier hs-var"
	  >w8_1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920569"
	><span class="hs-identifier hs-var"
	  >w8_2</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-503"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#xorByteString"
	><span class="hs-pragma hs-type"
	  >xorByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-504"
      ></span
      ><span
      >
</span
      ><span id="line-505"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bitwise logical complement, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122).</span
	></span
      ><span
      >
</span
      ><span id="line-506"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#complementByteString"
	><span class="hs-identifier hs-type"
	  >complementByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-507"
      ></span
      ><span id="complementByteString"
      ><span class="annot"
	><span class="annottext"
	  >complementByteString :: ByteString -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#complementByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >complementByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920570"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920570"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCStringLen"
	><span class="hs-identifier hs-var"
	  >BS.useAsCStringLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920570"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((CStringLen -&gt; IO ByteString) -&gt; ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920571"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920571"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920572"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920572"
	  ><span class="hs-identifier hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-508"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- We use loop sectioning here; see Note [Loop sectioning] as to why we do this</span
      ><span
      >
</span
      ><span id="line-509"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920575"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920575"
	  ><span class="hs-identifier hs-var"
	    >bigStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920576"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920576"
	  ><span class="hs-identifier hs-var"
	    >littleStrides</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920572"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-510"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920579"
      ><span class="annot"
	><span class="annottext"
	  >offset :: Int
</span
	  ><a href="#local-6989586621681920579"
	  ><span class="hs-identifier hs-var hs-var"
	    >offset</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920575"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-511"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920572"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920580"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920580"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-512"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920581"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920581"
	  ><span class="hs-identifier hs-var"
	    >bigSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920571"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-513"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920582"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920582"
	  ><span class="hs-identifier hs-var"
	    >bigDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920580"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-514"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920575"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920583"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920583"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-515"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621681920584"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920584"
	  ><span class="hs-identifier hs-var"
	    >w64</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920581"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920583"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-516"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Word64 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920582"
	><span class="hs-identifier hs-var"
	  >bigDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920583"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word64 -&gt; IO ()) -&gt; (Word64 -&gt; Word64) -&gt; Word64 -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#complement"
	><span class="hs-identifier hs-var"
	  >Bits.complement</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word64 -&gt; IO ()) -&gt; Word64 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920584"
	><span class="hs-identifier hs-var"
	  >w64</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-517"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920586"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920586"
	  ><span class="hs-identifier hs-var"
	    >smallSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920571"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920579"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-518"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920587"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920587"
	  ><span class="hs-identifier hs-var"
	    >smallDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920580"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920579"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-519"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920576"
	><span class="hs-identifier hs-var"
	  >littleStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920588"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920588"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-520"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621681920589"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920589"
	  ><span class="hs-identifier hs-var"
	    >w8</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920586"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920588"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-521"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeElemOff"
	><span class="hs-identifier hs-var"
	  >pokeElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920587"
	><span class="hs-identifier hs-var"
	  >smallDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920588"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; IO ()) -&gt; (Word8 -&gt; Word8) -&gt; Word8 -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#complement"
	><span class="hs-identifier hs-var"
	  >Bits.complement</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; IO ()) -&gt; Word8 -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920589"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-522"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#complementByteString"
	><span class="hs-pragma hs-type"
	  >complementByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-523"
      ></span
      ><span
      >
</span
      ><span id="line-524"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bit read at index, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122)</span
	></span
      ><span
      >
</span
      ><span id="line-525"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#readBit"
	><span class="hs-identifier hs-type"
	  >readBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#BuiltinResult"
	><span class="hs-identifier hs-type"
	  >BuiltinResult</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-526"
      ></span
      ><span id="readBit"
      ><span class="annot"
	><span class="annottext"
	  >readBit :: ByteString -&gt; Int -&gt; BuiltinResult Bool
</span
	  ><a href="PlutusCore.Bitwise.html#readBit"
	  ><span class="hs-identifier hs-var hs-var"
	    >readBit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920590"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920590"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920591"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920591"
	  ><span class="hs-identifier hs-var"
	    >ix</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-527"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920591"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-528"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;readBit: index out of bounds&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-529"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Index: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Text) -&gt; Int -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920591"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-530"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult Bool
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-531"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920591"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920592"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-532"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;readBit: index out of bounds&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-533"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Index: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Text) -&gt; Int -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920591"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-534"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult Bool
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-535"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-536"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920595"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920595"
	  ><span class="hs-identifier hs-var"
	    >bigIx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920596"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920596"
	  ><span class="hs-identifier hs-var"
	    >littleIx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920591"
	><span class="hs-identifier hs-var"
	  >ix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-537"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920600"
      ><span class="annot"
	><span class="annottext"
	  >flipIx :: Int
</span
	  ><a href="#local-6989586621681920600"
	  ><span class="hs-identifier hs-var hs-var"
	    >flipIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920592"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920595"
	><span class="hs-identifier hs-var"
	  >bigIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-538"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; BuiltinResult Bool
forall a. a -&gt; BuiltinResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Bool -&gt; BuiltinResult Bool) -&gt; Bool -&gt; BuiltinResult Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#testBit"
	><span class="hs-identifier hs-var"
	  >Bits.testBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
ByteString -&gt; Int -&gt; Word8
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#index"
	><span class="hs-identifier hs-var"
	  >BS.index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920590"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920600"
	><span class="hs-identifier hs-var"
	  >flipIx</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920596"
	><span class="hs-identifier hs-var"
	  >littleIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-539"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-540"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920592"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-541"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920592"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920592"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920590"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-542"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#readBit"
	><span class="hs-pragma hs-type"
	  >readBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-543"
      ></span
      ><span
      >
</span
      ><span id="line-544"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Bulk bit write, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122)</span
	></span
      ><span
      >
</span
      ><span id="line-545"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#writeBits"
	><span class="hs-identifier hs-type"
	  >writeBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#BuiltinResult"
	><span class="hs-identifier hs-type"
	  >BuiltinResult</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-546"
      ></span
      ><span id="writeBits"
      ><span class="annot"
	><span class="annottext"
	  >writeBits :: ByteString -&gt; [Integer] -&gt; Bool -&gt; BuiltinResult ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#writeBits"
	  ><span class="hs-identifier hs-var hs-var"
	    >writeBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920602"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920602"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920603"
      ><span class="annot"
	><span class="annottext"
	  >[Integer]
</span
	  ><a href="#local-6989586621681920603"
	  ><span class="hs-identifier hs-var"
	    >ixs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920604"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621681920604"
	  ><span class="hs-identifier hs-var"
	    >bit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO (Either WriteBitsException ByteString)
-&gt; Either WriteBitsException ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO (Either WriteBitsException ByteString)
 -&gt; Either WriteBitsException ByteString)
-&gt; (IO ByteString -&gt; IO (Either WriteBitsException ByteString))
-&gt; IO ByteString
-&gt; Either WriteBitsException ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; IO (Either WriteBitsException ByteString)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Exception.Base.html#try"
	><span class="hs-identifier hs-var"
	  >try</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; Either WriteBitsException ByteString)
-&gt; IO ByteString -&gt; Either WriteBitsException ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString
</span
	><a href="#local-6989586621681920605"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-547"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Left"
	><span class="hs-identifier hs-type"
	  >Left</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#WriteBitsException"
	><span class="hs-identifier hs-type"
	  >WriteBitsException</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920607"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920607"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-548"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;writeBits: index out of bounds&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-549"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Index: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920607"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-550"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-551"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Either.html#Right"
	><span class="hs-identifier hs-type"
	  >Right</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621681920608"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920608"
	  ><span class="hs-identifier hs-var"
	    >result</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; BuiltinResult ByteString
forall a. a -&gt; BuiltinResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920608"
	><span class="hs-identifier hs-var"
	  >result</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-552"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-553"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- This is written in a somewhat strange way. See Note [writeBits and</span
      ><span
      >
</span
      ><span id="line-554"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- exceptions], which covers why we did this.</span
      ><span
      >
</span
      ><span id="line-555"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920605"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-556"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920605"
      ><span class="annot"
	><span class="annottext"
	  >go :: IO ByteString
</span
	  ><a href="#local-6989586621681920605"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920602"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920609"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920609"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-557"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920610"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-558"
      ></span
      ><span
      >            </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920611"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920611"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-559"
      ></span
      ><span
      >              </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920614"
      ><span class="annot"
	><span class="annottext"
	  >go2 :: [Integer] -&gt; IO ()
</span
	  ><a href="#local-6989586621681920614"
	  ><span class="hs-identifier hs-var hs-var"
	    >go2</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920615"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920615"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span id="local-6989586621681920616"
      ><span class="annot"
	><span class="annottext"
	  >[Integer]
</span
	  ><a href="#local-6989586621681920616"
	  ><span class="hs-identifier hs-var"
	    >is</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Integer -&gt; IO ()
</span
	><a href="#local-6989586621681920617"
	><span class="hs-identifier hs-var"
	  >setOrClearAtIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920611"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920615"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2A%3E"
	><span class="hs-operator hs-var"
	  >*&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Integer] -&gt; IO ()
</span
	><a href="#local-6989586621681920614"
	><span class="hs-identifier hs-var"
	  >go2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Integer]
</span
	><a href="#local-6989586621681920616"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-560"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><a href="#local-6989586621681920614"
	><span class="hs-identifier hs-var"
	  >go2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Integer]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-561"
      ></span
      ><span
      >              </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-562"
      ></span
      ><span
      >                </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920611"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920609"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920610"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-563"
      ></span
      ><span
      >                </span
      ><span class="annot"
      ><span class="annottext"
	>[Integer] -&gt; IO ()
</span
	><a href="#local-6989586621681920614"
	><span class="hs-identifier hs-var"
	  >go2</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Integer]
</span
	><a href="#local-6989586621681920603"
	><span class="hs-identifier hs-var"
	  >ixs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-564"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920610"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-565"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920610"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920610"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920602"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-566"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920618"
	><span class="hs-identifier hs-type"
	  >bitLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-567"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920618"
      ><span class="annot"
	><span class="annottext"
	  >bitLen :: Integer
</span
	  ><a href="#local-6989586621681920618"
	  ><span class="hs-identifier hs-var hs-var"
	    >bitLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920610"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-568"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920617"
	><span class="hs-identifier hs-type"
	  >setOrClearAtIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-569"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920617"
      ><span class="annot"
	><span class="annottext"
	  >setOrClearAtIx :: Ptr Word8 -&gt; Integer -&gt; IO ()
</span
	  ><a href="#local-6989586621681920617"
	  ><span class="hs-identifier hs-var hs-var"
	    >setOrClearAtIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920619"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920619"
	  ><span class="hs-identifier hs-var"
	    >ptr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920620"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920620"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-570"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920620"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>WriteBitsException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.html#throwIO"
	><span class="hs-identifier hs-var"
	  >throwIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(WriteBitsException -&gt; IO ()) -&gt; WriteBitsException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; WriteBitsException
</span
	><a href="PlutusCore.Bitwise.html#WriteBitsException"
	><span class="hs-identifier hs-var"
	  >WriteBitsException</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920620"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-571"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920620"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920618"
	><span class="hs-identifier hs-var"
	  >bitLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>WriteBitsException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.html#throwIO"
	><span class="hs-identifier hs-var"
	  >throwIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(WriteBitsException -&gt; IO ()) -&gt; WriteBitsException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; WriteBitsException
</span
	><a href="PlutusCore.Bitwise.html#WriteBitsException"
	><span class="hs-identifier hs-var"
	  >WriteBitsException</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920620"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-572"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-573"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920623"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920623"
	  ><span class="hs-identifier hs-var"
	    >bigIx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920624"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920624"
	  ><span class="hs-identifier hs-var"
	    >littleIx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920620"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-574"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920630"
      ><span class="annot"
	><span class="annottext"
	  >flipIx :: Int
</span
	  ><a href="#local-6989586621681920630"
	  ><span class="hs-identifier hs-var hs-var"
	    >flipIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920610"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920623"
	><span class="hs-identifier hs-var"
	  >bigIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-575"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621681920631"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920631"
	  ><span class="hs-identifier hs-var"
	    >w8</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920619"
	><span class="hs-identifier hs-var"
	  >ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920630"
	><span class="hs-identifier hs-var"
	  >flipIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-576"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920638"
      ><span class="annot"
	><span class="annottext"
	  >toWrite :: Word8
</span
	  ><a href="#local-6989586621681920638"
	  ><span class="hs-identifier hs-var hs-var"
	    >toWrite</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621681920604"
	><span class="hs-identifier hs-var"
	  >bit</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-577"
      ></span
      ><span
      >                        </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#setBit"
	><span class="hs-identifier hs-var"
	  >Bits.setBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920631"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Word8) -&gt; (Integer -&gt; Int) -&gt; Integer -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Word8) -&gt; Integer -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920624"
	><span class="hs-identifier hs-var"
	  >littleIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-578"
      ></span
      ><span
      >                        </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#clearBit"
	><span class="hs-identifier hs-var"
	  >Bits.clearBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920631"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Word8) -&gt; (Integer -&gt; Int) -&gt; Integer -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Word8) -&gt; Integer -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920624"
	><span class="hs-identifier hs-var"
	  >littleIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-579"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920619"
	><span class="hs-identifier hs-var"
	  >ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920630"
	><span class="hs-identifier hs-var"
	  >flipIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920638"
	><span class="hs-identifier hs-var"
	  >toWrite</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-580"
      ></span
      ><span
      >    </span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621681920617"
	><span class="hs-pragma hs-type"
	  >setOrClearAtIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-581"
      ></span
      ><span class="hs-pragma"
      >{-# INLINEABLE</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#writeBits"
	><span class="hs-pragma hs-type"
	  >writeBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-pragma"
      >#-}</span
      ><span
      >
</span
      ><span id="line-582"
      ></span
      ><span
      >
</span
      ><span id="line-583"
      ></span
      ><span class="hs-comment"
      >-- | Byte replication, as per [CIP-122](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0122)</span
      ><span
      >
</span
      ><span id="line-584"
      ></span
      ><span class="hs-comment"
      >-- We want to cautious about the allocation of huge amounts of memory so we</span
      ><span
      >
</span
      ><span id="line-585"
      ></span
      ><span class="hs-comment"
      >-- impose the same length limit that's used in integerToByteString.</span
      ><span
      >
</span
      ><span id="line-586"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#replicateByte"
	><span class="hs-identifier hs-type"
	  >replicateByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Builtin.Result.html#BuiltinResult"
	><span class="hs-identifier hs-type"
	  >BuiltinResult</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-587"
      ></span
      ><span id="replicateByte"
      ><span class="annot"
	><span class="annottext"
	  >replicateByte :: Integer -&gt; Word8 -&gt; BuiltinResult ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#replicateByte"
	  ><span class="hs-identifier hs-var hs-var"
	    >replicateByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920641"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920641"
	  ><span class="hs-identifier hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920642"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920642"
	  ><span class="hs-identifier hs-var"
	    >w8</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-588"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920641"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-589"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;replicateByte: negative length requested&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-590"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-591"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920641"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-592"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ())
-&gt; ([Char] -&gt; Text) -&gt; [Char] -&gt; BuiltinResult ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; BuiltinResult ()) -&gt; [Char] -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot;replicateByte: requested length is too long (maximum is &quot;</span
	></span
      ><span
      >
</span
      ><span id="line-593"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="PlutusCore.Bitwise.html#maximumOutputLength"
	><span class="hs-identifier hs-var"
	  >maximumOutputLength</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-594"
      ></span
      ><span
      >               </span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Char]
</span
	><span class="hs-string"
	>&quot; bytes)&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-595"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; BuiltinResult ()
</span
	><a href="PlutusCore.Builtin.Result.html#emit"
	><span class="hs-identifier hs-var"
	  >emit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; BuiltinResult ()) -&gt; Text -&gt; BuiltinResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Length requested: &quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Char] -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Char] -&gt; Text) -&gt; (Integer -&gt; [Char]) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920641"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-596"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinResult ByteString
forall a. BuiltinResult a
</span
	><a href="PlutusCore.Builtin.Result.html#builtinResultFailure"
	><span class="hs-identifier hs-var"
	  >builtinResultFailure</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-597"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; BuiltinResult ByteString
forall a. a -&gt; BuiltinResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ByteString -&gt; BuiltinResult ByteString)
-&gt; (Word8 -&gt; ByteString) -&gt; Word8 -&gt; BuiltinResult ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word8 -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#replicate"
	><span class="hs-identifier hs-var"
	  >BS.replicate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920641"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Word8 -&gt; BuiltinResult ByteString)
-&gt; Word8 -&gt; BuiltinResult ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920642"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-598"
      ></span
      ><span
      >
</span
      ><span id="line-599"
      ></span
      ><span class="hs-comment"
      >-- | Wrapper for calling 'unsafesShiftByteString' safely. Specifically, we avoid various edge cases:</span
      ><span
      >
</span
      ><span id="line-600"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-601"
      ></span
      ><span class="hs-comment"
      >-- * Empty 'ByteString's and zero moves don't do anything</span
      ><span
      >
</span
      ><span id="line-602"
      ></span
      ><span class="hs-comment"
      >-- * Bit moves whose absolute value is larger than the bit length produce all-zeroes</span
      ><span
      >
</span
      ><span id="line-603"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-604"
      ></span
      ><span class="hs-comment"
      >-- This also ensures we don't accidentally hit integer overflow issues.</span
      ><span
      >
</span
      ><span id="line-605"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#shiftByteString"
	><span class="hs-identifier hs-type"
	  >shiftByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-606"
      ></span
      ><span id="shiftByteString"
      ><span class="annot"
	><span class="annottext"
	  >shiftByteString :: ByteString -&gt; Integer -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#shiftByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >shiftByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920643"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920643"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920644"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920644"
	  ><span class="hs-identifier hs-var"
	    >bitMove</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-607"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#null"
	><span class="hs-identifier hs-var"
	  >BS.null</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920643"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920643"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-608"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920644"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920643"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-609"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920646"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920646"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920643"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-610"
      ></span
      ><span
      >                    </span
      ><span id="local-6989586621681920651"
      ><span class="annot"
	><span class="annottext"
	  >bitLen :: Integer
</span
	  ><a href="#local-6989586621681920651"
	  ><span class="hs-identifier hs-var hs-var"
	    >bitLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920646"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-611"
      ></span
      ><span
      >                  </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#abs"
	><span class="hs-identifier hs-var"
	  >abs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920644"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920651"
	><span class="hs-identifier hs-var"
	  >bitLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-612"
      ></span
      ><span
      >                     </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Word8 -&gt; ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#replicate"
	><span class="hs-identifier hs-var"
	  >BS.replicate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920646"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x00</span
	></span
      ><span
      >
</span
      ><span id="line-613"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- fromIntegral is safe to use here, as the only way this</span
      ><span
      >
</span
      ><span id="line-614"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- could overflow (or underflow) an Int is if we had a</span
      ><span
      >
</span
      ><span id="line-615"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- ByteString onchain that was over 30 petabytes in size.</span
      ><span
      >
</span
      ><span id="line-616"
      ></span
      ><span
      >                     </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int -&gt; ByteString
</span
	><a href="PlutusCore.Bitwise.html#unsafeShiftByteString"
	><span class="hs-identifier hs-var"
	  >unsafeShiftByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920643"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920644"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-617"
      ></span
      ><span
      >
</span
      ><span id="line-618"
      ></span
      ><span class="hs-comment"
      >-- | Wrapper for calling 'unsafeRotateByteString' safely. Specifically, we avoid various edge cases:</span
      ><span
      >
</span
      ><span id="line-619"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-620"
      ></span
      ><span class="hs-comment"
      >-- * Empty 'ByteString's and zero moves don't do anything</span
      ><span
      >
</span
      ><span id="line-621"
      ></span
      ><span class="hs-comment"
      >-- * Bit moves whose absolute value is larger than the bit length are reduced modulo the length</span
      ><span
      >
</span
      ><span id="line-622"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-623"
      ></span
      ><span class="hs-comment"
      >-- Furthermore, we can convert all rotations into positive rotations, by noting that a rotation by @b@</span
      ><span
      >
</span
      ><span id="line-624"
      ></span
      ><span class="hs-comment"
      >-- is the same as a rotation by @b `mod` bitLen@, where @bitLen@ is the length of the 'ByteString'</span
      ><span
      >
</span
      ><span id="line-625"
      ></span
      ><span class="hs-comment"
      >-- argument in bits. This value is always non-negative, and if we get 0, we have nothing to do. This</span
      ><span
      >
</span
      ><span id="line-626"
      ></span
      ><span class="hs-comment"
      >-- reduction also helps us avoid integer overflow issues.</span
      ><span
      >
</span
      ><span id="line-627"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#rotateByteString"
	><span class="hs-identifier hs-type"
	  >rotateByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-628"
      ></span
      ><span id="rotateByteString"
      ><span class="annot"
	><span class="annottext"
	  >rotateByteString :: ByteString -&gt; Integer -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#rotateByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >rotateByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920656"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920656"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920657"
      ><span class="annot"
	><span class="annottext"
	  >Integer
</span
	  ><a href="#local-6989586621681920657"
	  ><span class="hs-identifier hs-var"
	    >bitMove</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-629"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#null"
	><span class="hs-identifier hs-var"
	  >BS.null</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920656"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920656"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-630"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920662"
      ><span class="annot"
	><span class="annottext"
	  >bitLen :: Integer
</span
	  ><a href="#local-6989586621681920662"
	  ><span class="hs-identifier hs-var hs-var"
	    >bitLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920656"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-631"
      ></span
      ><span
      >                    </span
      ><span class="hs-comment"
      >-- This is guaranteed non-negative</span
      ><span
      >
</span
      ><span id="line-632"
      ></span
      ><span
      >                    </span
      ><span id="local-6989586621681920664"
      ><span class="annot"
	><span class="annottext"
	  >reducedBitMove :: Integer
</span
	  ><a href="#local-6989586621681920664"
	  ><span class="hs-identifier hs-var hs-var"
	    >reducedBitMove</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920657"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#mod"
	><span class="hs-operator hs-var"
	  >`mod`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920662"
	><span class="hs-identifier hs-var"
	  >bitLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-633"
      ></span
      ><span
      >                  </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920664"
	><span class="hs-identifier hs-var"
	  >reducedBitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-634"
      ></span
      ><span
      >                     </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920656"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-635"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- fromIntegral is safe to use here since for a bytestring to have a</span
      ><span
      >
</span
      ><span id="line-636"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- size that doesn't fit into an `Int` it would have to have a size</span
      ><span
      >
</span
      ><span id="line-637"
      ></span
      ><span
      >                     </span
      ><span class="hs-comment"
      >-- exceeding something like 37 petabytes.</span
      ><span
      >
</span
      ><span id="line-638"
      ></span
      ><span
      >                     </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int -&gt; ByteString
</span
	><a href="PlutusCore.Bitwise.html#unsafeRotateByteString"
	><span class="hs-identifier hs-var"
	  >unsafeRotateByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920656"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Integer
</span
	><a href="#local-6989586621681920664"
	><span class="hs-identifier hs-var"
	  >reducedBitMove</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-639"
      ></span
      ><span
      >
</span
      ><span id="line-640"
      ></span
      ><span class="hs-comment"
      >{- Note [Shift and rotation implementation]

Both shifts and rotations work similarly: they effectively impose a 'write
offset' to bits in the data argument, then write those bits to the result with
this offset applied. The difference between them is in what should be done if
the resulting offset index would fall out of bounds: shifts just discard the
data (and fill whatever remains with zeroes), while rotations 'wrap around'
modularly. This operation is bit parallel by definition, thus theoretically
making it amenable to the techniques described in Note [Loop sectioning].

However, the naive way of doing this runs into a problem: the byte ordering
on Tier 1 platforms inside `Word64` means that consecutive bit indexes
according to CIP-122 don't remain that way. We could avoid this by using a
byte flip followed by an adjustment in the opposite direction, then a byte flip
back again. However, this is a costly operation, and would also be extremely
fiddly across stride boundaries, making both performance and implementation
clarity suffer. Instead, we use a different observation, namely that both
shifts and rotations on the same input are monoidally homomorphic into
natural number addition (assuming the same 'direction' for shifts). Using
this, combined with Euclidean division, we can decompose any shift or
rotation by `i` into two consecutive shifts and rotations:

1. A 'large' shift or rotation, by `div i 8`; and
2. A 'small' shift or rotation, by `mod i 8`.

While on paper, this seems much less efficient (as our stride is smaller),
we also observe that the 'large' shift moves around whole bytes, while also
keeping consecutive bytes consecutive, assuming their bit indices remain
in-bounds. This means that we can implement step 1 both simply and efficiently:

* For shifts, we perform a partial copy of all the bytes whose bits remain
  in-bounds, followed by clearing of whatever remains.
* For rotations, we perform two partial copies: first of all the bytes whose
  bits remain in-bounds, followed by whatever remains, at the 'opposite end'.

These can make use of the bulk copying and clearing operations provided by the
GHC runtime. Not only are these shorter and more readable, they are also _far_
more efficient than anything we could do, as they rely on optimized C called
via the runtime (meaning no FFI penalty). From our experiments, both with
these operations, and others from CIP-122, we note that the cost of these is
essentially constant up to about the size of 1-2 cache lines (64-128 bytes):
since we anticipate smaller inputs are far more likely, this actually runs
_faster_ than our proposed sectioning approach, while being easier to read
and write.

It is arguable that our approach forces 'double writing', as Step 2 has to
possibly overwrite our work in Step 1. However, by avoiding the need to
perform byte flips, as well as benefitting from the huge speedups gained
from our split approach, this cost is essentially negligible, especially
given that we can operate mutably throughout. We also have an additional
benefit: if the requested rotation or shift happens to be an exact multiple
of 8, we can be _much_ faster, as Step 2 becomes unnecessary in that case.
-}</span
      ><span
      >
</span
      ><span id="line-693"
      ></span
      ><span
      >
</span
      ><span id="line-694"
      ></span
      ><span class="hs-comment"
      >-- | Shifts, as per [CIP-123](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0123).</span
      ><span
      >
</span
      ><span id="line-695"
      ></span
      ><span class="hs-comment"
      >-- This may not actually be unsafe, but it shouldn't be used outside this module.</span
      ><span
      >
</span
      ><span id="line-696"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#unsafeShiftByteString"
	><span class="hs-identifier hs-type"
	  >unsafeShiftByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-697"
      ></span
      ><span id="unsafeShiftByteString"
      ><span class="annot"
	><span class="annottext"
	  >unsafeShiftByteString :: ByteString -&gt; Int -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#unsafeShiftByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >unsafeShiftByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920665"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920665"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920666"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920666"
	  ><span class="hs-identifier hs-var"
	    >bitMove</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920665"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920667"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920667"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-698"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920669"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920669"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-699"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- To simplify our calculations, we work only with absolute values,</span
      ><span
      >
</span
      ><span id="line-700"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- letting different functions control for direction, instead of</span
      ><span
      >
</span
      ><span id="line-701"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- trying to unify the scheme for both positive and negative shifts.</span
      ><span
      >
</span
      ><span id="line-702"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920671"
      ><span class="annot"
	><span class="annottext"
	  >magnitude :: Int
</span
	  ><a href="#local-6989586621681920671"
	  ><span class="hs-identifier hs-var hs-var"
	    >magnitude</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#abs"
	><span class="hs-identifier hs-var"
	  >abs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920666"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-703"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- Instead of worrying about partial clearing, we just zero the entire</span
      ><span
      >
</span
      ><span id="line-704"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- block of memory, as the cost is essentially negligible and saves us</span
      ><span
      >
</span
      ><span id="line-705"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- a bunch of offset arithmetic.</span
      ><span
      >
</span
      ><span id="line-706"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Word8 -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#fillBytes"
	><span class="hs-identifier hs-var"
	  >fillBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920669"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0x00</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-707"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#unless"
	><span class="hs-identifier hs-var"
	  >unless</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920671"
	><span class="hs-identifier hs-var"
	  >magnitude</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920672"
	><span class="hs-identifier hs-var"
	  >bitLen</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-708"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920675"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920675"
	  ><span class="hs-identifier hs-var"
	    >bigShift</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920676"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920676"
	  ><span class="hs-identifier hs-var"
	    >smallShift</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920671"
	><span class="hs-identifier hs-var"
	  >magnitude</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-709"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#signum"
	><span class="hs-identifier hs-var"
	  >signum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920666"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-710"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-</span
      ><span class="hs-number"
      >1</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	><a href="#local-6989586621681920678"
	><span class="hs-identifier hs-var"
	  >negativeShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920667"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920669"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920675"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920676"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-711"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	><a href="#local-6989586621681920679"
	><span class="hs-identifier hs-var"
	  >positiveShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920667"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920669"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920675"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920676"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-712"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-713"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-714"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920668"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920668"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920665"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-715"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920672"
	><span class="hs-identifier hs-type"
	  >bitLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-716"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920672"
      ><span class="annot"
	><span class="annottext"
	  >bitLen :: Int
</span
	  ><a href="#local-6989586621681920672"
	  ><span class="hs-identifier hs-var hs-var"
	    >bitLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-717"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920678"
	><span class="hs-identifier hs-type"
	  >negativeShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-718"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920678"
      ><span class="annot"
	><span class="annottext"
	  >negativeShift :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	  ><a href="#local-6989586621681920678"
	  ><span class="hs-identifier hs-var hs-var"
	    >negativeShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920680"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920680"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920681"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920681"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920682"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920682"
	  ><span class="hs-identifier hs-var"
	    >bigShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920683"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920683"
	  ><span class="hs-identifier hs-var"
	    >smallShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-719"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920684"
      ><span class="annot"
	><span class="annottext"
	  >copyDstPtr :: Ptr b
</span
	  ><a href="#local-6989586621681920684"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920682"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-720"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920686"
      ><span class="annot"
	><span class="annottext"
	  >copyLen :: Int
</span
	  ><a href="#local-6989586621681920686"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920682"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-721"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- Since we already zeroed everything, we only do the partial copy.</span
      ><span
      >
</span
      ><span id="line-722"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
forall {b}. Ptr b
</span
	><a href="#local-6989586621681920684"
	><span class="hs-identifier hs-var"
	  >copyDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920680"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920686"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-723"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#when"
	><span class="hs-identifier hs-var"
	  >when</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920683"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-724"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- When working with the small shift, we have to shift bits across</span
      ><span
      >
</span
      ><span id="line-725"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- byte boundaries. Thus, we have to make sure that:</span
      ><span
      >
</span
      ><span id="line-726"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-727"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- 1. We 'save' our first byte from being processed.</span
      ><span
      >
</span
      ><span id="line-728"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- 2. We can 'select' the bits that would be shifted over the</span
      ><span
      >
</span
      ><span id="line-729"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >--    boundary and apply them.</span
      ><span
      >
</span
      ><span id="line-730"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920689"
      ><span class="annot"
	><span class="annottext"
	  >invSmallShift :: Int
</span
	  ><a href="#local-6989586621681920689"
	  ><span class="hs-identifier hs-var hs-var"
	    >invSmallShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920683"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-731"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920693"
      ><span class="annot"
	><span class="annottext"
	  >mask :: Word8
</span
	  ><a href="#local-6989586621681920693"
	  ><span class="hs-identifier hs-var hs-var"
	    >mask</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0xFF</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920689"
	><span class="hs-identifier hs-var"
	  >invSmallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-732"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920686"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920694"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920694"
	  ><span class="hs-identifier hs-var"
	    >byteIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-733"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- To handle shifts across byte boundaries, we have to 'read</span
      ><span
      >
</span
      ><span id="line-734"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- backwards', mask off the relevant part, then recombine.</span
      ><span
      >
</span
      ><span id="line-735"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920695"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920695"
	  ><span class="hs-identifier hs-var"
	    >currentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920694"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-736"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920696"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920696"
	  ><span class="hs-identifier hs-var"
	    >prevByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920694"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-737"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920698"
      ><span class="annot"
	><span class="annottext"
	  >prevOverflowBits :: Word8
</span
	  ><a href="#local-6989586621681920698"
	  ><span class="hs-identifier hs-var hs-var"
	    >prevOverflowBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920696"
	><span class="hs-identifier hs-var"
	  >prevByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920693"
	><span class="hs-identifier hs-var"
	  >mask</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-738"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920702"
      ><span class="annot"
	><span class="annottext"
	  >newCurrentByte :: Word8
</span
	  ><a href="#local-6989586621681920702"
	  ><span class="hs-identifier hs-var hs-var"
	    >newCurrentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-739"
      ></span
      ><span
      >                </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920695"
	><span class="hs-identifier hs-var"
	  >currentByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920683"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-740"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920698"
	><span class="hs-identifier hs-var"
	  >prevOverflowBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920689"
	><span class="hs-identifier hs-var"
	  >invSmallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-741"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920694"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920702"
	><span class="hs-identifier hs-var"
	  >newCurrentByte</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-742"
      ></span
      ><span
      >        </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920703"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920703"
	  ><span class="hs-identifier hs-var"
	    >firstByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920686"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-743"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920681"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920686"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920703"
	><span class="hs-identifier hs-var"
	  >firstByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920683"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-744"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- This works similarly to `negativeShift` above, but in the opposite direction.</span
      ><span
      >
</span
      ><span id="line-745"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920679"
	><span class="hs-identifier hs-type"
	  >positiveShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-746"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920679"
      ><span class="annot"
	><span class="annottext"
	  >positiveShift :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	  ><a href="#local-6989586621681920679"
	  ><span class="hs-identifier hs-var hs-var"
	    >positiveShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920704"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920704"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920705"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920705"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920706"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920706"
	  ><span class="hs-identifier hs-var"
	    >bigShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920707"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920707"
	  ><span class="hs-identifier hs-var"
	    >smallShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-747"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920708"
      ><span class="annot"
	><span class="annottext"
	  >copySrcPtr :: Ptr b
</span
	  ><a href="#local-6989586621681920708"
	  ><span class="hs-identifier hs-var hs-var"
	    >copySrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920704"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920706"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-748"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920710"
      ><span class="annot"
	><span class="annottext"
	  >copyLen :: Int
</span
	  ><a href="#local-6989586621681920710"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920668"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920706"
	><span class="hs-identifier hs-var"
	  >bigShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-749"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
forall {b}. Ptr b
</span
	><a href="#local-6989586621681920708"
	><span class="hs-identifier hs-var"
	  >copySrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920710"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-750"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#when"
	><span class="hs-identifier hs-var"
	  >when</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920707"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-751"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920713"
      ><span class="annot"
	><span class="annottext"
	  >invSmallShift :: Int
</span
	  ><a href="#local-6989586621681920713"
	  ><span class="hs-identifier hs-var hs-var"
	    >invSmallShift</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920707"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-752"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920717"
      ><span class="annot"
	><span class="annottext"
	  >mask :: Word8
</span
	  ><a href="#local-6989586621681920717"
	  ><span class="hs-identifier hs-var hs-var"
	    >mask</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0xFF</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920713"
	><span class="hs-identifier hs-var"
	  >invSmallShift</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-753"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920710"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920718"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920718"
	  ><span class="hs-identifier hs-var"
	    >byteIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-754"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920719"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920719"
	  ><span class="hs-identifier hs-var"
	    >currentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920718"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-755"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920720"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920720"
	  ><span class="hs-identifier hs-var"
	    >nextByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920718"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-756"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920722"
      ><span class="annot"
	><span class="annottext"
	  >nextOverflowBits :: Word8
</span
	  ><a href="#local-6989586621681920722"
	  ><span class="hs-identifier hs-var hs-var"
	    >nextOverflowBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920720"
	><span class="hs-identifier hs-var"
	  >nextByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920717"
	><span class="hs-identifier hs-var"
	  >mask</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-757"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920726"
      ><span class="annot"
	><span class="annottext"
	  >newCurrentByte :: Word8
</span
	  ><a href="#local-6989586621681920726"
	  ><span class="hs-identifier hs-var hs-var"
	    >newCurrentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-758"
      ></span
      ><span
      >                </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920719"
	><span class="hs-identifier hs-var"
	  >currentByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920707"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-759"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920722"
	><span class="hs-identifier hs-var"
	  >nextOverflowBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920713"
	><span class="hs-identifier hs-var"
	  >invSmallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-760"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920718"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920726"
	><span class="hs-identifier hs-var"
	  >newCurrentByte</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-761"
      ></span
      ><span
      >        </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920727"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920727"
	  ><span class="hs-identifier hs-var"
	    >lastByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920710"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-762"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920705"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920710"
	><span class="hs-identifier hs-var"
	  >copyLen</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920727"
	><span class="hs-identifier hs-var"
	  >lastByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920707"
	><span class="hs-identifier hs-var"
	  >smallShift</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-763"
      ></span
      ><span
      >
</span
      ><span id="line-764"
      ></span
      ><span class="hs-comment"
      >-- | Rotations, as per [CIP-123](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0123).</span
      ><span
      >
</span
      ><span id="line-765"
      ></span
      ><span class="hs-comment"
      >-- This is defintely unsafe: calling it with bitMove = minBound::Int can cause a</span
      ><span
      >
</span
      ><span id="line-766"
      ></span
      ><span class="hs-comment"
      >-- segmentation fault.  It must not be used outside this module.</span
      ><span
      >
</span
      ><span id="line-767"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#unsafeRotateByteString"
	><span class="hs-identifier hs-type"
	  >unsafeRotateByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-768"
      ></span
      ><span id="unsafeRotateByteString"
      ><span class="annot"
	><span class="annottext"
	  >unsafeRotateByteString :: ByteString -&gt; Int -&gt; ByteString
</span
	  ><a href="PlutusCore.Bitwise.html#unsafeRotateByteString"
	  ><span class="hs-identifier hs-var hs-var"
	    >unsafeRotateByteString</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920728"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920728"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920729"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920729"
	  ><span class="hs-identifier hs-var"
	    >bitMove</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO ByteString -&gt; ByteString)
-&gt; ((Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920728"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO ByteString) -&gt; ByteString)
-&gt; (Ptr CChar -&gt; IO ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920730"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920730"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-769"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#create"
	><span class="hs-identifier hs-var"
	  >BSI.create</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920732"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920732"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-770"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- The move is guaranteed positive and reduced already. Thus, unlike for</span
      ><span
      >
</span
      ><span id="line-771"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- shifts, we don't need two variants for different directions.</span
      ><span
      >
</span
      ><span id="line-772"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920735"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920735"
	  ><span class="hs-identifier hs-var"
	    >bigRotation</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920736"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920736"
	  ><span class="hs-identifier hs-var"
	    >smallRotation</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920729"
	><span class="hs-identifier hs-var"
	  >bitMove</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quotRem"
	><span class="hs-operator hs-var"
	  >`quotRem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-773"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	><a href="#local-6989586621681920737"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920730"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920732"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920735"
	><span class="hs-identifier hs-var"
	  >bigRotation</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920736"
	><span class="hs-identifier hs-var"
	  >smallRotation</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-774"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-775"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-776"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920731"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920731"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920728"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-777"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920737"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-778"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920737"
      ><span class="annot"
	><span class="annottext"
	  >go :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO ()
</span
	  ><a href="#local-6989586621681920737"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920738"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920738"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920739"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920739"
	  ><span class="hs-identifier hs-var"
	    >dstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920740"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920740"
	  ><span class="hs-identifier hs-var"
	    >bigRotate</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920741"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920741"
	  ><span class="hs-identifier hs-var"
	    >smallRotate</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-779"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- Two partial copies are needed here, unlike with shifts, because</span
      ><span
      >
</span
      ><span id="line-780"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- there's no point zeroing our data, since it'll all be overwritten</span
      ><span
      >
</span
      ><span id="line-781"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- with stuff from the input anyway.</span
      ><span
      >
</span
      ><span id="line-782"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920742"
      ><span class="annot"
	><span class="annottext"
	  >copyStartSrcPtr :: Ptr b
</span
	  ><a href="#local-6989586621681920742"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyStartSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920738"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920740"
	><span class="hs-identifier hs-var"
	  >bigRotate</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-783"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920744"
      ><span class="annot"
	><span class="annottext"
	  >copyStartLen :: Int
</span
	  ><a href="#local-6989586621681920744"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyStartLen</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920740"
	><span class="hs-identifier hs-var"
	  >bigRotate</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-784"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
forall {b}. Ptr b
</span
	><a href="#local-6989586621681920742"
	><span class="hs-identifier hs-var"
	  >copyStartSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920744"
	><span class="hs-identifier hs-var"
	  >copyStartLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-785"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920745"
      ><span class="annot"
	><span class="annottext"
	  >copyEndDstPtr :: Ptr b
</span
	  ><a href="#local-6989586621681920745"
	  ><span class="hs-identifier hs-var hs-var"
	    >copyEndDstPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920744"
	><span class="hs-identifier hs-var"
	  >copyStartLen</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-786"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Marshal.Utils.html#copyBytes"
	><span class="hs-identifier hs-var"
	  >copyBytes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
forall {b}. Ptr b
</span
	><a href="#local-6989586621681920745"
	><span class="hs-identifier hs-var"
	  >copyEndDstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920738"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920740"
	><span class="hs-identifier hs-var"
	  >bigRotate</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-787"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#when"
	><span class="hs-identifier hs-var"
	  >when</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920741"
	><span class="hs-identifier hs-var"
	  >smallRotate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E"
	><span class="hs-operator hs-var"
	  >&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-788"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- This works similarly to shifts</span
      ><span
      >
</span
      ><span id="line-789"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920748"
      ><span class="annot"
	><span class="annottext"
	  >invSmallRotate :: Int
</span
	  ><a href="#local-6989586621681920748"
	  ><span class="hs-identifier hs-var hs-var"
	    >invSmallRotate</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920741"
	><span class="hs-identifier hs-var"
	  >smallRotate</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-790"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920752"
      ><span class="annot"
	><span class="annottext"
	  >mask :: Word8
</span
	  ><a href="#local-6989586621681920752"
	  ><span class="hs-identifier hs-var hs-var"
	    >mask</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><span class="hs-number"
	>0xFF</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920748"
	><span class="hs-identifier hs-var"
	  >invSmallRotate</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-791"
      ></span
      ><span
      >        </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920753"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920753"
	  ><span class="hs-identifier hs-var"
	    >cloneFirstByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-792"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#for_"
	><span class="hs-identifier hs-var"
	  >for_</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920754"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920754"
	  ><span class="hs-identifier hs-var"
	    >byteIx</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-793"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920755"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920755"
	  ><span class="hs-identifier hs-var"
	    >currentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920754"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-794"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920756"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920756"
	  ><span class="hs-identifier hs-var"
	    >nextByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920754"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-795"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920758"
      ><span class="annot"
	><span class="annottext"
	  >nextOverflowBits :: Word8
</span
	  ><a href="#local-6989586621681920758"
	  ><span class="hs-identifier hs-var hs-var"
	    >nextOverflowBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920756"
	><span class="hs-identifier hs-var"
	  >nextByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920752"
	><span class="hs-identifier hs-var"
	  >mask</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-796"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920762"
      ><span class="annot"
	><span class="annottext"
	  >newCurrentByte :: Word8
</span
	  ><a href="#local-6989586621681920762"
	  ><span class="hs-identifier hs-var hs-var"
	    >newCurrentByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-797"
      ></span
      ><span
      >                </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920755"
	><span class="hs-identifier hs-var"
	  >currentByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920741"
	><span class="hs-identifier hs-var"
	  >smallRotate</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-798"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920758"
	><span class="hs-identifier hs-var"
	  >nextOverflowBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920748"
	><span class="hs-identifier hs-var"
	  >invSmallRotate</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-799"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920754"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920762"
	><span class="hs-identifier hs-var"
	  >newCurrentByte</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-800"
      ></span
      ><span
      >        </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920763"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920763"
	  ><span class="hs-identifier hs-var"
	    >lastByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-801"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920765"
      ><span class="annot"
	><span class="annottext"
	  >firstOverflowBits :: Word8
</span
	  ><a href="#local-6989586621681920765"
	  ><span class="hs-identifier hs-var hs-var"
	    >firstOverflowBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920753"
	><span class="hs-identifier hs-var"
	  >cloneFirstByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%26."
	><span class="hs-operator hs-var"
	  >Bits..&amp;.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920752"
	><span class="hs-identifier hs-var"
	  >mask</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-802"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920769"
      ><span class="annot"
	><span class="annottext"
	  >newLastByte :: Word8
</span
	  ><a href="#local-6989586621681920769"
	  ><span class="hs-identifier hs-var hs-var"
	    >newLastByte</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-803"
      ></span
      ><span
      >              </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920763"
	><span class="hs-identifier hs-var"
	  >lastByte</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftL"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftL`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920741"
	><span class="hs-identifier hs-var"
	  >smallRotate</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-804"
      ></span
      ><span
      >                </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#.%7C."
	><span class="hs-operator hs-var"
	  >Bits..|.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920765"
	><span class="hs-identifier hs-var"
	  >firstOverflowBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#unsafeShiftR"
	><span class="hs-operator hs-var"
	  >`Bits.unsafeShiftR`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920748"
	><span class="hs-identifier hs-var"
	  >invSmallRotate</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-805"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#pokeByteOff"
	><span class="hs-identifier hs-var"
	  >pokeByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920739"
	><span class="hs-identifier hs-var"
	  >dstPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920731"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920769"
	><span class="hs-identifier hs-var"
	  >newLastByte</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-806"
      ></span
      ><span
      >
</span
      ><span id="line-807"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Counting the number of set bits, as per [CIP-123](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0123).</span
	></span
      ><span
      >
</span
      ><span id="line-808"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#countSetBits"
	><span class="hs-identifier hs-type"
	  >countSetBits</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-809"
      ></span
      ><span id="countSetBits"
      ><span class="annot"
	><span class="annottext"
	  >countSetBits :: ByteString -&gt; Int
</span
	  ><a href="PlutusCore.Bitwise.html#countSetBits"
	  ><span class="hs-identifier hs-var hs-var"
	    >countSetBits</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920770"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920770"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO Int -&gt; Int
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO Int -&gt; Int)
-&gt; ((Ptr CChar -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr CChar -&gt; IO Int)
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO Int) -&gt; IO Int
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920770"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO Int) -&gt; Int) -&gt; (Ptr CChar -&gt; IO Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920771"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920771"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-810"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- See Note [Loop sectioning] for details of why we</span
      ><span
      >
</span
      ><span id="line-811"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- define this function the way it is. We make use of the fact that `popCount`</span
      ><span
      >
</span
      ><span id="line-812"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- is bit-parallel, and has a constant-time implementation for `Word64` and `Word8`.</span
      ><span
      >
</span
      ><span id="line-813"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920772"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920772"
	  ><span class="hs-identifier hs-var"
	    >bigSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920771"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-814"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920773"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920773"
	  ><span class="hs-identifier hs-var"
	    >smallSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#plusPtr"
	><span class="hs-identifier hs-var"
	  >plusPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920771"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920774"
	><span class="hs-identifier hs-var"
	  >offset</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-815"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920775"
	><span class="hs-identifier hs-var"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920772"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920773"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-816"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-817"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920776"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-818"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920776"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920776"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920770"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-819"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We do this as two separate bindings, for similar reasons as for</span
      ><span
      >
</span
      ><span id="line-820"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- `integerToByteString`: we take a surprising hit to performance when</span
      ><span
      >
</span
      ><span id="line-821"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- using a pair, even though eliminating it should be possible here.</span
      ><span
      >
</span
      ><span id="line-822"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920777"
	><span class="hs-identifier hs-type"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-823"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920777"
      ><span class="annot"
	><span class="annottext"
	  >bigStrides :: Int
</span
	  ><a href="#local-6989586621681920777"
	  ><span class="hs-identifier hs-var hs-var"
	    >bigStrides</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920776"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#quot"
	><span class="hs-operator hs-var"
	  >`quot`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-824"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920779"
	><span class="hs-identifier hs-type"
	  >smallStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-825"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920779"
      ><span class="annot"
	><span class="annottext"
	  >smallStrides :: Int
</span
	  ><a href="#local-6989586621681920779"
	  ><span class="hs-identifier hs-var hs-var"
	    >smallStrides</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920776"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#rem"
	><span class="hs-operator hs-var"
	  >`rem`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-826"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920774"
	><span class="hs-identifier hs-type"
	  >offset</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-827"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920774"
      ><span class="annot"
	><span class="annottext"
	  >offset :: Int
</span
	  ><a href="#local-6989586621681920774"
	  ><span class="hs-identifier hs-var hs-var"
	    >offset</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920777"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-828"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920775"
	><span class="hs-identifier hs-type"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-829"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920775"
      ><span class="annot"
	><span class="annottext"
	  >goBig :: Ptr Word64 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	  ><a href="#local-6989586621681920775"
	  ><span class="hs-identifier hs-var hs-var"
	    >goBig</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920781"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920781"
	  ><span class="hs-identifier hs-var"
	    >bigSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920782"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920782"
	  ><span class="hs-identifier hs-var"
	    >smallSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920783"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920783"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920784"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920784"
	  ><span class="hs-identifier hs-var"
	    >bigIx</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-830"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920784"
	><span class="hs-identifier hs-var"
	  >bigIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920777"
	><span class="hs-identifier hs-var"
	  >bigStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920785"
	><span class="hs-identifier hs-var"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920782"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920783"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      >
</span
      ><span id="line-831"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-832"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920786"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920786"
	  ><span class="hs-identifier hs-var"
	    >w64</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920781"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920784"
	><span class="hs-identifier hs-var"
	  >bigIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-833"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920775"
	><span class="hs-identifier hs-var"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920781"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920782"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920783"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int
forall a. Bits a =&gt; a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#popCount"
	><span class="hs-identifier hs-var"
	  >Bits.popCount</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920786"
	><span class="hs-identifier hs-var"
	  >w64</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920784"
	><span class="hs-identifier hs-var"
	  >bigIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-834"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920785"
	><span class="hs-identifier hs-type"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-835"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920785"
      ><span class="annot"
	><span class="annottext"
	  >goSmall :: Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	  ><a href="#local-6989586621681920785"
	  ><span class="hs-identifier hs-var hs-var"
	    >goSmall</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920788"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920788"
	  ><span class="hs-identifier hs-var"
	    >smallSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920789"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920789"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920790"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920790"
	  ><span class="hs-identifier hs-var"
	    >smallIx</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-836"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920790"
	><span class="hs-identifier hs-var"
	  >smallIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920779"
	><span class="hs-identifier hs-var"
	  >smallStrides</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; IO Int
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920789"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-837"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-838"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920791"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920791"
	  ><span class="hs-identifier hs-var"
	    >w8</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekElemOff"
	><span class="hs-identifier hs-var"
	  >peekElemOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920788"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920790"
	><span class="hs-identifier hs-var"
	  >smallIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-839"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920785"
	><span class="hs-identifier hs-var"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920788"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920789"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int
forall a. Bits a =&gt; a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#popCount"
	><span class="hs-identifier hs-var"
	  >Bits.popCount</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920791"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920790"
	><span class="hs-identifier hs-var"
	  >smallIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-840"
      ></span
      ><span
      >
</span
      ><span id="line-841"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Finding the first set bit's index, as per [CIP-123](https://github.com/cardano-foundation/CIPs/tree/master/CIP-0123).</span
	></span
      ><span
      >
</span
      ><span id="line-842"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Bitwise.html#findFirstSetBit"
	><span class="hs-identifier hs-type"
	  >findFirstSetBit</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.Internal.Type.html#ByteString"
	><span class="hs-identifier hs-type"
	  >ByteString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-843"
      ></span
      ><span id="findFirstSetBit"
      ><span class="annot"
	><span class="annottext"
	  >findFirstSetBit :: ByteString -&gt; Int
</span
	  ><a href="PlutusCore.Bitwise.html#findFirstSetBit"
	  ><span class="hs-identifier hs-var hs-var"
	    >findFirstSetBit</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621681920792"
      ><span class="annot"
	><span class="annottext"
	  >ByteString
</span
	  ><a href="#local-6989586621681920792"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>IO Int -&gt; Int
forall a. IO a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.IO.Unsafe.html#unsafeDupablePerformIO"
	><span class="hs-identifier hs-var"
	  >unsafeDupablePerformIO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(IO Int -&gt; Int)
-&gt; ((Ptr CChar -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr CChar -&gt; IO Int)
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; (Ptr CChar -&gt; IO Int) -&gt; IO Int
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#useAsCString"
	><span class="hs-identifier hs-var"
	  >BS.useAsCString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920792"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Ptr CChar -&gt; IO Int) -&gt; Int) -&gt; (Ptr CChar -&gt; IO Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621681920793"
      ><span class="annot"
	><span class="annottext"
	  >Ptr CChar
</span
	  ><a href="#local-6989586621681920793"
	  ><span class="hs-identifier hs-var"
	    >srcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-844"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621681920794"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920794"
	  ><span class="hs-identifier hs-var"
	    >bigSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar -&gt; Ptr Word64
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr CChar
</span
	><a href="#local-6989586621681920793"
	><span class="hs-identifier hs-var"
	  >srcPtr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-845"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920795"
	><span class="hs-identifier hs-var"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920794"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920796"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-846"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-847"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We implement this operation in a somewhat unusual way, to try and</span
      ><span
      >
</span
      ><span id="line-848"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- benefit from bit paralellism, thus allowing loop sectioning as well:</span
      ><span
      >
</span
      ><span id="line-849"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- see Note [Loop sectioning] as to why we choose to</span
      ><span
      >
</span
      ><span id="line-850"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- do this.</span
      ><span
      >
</span
      ><span id="line-851"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-852"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Finding the first set bit is not (inherently) bit parallel, as there is</span
      ><span
      >
</span
      ><span id="line-853"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- a clear 'horizontal dependency'. Thus, we instead 'localize' this</span
      ><span
      >
</span
      ><span id="line-854"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- 'horizontal dependency' by noting that the following operations _are_</span
      ><span
      >
</span
      ><span id="line-855"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- bit-parallel:</span
      ><span
      >
</span
      ><span id="line-856"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-857"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- 1. Checking if all bits are zero</span
      ><span
      >
</span
      ><span id="line-858"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- 2. Keeping an additive accumulator</span
      ><span
      >
</span
      ><span id="line-859"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-860"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Essentially, we begin by taking large steps through our data, checking</span
      ><span
      >
</span
      ><span id="line-861"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- whether we only have zeroes. This can be done in strides of 64 bits at a</span
      ><span
      >
</span
      ><span id="line-862"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- time, and every time we find that many zeroes, we keep track. After we</span
      ><span
      >
</span
      ><span id="line-863"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- encounter a nonzero `Word64`, we 'step down' to `Word8`-sized steps,</span
      ><span
      >
</span
      ><span id="line-864"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- continuing to count zero blocks the same way. Once we encounter a</span
      ><span
      >
</span
      ><span id="line-865"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- non-zero `Word8`, we can resort to the specialized operation for</span
      ><span
      >
</span
      ><span id="line-866"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- counting trailing zeroes from `Data.Bits`, and 'top up' our accumulated</span
      ><span
      >
</span
      ><span id="line-867"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- count to produce the index we want. If we ever 'walk off the end', we</span
      ><span
      >
</span
      ><span id="line-868"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- know that there's no way we could find any set bits and return -1.</span
      ><span
      >
</span
      ><span id="line-869"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-870"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- This is complicated slightly by us having to walk the input backwards</span
      ><span
      >
</span
      ><span id="line-871"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- instead of forwards, but due to the requirements of the CIP-122 bit</span
      ><span
      >
</span
      ><span id="line-872"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- indexing scheme, we don't really have a choice here. This doesn't</span
      ><span
      >
</span
      ><span id="line-873"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- affect the description above however: it just complicates the indexing</span
      ><span
      >
</span
      ><span id="line-874"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- maths required.</span
      ><span
      >
</span
      ><span id="line-875"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920795"
	><span class="hs-identifier hs-type"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-876"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920795"
      ><span class="annot"
	><span class="annottext"
	  >goBig :: Ptr Word64 -&gt; Int -&gt; Int -&gt; IO Int
</span
	  ><a href="#local-6989586621681920795"
	  ><span class="hs-identifier hs-var hs-var"
	    >goBig</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920797"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word64
</span
	  ><a href="#local-6989586621681920797"
	  ><span class="hs-identifier hs-var"
	    >bigSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920798"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920798"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920799"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920799"
	  ><span class="hs-identifier hs-var"
	    >byteIx</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-877"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- We can do at least one large step. This works because we read</span
      ><span
      >
</span
      ><span id="line-878"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- backwards, which means that `byteIx` is the _last_ position we read</span
      ><span
      >
</span
      ><span id="line-879"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-880"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920800"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621681920800"
	  ><span class="hs-identifier hs-var"
	    >w64</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier hs-type"
	  >Word64</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; IO Word64
forall b. Ptr b -&gt; Int -&gt; IO Word64
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920797"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-881"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- In theory, we could use the same technique here as we do in</span
      ><span
      >
</span
      ><span id="line-882"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- `goSmall`, namely count speculatively and then compare to 64.</span
      ><span
      >
</span
      ><span id="line-883"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- However this is not possible for us, as the native byte ordering</span
      ><span
      >
</span
      ><span id="line-884"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- on Tier 1 platforms does not keep consecutive bits _across_ bytes</span
      ><span
      >
</span
      ><span id="line-885"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- consecutive, which would make this result unreliable. While we</span
      ><span
      >
</span
      ><span id="line-886"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- _could_ do a byte order flip before counting (from the opposite</span
      ><span
      >
</span
      ><span id="line-887"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- end) to avoid this, the cost of this operation is much larger</span
      ><span
      >
</span
      ><span id="line-888"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- than a comparison to zero, and would only benefit us _once_,</span
      ><span
      >
</span
      ><span id="line-889"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- instead of once-per-stride. Thus, we instead use the approach</span
      ><span
      >
</span
      ><span id="line-890"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- here.</span
      ><span
      >
</span
      ><span id="line-891"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621681920800"
	><span class="hs-identifier hs-var"
	  >w64</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0x0</span
	></span
      ><span
      >
</span
      ><span id="line-892"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920795"
	><span class="hs-identifier hs-var"
	  >goBig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920797"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920798"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>64</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-893"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920801"
	><span class="hs-identifier hs-var"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920797"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920798"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>7</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-894"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- We've 'walked off the end' and not found anything, so everything</span
      ><span
      >
</span
      ><span id="line-895"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- must be zeroes</span
      ><span
      >
</span
      ><span id="line-896"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; IO Int
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-897"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- We can end up here in one of two ways:</span
      ><span
      >
</span
      ><span id="line-898"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-899"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- 1. Our input `ByteString` is 7 bytes long or smaller; or</span
      ><span
      >
</span
      ><span id="line-900"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- 2. We have done all the large steps we can, and have between 1</span
      ><span
      >
</span
      ><span id="line-901"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >--    and 7 bytes to go.</span
      ><span
      >
</span
      ><span id="line-902"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-903"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- In either case, we forward the accumulator (which will be 0 in</span
      ><span
      >
</span
      ><span id="line-904"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- case 1) to small stepping. Combining these cases allows us to</span
      ><span
      >
</span
      ><span id="line-905"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- avoid separate tests for these conditions.</span
      ><span
      >
</span
      ><span id="line-906"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920801"
	><span class="hs-identifier hs-var"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64 -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#castPtr"
	><span class="hs-identifier hs-var"
	  >castPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word64
</span
	><a href="#local-6989586621681920797"
	><span class="hs-identifier hs-var"
	  >bigSrcPtr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920798"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920799"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-907"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920801"
	><span class="hs-identifier hs-type"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Ptr.html#Ptr"
	><span class="hs-identifier hs-type"
	  >Ptr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#IO"
	><span class="hs-identifier hs-type"
	  >IO</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-908"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621681920801"
      ><span class="annot"
	><span class="annottext"
	  >goSmall :: Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	  ><a href="#local-6989586621681920801"
	  ><span class="hs-identifier hs-var hs-var"
	    >goSmall</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920802"
      ><span class="annot"
	><span class="annottext"
	  >Ptr Word8
</span
	  ><a href="#local-6989586621681920802"
	  ><span class="hs-identifier hs-var"
	    >smallSrcPtr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920803"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920803"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920804"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621681920804"
	  ><span class="hs-identifier hs-var"
	    >byteIx</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-909"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920804"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C"
	><span class="hs-operator hs-var"
	  >&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; IO Int
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-910"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-911"
      ></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >!</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920805"
      ><span class="annot"
	><span class="annottext"
	  >Word8
</span
	  ><a href="#local-6989586621681920805"
	  ><span class="hs-identifier hs-var"
	    >w8</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word8"
	><span class="hs-identifier hs-type"
	  >Word8</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Foreign.Storable.html#peekByteOff"
	><span class="hs-identifier hs-var"
	  >peekByteOff</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920802"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920804"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-912"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Instead of redundantly first checking for a zero byte,</span
      ><span
      >
</span
      ><span id="line-913"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- then counting, we speculatively count, relying on the behaviour of</span
      ><span
      >
</span
      ><span id="line-914"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- `countTrailingZeros` that, on a zero byte, we get 8.</span
      ><span
      >
</span
      ><span id="line-915"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920808"
      ><span class="annot"
	><span class="annottext"
	  >counted :: Int
</span
	  ><a href="#local-6989586621681920808"
	  ><span class="hs-identifier hs-var hs-var"
	    >counted</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8 -&gt; Int
forall b. FiniteBits b =&gt; b -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Bits.html#countTrailingZeros"
	><span class="hs-identifier hs-var"
	  >Bits.countTrailingZeros</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word8
</span
	><a href="#local-6989586621681920805"
	><span class="hs-identifier hs-var"
	  >w8</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-916"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920811"
      ><span class="annot"
	><span class="annottext"
	  >newAcc :: Int
</span
	  ><a href="#local-6989586621681920811"
	  ><span class="hs-identifier hs-var hs-var"
	    >newAcc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920803"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920808"
	><span class="hs-identifier hs-var"
	  >counted</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-917"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920808"
	><span class="hs-identifier hs-var"
	  >counted</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>8</span
	></span
      ><span
      >
</span
      ><span id="line-918"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8 -&gt; Int -&gt; Int -&gt; IO Int
</span
	><a href="#local-6989586621681920801"
	><span class="hs-identifier hs-var"
	  >goSmall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Ptr Word8
</span
	><a href="#local-6989586621681920802"
	><span class="hs-identifier hs-var"
	  >smallSrcPtr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920811"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920804"
	><span class="hs-identifier hs-var"
	  >byteIx</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-919"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; IO Int
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621681920811"
	><span class="hs-identifier hs-var"
	  >newAcc</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-920"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621681920796"
	><span class="hs-identifier hs-type"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-921"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >!</span
      ><span id="local-6989586621681920796"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621681920796"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/bytestring-0.11.5.4/docs/src/Data.ByteString.html#length"
	><span class="hs-identifier hs-var"
	  >BS.length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ByteString
</span
	><a href="#local-6989586621681920792"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-922"
      ></span
      ><span
      >
</span
      ><span id="line-923"
      ></span
      ><span class="hs-comment"
      >-- Helpers</span
      ><span
      >
</span
      ><span id="line-924"
      ></span
      ><span
      >
</span
      ><span id="line-925"
      ></span
      ><span class="hs-comment"
      >{- Note [writeBits and exceptions]

   As `writeBits` allows us to pass a changelist argument of any length, we
   potentially could have an out-of-bounds index anywhere in the list. As we
   have to fail on such cases (and report them appropriately), we end up needing
   _both_ IO (to do mutable things) as well as a way to signal errors. We can
   do this in two ways:

   1. Pre-scan the changelist for any out-of-bounds indexes, fail if we see any,
      then apply the necessary changes if no out-of-bounds indexes are found.
   2. Speculatively allocate the new `ByteString`, then do the changes in the
      changelist argument one at a time, failing as soon as we see an out-of-bounds
      index.

  Option 1 would require traversing the changelist argument twice, which is
  undesirable, which means that option 2 is the more efficient choice. The
  natural choice for option 2 would be something similar to `ExceptT Int IO`
  (with the `Int` being an out-of-bounds index). However, we aren't able to do
  this, as ultimately, `ByteString`s are implemented as `ForeignPtr`s, forcing
  us to use the following function to interact with them, directly or not:

  withForeignPtr :: forall (a :: Type) . ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b

  Notably, the function argument produces a result of `IO b`, whereas we would
  need `MonadIO m =&gt; m b` instead. This means that our _only_ choice is to
  use the exception mechanism, either directly or via some wrappers like
  `MonadUnliftIO`. While this is unusual, and arguably against the spirit of
  the use of `IO` relative `ByteString` construction, we don't have any other
  choice. We decided to use the exception mechanism directly, as while
  `MonadUnliftIO` is a bit cleaner, it ultimately ends up doing the same thing
  anyway, and this method at least makes it clear what we're doing.

  This doesn't pose any problems from the point of view of Plutus Core, as this
  exception cannot 'leak'; we handle it entirely within `writeBits`, and no
  other Plutus Core code can ever see it.
-}</span
      ><span
      >
</span
      ><span id="line-961"
      ></span
      ><span class="hs-keyword"
      >newtype</span
      ><span
      > </span
      ><span id="WriteBitsException"
      ><span class="annot"
	><a href="PlutusCore.Bitwise.html#WriteBitsException"
	  ><span class="hs-identifier hs-var"
	    >WriteBitsException</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span id="WriteBitsException"
      ><span class="annot"
	><a href="PlutusCore.Bitwise.html#WriteBitsException"
	  ><span class="hs-identifier hs-var"
	    >WriteBitsException</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-bignum-1.3/docs/src/GHC.Num.Integer.html#Integer"
	><span class="hs-identifier hs-type"
	  >Integer</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-962"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >deriving</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-keyword"
	>stock</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621681920813"
      ><span id="local-6989586621681920816"
	><span class="annot"
	  ><span class="annottext"
	    >WriteBitsException -&gt; WriteBitsException -&gt; Bool
(WriteBitsException -&gt; WriteBitsException -&gt; Bool)
-&gt; (WriteBitsException -&gt; WriteBitsException -&gt; Bool)
-&gt; Eq WriteBitsException
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: WriteBitsException -&gt; WriteBitsException -&gt; Bool
== :: WriteBitsException -&gt; WriteBitsException -&gt; Bool
$c/= :: WriteBitsException -&gt; WriteBitsException -&gt; Bool
/= :: WriteBitsException -&gt; WriteBitsException -&gt; Bool
</span
	    ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#Eq"
	    ><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var"
	      >Eq</span
	      ></a
	    ></span
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621681920820"
      ><span id="local-6989586621681920824"
	><span id="local-6989586621681920828"
	  ><span class="annot"
	    ><span class="annottext"
	      >Int -&gt; WriteBitsException -&gt; [Char] -&gt; [Char]
[WriteBitsException] -&gt; [Char] -&gt; [Char]
WriteBitsException -&gt; [Char]
(Int -&gt; WriteBitsException -&gt; [Char] -&gt; [Char])
-&gt; (WriteBitsException -&gt; [Char])
-&gt; ([WriteBitsException] -&gt; [Char] -&gt; [Char])
-&gt; Show WriteBitsException
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; WriteBitsException -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; WriteBitsException -&gt; [Char] -&gt; [Char]
$cshow :: WriteBitsException -&gt; [Char]
show :: WriteBitsException -&gt; [Char]
$cshowList :: [WriteBitsException] -&gt; [Char] -&gt; [Char]
showList :: [WriteBitsException] -&gt; [Char] -&gt; [Char]
</span
	      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#Show"
	      ><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var"
		>Show</span
		></a
	      ></span
	    ></span
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-963"
      ></span
      ><span
      >
</span
      ><span id="line-964"
      ></span
      ><span class="hs-keyword"
      >instance</span
      ><span
      > </span
      ><span id="local-6989586621681920835"
      ><span id="local-6989586621681920838"
	><span id="local-6989586621681920841"
	  ><span class="annot"
	    ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Exception.Type.html#Exception"
	      ><span class="hs-identifier hs-type"
		>Exception</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusCore.Bitwise.html#WriteBitsException"
	      ><span class="hs-identifier hs-type"
		>WriteBitsException</span
		></a
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-965"
      ></span
      ><span
      >
</span
      ><span id="line-966"
      ></span
      ><span class="hs-comment"
      >{- Note [Manual specialization]
For both integerToByteString and byteStringToInteger, we have to perform very
similar operations, but with small variations:

- Most-significant-first versus most-significant-last (for both)
- Whether we have a size limit or not (for integerToByteString)

Additionally, loop sectioning (see Note [Loop sectioning]) requires us to have
separate 'big-stride' and 'small-stride' operations to ensure universality of
input handling. Lastly, we have several subroutines (digit extraction, for
instance) that may vary in similar ways. In such a case, generalization by
means of abstraction seems like a good idea, as the operations (and
subroutines) vary little.

At the same time, to determine which variation of any given function (or
subroutine) we need, we only have to scrutinize the relevant argument(s) once:
these specifics (such as byte order) don't change during the course of the
operation. Thus, we want to make sure that these checks in the code are _also_
performed only once, ideally at the beginning.

However, if we write such operations naively as so:

&gt; subroutine byteOrder arg1 arg2 = case byteOrder of
&gt;       LittleEndian -&gt; ...
&gt;       BigEndian -&gt; ...

the byteOrder argument will be scrutinized on each call of subroutine. This is
correct in general (as there is no guarantee that the argument will be stable).
Strangely, however, even in a case like this one:

&gt; mainRoutine byteOrder arg1 arg2 = ...
&gt;    where
&gt;       subroutine arg3 = case byteOrder of
&gt;           LittleEndian -&gt; ...
&gt;           BigEndian -&gt; ...

GHC _still_ re-scrutinizes byteOrder in every call of subroutine! This penalty
can be somewhat lessened using a form similar to this:

&gt; mainRoutine byteOrder arg1 arg2 = ...
&gt;     where
&gt;        !subroutine = case byteOrder of
&gt;             LittleEndian -&gt; \arg3 -&gt; ...
&gt;             BigEndian -&gt; \arg3 -&gt; ...

but this is _still_ between 20 and 30% worse than doing something like this:

&gt; mainRoutine byteOrder arg1 arg2 = case byteOrder of
&gt;     LittleEndian -&gt; [code calling subroutineLE where needed]
&gt;     BigEndian -&gt; [code calling subroutineBE where needed]
&gt;     where
&gt;         subroutineLE arg3 = ...
&gt;         subroutineBE arg3 = ...

This form _ensures_ we scrutinize (and branch) only the number of times we have
to, and in a predictable place. Since these are backends for Plutus Core primops,
and performance is thus critical, we choose to use this manually-specialized form
for each combination of relevant arguments. While this is repetitive, and thus
also somewhat error-prone, the performance penalty for not doing this is
unacceptable.
-}</span
      ><span
      >
</span
      ><span id="line-1027"
      ></span
      ><span
      >
</span
      ><span id="line-1028"
      ></span
      ><span class="hs-comment"
      >{- Note [Loop sectioning]

Several operations in this module (including binary logical operations,
`integerToByteString` and `byteStringToInteger`) effectively function as loops
over fixed-width binary chunks: these can be bytes (for logical operations),
digits (for conversions) or something else. These chunks have to be read,
written or both, and may also require processing using fixed-width,
constant-time operations over those chunks from the Haskell side, in some
cases effectively 'translating' these fixed-size operations into variable-width
equivalents over `ByteString`s. In all cases, this involves trafficking data
between memory and machine registers (as `ByteString`s and `Integer`s are both
wrappers around counted arrays), as well as the overheads of looping
(involving comparison and branches). This trafficking is necessary not only to
move the memory around, but also to process it, as on modern architectures,
data must first be moved into a register in order to do anything with it.

However, on all architectures of interest (essentially, 64-bit Tier 1),
general-purpose registers (GPRs henceforth) are 64 bits (or 8 bytes).
Furthermore, the primary cost of moving data between memory and registers is
having to overcome the 'memory wall': the exact amount of data being moved
doesn't affect this very much. In addition to this, when we operate on single
bytes, the remaining 56 bits of the GPR holding that data are essentially
'wasted'. In the situation we have (namely, operating over arrays, whose data
is adjacent in memory), we thus get two sources of inefficiency:

* Despite paying the cost for a memory transfer, we transfer only one-eighth
  the data we could; and
* Despite transferring data from memory to registers, we utilize the register
  at only one-eighth capacity.

This essentially means we perform _eight times_ more rotations of the loop,
and memory moves, than we need to!

To avoid this, we use a technique known as _loop sectioning_.
Effectively, this transforms our homogenous loop (that always operates one byte at
a time) into a heterogenous loop: first, we operate on a larger section (called
a _stride_) until we can no longer do this, and then we finish up using byte
at a time processing. Essentially, when given an input like this:

[ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10 ]

the homogeous byte-at-a-time approach would process it like so:

  _   _   _   _   _   _   _   _   _   _
[ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10 ]

for a total of 10 memory transfers and 10 loop spins, whereas a loop-sectioned
approach with a stride of 8 would instead process like so:

  ______________________________  _   _
[ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10 ]

Giving us only _three_ memory transfers and _three_ loop spins instead. This
effectively reduces our work by a factor of 8. In our cases, this is almost
free, as there is no data processing to be done: all we need to do is copy
from one place to another, essentially.

This technique only benefits us because counted arrays are cache-friendly: see
Note [Superscalarity and caching] for a longer explanation of this and why it
matters.

Further information:

- Tier 1 GHC platform list:
    https://gitlab.haskell.org/ghc/ghc/-/wikis/platforms#tier-1-platforms
- Memory wall:
    https://link.springer.com/referenceworkentry/10.1007/978-0-387-09766-4_234
- Loop sectioning in more detail:
    http://physics.ujep.cz/~zmoravec/prga/main_for/mergedProjects/optaps_for/common/optaps_vec_mine.htm
-}</span
      ><span
      >
</span
      ><span id="line-1098"
      ></span
      ><span
      >
</span
      ><span id="line-1099"
      ></span
      ><span class="hs-comment"
      >{- Note [Superscalarity and caching]
On modern architectures, in order to process data, it must first be moved from
memory into a register. This operation has some cost (known as the 'memory wall'),
which is largely independent of how much data gets moved (assuming the register
can hold it): moving one byte, or a whole register's worth, costs about the same.
To reduce this cost, CPU manufacturers have introduced _cache hierarchies_,
which are designed to limit the cost of the wall, as long as the data access
matches the cache's optimal usage pattern. Thus, while an idealized view of
the memory hierachy is this:

Registers
---------
Memory

in reality, the view is more like this:

Registers
---------
L1 cache
---------
L2 cache
---------
L3 cache (on some platforms)
---------
Memory

Each 'higher' cache in the hierarchy is smaller, but faster, and when a memory
fetch is requested in code, in addition to moving the requested data to a
register, that data (plus some more) is moved into caches as well. The amount
of data moved into cache (a _cache line_) is typically eight machine words on
modern architectures (and definitely is the case for all Tier 1 GHC platforms):
for the cases concerning Plutus, that is 64 bytes. Therefore, if data we need
soon after a fetch is _physically_ nearby, it won't need to be fetched from
memory: instead, it would come from a cache, which is faster (by a considerable
margin).

To see how this can matter, consider the following ByteString:

[ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11 ]

The ByteString (being a counted array) has all of its data physically adjacent
to each other. Suppose we wanted to fetch the byte at index 1 (second position).
The naive view of what happens is like this:

Registers: [b2] [ ] [ ] .... [ ]
Memory: [ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11 ]

Thus, it would appear that, if we wanted a different position's value, we would
need to fetch from memory again. However, what _actually_ happens is more like this:

Registers: [b2] [ ] [ ] .... [ ]
L1 cache: [ b2, b3, b4, b5, b6, b7, b8, b9, b10, b11 ]
Memory: [ b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11 ]

We note that b2, as well as its adjacent elements, were _all_ pulled into the L1
cache. This can only work because all these elements are physically adjacent in
memory. The improvement in performance from this cache use is _very_ non-trivial:
an L1 cache is about 200 times faster than a memory access, and an L2 cache about
20 times faster.

To take further advantage of this, modern CPUs (and all Tier 1 GHC platforms have
this capability) are _superscalar_. To explain what this means, let's consider the
naive view of how CPUs execute instructions: namely, it is one-at-a-time, and
synchronous. While CPUs must give the _appearance_ that they behave this way, in
practice, CPU execution is very much asynchronous: due to the proliferation of ALUs
on a single chip, having twice as many processing units is much cheaper than having
processing units run twice as fast. Thus, if there are no data dependencies
between instructions, CPUs can (and do!) execute them simultaneously, stalling to
await results if a data dependency is detected. This can be done automatically
using Tomasulo's algorithm, which ensures no conflicts with maximum throughput.

Superscalarity interacts well with the cache hierarchy, as it makes data more
easily available for processing, provided there is enough 'work to do', and no
data dependencies. In our situation, most of what we do is data _movement_ from
one memory location to another, which by its very nature lacks any data
dependencies.

Further references:

- Numbers for cache and memory transfers: https://gist.github.com/jboner/2841832
- Superscalarity: https://en.wikipedia.org/wiki/Superscalar_processor
- Tomasulo's algorithm: https://en.wikipedia.org/wiki/Tomasulo%27s_algorithm
-}</span
      ><span
      >
</span
      ><span id="line-1182"
      ></span
      ></pre
    ></body
  ></html
>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-comment"
      >-- editorconfig-checker-disable-file</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE FlexibleContexts #-}</span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE LambdaCase #-}</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE OverloadedStrings #-}</span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TupleSections #-}</span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TypeApplications #-}</span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span
      >
</span
      ><span id="line-8"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Functions for compiling let-bound PIR datatypes into PLC.</span
	></span
      ><span
      >
</span
      ><span id="line-9"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusIR.Compiler.Datatype</span
      ><span
      >
</span
      ><span id="line-10"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#compileDatatype"
	><span class="hs-identifier"
	  >compileDatatype</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#compileDatatypeDefs"
	><span class="hs-identifier"
	  >compileDatatypeDefs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#compileRecDatatypes"
	><span class="hs-identifier"
	  >compileRecDatatypes</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeValueType"
	><span class="hs-identifier"
	  >mkDatatypeValueType</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#mkDestructorTy"
	><span class="hs-identifier"
	  >mkDestructorTy</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-15"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#mkScottTy"
	><span class="hs-identifier"
	  >mkScottTy</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-16"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	><span class="hs-identifier"
	  >resultTypeName</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-17"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-18"
      ></span
      ><span
      >
</span
      ><span id="line-19"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusPrelude.html"
	><span class="hs-identifier"
	  >PlutusPrelude</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusPrelude.html#showText"
	><span class="hs-identifier"
	  >showText</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-20"
      ></span
      ><span
      >
</span
      ><span id="line-21"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.html"
	><span class="hs-identifier"
	  >PlutusIR</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-22"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Names.html"
	><span class="hs-identifier"
	  >PlutusIR.Compiler.Names</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-23"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Provenance.html"
	><span class="hs-identifier"
	  >PlutusIR.Compiler.Provenance</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-24"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Types.html"
	><span class="hs-identifier"
	  >PlutusIR.Compiler.Types</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-25"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Error.html"
	><span class="hs-identifier"
	  >PlutusIR.Error</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-26"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.MkPir.html"
	><span class="hs-identifier"
	  >PlutusIR.MkPir</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PIR</span
	></span
      ><span
      >
</span
      ><span id="line-27"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Subst.html"
	><span class="hs-identifier"
	  >PlutusIR.Subst</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-28"
      ></span
      ><span
      >
</span
      ><span id="line-29"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Core.html"
	><span class="hs-identifier"
	  >PlutusCore.Core</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-30"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.MkPlc.html"
	><span class="hs-identifier"
	  >PlutusCore.MkPlc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-31"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Quote.html"
	><span class="hs-identifier"
	  >PlutusCore.Quote</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-32"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.StdLib.Type.html"
	><span class="hs-identifier"
	  >PlutusCore.StdLib.Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Types</span
	></span
      ><span
      >
</span
      ><span id="line-33"
      ></span
      ><span
      >
</span
      ><span id="line-34"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.Except.html"
	><span class="hs-identifier"
	  >Control.Monad.Except</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-35"
      ></span
      ><span
      >
</span
      ><span id="line-36"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.html"
	><span class="hs-identifier"
	  >Data.Text</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>T</span
	></span
      ><span
      >
</span
      ><span id="line-37"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html"
	><span class="hs-identifier"
	  >Data.Traversable</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-38"
      ></span
      ><span
      >
</span
      ><span id="line-39"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Control.Lens</span
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >hiding</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="hs-identifier"
	>index</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-40"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.List.NonEmpty.html"
	><span class="hs-identifier"
	  >Data.List.NonEmpty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>NE</span
	></span
      ><span
      >
</span
      ><span id="line-41"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Word.html"
	><span class="hs-identifier"
	  >Data.Word</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
	><span class="hs-identifier"
	  >Word64</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-42"
      ></span
      ><span
      >
</span
      ><span id="line-43"
      ></span
      ><span class="hs-comment"
      >{- Note [Normalization of data-constructors' types]

Currently the typechecking and compilation of dataconstructors/destructor
assume that the data-constructors' types (of the parsed PIR input) are in normalized form.
If these types are not normalized, the compilation will generate failing plc code.

There are no checks in place to enforce this normalization, and while
plutus-tx plugin is unlikely to generate PIR code with unnormalized types inside
these dataconstructor locations, it may still need to be taken into account in
the unlikely case that a user has manually modified the PIR input.

Future solutions:

1) disallow unnormalized types in dataconstructors, by adding a &quot;isNormalized&quot; check  prior to compilation.
2) allow unnormalized types in dataconstructors and normalize them prior to compilation.
-}</span
      ><span
      >
</span
      ><span id="line-59"
      ></span
      ><span
      >
</span
      ><span id="line-60"
      ></span
      ><span class="hs-comment"
      >-- Utilities</span
      ><span
      >
</span
      ><span id="line-61"
      ></span
      ><span
      >
</span
      ><span id="line-62"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Given the type of a constructor, get the type of the &quot;case&quot; type with the given result type.
@constructorCaseType R (A-&gt;Maybe A) = (A -&gt; R)@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-64"
      ></span
      ><span id="local-6989586621679481120"
      ><span id="local-6989586621679481121"
	><span id="local-6989586621679481122"
	  ><span id="local-6989586621679481124"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#constructorCaseType"
		><span class="hs-identifier hs-type"
		  >constructorCaseType</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481120"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481121"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481122"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481120"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
		><span class="hs-identifier hs-type"
		  >VarDecl</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481121"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481124"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481122"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481120"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481121"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481122"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481120"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-65"
      ></span
      ><span id="constructorCaseType"
      ><span class="annot"
	><span class="annottext"
	  >constructorCaseType :: forall a tyname (uni :: * -&gt; *) name.
a
-&gt; Type tyname uni a
-&gt; VarDecl tyname name uni a
-&gt; Type tyname uni a
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#constructorCaseType"
	  ><span class="hs-identifier hs-var hs-var"
	    >constructorCaseType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481449"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679481449"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481450"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni a
</span
	  ><a href="#local-6989586621679481450"
	  ><span class="hs-identifier hs-var"
	    >resultType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481451"
      ><span class="annot"
	><span class="annottext"
	  >VarDecl tyname name uni a
</span
	  ><a href="#local-6989586621679481451"
	  ><span class="hs-identifier hs-var"
	    >vd</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; [Type tyname uni a] -&gt; Type tyname uni a -&gt; Type tyname uni a
forall ann tyname (uni :: * -&gt; *).
ann
-&gt; [Type tyname uni ann]
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyFun"
	><span class="hs-identifier hs-var"
	  >PLC.mkIterTyFun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481449"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni a -&gt; [Type tyname uni a]
forall tyname (uni :: * -&gt; *) a.
Type tyname uni a -&gt; [Type tyname uni a]
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#funTyArgs"
	><span class="hs-identifier hs-var"
	  >PLC.funTyArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl tyname name uni a -&gt; Type tyname uni a
forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_varDeclType"
	><span class="hs-identifier hs-var"
	  >_varDeclType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl tyname name uni a
</span
	><a href="#local-6989586621679481451"
	><span class="hs-identifier hs-var"
	  >vd</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni a
</span
	><a href="#local-6989586621679481450"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-66"
      ></span
      ><span
      >
</span
      ><span id="line-67"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Given the type of a constructor, get its argument types.
@constructorArgTypes (A-&gt;Maybe A) = [A] -}</span
	></span
      ><span
      >
</span
      ><span id="line-69"
      ></span
      ><span id="local-6989586621679481140"
      ><span id="local-6989586621679481141"
	><span id="local-6989586621679481142"
	  ><span id="local-6989586621679481143"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#constructorArgTypes"
		><span class="hs-identifier hs-type"
		  >constructorArgTypes</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
		><span class="hs-identifier hs-type"
		  >VarDecl</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481140"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481141"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481142"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481143"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >[</span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481140"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481142"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481143"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >]</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-70"
      ></span
      ><span id="constructorArgTypes"
      ><span class="annot"
	><span class="annottext"
	  >constructorArgTypes :: forall tyname name (uni :: * -&gt; *) a.
VarDecl tyname name uni a -&gt; [Type tyname uni a]
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#constructorArgTypes"
	  ><span class="hs-identifier hs-var hs-var"
	    >constructorArgTypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni a -&gt; [Type tyname uni a]
forall tyname (uni :: * -&gt; *) a.
Type tyname uni a -&gt; [Type tyname uni a]
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#funTyArgs"
	><span class="hs-identifier hs-var"
	  >PLC.funTyArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type tyname uni a -&gt; [Type tyname uni a])
-&gt; (VarDecl tyname name uni a -&gt; Type tyname uni a)
-&gt; VarDecl tyname name uni a
-&gt; [Type tyname uni a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl tyname name uni a -&gt; Type tyname uni a
forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_varDeclType"
	><span class="hs-identifier hs-var"
	  >_varDeclType</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-71"
      ></span
      ><span
      >
</span
      ><span id="line-72"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | &quot;Unveil&quot; a datatype definition in a type, by replacing uses of the name as a type variable with the concrete definition.</span
	></span
      ><span
      >
</span
      ><span id="line-73"
      ></span
      ><span id="local-6989586621679481151"
      ><span id="local-6989586621679481152"
	><span id="local-6989586621679481153"
	  ><span id="local-6989586621679481154"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
		><span class="hs-identifier hs-type"
		  >unveilDatatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#Eq"
		><span class="hs-identifier hs-type"
		  >Eq</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481151"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481151"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481152"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481153"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481151"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481154"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481152"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481153"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481151"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481152"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481153"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
		><span class="hs-identifier hs-type"
		  >Type</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481151"
		><span class="hs-identifier hs-type"
		  >tyname</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481152"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481153"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-74"
      ></span
      ><span id="unveilDatatype"
      ><span class="annot"
	><span class="annottext"
	  >unveilDatatype :: forall tyname (uni :: * -&gt; *) a name.
Eq tyname =&gt;
Type tyname uni a
-&gt; Datatype tyname name uni a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
	  ><span class="hs-identifier hs-var hs-var"
	    >unveilDatatype</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481460"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni a
</span
	  ><a href="#local-6989586621679481460"
	  ><span class="hs-identifier hs-var"
	    >dty</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481462"
      ><span class="annot"
	><span class="annottext"
	  >TyVarDecl tyname a
</span
	  ><a href="#local-6989586621679481462"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl tyname a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl tyname name uni a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(tyname -&gt; Maybe (Type tyname uni a))
-&gt; Type tyname uni a -&gt; Type tyname uni a
forall tyname (uni :: * -&gt; *) ann.
(tyname -&gt; Maybe (Type tyname uni ann))
-&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Subst.html#typeSubstTyNames"
	><span class="hs-identifier hs-var"
	  >typeSubstTyNames</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679481464"
      ><span class="annot"
	><span class="annottext"
	  >tyname
</span
	  ><a href="#local-6989586621679481464"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679481464"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname -&gt; tyname -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl tyname a -&gt; tyname
forall tyname ann. TyVarDecl tyname ann -&gt; tyname
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_tyVarDeclName"
	><span class="hs-identifier hs-var"
	  >_tyVarDeclName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl tyname a
</span
	><a href="#local-6989586621679481462"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni a -&gt; Maybe (Type tyname uni a)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni a
</span
	><a href="#local-6989586621679481460"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni a)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-75"
      ></span
      ><span
      >
</span
      ><span id="line-76"
      ></span
      ><span id="local-6989586621679481168"
      ><span id="local-6989586621679481172"
	><span id="local-6989586621679481173"
	  ><span class="annot"
	    ><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	      ><span class="hs-identifier hs-type"
		>resultTypeName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >::</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
	      ><span class="hs-identifier hs-type"
		>MonadQuote</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481168"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >=&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusIR.Core.Type.html#Datatype"
	      ><span class="hs-identifier hs-type"
		>Datatype</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	      ><span class="hs-identifier hs-type"
		>Name</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481172"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481173"
	      ><span class="hs-identifier hs-type"
		>a</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481168"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-77"
      ></span
      ><span id="resultTypeName"
      ><span class="annot"
	><span class="annottext"
	  >resultTypeName :: forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m TyName
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	  ><span class="hs-identifier hs-var hs-var"
	    >resultTypeName</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481476"
      ><span class="annot"
	><span class="annottext"
	  >TyVarDecl TyName a
</span
	  ><a href="#local-6989586621679481476"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Quote TyName -&gt; m TyName
forall a. Quote a -&gt; m a
forall (m :: * -&gt; *) a. MonadQuote m =&gt; Quote a -&gt; m a
</span
	><a href="../../plutus-core/src/PlutusCore.Quote.html#liftQuote"
	><span class="hs-identifier hs-var"
	  >liftQuote</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Quote TyName -&gt; m TyName) -&gt; Quote TyName -&gt; m TyName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Quote TyName
forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m TyName
</span
	><a href="../../plutus-core/src/PlutusCore.Quote.html#freshTyName"
	><span class="hs-identifier hs-var"
	  >freshTyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; Quote TyName) -&gt; Text -&gt; Quote TyName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;out_&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Text
</span
	><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#_nameText"
	><span class="hs-identifier hs-var"
	  >_nameText</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Name -&gt; Text) -&gt; Name -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName -&gt; Name
</span
	><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#unTyName"
	><span class="hs-identifier hs-var"
	  >unTyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(TyName -&gt; Name) -&gt; TyName -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName a -&gt; TyName
forall tyname ann. TyVarDecl tyname ann -&gt; tyname
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_tyVarDeclName"
	><span class="hs-identifier hs-var"
	  >_tyVarDeclName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName a
</span
	><a href="#local-6989586621679481476"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-78"
      ></span
      ><span
      >
</span
      ><span id="line-79"
      ></span
      ><span class="hs-comment"
      >-- Datatypes</span
      ><span
      >
</span
      ><span id="line-80"
      ></span
      ><span
      >
</span
      ><span id="line-81"
      ></span
      ><span class="hs-comment"
      >{- Note [Encoding of datatypes]
PIR datatypes must be encoded into PLC. We support two schemes for doing this:
- Scott encoding (see Note [Scott encoding of datatypes] for details)
- Sums-of-products (SOPs) (See Note [SOP encoding of datatypes] for details)

Scott encoding is what we used originally, before we had SOPs. We still support both
modes, because users targeting older versions of the language can't use the SOP
encoding. Otherwise, the SOP encoding is superior (faster, simpler).
-}</span
      ><span
      >
</span
      ><span id="line-90"
      ></span
      ><span
      >
</span
      ><span id="line-91"
      ></span
      ><span class="hs-comment"
      >{- Note [Scott encoding of datatypes]
We can translate our datatypes using the Scott encoding. The fundamental idea is that there is one thing
you can do with a datatype value: pattern match on it. A datatype value is therefore represented by
precisely the thing you need to do a pattern match. Namely, a function that takes functions implementing
each arm of the match, and then gives you a result.

We also need to think about the types. In general, we need:
- The encoded type corresponding to the datatype itself
- The encoded type of each constructor
- The encoded term for each constructor
- The encoded type of the destructor
- The encoded term for the destructor

-- Basic example

For example, consider 'data Maybe a = Nothing | Just a'. Then:
- The type corresponding to the datatype is:
  Maybe = \(t :: *) . forall (out_Maybe :: *) . out_Maybe -&gt; (t -&gt; out_Maybe) -&gt; out_Maybe
- The type of the constructors are:
  Just : forall (t :: *) . t -&gt; Maybe t
  Nothing : forall (t :: *) . Maybe t
- The terms for the constructors are:
  Just = /\ (t :: *) \(x : t) /\ (out_Maybe :: *) \(case_Nothing : out_Maybe) (case_Just : t -&gt; out_Maybe) . case_Just x
  Nothing = /\ (t :: *) /\ (out_Maybe :: *) \(case_Nothing : out_Maybe) (case_Just : t -&gt; out_Maybe) . case_Nothing
- The type of the destructor is:
  match_Maybe : forall (t :: *) . Maybe t -&gt; forall (out_Maybe :: *) . out_Maybe -&gt; (t -&gt; out_Maybe) -&gt; out_Maybe
- The term for the destructor is:
  match_Maybe = /\(t :: *) \(x : Maybe t) . x

-- General case

Consider a datatype as defined in Plutus IR:
(datatype
  (tyvardecl T (type))
  (tyvardecl t_0 k_0)
  ..
  (tyvardecl t_n k_n)
  match_T
  (vardecl c_0 (fun t_c_0_0 .. (fun t_c_0_(c_0_k)) [T t0 .. tn]))
  ..
  (vardecl c_j (fun t_c_j_0 .. (fun t_c_j_(c_j_k)) [T t0 .. tn]))
)

That is, it has:
- Name T
- Type parameters t_0 to t_n of kind k_0 to k_n
- Kind * -&gt; ... n times ... -&gt; *
- Destructor match_t
_ Constructors c_0 to c_j with the arguments of c_i having types t_c_i_1 to t_c_i_(c_i_k)

The type corresponding to the datatype is:
\(t_0 :: k_0) .. (t_n :: k_n) .
  forall out_T :: * .
    (t_c_0_0 -&gt; .. -&gt; t_c_0_(c_0_k) -&gt; out_T) -&gt; .. -&gt; (t_c_j_0 -&gt; .. -&gt; t_c_j_(c_j_k) -&gt; out_T) -&gt;
      out_T

The type of the constructor c_i (0 &lt;= i &lt;= j) is:
forall (t_0 :: k_0) .. (t_n :: k_n) .
  t_c_i_0 -&gt; .. -&gt; t_c_i_(c_i_k) -&gt;
    (T t_0 .. t_n)
This is actually declared for us in the datatype declaration, but without the type
variables being abstracted out. We use this to get the argument types of the constructor.

The term for the constructor c_i (0 &lt;= i &lt;= j) is (slightly fudged types, see Note [Abstract data types]):
/\(t_0 :: k_0) .. (t_n :: k_n) .
  \(x_0 : t_c_i_0) .. (x_(c_i_k) : t_c_i_(c_i_k)) .
    /\(out_T :: *) .
      \(case_c_0 : (t_c_0_0 -&gt; .. -&gt; t_c_0_(c_0_k) -&gt; out_T)) .. (case_c_j : (t_c_j_0 -&gt; .. -&gt; t_c_j_(c_j_k) -&gt; out_T)) .
        case_c_i x_0 .. x_(c_i_k)

The type of the destructor is:
forall (t_0 :: k_0) .. (t_n :: k_n) .
  (T t_0 .. t_n) -&gt;
    forall out_T :: * .
      (t_c_0_0 -&gt; .. -&gt; t_c_0_(c_0_k) -&gt; out_T) -&gt; .. -&gt; (t_c_j_0 -&gt; .. -&gt; t_c_j_(c_j_k) -&gt; out_T) -&gt;
        out_T

The term for the destructor is (slightly fudged types, see Note [Abstract data types]):
/\(t_0 :: k_0) .. (t_n :: k_n) .
  \(x :: (T t_0 .. t_n)) .
    x
-}</span
      ><span
      >
</span
      ><span id="line-173"
      ></span
      ><span
      >
</span
      ><span id="line-174"
      ></span
      ><span class="hs-comment"
      >{- Note [SOP encoding of datatypes]
We can translate our datatypes using SOPs. This is much more direct than Scott encoding, since
we have terms in the language for construction and destruction themselves.

We still need to think about the types. In general, we need:
- The encoded type corresponding to the datatype itself
- The encoded type of each constructor
- The encoded term for each constructor
- The encoded type of the destructor
- The encoded term for the destructor

-- Basic example

For example, consider 'data Maybe a = Nothing | Just a'. Then:
- The type corresponding to the datatype is:
  Maybe = \(a :: *) . sop [] [a]
- The type of the constructors are:
  Nothing : forall (a :: *) . Maybe a
  Just    : forall (a :: *) . a -&gt; Maybe a
- The terms for the constructors are:
  Nothing =           /\(a :: *) . constr 0 (Maybe a)
  Just    = /\(a :: *) \(x :: a) . constr 1 (Maybe a) x
- The type of the destructor is:
  match_Maybe :: forall (a :: *) . Maybe a -&gt; forall (out_Maybe :: *) . out_Maybe -&gt; (a -&gt; out_Maybe) -&gt; out_Maybe
- The term for the destructor is:
  match_Maybe = /\(a :: *) \(x : Maybe a) /\(out_Maybe :: *) \(case_Nothing :: out_Maybe) (case_Just :: a -&gt; out_Maybe) .
    case out_Maybe x case_Nothing case_Just

-- General case

Consider a datatype as defined in Plutus IR:
(datatype
  (tyvardecl T (type))
  (tyvardecl t_0 k_0)
  ..
  (tyvardecl t_n k_n)
  match_T
  (vardecl c_0 (fun t_c_0_0 .. (fun t_c_0_(c_0_k)) [T t0 .. tn]))
  ..
  (vardecl c_j (fun t_c_j_0 .. (fun t_c_j_(c_j_k)) [T t0 .. tn]))
)

That is, it has:
- Name T
- Type parameters t_0 to t_n of kind k_0 to k_n
- Kind * -&gt; ... n times .. -&gt; *
- Destructor match_T
_ Constructors c_0 to c_j with the arguments of c_i having types t_c_i_0 to t_c_i_(c_i_k)

The type corresponding to the datatype is:
\(t_0 :: k_0) .. (t_n :: k_n) . sop [t_c_0_0 .. t_c_0_(c_0_k)] .. [t_c_j_0 .. t_c_j_(c_j_k)]

The type of the constructor c_i (0 &lt;= i &lt;= j) is:
forall (t_0 :: t_0) .. (t_n :: k_n) .
  t_c_i_0 -&gt; .. -&gt; t_c_i_(c_i_k) -&gt;
    (T t_0 .. t_n)
This is actually declared for us in the datatype declaration, but without the type
variables being abstracted out. We use this to get the argument types of the constructor.

The term for the constructor c_i (0 &lt;= i &lt;= j) is (slightly fudged types, see Note [Abstract data types]):
/\(t_0 :: t_0) .. (t_n :: k_n) .
  \(x_0 : t_c_i_0) .. (x_(c_i_k) : t_c_i_(c_i_k)) .
    constr (T t_0 .. t_n) i (T t_0 .. t_n) x_0 .. x_(c_i_k)

The type of the destructor is:
forall (t_0 :: k_0) .. (t_n :: k_n) .
  (T t_0 .. t_n) -&gt;
    forall out_T :: * .
      (t_c_0_1 -&gt; .. -&gt; t_c_0_(c_0_k) -&gt; out_T) -&gt; .. -&gt; (t_c_j_0 -&gt; .. -&gt; t_c_j_(c_j_k) -&gt; out_T) -&gt;
        out_T

The term for the destructor is (slightly fudged types, see Note [Abstract data types]):
/\(t_0 :: k_0) .. (t_n :: k_n) .
  \(x :: (T t_0 .. t_n)) .
    /\(out_T :: *) .
      \(case_c_0 : (t_c_0_0 -&gt; .. -&gt; t_c_0_(c_0_k) -&gt; out_T)) .. (case_c_j : (t_c_j_0 -&gt; .. -&gt; t_c_j_(c_j_k) -&gt; out_T)) .
        case out_T x case_c_0 .. case_c_j
-}</span
      ><span
      >
</span
      ><span id="line-252"
      ></span
      ><span
      >
</span
      ><span id="line-253"
      ></span
      ><span class="hs-comment"
      >{- Note [Compiling uses of datatypes]

We turn constructor invocations into calls to the constructor functions.

Pattern matching is slightly more complex as we need to turn it into an invocation of the destructor:
- We take each alternative, turn it into a function of its bound variables.
- We apply the destructor to the scrutinee, and then instantiate that (which will be polymorphic
  in the result type) at the type of the overall match expression.
    - This does indicate one wrinkle: we need to know the overall type, we can't infer it.
- We apply the instantiated value to the functions for each alternative.
-}</span
      ><span
      >
</span
      ><span id="line-264"
      ></span
      ><span
      >
</span
      ><span id="line-265"
      ></span
      ><span class="hs-comment"
      >{- Note [Abstract data types]
While the Scott encoding makes it easy to simply convert all types inline, it
is convenient for a number of reasons to instead abstract out data types. Namely:
- The resulting code is much more readable, since we have named types instead
of (potentially big) inlined types.
- We generate less code because we're not repeating the definition at every use site.

The basic idea is to &quot;let-bind&quot; types using type abstractions, and values using
lambda abstractions. There are a few considerations that make this tricky, however:

1. When types are inlined, the Scott encoding allows us to construct values by
  constructing the matching function inline. When they are abstract, we need to provide
  (suitably polymorphic) constructors abstractly.
2. When types are inlined, the Scott encoding allows us to match against a type by
  simply using it as a function. When they are abstract, we need to provide a
  (suitably polymorphic) matching function abstractly.
3. The definition of a type must be abstract in the binding types of the constructors and destructors
  (so they can be used alongside the abstract type), but it must *not* be abstract in the
  *definition* of the constructors or destructors, because they depend on knowing the real structure
  of the type.
    1. In fact we can do slightly better than this: in the constructors of a recursive datatype we can use the type
       as a name inside the 'wrap'.

Consequently, for a single type we end up with something like the following:

(/\ ty :: * .
  -- ty abstract in these types
  \(c_1 : &lt;constructor type i&gt;) .. (c_j : &lt;constructor type j&gt;) .
    -- ty abstract in this type
    \match : &lt;destructor type&gt; .
      &lt;user term&gt;
)
&lt;defn of ty&gt;
-- ty concrete in these terms, except maybe inside a 'wrap'
&lt;defn of c_1&gt;
..
&lt;defn of c_j&gt;
-- ty concrete in this term
&lt;defn of match&gt;

(see Note [Encoding of datatypes] for how the actual definitions are constructed)
-}</span
      ><span
      >
</span
      ><span id="line-307"
      ></span
      ><span
      >
</span
      ><span id="line-308"
      ></span
      ><span class="hs-comment"
      >{- Note [Recursive datatypes]
Recursive data types make the scheme described in [Encoding of datatypes] a bit more
complex. At the moment we only support self-recursive datatypes.

For a (self-)recursive datatype we have to change three things:
- The type of the datatype itself must have an enclosing fix over the type variable for
  the type itself.
- Constructors must include a wrap.
- Destructors must include an unwrap.
-}</span
      ><span
      >
</span
      ><span id="line-318"
      ></span
      ><span
      >
</span
      ><span id="line-319"
      ></span
      ><span class="hs-comment"
      >-- See Note [Encoding of datatypes]</span
      ><span
      >
</span
      ><span id="line-320"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the &quot;Scott-encoded&quot; type for a 'Datatype', with type variables free.
This is exactly the type of an eliminator function for the datatype.

@mkScottTy Maybe = forall out_Maybe. out_Maybe -&gt; (a -&gt; out_Maybe) -&gt; out_Maybe@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-324"
      ></span
      ><span id="local-6989586621679481189"
      ><span id="local-6989586621679481190"
	><span id="local-6989586621679481191"
	  ><span class="annot"
	    ><a href="PlutusIR.Compiler.Datatype.html#mkScottTy"
	      ><span class="hs-identifier hs-type"
		>mkScottTy</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >::</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
	      ><span class="hs-identifier hs-type"
		>MonadQuote</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481189"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >=&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481190"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusIR.Core.Type.html#Datatype"
	      ><span class="hs-identifier hs-type"
		>Datatype</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	      ><span class="hs-identifier hs-type"
		>Name</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481191"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481190"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481189"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-special"
	    >(</span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	      ><span class="hs-identifier hs-type"
		>Type</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481191"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481190"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span class="hs-special"
	    >)</span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-325"
      ></span
      ><span id="mkScottTy"
      ><span class="annot"
	><span class="annottext"
	  >mkScottTy :: forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkScottTy"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkScottTy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481489"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679481489"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481490"
      ><span class="annot"
	><span class="annottext"
	  >d :: Datatype TyName Name uni ann
</span
	  ><a href="#local-6989586621679481490"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName ann]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481491"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni ann]
</span
	  ><a href="#local-6989586621679481491"
	  ><span class="hs-identifier hs-var"
	    >constrs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-326"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481492"
      ><span class="annot"
	><span class="annottext"
	  >TyName
</span
	  ><a href="#local-6989586621679481492"
	  ><span class="hs-identifier hs-var"
	    >res</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni ann -&gt; m TyName
forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m TyName
</span
	><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	><span class="hs-identifier hs-var"
	  >resultTypeName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni ann
</span
	><a href="#local-6989586621679481490"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-327"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- FIXME (https://github.com/IntersectMBO/plutus-private/issues/1875):</span
      ><span
      >
</span
      ><span id="line-328"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- normalize datacons' types also here</span
      ><span
      >
</span
      ><span id="line-329"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481495"
      ><span class="annot"
	><span class="annottext"
	  >caseTys :: [Type TyName uni ann]
</span
	  ><a href="#local-6989586621679481495"
	  ><span class="hs-identifier hs-var hs-var"
	    >caseTys</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni ann -&gt; Type TyName uni ann)
-&gt; [VarDecl TyName Name uni ann] -&gt; [Type TyName uni ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Type TyName uni ann
-&gt; VarDecl TyName Name uni ann
-&gt; Type TyName uni ann
forall a tyname (uni :: * -&gt; *) name.
a
-&gt; Type tyname uni a
-&gt; VarDecl tyname name uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#constructorCaseType"
	><span class="hs-identifier hs-var"
	  >constructorCaseType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; TyName -&gt; Type TyName uni ann
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVar"
	><span class="hs-identifier hs-var"
	  >TyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481492"
	><span class="hs-identifier hs-var"
	  >res</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni ann]
</span
	><a href="#local-6989586621679481491"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-330"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni ann -&gt; m (Type TyName uni ann))
-&gt; Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-331"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- forall res.</span
      ><span
      >
</span
      ><span id="line-332"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; TyName -&gt; Kind ann -&gt; Type TyName uni ann -&gt; Type TyName uni ann
forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyForall"
	><span class="hs-identifier hs-var"
	  >TyForall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481492"
	><span class="hs-identifier hs-var"
	  >res</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; Kind ann
forall ann. ann -&gt; Kind ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	><span class="hs-identifier hs-var"
	  >Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni ann -&gt; Type TyName uni ann)
-&gt; Type TyName uni ann -&gt; Type TyName uni ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-333"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- c_1 -&gt; .. -&gt; c_n -&gt; res</span
      ><span
      >
</span
      ><span id="line-334"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; [Type TyName uni ann]
-&gt; Type TyName uni ann
-&gt; Type TyName uni ann
forall ann tyname (uni :: * -&gt; *).
ann
-&gt; [Type tyname uni ann]
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyFun"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyFun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Type TyName uni ann]
</span
	><a href="#local-6989586621679481495"
	><span class="hs-identifier hs-var"
	  >caseTys</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; TyName -&gt; Type TyName uni ann
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVar"
	><span class="hs-identifier hs-var"
	  >TyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481489"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481492"
	><span class="hs-identifier hs-var"
	  >res</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-335"
      ></span
      ><span
      >
</span
      ><span id="line-336"
      ></span
      ><span id="local-6989586621679481206"
      ><span id="local-6989586621679481207"
	><span class="annot"
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeSOPTy"
	    ><span class="hs-identifier hs-type"
	      >mkDatatypeSOPTy</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >::</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481206"
	    ><span class="hs-identifier hs-type"
	      >ann</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="PlutusIR.Core.Type.html#Datatype"
	    ><span class="hs-identifier hs-type"
	      >Datatype</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	    ><span class="hs-identifier hs-type"
	      >Name</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481207"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481206"
	    ><span class="hs-identifier hs-type"
	      >ann</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	    ><span class="hs-identifier hs-type"
	      >Type</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481207"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481206"
	    ><span class="hs-identifier hs-type"
	      >ann</span
	      ></a
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-337"
      ></span
      ><span id="mkDatatypeSOPTy"
      ><span class="annot"
	><span class="annottext"
	  >mkDatatypeSOPTy :: forall ann (uni :: * -&gt; *).
ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeSOPTy"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkDatatypeSOPTy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481501"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679481501"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName ann]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481502"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni ann]
</span
	  ><a href="#local-6989586621679481502"
	  ><span class="hs-identifier hs-var"
	    >constrs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; [[Type TyName uni ann]] -&gt; Type TyName uni ann
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; [[Type tyname uni ann]] -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TySOP"
	><span class="hs-identifier hs-var"
	  >TySOP</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481501"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni ann -&gt; [Type TyName uni ann])
-&gt; [VarDecl TyName Name uni ann] -&gt; [[Type TyName uni ann]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni ann -&gt; [Type TyName uni ann]
forall tyname name (uni :: * -&gt; *) a.
VarDecl tyname name uni a -&gt; [Type tyname uni a]
</span
	><a href="PlutusIR.Compiler.Datatype.html#constructorArgTypes"
	><span class="hs-identifier hs-var"
	  >constructorArgTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni ann]
</span
	><a href="#local-6989586621679481502"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-338"
      ></span
      ><span
      >
</span
      ><span id="line-339"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the body of the &quot;pattern functor&quot; of a 'Datatype'. This is just the non-abstract datatype type,
but with the type variable for the type itself free and its type variables free.

Scott: @mkPatternFunctorBody List = forall (out_List :: *) . out_List -&gt; (a -&gt; List a -&gt; out_List) -&gt; out_List@
SOPs: @mkPatternFunctorBody List = sop [] [a, List a]@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-344"
      ></span
      ><span id="local-6989586621679481210"
      ><span id="local-6989586621679481212"
	><span id="local-6989586621679481213"
	  ><span class="annot"
	    ><a href="PlutusIR.Compiler.Datatype.html#mkPatternFunctorBody"
	      ><span class="hs-identifier hs-type"
		>mkPatternFunctorBody</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >::</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
	      ><span class="hs-identifier hs-type"
		>MonadQuote</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481210"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >=&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusIR.Compiler.Types.html#DatatypeCompilationOpts"
	      ><span class="hs-identifier hs-type"
		>DatatypeCompilationOpts</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481212"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusIR.Core.Type.html#Datatype"
	      ><span class="hs-identifier hs-type"
		>Datatype</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	      ><span class="hs-identifier hs-type"
		>Name</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481213"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481212"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481210"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-special"
	    >(</span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	      ><span class="hs-identifier hs-type"
		>Type</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481213"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481212"
	      ><span class="hs-identifier hs-type"
		>ann</span
		></a
	      ></span
	    ><span class="hs-special"
	    >)</span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-345"
      ></span
      ><span id="mkPatternFunctorBody"
      ><span class="annot"
	><span class="annottext"
	  >mkPatternFunctorBody :: forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkPatternFunctorBody"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkPatternFunctorBody</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481511"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481511"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481512"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679481512"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481513"
      ><span class="annot"
	><span class="annottext"
	  >Datatype TyName Name uni ann
</span
	  ><a href="#local-6989586621679481513"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts -&gt; DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#_dcoStyle"
	><span class="hs-identifier hs-var"
	  >_dcoStyle</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481511"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-346"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#ScottEncoding"
	><span class="hs-identifier hs-var"
	  >ScottEncoding</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkScottTy"
	><span class="hs-identifier hs-var"
	  >mkScottTy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481512"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni ann
</span
	><a href="#local-6989586621679481513"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-347"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#SumsOfProducts"
	><span class="hs-identifier hs-var"
	  >SumsOfProducts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni ann -&gt; m (Type TyName uni ann))
-&gt; Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
forall ann (uni :: * -&gt; *).
ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeSOPTy"
	><span class="hs-identifier hs-var"
	  >mkDatatypeSOPTy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481512"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni ann
</span
	><a href="#local-6989586621679481513"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-348"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#BuiltinCasing"
	><span class="hs-identifier hs-var"
	  >BuiltinCasing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni ann -&gt; m (Type TyName uni ann))
-&gt; Type TyName uni ann -&gt; m (Type TyName uni ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
forall ann (uni :: * -&gt; *).
ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeSOPTy"
	><span class="hs-identifier hs-var"
	  >mkDatatypeSOPTy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679481512"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni ann
</span
	><a href="#local-6989586621679481513"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-349"
      ></span
      ><span
      >
</span
      ><span id="line-350"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the real PLC type corresponding to a 'Datatype' with the given pattern functor body.

Scott:
@
    mkDatatypeType List &lt;pattern functor body of List&gt;
        = fix (\(List :: * -&gt; *) (a :: *) -&gt; &lt;pattern functor body of List&gt;)
        = fix (\(List :: * -&gt; *) (a :: *) -&gt; forall (r :: *) . r -&gt; (a -&gt; List a -&gt; r) -&gt; r)
@

SOPs:
@
    mkDatatypeType List &lt;pattern functor of List&gt;
        = fix (\(List :: * -&gt; *) (a :: *) -&gt; &lt;pattern functor body of List&gt;)
        = fix (\(List :: * -&gt; *) (a :: *) -&gt; \(a :: *) -&gt; sop [] [a, List a])
@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-365"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeType"
	><span class="hs-identifier hs-type"
	  >mkDatatypeType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679481218"
      ><span class="annot"
	><a href="#local-6989586621679481218"
	  ><span class="hs-identifier hs-type"
	    >m</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481220"
      ><span class="annot"
	><a href="#local-6989586621679481220"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481223"
      ><span class="annot"
	><a href="#local-6989586621679481223"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481221"
      ><span class="annot"
	><a href="#local-6989586621679481221"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	></span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
	><span class="hs-identifier hs-type"
	  >MonadQuote</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481218"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Types.html#DatatypeCompilationOpts"
	><span class="hs-identifier hs-type"
	  >DatatypeCompilationOpts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Recursivity"
	><span class="hs-identifier hs-type"
	  >Recursivity</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	><span class="hs-identifier hs-type"
	  >TyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481220"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
	><span class="hs-identifier hs-type"
	  >Provenance</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481221"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481218"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Types.html#PLCRecType"
	><span class="hs-identifier hs-type"
	  >PLCRecType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481220"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481223"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481221"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-366"
      ></span
      ><span id="mkDatatypeType"
      ><span class="annot"
	><span class="annottext"
	  >mkDatatypeType :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PLCRecType uni fun a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeType"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkDatatypeType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481529"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481529"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481530"
      ><span class="annot"
	><span class="annottext"
	  >Recursivity
</span
	  ><a href="#local-6989586621679481530"
	  ><span class="hs-identifier hs-var"
	    >r</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481531"
      ><span class="annot"
	><span class="annottext"
	  >d :: Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481531"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679481532"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481532"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481533"
      ><span class="annot"
	><span class="annottext"
	  >TyVarDecl TyName (Provenance a)
</span
	  ><a href="#local-6989586621679481533"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481534"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName (Provenance a)]
</span
	  ><a href="#local-6989586621679481534"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-367"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481535"
      ><span class="annot"
	><span class="annottext"
	  >Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481535"
	  ><span class="hs-identifier hs-var"
	    >pf</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; Provenance a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (Type TyName uni (Provenance a))
forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkPatternFunctorBody"
	><span class="hs-identifier hs-var"
	  >mkPatternFunctorBody</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481529"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481532"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481531"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-368"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="#local-6989586621679481530"
	><span class="hs-identifier hs-var"
	  >r</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-369"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#NonRec"
	><span class="hs-identifier hs-var"
	  >NonRec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; m (PLCRecType uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PLCRecType uni fun a -&gt; m (PLCRecType uni fun a))
-&gt; PLCRecType uni fun a -&gt; m (PLCRecType uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a) -&gt; PLCRecType uni fun a
forall (uni :: * -&gt; *) fun a. PLCType uni a -&gt; PLCRecType uni fun a
</span
	><a href="PlutusIR.Compiler.Types.html#PlainType"
	><span class="hs-identifier hs-var"
	  >PlainType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a) -&gt; PLCRecType uni fun a)
-&gt; Type TyName uni (Provenance a) -&gt; PLCRecType uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
-&gt; Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a)
forall tyname ann (uni :: * -&gt; *).
[TyVarDecl tyname ann]
-&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyLam"
	><span class="hs-identifier hs-var"
	  >PLC.mkIterTyLam</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481534"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481535"
	><span class="hs-identifier hs-var"
	  >pf</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-370"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- See Note [Recursive datatypes]</span
      ><span
      >
</span
      ><span id="line-371"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- We are reusing the same type name for the fixpoint variable. This is fine</span
      ><span
      >
</span
      ><span id="line-372"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- so long as we do renaming later, since we only reuse the name inside an inner binder</span
      ><span
      >
</span
      ><span id="line-373"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#Rec"
	><span class="hs-identifier hs-var"
	  >Rec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-374"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>RecursiveType uni fun (Provenance a) -&gt; PLCRecType uni fun a
forall (uni :: * -&gt; *) fun a.
RecursiveType uni fun (Provenance a) -&gt; PLCRecType uni fun a
</span
	><a href="PlutusIR.Compiler.Types.html#RecursiveType"
	><span class="hs-identifier hs-var"
	  >RecursiveType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(RecursiveType uni fun (Provenance a) -&gt; PLCRecType uni fun a)
-&gt; m (RecursiveType uni fun (Provenance a))
-&gt; m (PLCRecType uni fun a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Quote (RecursiveType uni fun (Provenance a))
-&gt; m (RecursiveType uni fun (Provenance a))
forall a. Quote a -&gt; m a
forall (m :: * -&gt; *) a. MonadQuote m =&gt; Quote a -&gt; m a
</span
	><a href="../../plutus-core/src/PlutusCore.Quote.html#liftQuote"
	><span class="hs-identifier hs-var"
	  >liftQuote</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Quote (RecursiveType uni fun (Provenance a))
 -&gt; m (RecursiveType uni fun (Provenance a)))
-&gt; Quote (RecursiveType uni fun (Provenance a))
-&gt; m (RecursiveType uni fun (Provenance a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>forall (uni :: * -&gt; *) ann fun.
FromDataPieces uni ann (RecursiveType uni fun ann)
</span
	><a href="../../plutus-core/src/PlutusCore.StdLib.Type.html#makeRecursiveType"
	><span class="hs-identifier hs-var"
	  >Types.makeRecursiveType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >@</span
      ><span class="annot"
      ><a href="#local-6989586621679481220"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
	><span class="hs-identifier hs-type"
	  >Provenance</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679481221"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481532"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a) -&gt; TyName
forall tyname ann. TyVarDecl tyname ann -&gt; tyname
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_tyVarDeclName"
	><span class="hs-identifier hs-var"
	  >_tyVarDeclName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
</span
	><a href="#local-6989586621679481533"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481534"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481535"
	><span class="hs-identifier hs-var"
	  >pf</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-375"
      ></span
      ><span
      >
</span
      ><span id="line-376"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The type of a datatype-value is of the form `[TyCon tyarg1 tyarg2 ... tyargn]`</span
	></span
      ><span
      >
</span
      ><span id="line-377"
      ></span
      ><span id="local-6989586621679481543"
      ><span id="local-6989586621679481544"
	><span class="annot"
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeValueType"
	    ><span class="hs-identifier hs-type"
	      >mkDatatypeValueType</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >::</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481543"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="PlutusIR.Core.Type.html#Datatype"
	    ><span class="hs-identifier hs-type"
	      >Datatype</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	    ><span class="hs-identifier hs-type"
	      >Name</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481544"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481543"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	    ><span class="hs-identifier hs-type"
	      >Type</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481544"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481543"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-378"
      ></span
      ><span id="mkDatatypeValueType"
      ><span class="annot"
	><span class="annottext"
	  >mkDatatypeValueType :: forall ann (uni :: * -&gt; *).
ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeValueType"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkDatatypeValueType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481546"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679481546"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481547"
      ><span class="annot"
	><span class="annottext"
	  >TyVarDecl TyName a
</span
	  ><a href="#local-6989586621679481547"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481548"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName a]
</span
	  ><a href="#local-6989586621679481548"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni a -&gt; [(a, Type TyName uni a)] -&gt; Type TyName uni a
forall tyname (uni :: * -&gt; *) ann.
Type tyname uni ann
-&gt; [(ann, Type tyname uni ann)] -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyApp"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyApp</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; TyVarDecl TyName a -&gt; Type TyName uni a
forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkTyVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkTyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481546"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName a
</span
	><a href="#local-6989586621679481547"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(a, Type TyName uni a)] -&gt; Type TyName uni a)
-&gt; [(a, Type TyName uni a)] -&gt; Type TyName uni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481546"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni a -&gt; (a, Type TyName uni a))
-&gt; (TyVarDecl TyName a -&gt; Type TyName uni a)
-&gt; TyVarDecl TyName a
-&gt; (a, Type TyName uni a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; TyVarDecl TyName a -&gt; Type TyName uni a
forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkTyVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkTyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481546"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(TyVarDecl TyName a -&gt; (a, Type TyName uni a))
-&gt; [TyVarDecl TyName a] -&gt; [(a, Type TyName uni a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName a]
</span
	><a href="#local-6989586621679481548"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-379"
      ></span
      ><span
      >
</span
      ><span id="line-380"
      ></span
      ><span class="hs-comment"
      >-- Constructors</span
      ><span
      >
</span
      ><span id="line-381"
      ></span
      ><span
      >
</span
      ><span id="line-382"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the type of a constructor of a 'Datatype'. This is not quite the same as the declared type because the declared type has the
type variables free.
@
    mkConstructorType List Cons = forall (a :: *) . a -&gt; List a -&gt; List a
@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-387"
      ></span
      ><span id="local-6989586621679481252"
      ><span id="local-6989586621679481253"
	><span class="annot"
	  ><a href="PlutusIR.Compiler.Datatype.html#mkConstructorType"
	    ><span class="hs-identifier hs-type"
	      >mkConstructorType</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >::</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="PlutusIR.Core.Type.html#Datatype"
	    ><span class="hs-identifier hs-type"
	      >Datatype</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	    ><span class="hs-identifier hs-type"
	      >Name</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481252"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-special"
	  >(</span
	  ><span class="annot"
	  ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
	    ><span class="hs-identifier hs-type"
	      >Provenance</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481253"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ><span class="hs-special"
	  >)</span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	    ><span class="hs-identifier hs-type"
	      >VarDecl</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	    ><span class="hs-identifier hs-type"
	      >TyName</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	    ><span class="hs-identifier hs-type"
	      >Name</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481252"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="hs-special"
	  >(</span
	  ><span class="annot"
	  ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
	    ><span class="hs-identifier hs-type"
	      >Provenance</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481253"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ><span class="hs-special"
	  >)</span
	  ><span
	  > </span
	  ><span class="hs-glyph"
	  >-&gt;</span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="PlutusIR.Compiler.Types.html#PIRType"
	    ><span class="hs-identifier hs-type"
	      >PIRType</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481252"
	    ><span class="hs-identifier hs-type"
	      >uni</span
	      ></a
	    ></span
	  ><span
	  > </span
	  ><span class="annot"
	  ><a href="#local-6989586621679481253"
	    ><span class="hs-identifier hs-type"
	      >a</span
	      ></a
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-388"
      ></span
      ><span class="hs-comment"
      >-- this type appears *inside* the scope of the abstraction for the datatype so we can just reference the name and</span
      ><span
      >
</span
      ><span id="line-389"
      ></span
      ><span class="hs-comment"
      >-- we don't need to do anything to the declared type</span
      ><span
      >
</span
      ><span id="line-390"
      ></span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-391"
      ></span
      ><span class="hs-comment"
      >-- FIXME (https://github.com/IntersectMBO/plutus-private/issues/1875): normalize constructors also here</span
      ><span
      >
</span
      ><span id="line-392"
      ></span
      ><span id="mkConstructorType"
      ><span class="annot"
	><span class="annottext"
	  >mkConstructorType :: forall (uni :: * -&gt; *) a.
Datatype TyName Name uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a) -&gt; PIRType uni a
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkConstructorType"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkConstructorType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481552"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName (Provenance a)]
</span
	  ><a href="#local-6989586621679481552"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span id="local-6989586621679481553"
      ><span class="annot"
	><span class="annottext"
	  >VarDecl TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481553"
	  ><span class="hs-identifier hs-var"
	    >constr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
-&gt; Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a)
forall tyname ann (uni :: * -&gt; *).
[TyVarDecl tyname ann]
-&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyForall"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyForall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481552"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a))
-&gt; Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_varDeclType"
	><span class="hs-identifier hs-var"
	  >_varDeclType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481553"
	><span class="hs-identifier hs-var"
	  >constr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-393"
      ></span
      ><span
      >
</span
      ><span id="line-394"
      ></span
      ><span class="hs-comment"
      >-- See Note [Encoding of datatypes]</span
      ><span
      >
</span
      ><span id="line-395"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make a constructor of a 'Datatype' with the given pattern functor. The constructor argument mostly serves to identify the constructor
that we are interested in in the list of constructors.

Scott:
@
    mkConstructor &lt;definition of List&gt; List Cons
        = /\(a :: *) . \(x : a) (xs : &lt;definition of List&gt; a) .
            wrap &lt;pattern functor of List&gt; /\(out_List :: *) .
                \(case_Nil : out_List) (case_Cons : a -&gt; List a -&gt; out_List) . case_Cons arg1 arg2
@

SOPs:
@
    mkConstructor &lt;definition of List&gt; List Cons
        = /\(a :: *) . \(x : a) (xs : &lt;definition of List&gt; a) .
            wrap &lt;pattern functor of List&gt;
                constr ((\(List :: * -&gt; *) . &lt;pattern functor of List&gt;) &lt;definition of List&gt;) arg1 arg2
@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-413"
      ></span
      ><span id="local-6989586621679481257"
      ><span id="local-6989586621679481258"
	><span id="local-6989586621679481259"
	  ><span id="local-6989586621679481260"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#mkConstructor"
		><span class="hs-identifier hs-type"
		  >mkConstructor</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
		><span class="hs-identifier hs-type"
		  >MonadQuote</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481257"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#DatatypeCompilationOpts"
		><span class="hs-identifier hs-type"
		  >DatatypeCompilationOpts</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PLCRecType"
		><span class="hs-identifier hs-type"
		  >PLCRecType</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481258"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481259"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481260"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481258"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481260"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Word.html#Word64"
		><span class="hs-identifier hs-type"
		  >Word64</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481257"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481258"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481259"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481260"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-414"
      ></span
      ><span id="mkConstructor"
      ><span class="annot"
	><span class="annottext"
	  >mkConstructor :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Word64
-&gt; m (PIRTerm uni fun a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkConstructor"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkConstructor</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481606"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481606"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481607"
      ><span class="annot"
	><span class="annottext"
	  >PLCRecType uni fun a
</span
	  ><a href="#local-6989586621679481607"
	  ><span class="hs-identifier hs-var"
	    >dty</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481608"
      ><span class="annot"
	><span class="annottext"
	  >d :: Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481608"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679481609"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481609"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481610"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName (Provenance a)]
</span
	  ><a href="#local-6989586621679481610"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481611"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481611"
	  ><span class="hs-identifier hs-var"
	    >constrs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span id="local-6989586621679481612"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621679481612"
	  ><span class="hs-identifier hs-var"
	    >index</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-415"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- This is inelegant, but it should never fail</span
      ><span
      >
</span
      ><span id="line-416"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481618"
      ><span class="annot"
	><span class="annottext"
	  >thisConstr :: VarDecl TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481618"
	  ><span class="hs-identifier hs-var hs-var"
	    >thisConstr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481611"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; Int -&gt; VarDecl TyName Name uni (Provenance a)
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#%21%21"
	><span class="hs-operator hs-var"
	  >!!</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621679481612"
	><span class="hs-identifier hs-var"
	  >index</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-417"
      ></span
      ><span
      >
</span
      ><span id="line-418"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- constructor args and their types</span
      ><span
      >
</span
      ><span id="line-419"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481620"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481620"
	  ><span class="hs-identifier hs-var"
	    >argsAndTypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-420"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- these types appear *outside* the scope of the abstraction for the datatype, so we need to use the concrete datatype here</span
      ><span
      >
</span
      ><span id="line-421"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-422"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- FIXME (https://github.com/IntersectMBO/plutus-private/issues/1875): normalize datacons' types also here</span
      ><span
      >
</span
      ><span id="line-423"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481624"
      ><span class="annot"
	><span class="annottext"
	  >argTypes :: [Type TyName uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481624"
	  ><span class="hs-identifier hs-var hs-var"
	    >argTypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) a name.
Eq tyname =&gt;
Type tyname uni a
-&gt; Datatype tyname name uni a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
	><span class="hs-identifier hs-var"
	  >unveilDatatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481607"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481608"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a))
-&gt; [Type TyName uni (Provenance a)]
-&gt; [Type TyName uni (Provenance a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
-&gt; [Type TyName uni (Provenance a)]
forall tyname name (uni :: * -&gt; *) a.
VarDecl tyname name uni a -&gt; [Type tyname uni a]
</span
	><a href="PlutusIR.Compiler.Datatype.html#constructorArgTypes"
	><span class="hs-identifier hs-var"
	  >constructorArgTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481618"
	><span class="hs-identifier hs-var"
	  >thisConstr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-424"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- we don't have any names for these things, we just had the type, so we call them &quot;arg_i</span
      ><span
      >
</span
      ><span id="line-425"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481626"
      ><span class="annot"
	><span class="annottext"
	  >[Name]
</span
	  ><a href="#local-6989586621679481626"
	  ><span class="hs-identifier hs-var"
	    >argNames</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; m Name) -&gt; m [Name]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Type TyName uni (Provenance a)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Type TyName uni (Provenance a)]
</span
	><a href="#local-6989586621679481624"
	><span class="hs-identifier hs-var"
	  >argTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679481629"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679481629"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; m Name
forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span
	><a href="PlutusIR.Compiler.Names.html#safeFreshName"
	><span class="hs-identifier hs-var"
	  >safeFreshName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; m Name) -&gt; Text -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;arg_&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span
	><a href="../../plutus-core/src/PlutusPrelude.html#showText"
	><span class="hs-identifier hs-var"
	  >showText</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679481629"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-426"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([VarDecl TyName Name uni (Provenance a)]
 -&gt; m [VarDecl TyName Name uni (Provenance a)])
-&gt; [VarDecl TyName Name uni (Provenance a)]
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Name
 -&gt; Type TyName uni (Provenance a)
 -&gt; VarDecl TyName Name uni (Provenance a))
-&gt; [Name]
-&gt; [Type TyName uni (Provenance a)]
-&gt; [VarDecl TyName Name uni (Provenance a)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zipWith"
	><span class="hs-identifier hs-var"
	  >zipWith</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-var"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Name]
</span
	><a href="#local-6989586621679481626"
	><span class="hs-identifier hs-var"
	  >argNames</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Type TyName uni (Provenance a)]
</span
	><a href="#local-6989586621679481624"
	><span class="hs-identifier hs-var"
	  >argTypes</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-427"
      ></span
      ><span
      >
</span
      ><span id="line-428"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481633"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481633"
	  ><span class="hs-identifier hs-var"
	    >constrBody</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts -&gt; DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#_dcoStyle"
	><span class="hs-identifier hs-var"
	  >_dcoStyle</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481606"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-429"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481634"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeStyle
</span
	  ><a href="#local-6989586621679481634"
	  ><span class="hs-identifier hs-var"
	    >style</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="#local-6989586621679481634"
	><span class="hs-identifier hs-var"
	  >style</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle -&gt; DatatypeStyle -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#SumsOfProducts"
	><span class="hs-identifier hs-var"
	  >SumsOfProducts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Bool -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%7C%7C"
	><span class="hs-operator hs-var"
	  >||</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="#local-6989586621679481634"
	><span class="hs-identifier hs-var"
	  >style</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle -&gt; DatatypeStyle -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#BuiltinCasing"
	><span class="hs-identifier hs-var"
	  >BuiltinCasing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-430"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- We have to be a bit careful annotating the type of the constr. It is inside the 'wrap' so it</span
      ><span
      >
</span
      ><span id="line-431"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- needs to be one level &quot;unrolled&quot;.</span
      ><span
      >
</span
      ><span id="line-432"
      ></span
      ><span
      >
</span
      ><span id="line-433"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- The pattern functor with a hole in it</span
      ><span
      >
</span
      ><span id="line-434"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679481636"
      ><span class="annot"
	><span class="annottext"
	  >Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481636"
	  ><span class="hs-identifier hs-var"
	    >pf</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; Provenance a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (Type TyName uni (Provenance a))
forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkPatternFunctorBody"
	><span class="hs-identifier hs-var"
	  >mkPatternFunctorBody</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481606"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481608"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-435"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- ... and with the hole filled in with the datatype type</span
      ><span
      >
</span
      ><span id="line-436"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481638"
      ><span class="annot"
	><span class="annottext"
	  >unrolled :: Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481638"
	  ><span class="hs-identifier hs-var hs-var"
	    >unrolled</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) a name.
Eq tyname =&gt;
Type tyname uni a
-&gt; Datatype tyname name uni a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
	><span class="hs-identifier hs-var"
	  >unveilDatatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481607"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481608"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481636"
	><span class="hs-identifier hs-var"
	  >pf</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-437"
      ></span
      ><span
      >
</span
      ><span id="line-438"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Type TyName uni (Provenance a)
-&gt; Word64
-&gt; [PIRTerm uni fun a]
-&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Type tyname uni a
-&gt; Word64
-&gt; [Term tyname name uni fun a]
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#Constr"
	><span class="hs-identifier hs-var"
	  >Constr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481638"
	><span class="hs-identifier hs-var"
	  >unrolled</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621679481612"
	><span class="hs-identifier hs-var"
	  >index</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a)
-&gt; [VarDecl TyName Name uni (Provenance a)] -&gt; [PIRTerm uni fun a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
VarDecl tyname name uni ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481620"
	><span class="hs-identifier hs-var"
	  >argsAndTypes</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-439"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481641"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeStyle
</span
	  ><a href="#local-6989586621679481641"
	  ><span class="hs-identifier hs-var"
	    >_ScottEncoding</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-440"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679481642"
      ><span class="annot"
	><span class="annottext"
	  >TyName
</span
	  ><a href="#local-6989586621679481642"
	  ><span class="hs-identifier hs-var"
	    >resultType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a) -&gt; m TyName
forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m TyName
</span
	><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	><span class="hs-identifier hs-var"
	  >resultTypeName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481608"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-441"
      ></span
      ><span
      >
</span
      ><span id="line-442"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- case arguments and their types</span
      ><span
      >
</span
      ><span id="line-443"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679481643"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481643"
	  ><span class="hs-identifier hs-var"
	    >casesAndTypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-444"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- these types appear *outside* the scope of the abstraction for the datatype, so we need to use the concrete datatype here</span
      ><span
      >
</span
      ><span id="line-445"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-446"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- FIXME (https://github.com/IntersectMBO/plutus-private/issues/1875): normalize datacons' types also here</span
      ><span
      >
</span
      ><span id="line-447"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481647"
      ><span class="annot"
	><span class="annottext"
	  >caseTypes :: [Type TyName uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481647"
	  ><span class="hs-identifier hs-var hs-var"
	    >caseTypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) a name.
Eq tyname =&gt;
Type tyname uni a
-&gt; Datatype tyname name uni a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
	><span class="hs-identifier hs-var"
	  >unveilDatatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481607"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481608"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a))
-&gt; [Type TyName uni (Provenance a)]
-&gt; [Type TyName uni (Provenance a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a)
 -&gt; Type TyName uni (Provenance a))
-&gt; [VarDecl TyName Name uni (Provenance a)]
-&gt; [Type TyName uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall a tyname (uni :: * -&gt; *) name.
a
-&gt; Type tyname uni a
-&gt; VarDecl tyname name uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#constructorCaseType"
	><span class="hs-identifier hs-var"
	  >constructorCaseType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; TyName -&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVar"
	><span class="hs-identifier hs-var"
	  >TyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481642"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481611"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-448"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679481648"
      ><span class="annot"
	><span class="annottext"
	  >[Name]
</span
	  ><a href="#local-6989586621679481648"
	  ><span class="hs-identifier hs-var"
	    >caseArgNames</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; (VarDecl TyName Name uni (Provenance a) -&gt; m Name) -&gt; m [Name]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481611"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679481649"
      ><span class="annot"
	><span class="annottext"
	  >VarDecl TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481649"
	  ><span class="hs-identifier hs-var"
	    >c</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; m Name
forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span
	><a href="PlutusIR.Compiler.Names.html#safeFreshName"
	><span class="hs-identifier hs-var"
	  >safeFreshName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; m Name) -&gt; Text -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;case_&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >T.pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; String
forall tyname (uni :: * -&gt; *) a.
VarDecl tyname Name uni a -&gt; String
</span
	><a href="PlutusIR.Core.Type.html#varDeclNameString"
	><span class="hs-identifier hs-var"
	  >varDeclNameString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481649"
	><span class="hs-identifier hs-var"
	  >c</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-449"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([VarDecl TyName Name uni (Provenance a)]
 -&gt; m [VarDecl TyName Name uni (Provenance a)])
-&gt; [VarDecl TyName Name uni (Provenance a)]
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Name
 -&gt; Type TyName uni (Provenance a)
 -&gt; VarDecl TyName Name uni (Provenance a))
-&gt; [Name]
-&gt; [Type TyName uni (Provenance a)]
-&gt; [VarDecl TyName Name uni (Provenance a)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zipWith"
	><span class="hs-identifier hs-var"
	  >zipWith</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-var"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Name]
</span
	><a href="#local-6989586621679481648"
	><span class="hs-identifier hs-var"
	  >caseArgNames</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Type TyName uni (Provenance a)]
</span
	><a href="#local-6989586621679481647"
	><span class="hs-identifier hs-var"
	  >caseTypes</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-450"
      ></span
      ><span
      >
</span
      ><span id="line-451"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- This is inelegant, but it should never fail</span
      ><span
      >
</span
      ><span id="line-452"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481657"
      ><span class="annot"
	><span class="annottext"
	  >thisCase :: PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481657"
	  ><span class="hs-identifier hs-var hs-var"
	    >thisCase</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
VarDecl tyname name uni ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a)
-&gt; VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481643"
	><span class="hs-identifier hs-var"
	  >casesAndTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; Int -&gt; VarDecl TyName Name uni (Provenance a)
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#%21%21"
	><span class="hs-operator hs-var"
	  >!!</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621679481612"
	><span class="hs-identifier hs-var"
	  >index</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-453"
      ></span
      ><span
      >
</span
      ><span id="line-454"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-455"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- forall out</span
      ><span
      >
</span
      ><span id="line-456"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; TyName
-&gt; Kind (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; tyname
-&gt; Kind a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#TyAbs"
	><span class="hs-identifier hs-var"
	  >TyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481642"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; Kind (Provenance a)
forall ann. ann -&gt; Kind ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	><span class="hs-identifier hs-var"
	  >Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-457"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- \case_1 .. case_j</span
      ><span
      >
</span
      ><span id="line-458"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[VarDecl tyname name uni ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterLamAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterLamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481643"
	><span class="hs-identifier hs-var"
	  >casesAndTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-459"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- c_i arg_1 .. arg_m</span
      ><span
      >
</span
      ><span id="line-460"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
-&gt; [(Provenance a, PIRTerm uni fun a)] -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
term ann -&gt; [(ann, term ann)] -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterApp"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterApp</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481657"
	><span class="hs-identifier hs-var"
	  >thisCase</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a)
 -&gt; (Provenance a, PIRTerm uni fun a))
-&gt; [VarDecl TyName Name uni (Provenance a)]
-&gt; [(Provenance a, PIRTerm uni fun a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; (Provenance a, PIRTerm uni fun a))
-&gt; (VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a)
-&gt; VarDecl TyName Name uni (Provenance a)
-&gt; (Provenance a, PIRTerm uni fun a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
VarDecl tyname name uni ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkVar</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481620"
	><span class="hs-identifier hs-var"
	  >argsAndTypes</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-461"
      ></span
      ><span
      >
</span
      ><span id="line-462"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481664"
      ><span class="annot"
	><span class="annottext"
	  >constr :: PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481664"
	  ><span class="hs-identifier hs-var hs-var"
	    >constr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-463"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- /\t_1 .. t_n</span
      ><span
      >
</span
      ><span id="line-464"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[TyVarDecl tyname ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481610"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-465"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- \arg_1 .. arg_m</span
      ><span
      >
</span
      ><span id="line-466"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[VarDecl tyname name uni ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterLamAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterLamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481620"
	><span class="hs-identifier hs-var"
	  >argsAndTypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-467"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- See Note [Recursive datatypes]</span
      ><span
      >
</span
      ><span id="line-468"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- wrap</span
      ><span
      >
</span
      ><span id="line-469"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; PLCRecType uni fun a
-&gt; [Type TyName uni (Provenance a)]
-&gt; PIRTerm uni fun a
-&gt; PIRTerm uni fun a
forall a (uni :: * -&gt; *) fun.
Provenance a
-&gt; PLCRecType uni fun a
-&gt; [PLCType uni a]
-&gt; PIRTerm uni fun a
-&gt; PIRTerm uni fun a
</span
	><a href="PlutusIR.Compiler.Types.html#wrap"
	><span class="hs-identifier hs-var"
	  >wrap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481607"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(TyVarDecl TyName (Provenance a) -&gt; Type TyName uni (Provenance a))
-&gt; [TyVarDecl TyName (Provenance a)]
-&gt; [Type TyName uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; TyVarDecl TyName (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkTyVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkTyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481609"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481610"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481633"
	><span class="hs-identifier hs-var"
	  >constrBody</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-470"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Provenance a -&gt; Provenance a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b.
(a -&gt; b)
-&gt; Term TyName Name uni fun a -&gt; Term TyName Name uni fun b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679481667"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481667"
	  ><span class="hs-identifier hs-var"
	    >a</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#Constructor"
	><span class="hs-identifier hs-var"
	  >Constructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481667"
	><span class="hs-identifier hs-var"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481664"
	><span class="hs-identifier hs-var"
	  >constr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-471"
      ></span
      ><span
      >
</span
      ><span id="line-472"
      ></span
      ><span class="hs-comment"
      >-- Destructors</span
      ><span
      >
</span
      ><span id="line-473"
      ></span
      ><span
      >
</span
      ><span id="line-474"
      ></span
      ><span class="hs-comment"
      >-- See Note [Encoding of datatypes]</span
      ><span
      >
</span
      ><span id="line-475"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the destructor for a 'Datatype'.

Scott:
@
    mkDestructor &lt;definition of List&gt; List
       = /\(a :: *) -&gt; \(x : (&lt;definition of List&gt; a)) -&gt; unwrap x
@

SOPs:
@
    mkDestructor &lt;definition of List&gt; List
       = /\(a :: *) -&gt; \(x : (&lt;definition of List&gt; a)) -&gt;
         /\(r :: *) -&gt;
         \(case_Nil :: r) (case_Cons :: a -&gt; (&lt;definition of List&gt; a) -&gt; r) -&gt; case r (unwrap x) case_Nil case_Cons
@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-490"
      ></span
      ><span id="local-6989586621679481336"
      ><span id="local-6989586621679481337"
	><span id="local-6989586621679481338"
	  ><span id="local-6989586621679481339"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#mkDestructor"
		><span class="hs-identifier hs-type"
		  >mkDestructor</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
		><span class="hs-identifier hs-type"
		  >MonadQuote</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481336"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#DatatypeCompilationOpts"
		><span class="hs-identifier hs-type"
		  >DatatypeCompilationOpts</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PLCRecType"
		><span class="hs-identifier hs-type"
		  >PLCRecType</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481337"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481338"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481339"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481337"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481339"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481336"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481337"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481338"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481339"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-491"
      ></span
      ><span id="mkDestructor"
      ><span class="annot"
	><span class="annottext"
	  >mkDestructor :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDestructor"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkDestructor</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481697"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481697"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481698"
      ><span class="annot"
	><span class="annottext"
	  >PLCRecType uni fun a
</span
	  ><a href="#local-6989586621679481698"
	  ><span class="hs-identifier hs-var"
	    >dty</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481699"
      ><span class="annot"
	><span class="annottext"
	  >d :: Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481699"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679481700"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481700"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481701"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName (Provenance a)]
</span
	  ><a href="#local-6989586621679481701"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481702"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481702"
	  ><span class="hs-identifier hs-var"
	    >constrs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-492"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- This term appears *outside* the scope of the abstraction for the datatype, so we need to put in the Scott-encoded type here</span
      ><span
      >
</span
      ><span id="line-493"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-494"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- dty t_1 .. t_n</span
      ><span
      >
</span
      ><span id="line-495"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481704"
      ><span class="annot"
	><span class="annottext"
	  >appliedReal :: Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481704"
	  ><span class="hs-identifier hs-var hs-var"
	    >appliedReal</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
-&gt; [(Provenance a, Type TyName uni (Provenance a))]
-&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) ann.
Type tyname uni ann
-&gt; [(ann, Type tyname uni ann)] -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyApp"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyApp</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481698"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(TyVarDecl TyName (Provenance a)
 -&gt; (Provenance a, Type TyName uni (Provenance a)))
-&gt; [TyVarDecl TyName (Provenance a)]
-&gt; [(Provenance a, Type TyName uni (Provenance a))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a)
 -&gt; (Provenance a, Type TyName uni (Provenance a)))
-&gt; (TyVarDecl TyName (Provenance a)
    -&gt; Type TyName uni (Provenance a))
-&gt; TyVarDecl TyName (Provenance a)
-&gt; (Provenance a, Type TyName uni (Provenance a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; TyVarDecl TyName (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkTyVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkTyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481701"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-496"
      ></span
      ><span
      >
</span
      ><span id="line-497"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481705"
      ><span class="annot"
	><span class="annottext"
	  >Name
</span
	  ><a href="#local-6989586621679481705"
	  ><span class="hs-identifier hs-var"
	    >xn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; m Name
forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span
	><a href="PlutusIR.Compiler.Names.html#safeFreshName"
	><span class="hs-identifier hs-var"
	  >safeFreshName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;x&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-498"
      ></span
      ><span
      >
</span
      ><span id="line-499"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481706"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481706"
	  ><span class="hs-identifier hs-var"
	    >destrBody</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts -&gt; DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#_dcoStyle"
	><span class="hs-identifier hs-var"
	  >_dcoStyle</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481697"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-500"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481707"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeStyle
</span
	  ><a href="#local-6989586621679481707"
	  ><span class="hs-identifier hs-var"
	    >style</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="#local-6989586621679481707"
	><span class="hs-identifier hs-var"
	  >style</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle -&gt; DatatypeStyle -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#SumsOfProducts"
	><span class="hs-identifier hs-var"
	  >SumsOfProducts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Bool -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%7C%7C"
	><span class="hs-operator hs-var"
	  >||</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="#local-6989586621679481707"
	><span class="hs-identifier hs-var"
	  >style</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle -&gt; DatatypeStyle -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeStyle
</span
	><a href="PlutusIR.Compiler.Types.html#BuiltinCasing"
	><span class="hs-identifier hs-var"
	  >BuiltinCasing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-501"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679481708"
      ><span class="annot"
	><span class="annottext"
	  >TyName
</span
	  ><a href="#local-6989586621679481708"
	  ><span class="hs-identifier hs-var"
	    >resultType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a) -&gt; m TyName
forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m TyName
</span
	><a href="PlutusIR.Compiler.Datatype.html#resultTypeName"
	><span class="hs-identifier hs-var"
	  >resultTypeName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481699"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-502"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- Variables for case arguments, and the bodies to be used as the actual cases</span
      ><span
      >
</span
      ><span id="line-503"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679481709"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481709"
	  ><span class="hs-identifier hs-var"
	    >caseVars</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; (VarDecl TyName Name uni (Provenance a)
    -&gt; m (VarDecl TyName Name uni (Provenance a)))
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481702"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((VarDecl TyName Name uni (Provenance a)
  -&gt; m (VarDecl TyName Name uni (Provenance a)))
 -&gt; m [VarDecl TyName Name uni (Provenance a)])
-&gt; (VarDecl TyName Name uni (Provenance a)
    -&gt; m (VarDecl TyName Name uni (Provenance a)))
-&gt; m [VarDecl TyName Name uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679481710"
      ><span class="annot"
	><span class="annottext"
	  >VarDecl TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481710"
	  ><span class="hs-identifier hs-var"
	    >c</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-504"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- these types appear *outside* the scope of the abstraction for the datatype, so we need to use the concrete datatype here</span
      ><span
      >
</span
      ><span id="line-505"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-506"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- FIXME (https://github.com/IntersectMBO/plutus-private/issues/1875): normalize datacons' types also here</span
      ><span
      >
</span
      ><span id="line-507"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481711"
      ><span class="annot"
	><span class="annottext"
	  >caseType :: Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481711"
	  ><span class="hs-identifier hs-var hs-var"
	    >caseType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall a tyname (uni :: * -&gt; *) name.
a
-&gt; Type tyname uni a
-&gt; VarDecl tyname name uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#constructorCaseType"
	><span class="hs-identifier hs-var"
	  >constructorCaseType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; TyName -&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVar"
	><span class="hs-identifier hs-var"
	  >TyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481708"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481710"
	><span class="hs-identifier hs-var"
	  >c</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-508"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679481713"
      ><span class="annot"
	><span class="annottext"
	  >unveiledCaseType :: Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481713"
	  ><span class="hs-identifier hs-var hs-var"
	    >unveiledCaseType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) a name.
Eq tyname =&gt;
Type tyname uni a
-&gt; Datatype tyname name uni a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#unveilDatatype"
	><span class="hs-identifier hs-var"
	  >unveilDatatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481698"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481699"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481711"
	><span class="hs-identifier hs-var"
	  >caseType</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-509"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679481714"
      ><span class="annot"
	><span class="annottext"
	  >Name
</span
	  ><a href="#local-6989586621679481714"
	  ><span class="hs-identifier hs-var"
	    >caseArgName</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; m Name
forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span
	><a href="PlutusIR.Compiler.Names.html#safeFreshName"
	><span class="hs-identifier hs-var"
	  >safeFreshName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Text -&gt; m Name) -&gt; Text -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;case_&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; Text
</span
	><a href="https://hackage.haskell.org/package/text-2.0.2/docs/src/Data.Text.Internal.html#pack"
	><span class="hs-identifier hs-var"
	  >T.pack</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; String
forall tyname (uni :: * -&gt; *) a.
VarDecl tyname Name uni a -&gt; String
</span
	><a href="PlutusIR.Core.Type.html#varDeclNameString"
	><span class="hs-identifier hs-var"
	  >varDeclNameString</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481710"
	><span class="hs-identifier hs-var"
	  >c</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-510"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
-&gt; m (VarDecl TyName Name uni (Provenance a))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a)
 -&gt; m (VarDecl TyName Name uni (Provenance a)))
-&gt; VarDecl TyName Name uni (Provenance a)
-&gt; m (VarDecl TyName Name uni (Provenance a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-var"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621679481714"
	><span class="hs-identifier hs-var"
	  >caseArgName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481713"
	><span class="hs-identifier hs-var"
	  >unveiledCaseType</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-511"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-512"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- forall out</span
      ><span
      >
</span
      ><span id="line-513"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; TyName
-&gt; Kind (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; tyname
-&gt; Kind a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#TyAbs"
	><span class="hs-identifier hs-var"
	  >TyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481708"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; Kind (Provenance a)
forall ann. ann -&gt; Kind ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	><span class="hs-identifier hs-var"
	  >Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-514"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- \case_1 .. case_j</span
      ><span
      >
</span
      ><span id="line-515"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[VarDecl tyname name uni ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterLamAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterLamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481709"
	><span class="hs-identifier hs-var"
	  >caseVars</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-516"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- See Note [Recursive datatypes]</span
      ><span
      >
</span
      ><span id="line-517"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- case (unwrap x) case_1 .. case_j</span
      ><span
      >
</span
      ><span id="line-518"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Type TyName uni (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; [PIRTerm uni fun a]
-&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; [Term tyname name uni fun a]
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#Case"
	><span class="hs-identifier hs-var"
	  >Case</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; TyName -&gt; Type TyName uni (Provenance a)
forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVar"
	><span class="hs-identifier hs-var"
	  >TyVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyName
</span
	><a href="#local-6989586621679481708"
	><span class="hs-identifier hs-var"
	  >resultType</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; PLCRecType uni fun a -&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a (uni :: * -&gt; *) fun.
Provenance a
-&gt; PLCRecType uni fun a -&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
</span
	><a href="PlutusIR.Compiler.Types.html#unwrap"
	><span class="hs-identifier hs-var"
	  >unwrap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481698"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; Name -&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#Var"
	><span class="hs-identifier hs-var"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621679481705"
	><span class="hs-identifier hs-var"
	  >xn</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a)
-&gt; [VarDecl TyName Name uni (Provenance a)] -&gt; [PIRTerm uni fun a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
VarDecl tyname name uni ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkVar"
	><span class="hs-identifier hs-var"
	  >PIR.mkVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481709"
	><span class="hs-identifier hs-var"
	  >caseVars</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-519"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481718"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeStyle
</span
	  ><a href="#local-6989586621679481718"
	  ><span class="hs-identifier hs-var"
	    >_ScottEncoding</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-520"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-521"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- See Note [Recursive datatypes]</span
      ><span
      >
</span
      ><span id="line-522"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- unwrap</span
      ><span
      >
</span
      ><span id="line-523"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; PLCRecType uni fun a -&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a (uni :: * -&gt; *) fun.
Provenance a
-&gt; PLCRecType uni fun a -&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
</span
	><a href="PlutusIR.Compiler.Types.html#unwrap"
	><span class="hs-identifier hs-var"
	  >unwrap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a
</span
	><a href="#local-6989586621679481698"
	><span class="hs-identifier hs-var"
	  >dty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-524"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; Name -&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#Var"
	><span class="hs-identifier hs-var"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621679481705"
	><span class="hs-identifier hs-var"
	  >xn</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-525"
      ></span
      ><span
      >
</span
      ><span id="line-526"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481720"
      ><span class="annot"
	><span class="annottext"
	  >destr :: PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481720"
	  ><span class="hs-identifier hs-var hs-var"
	    >destr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-527"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- /\t_1 .. t_n</span
      ><span
      >
</span
      ><span id="line-528"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[TyVarDecl tyname ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481701"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; PIRTerm uni fun a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-529"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- \x</span
      ><span
      >
</span
      ><span id="line-530"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; PIRTerm uni fun a
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; name
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-var"
	  >LamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481700"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621679481705"
	><span class="hs-identifier hs-var"
	  >xn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481704"
	><span class="hs-identifier hs-var"
	  >appliedReal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481706"
	><span class="hs-identifier hs-var"
	  >destrBody</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-531"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#Destructor"
	><span class="hs-identifier hs-var"
	  >Destructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Provenance a -&gt; Provenance a)
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481720"
	><span class="hs-identifier hs-var"
	  >destr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-532"
      ></span
      ><span
      >
</span
      ><span id="line-533"
      ></span
      ><span class="hs-comment"
      >-- See Note [Encoding of datatypes]</span
      ><span
      >
</span
      ><span id="line-534"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Make the type of a destructor for a 'Datatype'.
@
    mkDestructorTy List
        = forall (a :: *) . List a -&gt; forall (out_List :: *) . (out_List -&gt; (a -&gt; List a -&gt; out_List) -&gt; out_List)
@ -}</span
	></span
      ><span
      >
</span
      ><span id="line-539"
      ></span
      ><span id="local-6989586621679481347"
      ><span id="local-6989586621679481348"
	><span id="local-6989586621679481349"
	  ><span class="annot"
	    ><a href="PlutusIR.Compiler.Datatype.html#mkDestructorTy"
	      ><span class="hs-identifier hs-type"
		>mkDestructorTy</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >::</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
	      ><span class="hs-identifier hs-type"
		>MonadQuote</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481347"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >=&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="PlutusIR.Core.Type.html#Datatype"
	      ><span class="hs-identifier hs-type"
		>Datatype</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	      ><span class="hs-identifier hs-type"
		>Name</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481348"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481349"
	      ><span class="hs-identifier hs-type"
		>a</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-glyph"
	    >-&gt;</span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481347"
	      ><span class="hs-identifier hs-type"
		>m</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="hs-special"
	    >(</span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	      ><span class="hs-identifier hs-type"
		>Type</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	      ><span class="hs-identifier hs-type"
		>TyName</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481348"
	      ><span class="hs-identifier hs-type"
		>uni</span
		></a
	      ></span
	    ><span
	    > </span
	    ><span class="annot"
	    ><a href="#local-6989586621679481349"
	      ><span class="hs-identifier hs-type"
		>a</span
		></a
	      ></span
	    ><span class="hs-special"
	    >)</span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-540"
      ></span
      ><span id="mkDestructorTy"
      ><span class="annot"
	><span class="annottext"
	  >mkDestructorTy :: forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m (Type TyName uni a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#mkDestructorTy"
	  ><span class="hs-identifier hs-var hs-var"
	    >mkDestructorTy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481729"
      ><span class="annot"
	><span class="annottext"
	  >dt :: Datatype TyName Name uni a
</span
	  ><a href="#local-6989586621679481729"
	  ><span class="hs-identifier hs-var"
	    >dt</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679481730"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679481730"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481731"
      ><span class="annot"
	><span class="annottext"
	  >[TyVarDecl TyName a]
</span
	  ><a href="#local-6989586621679481731"
	  ><span class="hs-identifier hs-var"
	    >tvs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-541"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- The scott type is exactly the eliminator type, which is what we want here regardless of the compilation style</span
      ><span
      >
</span
      ><span id="line-542"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481732"
      ><span class="annot"
	><span class="annottext"
	  >Type TyName uni a
</span
	  ><a href="#local-6989586621679481732"
	  ><span class="hs-identifier hs-var"
	    >st</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; Datatype TyName Name uni a -&gt; m (Type TyName uni a)
forall (m :: * -&gt; *) ann (uni :: * -&gt; *).
MonadQuote m =&gt;
ann -&gt; Datatype TyName Name uni ann -&gt; m (Type TyName uni ann)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkScottTy"
	><span class="hs-identifier hs-var"
	  >mkScottTy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481730"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni a
</span
	><a href="#local-6989586621679481729"
	><span class="hs-identifier hs-var"
	  >dt</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-543"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- these types appear *inside* the scope of the abstraction for the datatype, so we can just directly use</span
      ><span
      >
</span
      ><span id="line-544"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- references to the name</span
      ><span
      >
</span
      ><span id="line-545"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- see Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-546"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- t t_1 .. t_n</span
      ><span
      >
</span
      ><span id="line-547"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481733"
      ><span class="annot"
	><span class="annottext"
	  >valueType :: Type TyName uni a
</span
	  ><a href="#local-6989586621679481733"
	  ><span class="hs-identifier hs-var hs-var"
	    >valueType</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; Datatype TyName Name uni a -&gt; Type TyName uni a
forall ann (uni :: * -&gt; *).
ann -&gt; Datatype TyName Name uni ann -&gt; Type TyName uni ann
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeValueType"
	><span class="hs-identifier hs-var"
	  >mkDatatypeValueType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481730"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni a
</span
	><a href="#local-6989586621679481729"
	><span class="hs-identifier hs-var"
	  >dt</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-548"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- forall t_1 .. t_n</span
      ><span
      >
</span
      ><span id="line-549"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni a -&gt; m (Type TyName uni a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni a -&gt; m (Type TyName uni a))
-&gt; Type TyName uni a -&gt; m (Type TyName uni a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName a] -&gt; Type TyName uni a -&gt; Type TyName uni a
forall tyname ann (uni :: * -&gt; *).
[TyVarDecl tyname ann]
-&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyForall"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyForall</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName a]
</span
	><a href="#local-6989586621679481731"
	><span class="hs-identifier hs-var"
	  >tvs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni a -&gt; Type TyName uni a)
-&gt; Type TyName uni a -&gt; Type TyName uni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; Type TyName uni a -&gt; Type TyName uni a -&gt; Type TyName uni a
forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyFun"
	><span class="hs-identifier hs-var"
	  >TyFun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679481730"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni a
</span
	><a href="#local-6989586621679481733"
	><span class="hs-identifier hs-var"
	  >valueType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni a
</span
	><a href="#local-6989586621679481732"
	><span class="hs-identifier hs-var"
	  >st</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-550"
      ></span
      ><span
      >
</span
      ><span id="line-551"
      ></span
      ><span class="hs-comment"
      >-- The main function</span
      ><span
      >
</span
      ><span id="line-552"
      ></span
      ><span
      >
</span
      ><span id="line-553"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Compile a 'Datatype' bound with the given body.</span
	></span
      ><span
      >
</span
      ><span id="line-554"
      ></span
      ><span id="local-6989586621679481353"
      ><span id="local-6989586621679481354"
	><span id="local-6989586621679481355"
	  ><span id="local-6989586621679481356"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#compileDatatype"
		><span class="hs-identifier hs-type"
		  >compileDatatype</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-555"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#Compiling"
		><span class="hs-identifier hs-type"
		  >Compiling</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481353"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481354"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481355"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481356"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-556"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Recursivity"
		><span class="hs-identifier hs-type"
		  >Recursivity</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-557"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481354"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481355"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481356"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-558"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481354"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481356"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-559"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481353"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481354"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481355"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481356"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-560"
      ></span
      ><span id="compileDatatype"
      ><span class="annot"
	><span class="annottext"
	  >compileDatatype :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
Compiling m uni fun a =&gt;
Recursivity
-&gt; PIRTerm uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#compileDatatype"
	  ><span class="hs-identifier hs-var hs-var"
	    >compileDatatype</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481756"
      ><span class="annot"
	><span class="annottext"
	  >Recursivity
</span
	  ><a href="#local-6989586621679481756"
	  ><span class="hs-identifier hs-var"
	    >r</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481757"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481757"
	  ><span class="hs-identifier hs-var"
	    >body</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481758"
      ><span class="annot"
	><span class="annottext"
	  >Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481758"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-561"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481759"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481759"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting
  DatatypeCompilationOpts
  (CompilationCtx uni fun a)
  DatatypeCompilationOpts
-&gt; m DatatypeCompilationOpts
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span
	><span class="hs-identifier hs-var"
	>view</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(CompilationOpts a
 -&gt; Const DatatypeCompilationOpts (CompilationOpts a))
-&gt; CompilationCtx uni fun a
-&gt; Const DatatypeCompilationOpts (CompilationCtx uni fun a)
forall (uni :: * -&gt; *) fun a (f :: * -&gt; *).
Functor f =&gt;
(CompilationOpts a -&gt; f (CompilationOpts a))
-&gt; CompilationCtx uni fun a -&gt; f (CompilationCtx uni fun a)
</span
	><a href="PlutusIR.Compiler.Types.html#ccOpts"
	><span class="hs-identifier hs-var"
	  >ccOpts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((CompilationOpts a
  -&gt; Const DatatypeCompilationOpts (CompilationOpts a))
 -&gt; CompilationCtx uni fun a
 -&gt; Const DatatypeCompilationOpts (CompilationCtx uni fun a))
-&gt; ((DatatypeCompilationOpts
     -&gt; Const DatatypeCompilationOpts DatatypeCompilationOpts)
    -&gt; CompilationOpts a
    -&gt; Const DatatypeCompilationOpts (CompilationOpts a))
-&gt; Getting
     DatatypeCompilationOpts
     (CompilationCtx uni fun a)
     DatatypeCompilationOpts
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(DatatypeCompilationOpts
 -&gt; Const DatatypeCompilationOpts DatatypeCompilationOpts)
-&gt; CompilationOpts a
-&gt; Const DatatypeCompilationOpts (CompilationOpts a)
forall a (f :: * -&gt; *).
Functor f =&gt;
(DatatypeCompilationOpts -&gt; f DatatypeCompilationOpts)
-&gt; CompilationOpts a -&gt; f (CompilationOpts a)
</span
	><a href="PlutusIR.Compiler.Types.html#coDatatypes"
	><span class="hs-identifier hs-var"
	  >coDatatypes</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-562"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481763"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481763"
	  ><span class="hs-identifier hs-var"
	    >p</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>m (Provenance a)
forall (uni :: * -&gt; *) fun a (m :: * -&gt; *).
MonadReader (CompilationCtx uni fun a) m =&gt;
m (Provenance a)
</span
	><a href="PlutusIR.Compiler.Types.html#getEnclosing"
	><span class="hs-identifier hs-var"
	  >getEnclosing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-563"
      ></span
      ><span
      >
</span
      ><span id="line-564"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679481765"
      ><span class="annot"
	><span class="annottext"
	  >Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	  ><a href="#local-6989586621679481765"
	  ><span class="hs-identifier hs-var"
	    >concreteTyDef</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679481766"
      ><span class="annot"
	><span class="annottext"
	  >[Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
</span
	  ><a href="#local-6989586621679481766"
	  ><span class="hs-identifier hs-var"
	    >constrDefs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679481767"
      ><span class="annot"
	><span class="annottext"
	  >Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
</span
	  ><a href="#local-6989586621679481767"
	  ><span class="hs-identifier hs-var"
	    >destrDef</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a),
      [Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)],
      Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall (m :: * -&gt; *) (uni :: * -&gt; *) a fun.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a),
      [Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)],
      Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
</span
	><a href="PlutusIR.Compiler.Datatype.html#compileDatatypeDefs"
	><span class="hs-identifier hs-var"
	  >compileDatatypeDefs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481759"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="#local-6989586621679481756"
	><span class="hs-identifier hs-var"
	  >r</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481758"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-565"
      ></span
      ><span
      >
</span
      ><span id="line-566"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      >
</span
      ><span id="line-567"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481768"
      ><span class="annot"
	><span class="annottext"
	  >tyVars :: [TyVarDecl TyName (Provenance a)]
</span
	  ><a href="#local-6989586621679481768"
	  ><span class="hs-identifier hs-var hs-var"
	    >tyVars</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
-&gt; TyVarDecl TyName (Provenance a)
forall var val. Def var val -&gt; var
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVar"
	><span class="hs-identifier hs-var"
	  >PIR.defVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	><a href="#local-6989586621679481765"
	><span class="hs-identifier hs-var"
	  >concreteTyDef</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-568"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481770"
      ><span class="annot"
	><span class="annottext"
	  >tys :: [PLCType uni a]
</span
	  ><a href="#local-6989586621679481770"
	  ><span class="hs-identifier hs-var hs-var"
	    >tys</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>PLCRecType uni fun a -&gt; PLCType uni a
forall (uni :: * -&gt; *) fun a. PLCRecType uni fun a -&gt; PLCType uni a
</span
	><a href="PlutusIR.Compiler.Types.html#getType"
	><span class="hs-identifier hs-var"
	  >getType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PLCRecType uni fun a -&gt; PLCType uni a)
-&gt; PLCRecType uni fun a -&gt; PLCType uni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
-&gt; PLCRecType uni fun a
forall var val. Def var val -&gt; val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVal"
	><span class="hs-identifier hs-var"
	  >PIR.defVal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	><a href="#local-6989586621679481765"
	><span class="hs-identifier hs-var"
	  >concreteTyDef</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-569"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481773"
      ><span class="annot"
	><span class="annottext"
	  >vars :: [VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481773"
	  ><span class="hs-identifier hs-var hs-var"
	    >vars</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
 -&gt; VarDecl TyName Name uni (Provenance a))
-&gt; [Def
      (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
-&gt; [VarDecl TyName Name uni (Provenance a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall var val. Def var val -&gt; var
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVar"
	><span class="hs-identifier hs-var"
	  >PIR.defVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
</span
	><a href="#local-6989586621679481766"
	><span class="hs-identifier hs-var"
	  >constrDefs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; [VarDecl TyName Name uni (Provenance a)]
-&gt; [VarDecl TyName Name uni (Provenance a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall var val. Def var val -&gt; var
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVar"
	><span class="hs-identifier hs-var"
	  >PIR.defVar</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
</span
	><a href="#local-6989586621679481767"
	><span class="hs-identifier hs-var"
	  >destrDef</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-570"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481775"
      ><span class="annot"
	><span class="annottext"
	  >vals :: [PIRTerm uni fun a]
</span
	  ><a href="#local-6989586621679481775"
	  ><span class="hs-identifier hs-var hs-var"
	    >vals</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
 -&gt; PIRTerm uni fun a)
-&gt; [Def
      (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
-&gt; [PIRTerm uni fun a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; PIRTerm uni fun a
forall var val. Def var val -&gt; val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVal"
	><span class="hs-identifier hs-var"
	  >PIR.defVal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
</span
	><a href="#local-6989586621679481766"
	><span class="hs-identifier hs-var"
	  >constrDefs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[PIRTerm uni fun a] -&gt; [PIRTerm uni fun a] -&gt; [PIRTerm uni fun a]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; PIRTerm uni fun a
forall var val. Def var val -&gt; val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVal"
	><span class="hs-identifier hs-var"
	  >PIR.defVal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
</span
	><a href="#local-6989586621679481767"
	><span class="hs-identifier hs-var"
	  >destrDef</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-571"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- See Note [Abstract data types]</span
      ><span
      >
</span
      ><span id="line-572"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; m (PIRTerm uni fun a))
-&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-573"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
-&gt; [(Provenance a, PIRTerm uni fun a)] -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
term ann -&gt; [(ann, term ann)] -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterApp"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterApp</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-574"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
-&gt; [(Provenance a, PLCType uni a)] -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
term ann -&gt; [(ann, Type tyname uni ann)] -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterInst"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterInst</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[TyVarDecl tyname ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterTyAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterTyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><a href="#local-6989586621679481768"
	><span class="hs-identifier hs-var"
	  >tyVars</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; PIRTerm uni fun a -&gt; PIRTerm uni fun a
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
[VarDecl tyname name uni ann] -&gt; term ann -&gt; term ann
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#mkIterLamAbs"
	><span class="hs-identifier hs-var"
	  >PIR.mkIterLamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481773"
	><span class="hs-identifier hs-var"
	  >vars</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481757"
	><span class="hs-identifier hs-var"
	  >body</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481763"
	><span class="hs-identifier hs-var"
	  >p</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PLCType uni a -&gt; (Provenance a, PLCType uni a))
-&gt; [PLCType uni a] -&gt; [(Provenance a, PLCType uni a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[PLCType uni a]
</span
	><a href="#local-6989586621679481770"
	><span class="hs-identifier hs-var"
	  >tys</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-575"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481763"
	><span class="hs-identifier hs-var"
	  >p</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PIRTerm uni fun a -&gt; (Provenance a, PIRTerm uni fun a))
-&gt; [PIRTerm uni fun a] -&gt; [(Provenance a, PIRTerm uni fun a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[PIRTerm uni fun a]
</span
	><a href="#local-6989586621679481775"
	><span class="hs-identifier hs-var"
	  >vals</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-576"
      ></span
      ><span
      >
</span
      ><span id="line-577"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Compile a 'Datatype' to a triple of type-constructor, data-constructors, destructor definitions.</span
	></span
      ><span
      >
</span
      ><span id="line-578"
      ></span
      ><span id="local-6989586621679481394"
      ><span id="local-6989586621679481395"
	><span id="local-6989586621679481396"
	  ><span id="local-6989586621679481397"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#compileDatatypeDefs"
		><span class="hs-identifier hs-type"
		  >compileDatatypeDefs</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-579"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Quote.html#MonadQuote"
		><span class="hs-identifier hs-type"
		  >MonadQuote</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481394"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-580"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#DatatypeCompilationOpts"
		><span class="hs-identifier hs-type"
		  >DatatypeCompilationOpts</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-581"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Recursivity"
		><span class="hs-identifier hs-type"
		  >Recursivity</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-582"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-583"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481394"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-584"
	      ></span
	      ><span
	      >       </span
	      ><span class="hs-special"
	      >(</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
		><span class="hs-identifier hs-type"
		  >PLC.Def</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVarDecl"
		><span class="hs-identifier hs-type"
		  >TyVarDecl</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PLCRecType"
		><span class="hs-identifier hs-type"
		  >PLCRecType</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481397"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-585"
	      ></span
	      ><span
	      >       </span
	      ><span class="hs-special"
	      >,</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >[</span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
		><span class="hs-identifier hs-type"
		  >PLC.Def</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
		><span class="hs-identifier hs-type"
		  >VarDecl</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481397"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span class="hs-special"
	      >]</span
	      ><span
	      >
</span
	      ><span id="line-586"
	      ></span
	      ><span
	      >       </span
	      ><span class="hs-special"
	      >,</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
		><span class="hs-identifier hs-type"
		  >PLC.Def</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
		><span class="hs-identifier hs-type"
		  >VarDecl</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481395"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481397"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481396"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-587"
	      ></span
	      ><span
	      >       </span
	      ><span class="hs-special"
	      >)</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-588"
      ></span
      ><span id="compileDatatypeDefs"
      ><span class="annot"
	><span class="annottext"
	  >compileDatatypeDefs :: forall (m :: * -&gt; *) (uni :: * -&gt; *) a fun.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a),
      [Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)],
      Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#compileDatatypeDefs"
	  ><span class="hs-identifier hs-var hs-var"
	    >compileDatatypeDefs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481804"
      ><span class="annot"
	><span class="annottext"
	  >DatatypeCompilationOpts
</span
	  ><a href="#local-6989586621679481804"
	  ><span class="hs-identifier hs-var"
	    >opts</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481805"
      ><span class="annot"
	><span class="annottext"
	  >Recursivity
</span
	  ><a href="#local-6989586621679481805"
	  ><span class="hs-identifier hs-var"
	    >r</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481806"
      ><span class="annot"
	><span class="annottext"
	  >d :: Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481806"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Datatype"
	><span class="hs-identifier hs-type"
	  >Datatype</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679481807"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481807"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481808"
      ><span class="annot"
	><span class="annottext"
	  >TyVarDecl TyName (Provenance a)
</span
	  ><a href="#local-6989586621679481808"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[TyVarDecl TyName (Provenance a)]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481809"
      ><span class="annot"
	><span class="annottext"
	  >Name
</span
	  ><a href="#local-6989586621679481809"
	  ><span class="hs-identifier hs-var"
	    >destr</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481810"
      ><span class="annot"
	><span class="annottext"
	  >[VarDecl TyName Name uni (Provenance a)]
</span
	  ><a href="#local-6989586621679481810"
	  ><span class="hs-identifier hs-var"
	    >constrs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-589"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481811"
      ><span class="annot"
	><span class="annottext"
	  >Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	  ><a href="#local-6989586621679481811"
	  ><span class="hs-identifier hs-var"
	    >concreteTyDef</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
-&gt; PLCRecType uni fun a
-&gt; Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
forall var val. var -&gt; val -&gt; Def var val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
	><span class="hs-identifier hs-var"
	  >PIR.Def</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl TyName (Provenance a)
</span
	><a href="#local-6989586621679481808"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(PLCRecType uni fun a
 -&gt; Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a))
-&gt; m (PLCRecType uni fun a)
-&gt; m (Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PLCRecType uni fun a)
forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; Recursivity
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PLCRecType uni fun a)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDatatypeType"
	><span class="hs-identifier hs-var"
	  >mkDatatypeType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481804"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="#local-6989586621679481805"
	><span class="hs-identifier hs-var"
	  >r</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481806"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-590"
      ></span
      ><span
      >
</span
      ><span id="line-591"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481813"
      ><span class="annot"
	><span class="annottext"
	  >[Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
</span
	  ><a href="#local-6989586621679481813"
	  ><span class="hs-identifier hs-var"
	    >constrDefs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[(VarDecl TyName Name uni (Provenance a), Word64)]
-&gt; ((VarDecl TyName Name uni (Provenance a), Word64)
    -&gt; m (Def
            (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)))
-&gt; m [Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
-&gt; [Word64] -&gt; [(VarDecl TyName Name uni (Provenance a), Word64)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zip"
	><span class="hs-identifier hs-var"
	  >zip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[VarDecl TyName Name uni (Provenance a)]
</span
	><a href="#local-6989586621679481810"
	><span class="hs-identifier hs-var"
	  >constrs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >]</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(((VarDecl TyName Name uni (Provenance a), Word64)
  -&gt; m (Def
          (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)))
 -&gt; m [Def
         (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)])
-&gt; ((VarDecl TyName Name uni (Provenance a), Word64)
    -&gt; m (Def
            (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)))
-&gt; m [Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679481814"
      ><span class="annot"
	><span class="annottext"
	  >VarDecl TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481814"
	  ><span class="hs-identifier hs-var"
	    >constr</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679481815"
      ><span class="annot"
	><span class="annottext"
	  >Word64
</span
	  ><a href="#local-6989586621679481815"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-592"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679481817"
      ><span class="annot"
	><span class="annottext"
	  >constrTy :: Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481817"
	  ><span class="hs-identifier hs-var hs-var"
	    >constrTy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#ConstructorType"
	><span class="hs-identifier hs-var"
	  >ConstructorType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Provenance a -&gt; Provenance a)
-&gt; Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
-&gt; Type TyName uni (Provenance a)
forall (uni :: * -&gt; *) a.
Datatype TyName Name uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a) -&gt; PIRType uni a
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkConstructorType"
	><span class="hs-identifier hs-var"
	  >mkConstructorType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481806"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481814"
	><span class="hs-identifier hs-var"
	  >constr</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-593"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481819"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481819"
	  ><span class="hs-identifier hs-var"
	    >c</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Word64
-&gt; m (PIRTerm uni fun a)
forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; Word64
-&gt; m (PIRTerm uni fun a)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkConstructor"
	><span class="hs-identifier hs-var"
	  >mkConstructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481804"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
-&gt; PLCRecType uni fun a
forall var val. Def var val -&gt; val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVal"
	><span class="hs-identifier hs-var"
	  >PIR.defVal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	><a href="#local-6989586621679481811"
	><span class="hs-identifier hs-var"
	  >concreteTyDef</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481806"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Word64
</span
	><a href="#local-6989586621679481815"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-594"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; m (Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
 -&gt; m (Def
         (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)))
-&gt; Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; m (Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
forall var val. var -&gt; val -&gt; Def var val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
	><span class="hs-identifier hs-var"
	  >PIR.Def</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-var"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#Constructor"
	><span class="hs-identifier hs-var"
	  >Constructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481807"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a) -&gt; Name
forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; name
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#_varDeclName"
	><span class="hs-identifier hs-var"
	  >_varDeclName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481814"
	><span class="hs-identifier hs-var"
	  >constr</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481817"
	><span class="hs-identifier hs-var"
	  >constrTy</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481819"
	><span class="hs-identifier hs-var"
	  >c</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-595"
      ></span
      ><span
      >
</span
      ><span id="line-596"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481821"
      ><span class="annot"
	><span class="annottext"
	  >Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
</span
	  ><a href="#local-6989586621679481821"
	  ><span class="hs-identifier hs-var"
	    >destrDef</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-597"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481822"
      ><span class="annot"
	><span class="annottext"
	  >Type TyName uni (Provenance a)
</span
	  ><a href="#local-6989586621679481822"
	  ><span class="hs-identifier hs-var"
	    >destTy</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Provenance a -&gt; Provenance a)
-&gt; Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a)
forall a b. (a -&gt; b) -&gt; Type TyName uni a -&gt; Type TyName uni b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#DestructorType"
	><span class="hs-identifier hs-var"
	  >DestructorType</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type TyName uni (Provenance a) -&gt; Type TyName uni (Provenance a))
-&gt; m (Type TyName uni (Provenance a))
-&gt; m (Type TyName uni (Provenance a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
-&gt; m (Type TyName uni (Provenance a))
forall (m :: * -&gt; *) (uni :: * -&gt; *) a.
MonadQuote m =&gt;
Datatype TyName Name uni a -&gt; m (Type TyName uni a)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDestructorTy"
	><span class="hs-identifier hs-var"
	  >mkDestructorTy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481806"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-598"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481824"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481824"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
DatatypeCompilationOpts
-&gt; PLCRecType uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
</span
	><a href="PlutusIR.Compiler.Datatype.html#mkDestructor"
	><span class="hs-identifier hs-var"
	  >mkDestructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeCompilationOpts
</span
	><a href="#local-6989586621679481804"
	><span class="hs-identifier hs-var"
	  >opts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
-&gt; PLCRecType uni fun a
forall var val. Def var val -&gt; val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#defVal"
	><span class="hs-identifier hs-var"
	  >PIR.defVal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	><a href="#local-6989586621679481811"
	><span class="hs-identifier hs-var"
	  >concreteTyDef</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481806"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-599"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; m (Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
 -&gt; m (Def
         (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)))
-&gt; Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
-&gt; m (Def
        (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl TyName Name uni (Provenance a)
-&gt; PIRTerm uni fun a
-&gt; Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
forall var val. var -&gt; val -&gt; Def var val
</span
	><a href="../../plutus-core/src/PlutusCore.MkPlc.html#Def"
	><span class="hs-identifier hs-var"
	  >PIR.Def</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
-&gt; Name
-&gt; Type TyName uni (Provenance a)
-&gt; VarDecl TyName Name uni (Provenance a)
forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span
	><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-var"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent -&gt; Provenance a -&gt; Provenance a
forall a. DatatypeComponent -&gt; Provenance a -&gt; Provenance a
</span
	><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"
	><span class="hs-identifier hs-var"
	  >DatatypeComponent</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>DatatypeComponent
</span
	><a href="PlutusIR.Compiler.Provenance.html#Destructor"
	><span class="hs-identifier hs-var"
	  >Destructor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481807"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621679481809"
	><span class="hs-identifier hs-var"
	  >destr</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type TyName uni (Provenance a)
</span
	><a href="#local-6989586621679481822"
	><span class="hs-identifier hs-var"
	  >destTy</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481824"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-600"
      ></span
      ><span
      >
</span
      ><span id="line-601"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>(Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a),
 [Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)],
 Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
-&gt; m (Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a),
      [Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)],
      Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Def (TyVarDecl TyName (Provenance a)) (PLCRecType uni fun a)
</span
	><a href="#local-6989586621679481811"
	><span class="hs-identifier hs-var"
	  >concreteTyDef</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)]
</span
	><a href="#local-6989586621679481813"
	><span class="hs-identifier hs-var"
	  >constrDefs</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Def (VarDecl TyName Name uni (Provenance a)) (PIRTerm uni fun a)
</span
	><a href="#local-6989586621679481821"
	><span class="hs-identifier hs-var"
	  >destrDef</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-602"
      ></span
      ><span
      >
</span
      ><span id="line-603"
      ></span
      ><span id="local-6989586621679481423"
      ><span id="local-6989586621679481424"
	><span id="local-6989586621679481425"
	  ><span id="local-6989586621679481426"
	    ><span class="annot"
	      ><a href="PlutusIR.Compiler.Datatype.html#compileRecDatatypes"
		><span class="hs-identifier hs-type"
		  >compileRecDatatypes</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-604"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#Compiling"
		><span class="hs-identifier hs-type"
		  >Compiling</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481423"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481424"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481425"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481426"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-605"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481424"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481425"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481426"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-606"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#NonEmpty"
		><span class="hs-identifier hs-type"
		  >NE.NonEmpty</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Core.Type.html#Datatype"
		><span class="hs-identifier hs-type"
		  >Datatype</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
		><span class="hs-identifier hs-type"
		  >TyName</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
		><span class="hs-identifier hs-type"
		  >Name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481424"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Provenance.html#Provenance"
		><span class="hs-identifier hs-type"
		  >Provenance</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481426"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-607"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481423"
		><span class="hs-identifier hs-type"
		  >m</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusIR.Compiler.Types.html#PIRTerm"
		><span class="hs-identifier hs-type"
		  >PIRTerm</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481424"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481425"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621679481426"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-608"
      ></span
      ><span id="compileRecDatatypes"
      ><span class="annot"
	><span class="annottext"
	  >compileRecDatatypes :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
Compiling m uni fun a =&gt;
PIRTerm uni fun a
-&gt; NonEmpty (Datatype TyName Name uni (Provenance a))
-&gt; m (PIRTerm uni fun a)
</span
	  ><a href="PlutusIR.Compiler.Datatype.html#compileRecDatatypes"
	  ><span class="hs-identifier hs-var hs-var"
	    >compileRecDatatypes</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481834"
      ><span class="annot"
	><span class="annottext"
	  >PIRTerm uni fun a
</span
	  ><a href="#local-6989586621679481834"
	  ><span class="hs-identifier hs-var"
	    >body</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679481835"
      ><span class="annot"
	><span class="annottext"
	  >NonEmpty (Datatype TyName Name uni (Provenance a))
</span
	  ><a href="#local-6989586621679481835"
	  ><span class="hs-identifier hs-var"
	    >ds</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>NonEmpty (Datatype TyName Name uni (Provenance a))
</span
	><a href="#local-6989586621679481835"
	><span class="hs-identifier hs-var"
	  >ds</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-609"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679481836"
      ><span class="annot"
	><span class="annottext"
	  >Datatype TyName Name uni (Provenance a)
</span
	  ><a href="#local-6989586621679481836"
	  ><span class="hs-identifier hs-var"
	    >d</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3A%7C"
	><span class="hs-operator hs-type"
	  >NE.:|</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
-&gt; PIRTerm uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
Compiling m uni fun a =&gt;
Recursivity
-&gt; PIRTerm uni fun a
-&gt; Datatype TyName Name uni (Provenance a)
-&gt; m (PIRTerm uni fun a)
</span
	><a href="PlutusIR.Compiler.Datatype.html#compileDatatype"
	><span class="hs-identifier hs-var"
	  >compileDatatype</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#Rec"
	><span class="hs-identifier hs-var"
	  >Rec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PIRTerm uni fun a
</span
	><a href="#local-6989586621679481834"
	><span class="hs-identifier hs-var"
	  >body</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Datatype TyName Name uni (Provenance a)
</span
	><a href="#local-6989586621679481836"
	><span class="hs-identifier hs-var"
	  >d</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-610"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>NonEmpty (Datatype TyName Name uni (Provenance a))
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-611"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679481838"
      ><span class="annot"
	><span class="annottext"
	  >Provenance a
</span
	  ><a href="#local-6989586621679481838"
	  ><span class="hs-identifier hs-var"
	    >p</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>m (Provenance a)
forall (uni :: * -&gt; *) fun a (m :: * -&gt; *).
MonadReader (CompilationCtx uni fun a) m =&gt;
m (Provenance a)
</span
	><a href="PlutusIR.Compiler.Types.html#getEnclosing"
	><span class="hs-identifier hs-var"
	  >getEnclosing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-612"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Error uni fun (Provenance a) -&gt; m (PIRTerm uni fun a)
forall a. Error uni fun (Provenance a) -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.Error.Class.html#throwError"
	><span class="hs-identifier hs-var"
	  >throwError</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Error uni fun (Provenance a) -&gt; m (PIRTerm uni fun a))
-&gt; Error uni fun (Provenance a) -&gt; m (PIRTerm uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a -&gt; Text -&gt; Error uni fun (Provenance a)
forall (uni :: * -&gt; *) fun a. a -&gt; Text -&gt; Error uni fun a
</span
	><a href="PlutusIR.Error.html#UnsupportedError"
	><span class="hs-identifier hs-var"
	  >UnsupportedError</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Provenance a
</span
	><a href="#local-6989586621679481838"
	><span class="hs-identifier hs-var"
	  >p</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Text
</span
	><span class="hs-string"
	>&quot;Mutually recursive datatypes&quot;</span
	></span
      ><span
      >
</span
      ><span id="line-613"
      ></span
      ></pre
    ></body
  ></html
>

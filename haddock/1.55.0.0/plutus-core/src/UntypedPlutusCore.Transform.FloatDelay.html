<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE LambdaCase #-}</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- | The Float Delay optimization floats `Delay` from arguments into function bodies,
if possible. It turns @(\n -&gt; ...Force n...Force n...) (Delay arg)@ into
@(\n -&gt; ...Force (Delay n)...Force (Delay n)...) arg@.

The above transformation is performed if:

    * All occurrences of @arg@ are under @Force@.

    * @arg@ is essentially work-free.

This achieves a similar effect to Plutonomy's &quot;Split Delay&quot; optimization. The difference
is that Split Delay simply splits the @Delay@ argument into multiple arguments, turning the
above example into @(\m -&gt; (\n -&gt; ...Force n...Force n...) (Delay m)) arg@, and then relies
on other optimizations to simplify it further. Specifically, once the inliner inlines
@Delay m@, it will be identical to the result of Float Delay.

The advantages of Float Delay are:

    * It doesn't rely on the inliner. In this example, Split Delay relies on the inliner to
      inline @Delay m@, but there's no guarantee that the inliner will do so, because inlining
      it may increase the program size.

      We can potentially modify the inliner such that it is aware of Float Delay and
      Force-Delay Cancel, and makes inlining decisions with these other optimizations in mind.
      The problem is that, not only does this makes the inlining heuristics much more
      complex, but it could easily lead to code duplication. Other optimizations often
      need to do some calculation in order to make certain optimization decisions (e.g., in
      this case, we want to check whether all occurrences of @arg@ are under @Force@), and
      if we rely on the inliner to inline the @Delay@, then the same check would need to be
      performed by the inliner.

    * Because Force Delay requires that all occurrences of @arg@ are under @Force@, it
      guarantees to not increase the size or the cost of the program. This is not the case
      with Split Delay: in this example, if the occurrences of @n@ are not under @Force@,
      then Split Delay may increase the size of the program, regardless of whether or not
      @Delay m@ is inlined. If @Delay m@ is not inlined, then it will also increase the
      cost of the program, due to the additional application.

The alternative approach that always floats the @Delay@ regardless of whether or not all
occurences of @arg@ are under @Force@ was implemented and tested, and it is strictly worse than
Float Delay on our current test suite (specifically, Split Delay causes one test case
to have a slightly bigger program, and everything else is equal).

Why is this optimization performed on UPLC, not PIR?

    1. Not only are the types and let-bindings in PIR not useful for this optimization,
       they can also get in the way. For example, we cannot transform
       @let f = /\a. ...a... in ...{f t1}...{f t2}...@ into
       @ket f = ...a... in ...f...f...@.

    2. This optimization mainly interacts with ForceDelayCancel and the inliner, and
       both are part of the UPLC simplifier.
-}</span
	></span
      ><span
      >
</span
      ><span id="line-56"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >UntypedPlutusCore.Transform.FloatDelay</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.FloatDelay.html#floatDelay"
	><span class="hs-identifier"
	  >floatDelay</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-57"
      ></span
      ><span
      >
</span
      ><span id="line-58"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.html"
	><span class="hs-identifier"
	  >PlutusCore</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-59"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html"
	><span class="hs-identifier"
	  >PlutusCore.Name.Unique</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-60"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueMap.html"
	><span class="hs-identifier"
	  >PlutusCore.Name.UniqueMap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>UMap</span
	></span
      ><span
      >
</span
      ><span id="line-61"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueSet.html"
	><span class="hs-identifier"
	  >PlutusCore.Name.UniqueSet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>USet</span
	></span
      ><span
      >
</span
      ><span id="line-62"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Plated.html"
	><span class="hs-identifier"
	  >UntypedPlutusCore.Core.Plated</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Plated.html#termSubterms"
	><span class="hs-identifier"
	  >termSubterms</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-63"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html"
	><span class="hs-identifier"
	  >UntypedPlutusCore.Core.Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Term"
	><span class="hs-identifier"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-64"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.Simplifier.html"
	><span class="hs-identifier"
	  >UntypedPlutusCore.Transform.Simplifier</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.Simplifier.html#SimplifierStage"
	><span class="hs-identifier"
	  >SimplifierStage</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.Simplifier.html#FloatDelay"
	><span class="hs-identifier"
	  >FloatDelay</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.Simplifier.html#SimplifierT"
	><span class="hs-identifier"
	  >SimplifierT</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><span id="line-65"
      ></span
      ><span
      >                                               </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.Simplifier.html#recordSimplification"
	><span class="hs-identifier"
	  >recordSimplification</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-66"
      ></span
      ><span
      >
</span
      ><span id="line-67"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Control.Lens</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="hs-identifier"
	>forOf</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>forOf_</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>transformOf</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-68"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html"
	><span class="hs-identifier"
	  >Control.Monad.Trans.Writer.CPS</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#Writer"
	><span class="hs-identifier"
	  >Writer</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#execWriter"
	><span class="hs-identifier"
	  >execWriter</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#runWriter"
	><span class="hs-identifier"
	  >runWriter</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#tell"
	><span class="hs-identifier"
	  >tell</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-69"
      ></span
      ><span
      >
</span
      ><span id="line-70"
      ></span
      ><span id="local-6989586621682048961"
      ><span id="local-6989586621682048963"
	><span id="local-6989586621682048964"
	  ><span id="local-6989586621682048965"
	    ><span id="local-6989586621682048966"
	      ><span class="annot"
		><a href="UntypedPlutusCore.Transform.FloatDelay.html#floatDelay"
		  ><span class="hs-identifier hs-type"
		    >floatDelay</span
		    ></a
		  ></span
		><span
		> </span
		><span class="hs-glyph"
		>::</span
		><span
		>
</span
		><span id="line-71"
		></span
		><span
		>  </span
		><span class="hs-special"
		>(</span
		><span
		> </span
		><span class="annot"
		><a href="PlutusCore.Quote.html#MonadQuote"
		  ><span class="hs-identifier hs-type"
		    >PLC.MonadQuote</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048961"
		  ><span class="hs-identifier hs-type"
		    >m</span
		    ></a
		  ></span
		><span
		>
</span
		><span id="line-72"
		></span
		><span
		>  </span
		><span class="hs-special"
		>,</span
		><span
		> </span
		><span class="annot"
		><a href="PlutusCore.Rename.html#Rename"
		  ><span class="hs-identifier hs-type"
		    >PLC.Rename</span
		    ></a
		  ></span
		><span
		> </span
		><span class="hs-special"
		>(</span
		><span class="annot"
		><a href="UntypedPlutusCore.Core.Type.html#Term"
		  ><span class="hs-identifier hs-type"
		    >Term</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048963"
		  ><span class="hs-identifier hs-type"
		    >name</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048964"
		  ><span class="hs-identifier hs-type"
		    >uni</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048965"
		  ><span class="hs-identifier hs-type"
		    >fun</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048966"
		  ><span class="hs-identifier hs-type"
		    >a</span
		    ></a
		  ></span
		><span class="hs-special"
		>)</span
		><span
		>
</span
		><span id="line-73"
		></span
		><span
		>  </span
		><span class="hs-special"
		>,</span
		><span
		> </span
		><span class="annot"
		><a href="PlutusCore.Name.Unique.html#HasUnique"
		  ><span class="hs-identifier hs-type"
		    >PLC.HasUnique</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048963"
		  ><span class="hs-identifier hs-type"
		    >name</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="PlutusCore.Name.Unique.html#TermUnique"
		  ><span class="hs-identifier hs-type"
		    >PLC.TermUnique</span
		    ></a
		  ></span
		><span
		>
</span
		><span id="line-74"
		></span
		><span
		>  </span
		><span class="hs-special"
		>)</span
		><span
		> </span
		><span class="hs-glyph"
		>=&gt;</span
		><span
		>
</span
		><span id="line-75"
		></span
		><span
		>  </span
		><span class="annot"
		><a href="UntypedPlutusCore.Core.Type.html#Term"
		  ><span class="hs-identifier hs-type"
		    >Term</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048963"
		  ><span class="hs-identifier hs-type"
		    >name</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048964"
		  ><span class="hs-identifier hs-type"
		    >uni</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048965"
		  ><span class="hs-identifier hs-type"
		    >fun</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048966"
		  ><span class="hs-identifier hs-type"
		    >a</span
		    ></a
		  ></span
		><span
		> </span
		><span class="hs-glyph"
		>-&gt;</span
		><span
		>
</span
		><span id="line-76"
		></span
		><span
		>  </span
		><span class="annot"
		><a href="UntypedPlutusCore.Transform.Simplifier.html#SimplifierT"
		  ><span class="hs-identifier hs-type"
		    >SimplifierT</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048963"
		  ><span class="hs-identifier hs-type"
		    >name</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048964"
		  ><span class="hs-identifier hs-type"
		    >uni</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048965"
		  ><span class="hs-identifier hs-type"
		    >fun</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048966"
		  ><span class="hs-identifier hs-type"
		    >a</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048961"
		  ><span class="hs-identifier hs-type"
		    >m</span
		    ></a
		  ></span
		><span
		> </span
		><span class="hs-special"
		>(</span
		><span class="annot"
		><a href="UntypedPlutusCore.Core.Type.html#Term"
		  ><span class="hs-identifier hs-type"
		    >Term</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048963"
		  ><span class="hs-identifier hs-type"
		    >name</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048964"
		  ><span class="hs-identifier hs-type"
		    >uni</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048965"
		  ><span class="hs-identifier hs-type"
		    >fun</span
		    ></a
		  ></span
		><span
		> </span
		><span class="annot"
		><a href="#local-6989586621682048966"
		  ><span class="hs-identifier hs-type"
		    >a</span
		    ></a
		  ></span
		><span class="hs-special"
		>)</span
		></span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-77"
      ></span
      ><span id="floatDelay"
      ><span class="annot"
	><span class="annottext"
	  >floatDelay :: forall (m :: * -&gt; *) name (uni :: * -&gt; *) fun a.
(MonadQuote m, Rename (Term name uni fun a),
 HasUnique name TermUnique) =&gt;
Term name uni fun a
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
</span
	  ><a href="UntypedPlutusCore.Transform.FloatDelay.html#floatDelay"
	  ><span class="hs-identifier hs-var hs-var"
	    >floatDelay</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049146"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun a
</span
	  ><a href="#local-6989586621682049146"
	  ><span class="hs-identifier hs-var"
	    >term</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-78"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621682049147"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun a
</span
	  ><a href="#local-6989586621682049147"
	  ><span class="hs-identifier hs-var"
	    >result</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      >
</span
      ><span id="line-79"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
forall (m :: * -&gt; *).
MonadQuote m =&gt;
Term name uni fun a -&gt; m (Term name uni fun a)
</span
	><a href="PlutusCore.Rename.html#rename"
	><span class="hs-identifier hs-var"
	  >PLC.rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049146"
	><span class="hs-identifier hs-var"
	  >term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>SimplifierT name uni fun a m (Term name uni fun a)
-&gt; (Term name uni fun a
    -&gt; SimplifierT name uni fun a m (Term name uni fun a))
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall a b.
SimplifierT name uni fun a m a
-&gt; (a -&gt; SimplifierT name uni fun a m b)
-&gt; SimplifierT name uni fun a m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3E%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621682049149"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun a
</span
	  ><a href="#local-6989586621682049149"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-80"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall a. a -&gt; SimplifierT name uni fun a m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term name uni fun a
 -&gt; SimplifierT name uni fun a m (Term name uni fun a))
-&gt; ((Term name uni fun a, UniqueMap TermUnique a)
    -&gt; Term name uni fun a)
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term name uni fun a
 -&gt; UniqueMap TermUnique a -&gt; Term name uni fun a)
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
-&gt; Term name uni fun a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Tuple.html#uncurry"
	><span class="hs-identifier hs-var"
	  >uncurry</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(UniqueMap TermUnique a
 -&gt; Term name uni fun a -&gt; Term name uni fun a)
-&gt; Term name uni fun a
-&gt; UniqueMap TermUnique a
-&gt; Term name uni fun a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#flip"
	><span class="hs-identifier hs-var"
	  >flip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueMap TermUnique a
-&gt; Term name uni fun a -&gt; Term name uni fun a
forall name a (uni :: * -&gt; *) fun.
HasUnique name TermUnique =&gt;
UniqueMap TermUnique a
-&gt; Term name uni fun a -&gt; Term name uni fun a
</span
	><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyBodies"
	><span class="hs-identifier hs-var"
	  >simplifyBodies</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Term name uni fun a, UniqueMap TermUnique a)
 -&gt; SimplifierT name uni fun a m (Term name uni fun a))
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueSet TermUnique
-&gt; Term name uni fun a
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
forall name (uni :: * -&gt; *) fun a.
HasUnique name TermUnique =&gt;
UniqueSet TermUnique
-&gt; Term name uni fun a
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
</span
	><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyArgs"
	><span class="hs-identifier hs-var"
	  >simplifyArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a -&gt; UniqueSet TermUnique
forall name (uni :: * -&gt; *) fun a.
HasUnique name TermUnique =&gt;
Term name uni fun a -&gt; UniqueSet TermUnique
</span
	><a href="UntypedPlutusCore.Transform.FloatDelay.html#unforcedVars"
	><span class="hs-identifier hs-var"
	  >unforcedVars</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049149"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049149"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-81"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
-&gt; SimplifierStage
-&gt; Term name uni fun a
-&gt; SimplifierT name uni fun a m ()
forall (m :: * -&gt; *) name (uni :: * -&gt; *) fun a.
Monad m =&gt;
Term name uni fun a
-&gt; SimplifierStage
-&gt; Term name uni fun a
-&gt; SimplifierT name uni fun a m ()
</span
	><a href="UntypedPlutusCore.Transform.Simplifier.html#recordSimplification"
	><span class="hs-identifier hs-var"
	  >recordSimplification</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049146"
	><span class="hs-identifier hs-var"
	  >term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>SimplifierStage
</span
	><a href="UntypedPlutusCore.Transform.Simplifier.html#FloatDelay"
	><span class="hs-identifier hs-var"
	  >FloatDelay</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049147"
	><span class="hs-identifier hs-var"
	  >result</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-82"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
-&gt; SimplifierT name uni fun a m (Term name uni fun a)
forall a. a -&gt; SimplifierT name uni fun a m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#return"
	><span class="hs-identifier hs-var"
	  >return</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049147"
	><span class="hs-identifier hs-var"
	  >result</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-83"
      ></span
      ><span
      >
</span
      ><span id="line-84"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- | First pass. Returns the names of all variables, at least one occurrence
of which is not under `Force`.
-}</span
	></span
      ><span
      >
</span
      ><span id="line-87"
      ></span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.FloatDelay.html#unforcedVars"
	><span class="hs-identifier hs-type"
	  >unforcedVars</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-88"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621682049022"
      ><span class="annot"
	><a href="#local-6989586621682049022"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049023"
      ><span class="annot"
	><a href="#local-6989586621682049023"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049024"
      ><span class="annot"
	><a href="#local-6989586621682049024"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049025"
      ><span class="annot"
	><a href="#local-6989586621682049025"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-89"
      ></span
      ><span
      >  </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#HasUnique"
	><span class="hs-identifier hs-type"
	  >PLC.HasUnique</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049022"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-90"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049022"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049023"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049024"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049025"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-91"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueSet.html#UniqueSet"
	><span class="hs-identifier hs-type"
	  >PLC.UniqueSet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-92"
      ></span
      ><span id="unforcedVars"
      ><span class="annot"
	><span class="annottext"
	  >unforcedVars :: forall name (uni :: * -&gt; *) fun a.
HasUnique name TermUnique =&gt;
Term name uni fun a -&gt; UniqueSet TermUnique
</span
	  ><a href="UntypedPlutusCore.Transform.FloatDelay.html#unforcedVars"
	  ><span class="hs-identifier hs-var hs-var"
	    >unforcedVars</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Writer (UniqueSet TermUnique) () -&gt; UniqueSet TermUnique
forall w a. Monoid w =&gt; Writer w a -&gt; w
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#execWriter"
	><span class="hs-identifier hs-var"
	  >execWriter</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Writer (UniqueSet TermUnique) () -&gt; UniqueSet TermUnique)
-&gt; (Term name uni fun a -&gt; Writer (UniqueSet TermUnique) ())
-&gt; Term name uni fun a
-&gt; UniqueSet TermUnique
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a -&gt; Writer (UniqueSet TermUnique) ()
</span
	><a href="#local-6989586621682049174"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-93"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-94"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621682049174"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049022"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049023"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049024"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049025"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#Writer"
	><span class="hs-identifier hs-type"
	  >Writer</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueSet.html#UniqueSet"
	><span class="hs-identifier hs-type"
	  >PLC.UniqueSet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-95"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621682049174"
      ><span class="annot"
	><span class="annottext"
	  >go :: Term name uni fun a -&gt; Writer (UniqueSet TermUnique) ()
</span
	  ><a href="#local-6989586621682049174"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-96"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049176"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621682049176"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      >       </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueSet TermUnique -&gt; Writer (UniqueSet TermUnique) ()
forall w (m :: * -&gt; *). (Monoid w, Monad m) =&gt; w -&gt; WriterT w m ()
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#tell"
	><span class="hs-identifier hs-var"
	  >tell</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>name -&gt; UniqueSet TermUnique
forall name unique.
HasUnique name unique =&gt;
name -&gt; UniqueSet unique
</span
	><a href="PlutusCore.Name.UniqueSet.html#singletonName"
	><span class="hs-identifier hs-var"
	  >USet.singletonName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621682049176"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-97"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Force"
	><span class="hs-identifier hs-type"
	  >Force</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>() -&gt; Writer (UniqueSet TermUnique) ()
forall a. a -&gt; WriterT (UniqueSet TermUnique) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-98"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621682049178"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun a
</span
	  ><a href="#local-6989586621682049178"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      >             </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting
  (Traversed () (WriterT (UniqueSet TermUnique) Identity))
  (Term name uni fun a)
  (Term name uni fun a)
-&gt; Term name uni fun a
-&gt; (Term name uni fun a -&gt; Writer (UniqueSet TermUnique) ())
-&gt; Writer (UniqueSet TermUnique) ()
forall (f :: * -&gt; *) r s a.
Functor f =&gt;
Getting (Traversed r f) s a -&gt; s -&gt; (a -&gt; f r) -&gt; f ()
</span
	><span class="hs-identifier hs-var"
	>forOf_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting
  (Traversed () (WriterT (UniqueSet TermUnique) Identity))
  (Term name uni fun a)
  (Term name uni fun a)
forall name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Applicative f =&gt;
(Term name uni fun ann -&gt; f (Term name uni fun ann))
-&gt; Term name uni fun ann -&gt; f (Term name uni fun ann)
</span
	><a href="UntypedPlutusCore.Core.Plated.html#termSubterms"
	><span class="hs-identifier hs-var"
	  >termSubterms</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049178"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a -&gt; Writer (UniqueSet TermUnique) ()
</span
	><a href="#local-6989586621682049174"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-99"
      ></span
      ><span
      >
</span
      ><span id="line-100"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- | Second pass. Removes `Delay` from eligible arguments, and returns
the names of variables whose corresponding arguments are modified.
-}</span
	></span
      ><span
      >
</span
      ><span id="line-103"
      ></span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyArgs"
	><span class="hs-identifier hs-type"
	  >simplifyArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-104"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621682049018"
      ><span class="annot"
	><a href="#local-6989586621682049018"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049019"
      ><span class="annot"
	><a href="#local-6989586621682049019"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049020"
      ><span class="annot"
	><a href="#local-6989586621682049020"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049021"
      ><span class="annot"
	><a href="#local-6989586621682049021"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	></span
      ><span class="hs-operator"
      >.</span
      ><span
      >
</span
      ><span id="line-105"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#HasUnique"
	><span class="hs-identifier hs-type"
	  >PLC.HasUnique</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049018"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      >
</span
      ><span id="line-106"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The set of variables returned by `unforcedVars`.</span
	></span
      ><span
      >
</span
      ><span id="line-107"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueSet.html#UniqueSet"
	><span class="hs-identifier hs-type"
	  >PLC.UniqueSet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-108"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049018"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049019"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049020"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049021"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-109"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049018"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049019"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049020"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049021"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.UniqueMap.html#UniqueMap"
	><span class="hs-identifier hs-type"
	  >PLC.UniqueMap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusCore.Name.Unique.html#TermUnique"
	><span class="hs-identifier hs-type"
	  >PLC.TermUnique</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621682049021"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-110"
      ></span
      ><span id="simplifyArgs"
      ><span class="annot"
	><span class="annottext"
	  >simplifyArgs :: forall name (uni :: * -&gt; *) fun a.
HasUnique name TermUnique =&gt;
UniqueSet TermUnique
-&gt; Term name uni fun a
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
</span
	  ><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyArgs"
	  ><span class="hs-identifier hs-var hs-var"
	    >simplifyArgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049182"
      ><span class="annot"
	><span class="annottext"
	  >UniqueSet TermUnique
</span
	  ><a href="#local-6989586621682049182"
	  ><span class="hs-identifier hs-var"
	    >blacklist</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Writer (UniqueMap TermUnique a) (Term name uni fun a)
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
forall w a. Monoid w =&gt; Writer w a -&gt; (a, w)
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#runWriter"
	><span class="hs-identifier hs-var"
	  >runWriter</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Writer (UniqueMap TermUnique a) (Term name uni fun a)
 -&gt; (Term name uni fun a, UniqueMap TermUnique a))
-&gt; (Term name uni fun a
    -&gt; Writer (UniqueMap TermUnique a) (Term name uni fun a))
-&gt; Term name uni fun a
-&gt; (Term name uni fun a, UniqueMap TermUnique a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
-&gt; Writer (UniqueMap TermUnique a) (Term name uni fun a)
forall ann.
Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
</span
	><a href="#local-6989586621682049183"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-111"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-112"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621682049074"
      ><span class="annot"
	><a href="#local-6989586621682049183"
	  ><span class="hs-identifier hs-type"
	    >go</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="UntypedPlutusCore.Core.Type.html#Term"
	  ><span class="hs-identifier hs-type"
	    >Term</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049018"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049019"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049020"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049074"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#Writer"
	  ><span class="hs-identifier hs-type"
	    >Writer</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-special"
	>(</span
	><span class="annot"
	><a href="PlutusCore.Name.UniqueMap.html#UniqueMap"
	  ><span class="hs-identifier hs-type"
	    >PLC.UniqueMap</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="PlutusCore.Name.Unique.html#TermUnique"
	  ><span class="hs-identifier hs-type"
	    >PLC.TermUnique</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049074"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	><span class="hs-special"
	>)</span
	><span
	> </span
	><span class="hs-special"
	>(</span
	><span class="annot"
	><a href="UntypedPlutusCore.Core.Type.html#Term"
	  ><span class="hs-identifier hs-type"
	    >Term</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049018"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049019"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049020"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621682049074"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	><span class="hs-special"
	>)</span
	></span
      ><span
      >
</span
      ><span id="line-113"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621682049183"
      ><span class="annot"
	><span class="annottext"
	  >go :: forall ann.
Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
</span
	  ><a href="#local-6989586621682049183"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-114"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Apply"
	><span class="hs-identifier hs-type"
	  >Apply</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621682049196"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621682049196"
	  ><span class="hs-identifier hs-var"
	    >appAnn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-type"
	  >LamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621682049198"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621682049198"
	  ><span class="hs-identifier hs-var"
	    >lamAnn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049199"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621682049199"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049200"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun ann
</span
	  ><a href="#local-6989586621682049200"
	  ><span class="hs-identifier hs-var"
	    >lamBody</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Delay"
	><span class="hs-identifier hs-type"
	  >Delay</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621682049201"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621682049201"
	  ><span class="hs-identifier hs-var"
	    >delayAnn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049202"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun ann
</span
	  ><a href="#local-6989586621682049202"
	  ><span class="hs-identifier hs-var"
	    >arg</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-115"
      ></span
      ><span
      >        </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann -&gt; Bool
forall name (uni :: * -&gt; *) fun a. Term name uni fun a -&gt; Bool
</span
	><a href="UntypedPlutusCore.Transform.FloatDelay.html#isEssentiallyWorkFree"
	><span class="hs-identifier hs-var"
	  >isEssentiallyWorkFree</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
</span
	><a href="#local-6989586621682049202"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-116"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621682049199"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name -&gt; UniqueSet TermUnique -&gt; Bool
forall name unique.
HasUnique name unique =&gt;
name -&gt; UniqueSet unique -&gt; Bool
</span
	><a href="PlutusCore.Name.UniqueSet.html#notMemberByName"
	><span class="hs-operator hs-var"
	  >`USet.notMemberByName`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueSet TermUnique
</span
	><a href="#local-6989586621682049182"
	><span class="hs-identifier hs-var"
	  >blacklist</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-117"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueMap TermUnique ann
-&gt; WriterT (UniqueMap TermUnique ann) Identity ()
forall w (m :: * -&gt; *). (Monoid w, Monad m) =&gt; w -&gt; WriterT w m ()
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Writer.CPS.html#tell"
	><span class="hs-identifier hs-var"
	  >tell</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>name -&gt; ann -&gt; UniqueMap TermUnique ann
forall name unique a.
HasUnique name unique =&gt;
name -&gt; a -&gt; UniqueMap unique a
</span
	><a href="PlutusCore.Name.UniqueMap.html#singletonByName"
	><span class="hs-identifier hs-var"
	  >UMap.singletonByName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621682049199"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621682049201"
	><span class="hs-identifier hs-var"
	  >delayAnn</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-118"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
forall name (uni :: * -&gt; *) fun ann.
ann
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
</span
	><a href="UntypedPlutusCore.Core.Type.html#Apply"
	><span class="hs-identifier hs-var"
	  >Apply</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621682049196"
	><span class="hs-identifier hs-var"
	  >appAnn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term name uni fun ann
 -&gt; Term name uni fun ann -&gt; Term name uni fun ann)
-&gt; (Term name uni fun ann -&gt; Term name uni fun ann)
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
-&gt; Term name uni fun ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann -&gt; name -&gt; Term name uni fun ann -&gt; Term name uni fun ann
forall name (uni :: * -&gt; *) fun ann.
ann -&gt; name -&gt; Term name uni fun ann -&gt; Term name uni fun ann
</span
	><a href="UntypedPlutusCore.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-var"
	  >LamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621682049198"
	><span class="hs-identifier hs-var"
	  >lamAnn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621682049199"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term name uni fun ann
 -&gt; Term name uni fun ann -&gt; Term name uni fun ann)
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
-&gt; WriterT
     (UniqueMap TermUnique ann)
     Identity
     (Term name uni fun ann -&gt; Term name uni fun ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
forall ann.
Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
</span
	><a href="#local-6989586621682049183"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
</span
	><a href="#local-6989586621682049200"
	><span class="hs-identifier hs-var"
	  >lamBody</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>WriterT
  (UniqueMap TermUnique ann)
  Identity
  (Term name uni fun ann -&gt; Term name uni fun ann)
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
forall a b.
WriterT (UniqueMap TermUnique ann) Identity (a -&gt; b)
-&gt; WriterT (UniqueMap TermUnique ann) Identity a
-&gt; WriterT (UniqueMap TermUnique ann) Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%2A%3E"
	><span class="hs-operator hs-var"
	  >&lt;*&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
forall ann.
Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
</span
	><a href="#local-6989586621682049183"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
</span
	><a href="#local-6989586621682049202"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-119"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621682049207"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun ann
</span
	  ><a href="#local-6989586621682049207"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WriterT (UniqueMap TermUnique ann) Identity)
  (Term name uni fun ann)
  (Term name uni fun ann)
  (Term name uni fun ann)
  (Term name uni fun ann)
-&gt; Term name uni fun ann
-&gt; (Term name uni fun ann
    -&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann))
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; s -&gt; (a -&gt; f b) -&gt; f t
</span
	><span class="hs-identifier hs-var"
	>forOf</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WriterT (UniqueMap TermUnique ann) Identity)
  (Term name uni fun ann)
  (Term name uni fun ann)
  (Term name uni fun ann)
  (Term name uni fun ann)
forall name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Applicative f =&gt;
(Term name uni fun ann -&gt; f (Term name uni fun ann))
-&gt; Term name uni fun ann -&gt; f (Term name uni fun ann)
</span
	><a href="UntypedPlutusCore.Core.Plated.html#termSubterms"
	><span class="hs-identifier hs-var"
	  >termSubterms</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
</span
	><a href="#local-6989586621682049207"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
forall ann.
Term name uni fun ann
-&gt; Writer (UniqueMap TermUnique ann) (Term name uni fun ann)
</span
	><a href="#local-6989586621682049183"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-120"
      ></span
      ><span
      >
</span
      ><span id="line-121"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Third pass. Turns @Force n@ into @Force (Delay n)@ for all eligibile @n@.</span
	></span
      ><span
      >
</span
      ><span id="line-122"
      ></span
      ><span id="local-6989586621682049010"
      ><span id="local-6989586621682049011"
	><span id="local-6989586621682049012"
	  ><span id="local-6989586621682049013"
	    ><span class="annot"
	      ><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyBodies"
		><span class="hs-identifier hs-type"
		  >simplifyBodies</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-123"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="hs-special"
	      >(</span
	      ><span class="annot"
	      ><a href="PlutusCore.Name.Unique.html#HasUnique"
		><span class="hs-identifier hs-type"
		  >PLC.HasUnique</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049010"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusCore.Name.Unique.html#TermUnique"
		><span class="hs-identifier hs-type"
		  >PLC.TermUnique</span
		  ></a
		></span
	      ><span class="hs-special"
	      >)</span
	      ><span
	      >
</span
	      ><span id="line-124"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >=&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusCore.Name.UniqueMap.html#UniqueMap"
		><span class="hs-identifier hs-type"
		  >PLC.UniqueMap</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="PlutusCore.Name.Unique.html#TermUnique"
		><span class="hs-identifier hs-type"
		  >PLC.TermUnique</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049011"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-125"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="UntypedPlutusCore.Core.Type.html#Term"
		><span class="hs-identifier hs-type"
		  >Term</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049010"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049012"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049013"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049011"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      >
</span
	      ><span id="line-126"
	      ></span
	      ><span
	      >  </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="UntypedPlutusCore.Core.Type.html#Term"
		><span class="hs-identifier hs-type"
		  >Term</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049010"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049012"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049013"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049011"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-127"
      ></span
      ><span id="simplifyBodies"
      ><span class="annot"
	><span class="annottext"
	  >simplifyBodies :: forall name a (uni :: * -&gt; *) fun.
HasUnique name TermUnique =&gt;
UniqueMap TermUnique a
-&gt; Term name uni fun a -&gt; Term name uni fun a
</span
	  ><a href="UntypedPlutusCore.Transform.FloatDelay.html#simplifyBodies"
	  ><span class="hs-identifier hs-var hs-var"
	    >simplifyBodies</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049212"
      ><span class="annot"
	><span class="annottext"
	  >UniqueMap TermUnique a
</span
	  ><a href="#local-6989586621682049212"
	  ><span class="hs-identifier hs-var"
	    >whitelist</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ASetter
  (Term name uni fun a)
  (Term name uni fun a)
  (Term name uni fun a)
  (Term name uni fun a)
-&gt; (Term name uni fun a -&gt; Term name uni fun a)
-&gt; Term name uni fun a
-&gt; Term name uni fun a
forall a b. ASetter a b a b -&gt; (b -&gt; b) -&gt; a -&gt; b
</span
	><span class="hs-identifier hs-var"
	>transformOf</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ASetter
  (Term name uni fun a)
  (Term name uni fun a)
  (Term name uni fun a)
  (Term name uni fun a)
forall name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Applicative f =&gt;
(Term name uni fun ann -&gt; f (Term name uni fun ann))
-&gt; Term name uni fun ann -&gt; f (Term name uni fun ann)
</span
	><a href="UntypedPlutusCore.Core.Plated.html#termSubterms"
	><span class="hs-identifier hs-var"
	  >termSubterms</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Term name uni fun a -&gt; Term name uni fun a)
 -&gt; Term name uni fun a -&gt; Term name uni fun a)
-&gt; (Term name uni fun a -&gt; Term name uni fun a)
-&gt; Term name uni fun a
-&gt; Term name uni fun a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-128"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621682049213"
      ><span class="annot"
	><span class="annottext"
	  >var :: Term name uni fun a
</span
	  ><a href="#local-6989586621682049213"
	  ><span class="hs-identifier hs-var"
	    >var</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621682049214"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621682049214"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-129"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621682049215"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621682049215"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name -&gt; UniqueMap TermUnique a -&gt; Maybe a
forall name unique a.
HasUnique name unique =&gt;
name -&gt; UniqueMap unique a -&gt; Maybe a
</span
	><a href="PlutusCore.Name.UniqueMap.html#lookupName"
	><span class="hs-identifier hs-var"
	  >UMap.lookupName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621682049214"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>UniqueMap TermUnique a
</span
	><a href="#local-6989586621682049212"
	><span class="hs-identifier hs-var"
	  >whitelist</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; Term name uni fun a -&gt; Term name uni fun a
forall name (uni :: * -&gt; *) fun ann.
ann -&gt; Term name uni fun ann -&gt; Term name uni fun ann
</span
	><a href="UntypedPlutusCore.Core.Type.html#Delay"
	><span class="hs-identifier hs-var"
	  >Delay</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621682049215"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049213"
	><span class="hs-identifier hs-var"
	  >var</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-130"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621682049217"
      ><span class="annot"
	><span class="annottext"
	  >Term name uni fun a
</span
	  ><a href="#local-6989586621682049217"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term name uni fun a
</span
	><a href="#local-6989586621682049217"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-131"
      ></span
      ><span
      >
</span
      ><span id="line-132"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- | Whether evaluating the given `Term` is pure and essentially work-free
(barring the CEK machine overhead).
-}</span
	></span
      ><span
      >
</span
      ><span id="line-135"
      ></span
      ><span
      >
</span
      ><span id="line-136"
      ></span
      ><span class="hs-comment"
      >--- This should be the erased version of 'PlutusIR.Transform.LetFloat.isEssentiallyWorkFree'.</span
      ><span
      >
</span
      ><span id="line-137"
      ></span
      ><span id="local-6989586621682049078"
      ><span id="local-6989586621682049079"
	><span id="local-6989586621682049080"
	  ><span id="local-6989586621682049081"
	    ><span class="annot"
	      ><a href="UntypedPlutusCore.Transform.FloatDelay.html#isEssentiallyWorkFree"
		><span class="hs-identifier hs-type"
		  >isEssentiallyWorkFree</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >::</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="UntypedPlutusCore.Core.Type.html#Term"
		><span class="hs-identifier hs-type"
		  >Term</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049078"
		><span class="hs-identifier hs-type"
		  >name</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049079"
		><span class="hs-identifier hs-type"
		  >uni</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049080"
		><span class="hs-identifier hs-type"
		  >fun</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="#local-6989586621682049081"
		><span class="hs-identifier hs-type"
		  >a</span
		  ></a
		></span
	      ><span
	      > </span
	      ><span class="hs-glyph"
	      >-&gt;</span
	      ><span
	      > </span
	      ><span class="annot"
	      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
		><span class="hs-identifier hs-type"
		  >Bool</span
		  ></a
		></span
	      ></span
	    ></span
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-138"
      ></span
      ><span id="isEssentiallyWorkFree"
      ><span class="annot"
	><span class="annottext"
	  >isEssentiallyWorkFree :: forall name (uni :: * -&gt; *) fun a. Term name uni fun a -&gt; Bool
</span
	  ><a href="UntypedPlutusCore.Transform.FloatDelay.html#isEssentiallyWorkFree"
	  ><span class="hs-identifier hs-var hs-var"
	    >isEssentiallyWorkFree</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-139"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-type"
	  >LamAbs</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >   </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-140"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Constant"
	><span class="hs-identifier hs-type"
	  >Constant</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-141"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Delay"
	><span class="hs-identifier hs-type"
	  >Delay</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-142"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Constr"
	><span class="hs-identifier hs-type"
	  >Constr</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >   </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-143"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Builtin"
	><span class="hs-identifier hs-type"
	  >Builtin</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-144"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >      </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-145"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Force"
	><span class="hs-identifier hs-type"
	  >Force</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-146"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- Unsaturated builtin applications should also be essentially work-free,</span
      ><span
      >
</span
      ><span id="line-147"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- but this is currently not implemented for UPLC.</span
      ><span
      >
</span
      ><span id="line-148"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- `UntypedPlutusCore.Transform.Inline.isPure` has the same problem.</span
      ><span
      >
</span
      ><span id="line-149"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Apply"
	><span class="hs-identifier hs-type"
	  >Apply</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-150"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Case"
	><span class="hs-identifier hs-type"
	  >Case</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >     </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-151"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="UntypedPlutusCore.Core.Type.html#Error"
	><span class="hs-identifier hs-type"
	  >Error</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-152"
      ></span
      ></pre
    ></body
  ></html
>

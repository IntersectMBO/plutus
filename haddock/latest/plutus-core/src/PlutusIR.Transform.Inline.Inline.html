<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE ConstraintKinds #-}</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE FlexibleContexts #-}</span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE GADTs #-}</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE LambdaCase #-}</span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TypeFamilies #-}</span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| An inlining pass of *non-recursive* bindings. It includes
(1) unconditional inlining: similar to `PreInlineUnconditionally` and `PostInlineUnconditionally`
in the paper 'Secrets of the GHC Inliner'.
(2) call site inlining of fully applied functions. See `Inline.CallSiteInline.hs` -}</span
	></span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusIR.Transform.Inline.Inline</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inline"
	><span class="hs-identifier"
	  >inline</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePass"
	><span class="hs-identifier"
	  >inlinePass</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePassSC"
	><span class="hs-identifier"
	  >inlinePassSC</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Annotation.html#InlineHints"
	><span class="hs-identifier"
	  >InlineHints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.html"
	><span class="hs-identifier"
	  >PlutusCore</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Annotation.html"
	><span class="hs-identifier"
	  >PlutusCore.Annotation</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-15"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html"
	><span class="hs-identifier"
	  >PlutusCore.Name.Unique</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-16"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Quote.html"
	><span class="hs-identifier"
	  >PlutusCore.Quote</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-17"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.html"
	><span class="hs-identifier"
	  >PlutusCore.Rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.html#dupable"
	><span class="hs-identifier"
	  >dupable</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-18"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.html"
	><span class="hs-identifier"
	  >PlutusIR</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-19"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Builtins.html"
	><span class="hs-identifier"
	  >PlutusIR.Analysis.Builtins</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-20"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Usages.html"
	><span class="hs-identifier"
	  >PlutusIR.Analysis.Usages</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Usages</span
	></span
      ><span
      >
</span
      ><span id="line-21"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.VarInfo.html"
	><span class="hs-identifier"
	  >PlutusIR.Analysis.VarInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>VarInfo</span
	></span
      ><span
      >
</span
      ><span id="line-22"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.AstSize.html"
	><span class="hs-identifier"
	  >PlutusIR.AstSize</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.AstSize.html#AstSize"
	><span class="hs-identifier"
	  >AstSize</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.AstSize.html#termAstSize"
	><span class="hs-identifier"
	  >termAstSize</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-23"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html"
	><span class="hs-identifier"
	  >PlutusIR.Contexts</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#fillAppContext"
	><span class="hs-identifier"
	  >fillAppContext</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#splitApplication"
	><span class="hs-identifier"
	  >splitApplication</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-24"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.MkPir.html"
	><span class="hs-identifier"
	  >PlutusIR.MkPir</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.MkPir.html#mkLet"
	><span class="hs-identifier"
	  >mkLet</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-25"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Pass.html"
	><span class="hs-identifier"
	  >PlutusIR.Pass</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-26"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.CallSiteInline.html"
	><span class="hs-identifier"
	  >PlutusIR.Transform.Inline.CallSiteInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.CallSiteInline.html#callSiteInline"
	><span class="hs-identifier"
	  >callSiteInline</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-27"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html"
	><span class="hs-identifier"
	  >PlutusIR.Transform.Inline.Utils</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-28"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Rename.html"
	><span class="hs-identifier"
	  >PlutusIR.Transform.Rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-29"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.TypeCheck.html"
	><span class="hs-identifier"
	  >PlutusIR.TypeCheck</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>TC</span
	></span
      ><span
      >
</span
      ><span id="line-30"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusPrelude.html"
	><span class="hs-identifier"
	  >PlutusPrelude</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-31"
      ></span
      ><span
      >
</span
      ><span id="line-32"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Control.Lens</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="hs-identifier"
	>forMOf</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>traverseOf</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-33"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/extra-1.8/docs/src/Control.Monad.Extra.html"
	><span class="hs-identifier"
	  >Control.Monad.Extra</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-34"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.Reader.html"
	><span class="hs-identifier"
	  >Control.Monad.Reader</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Reader.html#runReaderT"
	><span class="hs-identifier"
	  >runReaderT</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-35"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.html"
	><span class="hs-identifier"
	  >Control.Monad.State</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.State.Lazy.html#evalStateT"
	><span class="hs-identifier"
	  >evalStateT</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#modify%27"
	><span class="hs-identifier"
	  >modify'</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-36"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html"
	><span class="hs-identifier"
	  >Control.Monad.State.Class</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#gets"
	><span class="hs-identifier"
	  >gets</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-37"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Maybe.html"
	><span class="hs-identifier"
	  >Data.Maybe</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-38"
      ></span
      ><span
      >
</span
      ><span id="line-39"
      ></span
      ><span class="hs-comment"
      >{- Note [Inlining approach and 'Secrets of the GHC Inliner']
The approach we take is more-or-less exactly taken from 'Secrets of the GHC Inliner'.

Overall, the cause of differences is that we are largely trying to just clean up some
basic issues, not do serious optimization. In many cases we've already run the GHC simplifier
on our input!

We differ from the paper a few ways, mostly leaving things out:

Functionality
------------

Inlining recursive bindings: not worth it, complicated.

Context-based inlining: Not needed atm.

Also, GHC implements many different optimization in a single simplifier pass.
The paper focusses on inlining, but does so in the context of GHC's monolithic simplifier, which
includes beta reduction and deadcode elimination.
We have opted to have more, single-purpose passes. See e.g. `Deadcode.hs` and `Beta.hs` for other
passes.

Implementation
--------------

In-scope set: we don't bother keeping it atm.

Suspended substitutions ('SuspEx') for values: we don't need it, because we simplify the RHS before
preInlineUnconditional. For GHC, they can do more simplification in context, but they only want to
process the binding RHS once, so delaying it until the call site is better
if it's a single-occurrence term. But in our case it's fine to leave any improved in-context
simplification to later passes, so we don't need this complication.

Optimization after substituting in DoneExprs: we can't make different inlining decisions
contextually, so there's no point doing this.
-}</span
      ><span
      >
</span
      ><span id="line-75"
      ></span
      ><span
      >
</span
      ><span id="line-76"
      ></span
      ><span class="hs-comment"
      >{- Note [The problem of inlining destructors]
Destructors are *perfect* candidates for inlining:

1. They are *always* called fully-saturated, because they are created from pattern matches,
which always provide all the arguments.
2. They will reduce well after being inlined, since their bodies consist of just one argument
applied to the others.

Unfortunately, we can't inline them even after we've compiled datatypes, because compiled datatypes
look like this (see Note [Abstract data types]). Here's an example with Maybe:

(/\Maybe :: * -&gt; * .
  \Nothing :: forall a . Maybe a  .
  \Just :: forall a . a -&gt; Maybe .
  \match_Maybe : forall r . Maybe a -&gt; r -&gt; (a -&gt; r) -&gt; r .
    &lt;user term&gt;
)
-- defn of Maybe
{ \ a . forall r . r -&gt; (a -&gt; r) -&gt; r }
-- defn of Nothing
(/\ a . /\ r . \(nothing_case :: r) . \(just_case :: a -&gt; r) . nothing_case)
-- defn of Just
(/\ a . \(x : a) . /\ r . \(nothing_case :: r) . \(just_case :: a -&gt; r) . just_case x)
-- defn of match_Maybe
(/\ a . \(dt : forall r . r -&gt; (a -&gt; r) -&gt; r) . dt)

The definitions of the constructors/destructor don't look like let-bindings because there
is a type abstraction in between the lambdas and their arguments! And this abstraction
is important: the bodies of the constructors/destructor only typecheck if they are
\*outside* the type abstraction, because they fundamentally rely on knowing what the
type actually *is* in order to be able to construct/destruct it. e.g. for a Scott-encoded
type we actually need to know that the datatype is encoded as a matching function,
not just an abstract type. So we can't just put the definitions of the
constructors/destructor inside the type abstraction.

We *could* inline the datatype definition. That would get rid of the type abstraction,
letting us inline the constructors/destructor (by effectively making the datatype not
abstract inside the body). But this way lies madness: doing that consistently would
mean inlining the definitions of *all* datatypes, which would enormously (exponentially!)
bloat the types inside, making the typechecker (and everything else that processes the
AST) incredibly slow.

So it seems that we're stuck. We can't inline destructors in PIR.

But we *can* do it in UPLC! No types, so no problem. The type abstraction/instantiation will
turn into a delay/force pair and get simplified away, and then we have something that we can
inline. This is essentially the reason for the existence of the UPLC inlining pass.

Note that much the same reasoning applies to constructors also. The main difference
is that they might not be applied saturated, so it's not _always_ clear that we want to
inline them. But at least in UPLC we _can_ inline them.
-}</span
      ><span
      >
</span
      ><span id="line-128"
      ></span
      ><span
      >
</span
      ><span id="line-129"
      ></span
      ><span class="hs-comment"
      >{- Note [Inlining and global uniqueness]
Inlining relies on global uniqueness for two reasons:
1. We track various things in big maps keyed by unique. This is tricky without global
uniqueness, but very straightforward with it: since names are globally unique, we can
just use them as map keys and not worry about things.
2. You need global uniqueness to be able to do substitution without worrying about
avoiding variable capture.

Inlining things can break global uniqueness, because it can duplicate terms, and those
terms can have binders in them.

There are two ways to approach this:
1. Try to maintain global uniqueness
2. Carefully track which terms have been potentially duplicated, and make sure you never
do anything unsafe with them.

We could probably do 2, but it is tricky and requires subtle argumentation to establish
its safety.  On the other hand, it is actually very easy to do 1: just rename terms
when we substitute them in! This is much more obviously correct since it maintains the
global uniqueness invariant. The only cost is that we won't have any pre-computed
information about the fresh variables (e.g. usage counts), since we compute all that
up-front. But this can only bit us if we process the renamed terms (which we currently
don't), and the effect would only be slightly worse optimization.

Renaming everything is a bit overkill, it corresponds to 'The sledgehammer' in 'Secrets'.
But we don't really care about the costs listed there: it's easy for us to get a name
supply, and the performance cost does not currently seem relevant. So it's fine.
-}</span
      ><span
      >
</span
      ><span id="line-157"
      ></span
      ><span
      >
</span
      ><span id="line-158"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePassSC"
	><span class="hs-identifier hs-type"
	  >inlinePassSC</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-159"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488052"
      ><span class="annot"
	><a href="#local-6989586621679488052"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488053"
      ><span class="annot"
	><a href="#local-6989586621679488053"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488056"
      ><span class="annot"
	><a href="#local-6989586621679488056"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488059"
      ><span class="annot"
	><a href="#local-6989586621679488059"
	  ><span class="hs-identifier hs-type"
	    >m</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-160"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.TypeCheck.html#Typecheckable"
	><span class="hs-identifier hs-type"
	  >PLC.Typecheckable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488053"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/some-1.0.6/docs/src/Data.GADT.Internal.html#GEq"
	><span class="hs-identifier hs-type"
	  >PLC.GEq</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#Ord"
	><span class="hs-identifier hs-type"
	  >Ord</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#ExternalConstraints"
	><span class="hs-identifier hs-type"
	  >ExternalConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	><span class="hs-identifier hs-type"
	  >TyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488053"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488059"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-161"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.AstSize.html#AstSize"
	><span class="hs-identifier hs-type"
	  >AstSize</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-162"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ inline threshold</span
	></span
      ><span
      >
</span
      ><span id="line-163"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-164"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ should we inline constants?</span
	></span
      ><span
      >
</span
      ><span id="line-165"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Types.html#PirTCConfig"
	><span class="hs-identifier hs-type"
	  >TC.PirTCConfig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488053"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-166"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Annotation.html#InlineHints"
	><span class="hs-identifier hs-type"
	  >InlineHints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-167"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Builtins.html#BuiltinsInfo"
	><span class="hs-identifier hs-type"
	  >BuiltinsInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488053"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-168"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Pass.html#Pass"
	><span class="hs-identifier hs-type"
	  >Pass</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488059"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	><span class="hs-identifier hs-type"
	  >TyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488052"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488053"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-169"
      ></span
      ><span id="inlinePassSC"
      ><span class="annot"
	><span class="annottext"
	  >inlinePassSC :: forall (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
(Typecheckable uni fun, GEq uni, Ord ann,
 ExternalConstraints TyName Name uni fun m) =&gt;
AstSize
-&gt; Bool
-&gt; PirTCConfig uni fun
-&gt; InlineHints Name ann
-&gt; BuiltinsInfo uni fun
-&gt; Pass m TyName Name uni fun ann
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePassSC"
	  ><span class="hs-identifier hs-var hs-var"
	    >inlinePassSC</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488451"
      ><span class="annot"
	><span class="annottext"
	  >AstSize
</span
	  ><a href="#local-6989586621679488451"
	  ><span class="hs-identifier hs-var"
	    >thresh</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488452"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679488452"
	  ><span class="hs-identifier hs-var"
	    >ic</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488453"
      ><span class="annot"
	><span class="annottext"
	  >PirTCConfig uni fun
</span
	  ><a href="#local-6989586621679488453"
	  ><span class="hs-identifier hs-var"
	    >tcconfig</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488454"
      ><span class="annot"
	><span class="annottext"
	  >InlineHints Name ann
</span
	  ><a href="#local-6989586621679488454"
	  ><span class="hs-identifier hs-var"
	    >hints</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488455"
      ><span class="annot"
	><span class="annottext"
	  >BuiltinsInfo uni fun
</span
	  ><a href="#local-6989586621679488455"
	  ><span class="hs-identifier hs-var"
	    >binfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-170"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Pass m TyName Name uni fun ann
forall name tyname (m :: * -&gt; *) a (uni :: * -&gt; *) fun.
(HasUnique name TermUnique, HasUnique tyname TypeUnique,
 MonadQuote m, Ord a) =&gt;
Pass m tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#renamePass"
	><span class="hs-identifier hs-var"
	  >renamePass</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Pass m TyName Name uni fun ann
-&gt; Pass m TyName Name uni fun ann -&gt; Pass m TyName Name uni fun ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3C%3E"
	><span class="hs-operator hs-var"
	  >&lt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
-&gt; Bool
-&gt; PirTCConfig uni fun
-&gt; InlineHints Name ann
-&gt; BuiltinsInfo uni fun
-&gt; Pass m TyName Name uni fun ann
forall (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
(Typecheckable uni fun, GEq uni, Ord ann,
 ExternalConstraints TyName Name uni fun m) =&gt;
AstSize
-&gt; Bool
-&gt; PirTCConfig uni fun
-&gt; InlineHints Name ann
-&gt; BuiltinsInfo uni fun
-&gt; Pass m TyName Name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#inlinePass"
	><span class="hs-identifier hs-var"
	  >inlinePass</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
</span
	><a href="#local-6989586621679488451"
	><span class="hs-identifier hs-var"
	  >thresh</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679488452"
	><span class="hs-identifier hs-var"
	  >ic</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PirTCConfig uni fun
</span
	><a href="#local-6989586621679488453"
	><span class="hs-identifier hs-var"
	  >tcconfig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineHints Name ann
</span
	><a href="#local-6989586621679488454"
	><span class="hs-identifier hs-var"
	  >hints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinsInfo uni fun
</span
	><a href="#local-6989586621679488455"
	><span class="hs-identifier hs-var"
	  >binfo</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-171"
      ></span
      ><span
      >
</span
      ><span id="line-172"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePass"
	><span class="hs-identifier hs-type"
	  >inlinePass</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-173"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488457"
      ><span class="annot"
	><a href="#local-6989586621679488457"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488458"
      ><span class="annot"
	><a href="#local-6989586621679488458"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488459"
      ><span class="annot"
	><a href="#local-6989586621679488459"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488460"
      ><span class="annot"
	><a href="#local-6989586621679488460"
	  ><span class="hs-identifier hs-type"
	    >m</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-174"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.TypeCheck.html#Typecheckable"
	><span class="hs-identifier hs-type"
	  >PLC.Typecheckable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488458"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/some-1.0.6/docs/src/Data.GADT.Internal.html#GEq"
	><span class="hs-identifier hs-type"
	  >PLC.GEq</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#Ord"
	><span class="hs-identifier hs-type"
	  >Ord</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488459"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#ExternalConstraints"
	><span class="hs-identifier hs-type"
	  >ExternalConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	><span class="hs-identifier hs-type"
	  >TyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488458"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488460"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-175"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.AstSize.html#AstSize"
	><span class="hs-identifier hs-type"
	  >AstSize</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-176"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ inline threshold</span
	></span
      ><span
      >
</span
      ><span id="line-177"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-178"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ should we inline constants?</span
	></span
      ><span
      >
</span
      ><span id="line-179"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Compiler.Types.html#PirTCConfig"
	><span class="hs-identifier hs-type"
	  >TC.PirTCConfig</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488458"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-180"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Annotation.html#InlineHints"
	><span class="hs-identifier hs-type"
	  >InlineHints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488459"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-181"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Builtins.html#BuiltinsInfo"
	><span class="hs-identifier hs-type"
	  >BuiltinsInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488458"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-182"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Pass.html#Pass"
	><span class="hs-identifier hs-type"
	  >Pass</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488460"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#TyName"
	><span class="hs-identifier hs-type"
	  >TyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Name.Unique.html#Name"
	><span class="hs-identifier hs-type"
	  >Name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488457"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488458"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488459"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-183"
      ></span
      ><span id="inlinePass"
      ><span class="annot"
	><span class="annottext"
	  >inlinePass :: forall (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
(Typecheckable uni fun, GEq uni, Ord ann,
 ExternalConstraints TyName Name uni fun m) =&gt;
AstSize
-&gt; Bool
-&gt; PirTCConfig uni fun
-&gt; InlineHints Name ann
-&gt; BuiltinsInfo uni fun
-&gt; Pass m TyName Name uni fun ann
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#inlinePass"
	  ><span class="hs-identifier hs-var hs-var"
	    >inlinePass</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488478"
      ><span class="annot"
	><span class="annottext"
	  >AstSize
</span
	  ><a href="#local-6989586621679488478"
	  ><span class="hs-identifier hs-var"
	    >thresh</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488479"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679488479"
	  ><span class="hs-identifier hs-var"
	    >ic</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488480"
      ><span class="annot"
	><span class="annottext"
	  >PirTCConfig uni fun
</span
	  ><a href="#local-6989586621679488480"
	  ><span class="hs-identifier hs-var"
	    >tcconfig</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488481"
      ><span class="annot"
	><span class="annottext"
	  >InlineHints Name ann
</span
	  ><a href="#local-6989586621679488481"
	  ><span class="hs-identifier hs-var"
	    >hints</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488482"
      ><span class="annot"
	><span class="annottext"
	  >BuiltinsInfo uni fun
</span
	  ><a href="#local-6989586621679488482"
	  ><span class="hs-identifier hs-var"
	    >binfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-184"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>String
-&gt; Pass m TyName Name uni fun ann -&gt; Pass m TyName Name uni fun ann
forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun a.
String
-&gt; Pass m tyname name uni fun a -&gt; Pass m tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#NamedPass"
	><span class="hs-identifier hs-var"
	  >NamedPass</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String
</span
	><span class="hs-string"
	>&quot;inline&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Pass m TyName Name uni fun ann -&gt; Pass m TyName Name uni fun ann)
-&gt; Pass m TyName Name uni fun ann -&gt; Pass m TyName Name uni fun ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-185"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>(Term TyName Name uni fun ann -&gt; m (Term TyName Name uni fun ann))
-&gt; [Condition TyName Name uni fun ann]
-&gt; [BiCondition TyName Name uni fun ann]
-&gt; Pass m TyName Name uni fun ann
forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun a.
(Term tyname name uni fun a -&gt; m (Term tyname name uni fun a))
-&gt; [Condition tyname name uni fun a]
-&gt; [BiCondition tyname name uni fun a]
-&gt; Pass m tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#Pass"
	><span class="hs-identifier hs-var"
	  >Pass</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-186"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
-&gt; Bool
-&gt; InlineHints Name ann
-&gt; BuiltinsInfo uni fun
-&gt; Term TyName Name uni fun ann
-&gt; m (Term TyName Name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
ExternalConstraints tyname name uni fun m =&gt;
AstSize
-&gt; Bool
-&gt; InlineHints name ann
-&gt; BuiltinsInfo uni fun
-&gt; Term tyname name uni fun ann
-&gt; m (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#inline"
	><span class="hs-identifier hs-var"
	  >inline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
</span
	><a href="#local-6989586621679488478"
	><span class="hs-identifier hs-var"
	  >thresh</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679488479"
	><span class="hs-identifier hs-var"
	  >ic</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineHints Name ann
</span
	><a href="#local-6989586621679488481"
	><span class="hs-identifier hs-var"
	  >hints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinsInfo uni fun
</span
	><a href="#local-6989586621679488482"
	><span class="hs-identifier hs-var"
	  >binfo</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-187"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Condition TyName Name uni fun ann
forall tyname name a (uni :: * -&gt; *) fun.
(HasUnique tyname TypeUnique, HasUnique name TermUnique, Ord a) =&gt;
Condition tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#GloballyUniqueNames"
	><span class="hs-identifier hs-var"
	  >GloballyUniqueNames</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PirTCConfig uni fun -&gt; Condition TyName Name uni fun ann
forall (uni :: * -&gt; *) fun a.
(Typecheckable uni fun, GEq uni) =&gt;
PirTCConfig uni fun -&gt; Condition TyName Name uni fun a
</span
	><a href="PlutusIR.Pass.html#Typechecks"
	><span class="hs-identifier hs-var"
	  >Typechecks</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PirTCConfig uni fun
</span
	><a href="#local-6989586621679488480"
	><span class="hs-identifier hs-var"
	  >tcconfig</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-188"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Condition TyName Name uni fun ann
-&gt; BiCondition TyName Name uni fun ann
forall tyname name (uni :: * -&gt; *) fun a.
Condition tyname name uni fun a
-&gt; BiCondition tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#ConstCondition"
	><span class="hs-identifier hs-var"
	  >ConstCondition</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Condition TyName Name uni fun ann
forall tyname name a (uni :: * -&gt; *) fun.
(HasUnique tyname TypeUnique, HasUnique name TermUnique, Ord a) =&gt;
Condition tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#GloballyUniqueNames"
	><span class="hs-identifier hs-var"
	  >GloballyUniqueNames</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Condition TyName Name uni fun ann
-&gt; BiCondition TyName Name uni fun ann
forall tyname name (uni :: * -&gt; *) fun a.
Condition tyname name uni fun a
-&gt; BiCondition tyname name uni fun a
</span
	><a href="PlutusIR.Pass.html#ConstCondition"
	><span class="hs-identifier hs-var"
	  >ConstCondition</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>PirTCConfig uni fun -&gt; Condition TyName Name uni fun ann
forall (uni :: * -&gt; *) fun a.
(Typecheckable uni fun, GEq uni) =&gt;
PirTCConfig uni fun -&gt; Condition TyName Name uni fun a
</span
	><a href="PlutusIR.Pass.html#Typechecks"
	><span class="hs-identifier hs-var"
	  >Typechecks</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>PirTCConfig uni fun
</span
	><a href="#local-6989586621679488480"
	><span class="hs-identifier hs-var"
	  >tcconfig</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-189"
      ></span
      ><span
      >
</span
      ><span id="line-190"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Inline non-recursive bindings. Relies on global uniqueness, and preserves it.
See Note [Inlining and global uniqueness] -}</span
	></span
      ><span
      >
</span
      ><span id="line-192"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#inline"
	><span class="hs-identifier hs-type"
	  >inline</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-193"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488109"
      ><span class="annot"
	><a href="#local-6989586621679488109"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488110"
      ><span class="annot"
	><a href="#local-6989586621679488110"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488111"
      ><span class="annot"
	><a href="#local-6989586621679488111"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488112"
      ><span class="annot"
	><a href="#local-6989586621679488112"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488114"
      ><span class="annot"
	><a href="#local-6989586621679488114"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488113"
      ><span class="annot"
	><a href="#local-6989586621679488113"
	  ><span class="hs-identifier hs-type"
	    >m</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-194"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#ExternalConstraints"
	><span class="hs-identifier hs-type"
	  >ExternalConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488109"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488110"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488111"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488112"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488113"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-195"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.AstSize.html#AstSize"
	><span class="hs-identifier hs-type"
	  >AstSize</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-196"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ inline threshold</span
	></span
      ><span
      >
</span
      ><span id="line-197"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-198"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ should we inline constants?</span
	></span
      ><span
      >
</span
      ><span id="line-199"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Annotation.html#InlineHints"
	><span class="hs-identifier hs-type"
	  >InlineHints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488110"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488114"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-200"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Builtins.html#BuiltinsInfo"
	><span class="hs-identifier hs-type"
	  >BuiltinsInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488111"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488112"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-201"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488109"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488110"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488111"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488112"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488114"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-202"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488113"
	><span class="hs-identifier hs-type"
	  >m</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488109"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488110"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488111"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488112"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488114"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-203"
      ></span
      ><span id="inline"
      ><span class="annot"
	><span class="annottext"
	  >inline :: forall tyname name (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
ExternalConstraints tyname name uni fun m =&gt;
AstSize
-&gt; Bool
-&gt; InlineHints name ann
-&gt; BuiltinsInfo uni fun
-&gt; Term tyname name uni fun ann
-&gt; m (Term tyname name uni fun ann)
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#inline"
	  ><span class="hs-identifier hs-var hs-var"
	    >inline</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488507"
      ><span class="annot"
	><span class="annottext"
	  >AstSize
</span
	  ><a href="#local-6989586621679488507"
	  ><span class="hs-identifier hs-var"
	    >thresh</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488508"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679488508"
	  ><span class="hs-identifier hs-var"
	    >ic</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488509"
      ><span class="annot"
	><span class="annottext"
	  >InlineHints name ann
</span
	  ><a href="#local-6989586621679488509"
	  ><span class="hs-identifier hs-var"
	    >hints</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488510"
      ><span class="annot"
	><span class="annottext"
	  >BuiltinsInfo uni fun
</span
	  ><a href="#local-6989586621679488510"
	  ><span class="hs-identifier hs-var"
	    >binfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488511"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488511"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-204"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      >
</span
      ><span id="line-205"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679488512"
	><span class="hs-identifier hs-type"
	  >inlineInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineInfo"
	><span class="hs-identifier hs-type"
	  >InlineInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488109"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488110"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488111"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488112"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488114"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-206"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488512"
      ><span class="annot"
	><span class="annottext"
	  >inlineInfo :: InlineInfo tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488512"
	  ><span class="hs-identifier hs-var hs-var"
	    >inlineInfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarsInfo tyname name uni ann
-&gt; Usages
-&gt; InlineHints name ann
-&gt; BuiltinsInfo uni fun
-&gt; Bool
-&gt; AstSize
-&gt; InlineInfo tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
VarsInfo tyname name uni ann
-&gt; Usages
-&gt; InlineHints name ann
-&gt; BuiltinsInfo uni fun
-&gt; Bool
-&gt; AstSize
-&gt; InlineInfo tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#InlineInfo"
	><span class="hs-identifier hs-var"
	  >InlineInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarsInfo tyname name uni ann
</span
	><a href="#local-6989586621679488514"
	><span class="hs-identifier hs-var"
	  >vinfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Usages
</span
	><a href="#local-6989586621679488515"
	><span class="hs-identifier hs-var"
	  >usgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineHints name ann
</span
	><a href="#local-6989586621679488509"
	><span class="hs-identifier hs-var"
	  >hints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>BuiltinsInfo uni fun
</span
	><a href="#local-6989586621679488510"
	><span class="hs-identifier hs-var"
	  >binfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679488508"
	><span class="hs-identifier hs-var"
	  >ic</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
</span
	><a href="#local-6989586621679488507"
	><span class="hs-identifier hs-var"
	  >thresh</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-207"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488514"
      ><span class="annot"
	><span class="annottext"
	  >vinfo :: VarsInfo tyname name uni ann
</span
	  ><a href="#local-6989586621679488514"
	  ><span class="hs-identifier hs-var hs-var"
	    >vinfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann -&gt; VarsInfo tyname name uni ann
forall name tyname (uni :: * -&gt; *) fun a.
(HasUnique name TermUnique, HasUnique tyname TypeUnique) =&gt;
Term tyname name uni fun a -&gt; VarsInfo tyname name uni a
</span
	><a href="PlutusIR.Analysis.VarInfo.html#termVarInfo"
	><span class="hs-identifier hs-var"
	  >VarInfo.termVarInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488511"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-208"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679488515"
	><span class="hs-identifier hs-type"
	  >usgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Usages.html#Usages"
	><span class="hs-identifier hs-type"
	  >Usages.Usages</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-209"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488515"
      ><span class="annot"
	><span class="annottext"
	  >usgs :: Usages
</span
	  ><a href="#local-6989586621679488515"
	  ><span class="hs-identifier hs-var hs-var"
	    >usgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann -&gt; Usages
forall name tyname (uni :: * -&gt; *) fun a.
(HasUnique name TermUnique, HasUnique tyname TypeUnique) =&gt;
Term tyname name uni fun a -&gt; Usages
</span
	><a href="PlutusIR.Analysis.Usages.html#termUsages"
	><span class="hs-identifier hs-var"
	  >Usages.termUsages</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488511"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-210"
      ></span
      ><span
      >   </span
      ><span class="hs-keyword"
      >in</span
      ><span
      >
</span
      ><span id="line-211"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Quote (Term tyname name uni fun ann)
-&gt; m (Term tyname name uni fun ann)
forall a. Quote a -&gt; m a
forall (m :: * -&gt; *) a. MonadQuote m =&gt; Quote a -&gt; m a
</span
	><a href="../../plutus-core/src/PlutusCore.Quote.html#liftQuote"
	><span class="hs-identifier hs-var"
	  >liftQuote</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Quote (Term tyname name uni fun ann)
 -&gt; m (Term tyname name uni fun ann))
-&gt; Quote (Term tyname name uni fun ann)
-&gt; m (Term tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(StateT
   (InlinerState tyname name uni fun ann)
   (QuoteT Identity)
   (Term tyname name uni fun ann)
 -&gt; InlinerState tyname name uni fun ann
 -&gt; Quote (Term tyname name uni fun ann))
-&gt; InlinerState tyname name uni fun ann
-&gt; StateT
     (InlinerState tyname name uni fun ann)
     (QuoteT Identity)
     (Term tyname name uni fun ann)
-&gt; Quote (Term tyname name uni fun ann)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#flip"
	><span class="hs-identifier hs-var"
	  >flip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>StateT
  (InlinerState tyname name uni fun ann)
  (QuoteT Identity)
  (Term tyname name uni fun ann)
-&gt; InlinerState tyname name uni fun ann
-&gt; Quote (Term tyname name uni fun ann)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.State.Lazy.html#evalStateT"
	><span class="hs-identifier hs-var"
	  >evalStateT</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlinerState tyname name uni fun ann
forall a. Monoid a =&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#mempty"
	><span class="hs-identifier hs-var"
	  >mempty</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(StateT
   (InlinerState tyname name uni fun ann)
   (QuoteT Identity)
   (Term tyname name uni fun ann)
 -&gt; Quote (Term tyname name uni fun ann))
-&gt; StateT
     (InlinerState tyname name uni fun ann)
     (QuoteT Identity)
     (Term tyname name uni fun ann)
-&gt; Quote (Term tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ReaderT
   (InlineInfo tyname name uni fun ann)
   (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
   (Term tyname name uni fun ann)
 -&gt; InlineInfo tyname name uni fun ann
 -&gt; StateT
      (InlinerState tyname name uni fun ann)
      (QuoteT Identity)
      (Term tyname name uni fun ann))
-&gt; InlineInfo tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Term tyname name uni fun ann)
-&gt; StateT
     (InlinerState tyname name uni fun ann)
     (QuoteT Identity)
     (Term tyname name uni fun ann)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#flip"
	><span class="hs-identifier hs-var"
	  >flip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  (Term tyname name uni fun ann)
-&gt; InlineInfo tyname name uni fun ann
-&gt; StateT
     (InlinerState tyname name uni fun ann)
     (QuoteT Identity)
     (Term tyname name uni fun ann)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/transformers-0.6.1.0/docs/src/Control.Monad.Trans.Reader.html#runReaderT"
	><span class="hs-identifier hs-var"
	  >runReaderT</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineInfo tyname name uni fun ann
</span
	><a href="#local-6989586621679488512"
	><span class="hs-identifier hs-var"
	  >inlineInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(ReaderT
   (InlineInfo tyname name uni fun ann)
   (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
   (Term tyname name uni fun ann)
 -&gt; StateT
      (InlinerState tyname name uni fun ann)
      (QuoteT Identity)
      (Term tyname name uni fun ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Term tyname name uni fun ann)
-&gt; StateT
     (InlinerState tyname name uni fun ann)
     (QuoteT Identity)
     (Term tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488511"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-212"
      ></span
      ><span
      >
</span
      ><span id="line-213"
      ></span
      ><span class="hs-comment"
      >{- Note [Removing inlined bindings]
We *do* remove bindings that we inline *unconditionally*. We *could*
leave this to the dead code pass, but it's helpful to do it here.
We *don't* remove bindings that we inline at the call site.
Crucially, we have to do the same reasoning wrt strict bindings and purity
(see Note [Inlining and purity]):
we can only inline *pure* strict bindings, which is effectively the same as what we do in the dead
code pass.

Annoyingly, this requires us to redo the analysis that we do for the dead binding pass.
TODO: merge them or figure out a way to share more work, especially since there's similar logic.
This might mean reinventing GHC's OccAnal...
-}</span
      ><span
      >
</span
      ><span id="line-226"
      ></span
      ><span
      >
</span
      ><span id="line-227"
      ></span
      ><span class="hs-comment"
      >{- Note [Processing multi-lets]

When we process a term in the inliner, if it is a multi-let, we split it and process the
bindings one by one, because the bindings after `b` need to be considered to determine
whether `b` can be unconditionally inlined. Consider e.g.
`let !x = &lt;effectful&gt;; !y = &lt;effectful&gt; in x`, we need to look at the binding for
`y` to know that inlining `x` would change the order of effects.
It's awkward to do this when they are part of the same term, (we would be
looking at &quot;the let term but only considering all the bindings after x&quot;) and
much easier when they are just separate terms.
-}</span
      ><span
      >
</span
      ><span id="line-238"
      ></span
      ><span
      >
</span
      ><span id="line-239"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Run the inliner on a `Core.Type.Term`.</span
	></span
      ><span
      >
</span
      ><span id="line-240"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-type"
	  >processTerm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-241"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488174"
      ><span class="annot"
	><a href="#local-6989586621679488174"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488175"
      ><span class="annot"
	><a href="#local-6989586621679488175"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488176"
      ><span class="annot"
	><a href="#local-6989586621679488176"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488177"
      ><span class="annot"
	><a href="#local-6989586621679488177"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488179"
      ><span class="annot"
	><a href="#local-6989586621679488179"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-242"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-243"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-244"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ Term to be processed.</span
	></span
      ><span
      >
</span
      ><span id="line-245"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-246"
      ></span
      ><span id="processTerm"
      ><span class="annot"
	><span class="annottext"
	  >processTerm :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	  ><span class="hs-identifier hs-var hs-var"
	    >processTerm</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="#local-6989586621679488576"
	><span class="hs-identifier hs-var"
	  >handleTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; (Term tyname name uni fun ann
    -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#%3C%3D%3C"
	><span class="hs-operator hs-var"
	  >&lt;=&lt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity)))
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Type tyname uni ann)
  (Type tyname uni ann)
-&gt; LensLike
     (ReaderT
        (InlineInfo tyname name uni fun ann)
        (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity)))
     (Term tyname name uni fun ann)
     (Term tyname name uni fun ann)
     (Type tyname uni ann)
     (Type tyname uni ann)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span
	><span class="hs-identifier hs-var"
	>traverseOf</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity)))
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Type tyname uni ann)
  (Type tyname uni ann)
forall tyname name (uni :: * -&gt; *) fun a (f :: * -&gt; *).
Applicative f =&gt;
(Type tyname uni a -&gt; f (Type tyname uni a))
-&gt; Term tyname name uni fun a -&gt; f (Term tyname name uni fun a)
</span
	><a href="PlutusIR.Core.Plated.html#termSubtypes"
	><span class="hs-identifier hs-var"
	  >termSubtypes</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Type tyname uni ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Type tyname uni ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#applyTypeSubstitution"
	><span class="hs-identifier hs-var"
	  >applyTypeSubstitution</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-247"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-248"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679488576"
	><span class="hs-identifier hs-type"
	  >handleTerm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-249"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-250"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-251"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488576"
      ><span class="annot"
	><span class="annottext"
	  >handleTerm :: Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	  ><a href="#local-6989586621679488576"
	  ><span class="hs-identifier hs-var hs-var"
	    >handleTerm</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-252"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679488580"
      ><span class="annot"
	><span class="annottext"
	  >v :: Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488580"
	  ><span class="hs-identifier hs-var"
	    >v</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488582"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679488582"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
forall a. a -&gt; Maybe a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Maybe.html#fromMaybe"
	><span class="hs-identifier hs-var"
	  >fromMaybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488580"
	><span class="hs-identifier hs-var"
	  >v</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Term tyname name uni fun ann)
 -&gt; Term tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe (Term tyname name uni fun ann))
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe (Term tyname name uni fun ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
name
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#substName"
	><span class="hs-identifier hs-var"
	  >substName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488582"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-253"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Let"
	><span class="hs-identifier hs-type"
	  >Let</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488587"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488587"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#NonRec"
	><span class="hs-identifier hs-var"
	  >NonRec</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488589"
      ><span class="annot"
	><span class="annottext"
	  >NonEmpty (Binding tyname name uni fun ann)
</span
	  ><a href="#local-6989586621679488589"
	  ><span class="hs-identifier hs-var"
	    >bs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488590"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488590"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>NonEmpty (Binding tyname name uni fun ann)
</span
	><a href="#local-6989586621679488589"
	><span class="hs-identifier hs-var"
	  >bs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-254"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679488591"
      ><span class="annot"
	><span class="annottext"
	  >Binding tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488591"
	  ><span class="hs-identifier hs-var"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3A%7C"
	><span class="hs-operator hs-type"
	  >:|</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-255"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Process the binding, eliminating it if it will be inlined unconditionally,</span
      ><span
      >
</span
      ><span id="line-256"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- and accumulating the new substitutions.</span
      ><span
      >
</span
      ><span id="line-257"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- See Note [Removing inlined bindings]</span
      ><span
      >
</span
      ><span id="line-258"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Note that we don't *remove* the binding or scope the state, so the state will</span
      ><span
      >
</span
      ><span id="line-259"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- carry over into &quot;sibling&quot; terms. This is fine because we have global uniqueness</span
      ><span
      >
</span
      ><span id="line-260"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- (see Note [Inlining and global uniqueness]), if somewhat wasteful.</span
      ><span
      >
</span
      ><span id="line-261"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679488593"
      ><span class="annot"
	><span class="annottext"
	  >Maybe (Binding tyname name uni fun ann)
</span
	  ><a href="#local-6989586621679488593"
	  ><span class="hs-identifier hs-var"
	    >b'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Binding tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; Binding tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processSingleBinding"
	><span class="hs-identifier hs-var"
	  >processSingleBinding</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488590"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
</span
	><a href="#local-6989586621679488591"
	><span class="hs-identifier hs-var"
	  >b</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-262"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679488595"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488595"
	  ><span class="hs-identifier hs-var"
	    >t'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488590"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-263"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Use 'mkLet': which takes a possibly empty list of bindings (rather than</span
      ><span
      >
</span
      ><span id="line-264"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- a non-empty list)</span
      ><span
      >
</span
      ><span id="line-265"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Recursivity
-&gt; [Binding tyname name uni fun ann]
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall a tyname name (uni :: * -&gt; *) fun.
a
-&gt; Recursivity
-&gt; [Binding tyname name uni fun a]
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.MkPir.html#mkLet"
	><span class="hs-identifier hs-var"
	  >mkLet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488587"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#NonRec"
	><span class="hs-identifier hs-var"
	  >NonRec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
-&gt; [Binding tyname name uni fun ann]
forall a. Maybe a -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Maybe.html#maybeToList"
	><span class="hs-identifier hs-var"
	  >maybeToList</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
</span
	><a href="#local-6989586621679488593"
	><span class="hs-identifier hs-var"
	  >b'</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488595"
	><span class="hs-identifier hs-var"
	  >t'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-266"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- See Note [Processing multi-lets]</span
      ><span
      >
</span
      ><span id="line-267"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679488597"
      ><span class="annot"
	><span class="annottext"
	  >Binding tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488597"
	  ><span class="hs-identifier hs-var"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3A%7C"
	><span class="hs-operator hs-type"
	  >:|</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488598"
      ><span class="annot"
	><span class="annottext"
	  >[Binding tyname name uni fun ann]
</span
	  ><a href="#local-6989586621679488598"
	  ><span class="hs-identifier hs-var"
	    >rest</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="#local-6989586621679488576"
	><span class="hs-identifier hs-var"
	  >handleTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Recursivity
-&gt; NonEmpty (Binding tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Recursivity
-&gt; NonEmpty (Binding tyname name uni fun a)
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#Let"
	><span class="hs-identifier hs-var"
	  >Let</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488587"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#NonRec"
	><span class="hs-identifier hs-var"
	  >NonRec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
-&gt; NonEmpty (Binding tyname name uni fun ann)
forall a. a -&gt; NonEmpty a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
</span
	><a href="#local-6989586621679488597"
	><span class="hs-identifier hs-var"
	  >b</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Recursivity
-&gt; [Binding tyname name uni fun ann]
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall a tyname name (uni :: * -&gt; *) fun.
a
-&gt; Recursivity
-&gt; [Binding tyname name uni fun a]
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span
	><a href="PlutusIR.MkPir.html#mkLet"
	><span class="hs-identifier hs-var"
	  >mkLet</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488587"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Recursivity
</span
	><a href="PlutusIR.Core.Type.html#NonRec"
	><span class="hs-identifier hs-var"
	  >NonRec</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Binding tyname name uni fun ann]
</span
	><a href="#local-6989586621679488598"
	><span class="hs-identifier hs-var"
	  >rest</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488590"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-268"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- This includes recursive let terms, we don't even consider inlining them at the moment</span
      ><span
      >
</span
      ><span id="line-269"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679488599"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488599"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-270"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- See Note [Processing order of call site inlining]</span
      ><span
      >
</span
      ><span id="line-271"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679488600"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488600"
	  ><span class="hs-identifier hs-var"
	    >hd</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679488601"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488601"
	  ><span class="hs-identifier hs-var"
	    >args</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; (Term tyname name uni fun ann,
    AppContext tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann
-&gt; (Term tyname name uni fun ann,
    AppContext tyname name uni fun ann)
</span
	><a href="PlutusIR.Contexts.html#splitApplication"
	><span class="hs-identifier hs-var"
	  >splitApplication</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488599"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-272"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-type"
	  >processArgs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-273"
      ></span
      ><span
      >              </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier hs-type"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-274"
      ></span
      ><span
      >              </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier hs-type"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488174"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488175"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488176"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488177"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488179"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-275"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679488602"
      ><span class="annot"
	><span class="annottext"
	  >processArgs :: AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
</span
	  ><a href="#local-6989586621679488602"
	  ><span class="hs-identifier hs-var hs-var"
	    >processArgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TermAppContext"
	><span class="hs-identifier hs-type"
	  >TermAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488604"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488604"
	  ><span class="hs-identifier hs-var"
	    >arg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488605"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488605"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488606"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488606"
	  ><span class="hs-identifier hs-var"
	    >ctx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-276"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621679488607"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488607"
	  ><span class="hs-identifier hs-var"
	    >processedArg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488604"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-277"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621679488608"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488608"
	  ><span class="hs-identifier hs-var"
	    >processedArgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
</span
	><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-var"
	  >processArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488606"
	><span class="hs-identifier hs-var"
	  >ctx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-278"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(AppContext tyname name uni fun ann
 -&gt; InlineM
      tyname name uni fun ann (AppContext tyname name uni fun ann))
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ann
-&gt; AppContext tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann
-&gt; ann
-&gt; AppContext tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#TermAppContext"
	><span class="hs-identifier hs-var"
	  >TermAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488607"
	><span class="hs-identifier hs-var"
	  >processedArg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488605"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488608"
	><span class="hs-identifier hs-var"
	  >processedArgs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-279"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-var"
	  >processArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TypeAppContext"
	><span class="hs-identifier hs-type"
	  >TypeAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488610"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679488610"
	  ><span class="hs-identifier hs-var"
	    >ty</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488611"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488611"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488612"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488612"
	  ><span class="hs-identifier hs-var"
	    >ctx</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-280"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621679488613"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488613"
	  ><span class="hs-identifier hs-var"
	    >processedArgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
</span
	><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-var"
	  >processArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488612"
	><span class="hs-identifier hs-var"
	  >ctx</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-281"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621679488614"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679488614"
	  ><span class="hs-identifier hs-var"
	    >ty'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Type tyname uni ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Type tyname uni ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#applyTypeSubstitution"
	><span class="hs-identifier hs-var"
	  >applyTypeSubstitution</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488610"
	><span class="hs-identifier hs-var"
	  >ty</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-282"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(AppContext tyname name uni fun ann
 -&gt; InlineM
      tyname name uni fun ann (AppContext tyname name uni fun ann))
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
-&gt; ann
-&gt; AppContext tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Type tyname uni ann
-&gt; ann
-&gt; AppContext tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#TypeAppContext"
	><span class="hs-identifier hs-var"
	  >TypeAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488614"
	><span class="hs-identifier hs-var"
	  >ty'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488611"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488613"
	><span class="hs-identifier hs-var"
	  >processedArgs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-283"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-var"
	  >processArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#AppContextEnd"
	><span class="hs-identifier hs-var"
	  >AppContextEnd</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
AppContext tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#AppContextEnd"
	><span class="hs-identifier hs-var"
	  >AppContextEnd</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-284"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488601"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-285"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- not really an application, so hd is the term itself. Processing it will loop.</span
      ><span
      >
</span
      ><span id="line-286"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#AppContextEnd"
	><span class="hs-identifier hs-var"
	  >AppContextEnd</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WrappedMonad
     (ReaderT
        (InlineInfo tyname name uni fun ann)
        (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))))
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
-&gt; (Term tyname name uni fun ann
    -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall (m :: * -&gt; *) s t a b.
LensLike (WrappedMonad m) s t a b -&gt; s -&gt; (a -&gt; m b) -&gt; m t
</span
	><span class="hs-identifier hs-var"
	>forMOf</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WrappedMonad
     (ReaderT
        (InlineInfo tyname name uni fun ann)
        (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))))
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun a (f :: * -&gt; *).
Applicative f =&gt;
(Term tyname name uni fun a -&gt; f (Term tyname name uni fun a))
-&gt; Term tyname name uni fun a -&gt; f (Term tyname name uni fun a)
</span
	><a href="PlutusIR.Core.Plated.html#termSubterms"
	><span class="hs-identifier hs-var"
	  >termSubterms</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488599"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-287"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-288"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679488617"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488617"
	  ><span class="hs-identifier hs-var"
	    >hd'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488600"
	><span class="hs-identifier hs-var"
	  >hd</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-289"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679488618"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488618"
	  ><span class="hs-identifier hs-var"
	    >args'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (AppContext tyname name uni fun ann)
</span
	><a href="#local-6989586621679488602"
	><span class="hs-identifier hs-var"
	  >processArgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488601"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-290"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679488619"
      ><span class="annot"
	><span class="annottext"
	  >reconstructed :: Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488619"
	  ><span class="hs-identifier hs-var hs-var"
	    >reconstructed</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#fillAppContext"
	><span class="hs-identifier hs-var"
	  >fillAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488617"
	><span class="hs-identifier hs-var"
	  >hd'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488618"
	><span class="hs-identifier hs-var"
	  >args'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-291"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488617"
	><span class="hs-identifier hs-var"
	  >hd'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-292"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Var"
	><span class="hs-identifier hs-type"
	  >Var</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488620"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679488620"
	  ><span class="hs-identifier hs-var"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-293"
      ></span
      ><span
      >                </span
      ><span class="annot"
      ><span class="annottext"
	>(InlinerState tyname name uni fun ann
 -&gt; Maybe (InlineVarInfo tyname name uni fun ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe (InlineVarInfo tyname name uni fun ann))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#gets"
	><span class="hs-identifier hs-var"
	  >gets</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>name
-&gt; InlinerState tyname name uni fun ann
-&gt; Maybe (InlineVarInfo tyname name uni fun ann)
forall name tyname (uni :: * -&gt; *) fun ann.
HasUnique name TermUnique =&gt;
name
-&gt; InlinerState tyname name uni fun ann
-&gt; Maybe (InlineVarInfo tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#lookupVarInfo"
	><span class="hs-identifier hs-var"
	  >lookupVarInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488620"
	><span class="hs-identifier hs-var"
	  >name</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  (Maybe (InlineVarInfo tyname name uni fun ann))
-&gt; (Maybe (InlineVarInfo tyname name uni fun ann)
    -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a b.
ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  a
-&gt; (a
    -&gt; ReaderT
         (InlineInfo tyname name uni fun ann)
         (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
         b)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3E%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-294"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488622"
      ><span class="annot"
	><span class="annottext"
	  >InlineVarInfo tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488622"
	  ><span class="hs-identifier hs-var"
	    >varInfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-295"
      ></span
      ><span
      >                    </span
      ><span id="local-6989586621679488623"
      ><span class="annot"
	><span class="annottext"
	  >Maybe (Term tyname name uni fun ann)
</span
	  ><a href="#local-6989586621679488623"
	  ><span class="hs-identifier hs-var"
	    >maybeInlined</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      >
</span
      ><span id="line-296"
      ></span
      ><span
      >                      </span
      ><span class="annot"
      ><span class="annottext"
	>AstSize
-&gt; InlineVarInfo tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe (Term tyname name uni fun ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
AstSize
-&gt; InlineVarInfo tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="PlutusIR.Transform.Inline.CallSiteInline.html#callSiteInline"
	><span class="hs-identifier hs-var"
	  >callSiteInline</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-297"
      ></span
      ><span
      >                        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann -&gt; AstSize
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann -&gt; AstSize
</span
	><a href="PlutusIR.AstSize.html#termAstSize"
	><span class="hs-identifier hs-var"
	  >termAstSize</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488619"
	><span class="hs-identifier hs-var"
	  >reconstructed</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-298"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann
</span
	><a href="#local-6989586621679488622"
	><span class="hs-identifier hs-var"
	  >varInfo</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-299"
      ></span
      ><span
      >                        </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679488618"
	><span class="hs-identifier hs-var"
	  >args'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-300"
      ></span
      ><span
      >                    </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann))
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
forall a. a -&gt; Maybe a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Maybe.html#fromMaybe"
	><span class="hs-identifier hs-var"
	  >fromMaybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488619"
	><span class="hs-identifier hs-var"
	  >reconstructed</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
</span
	><a href="#local-6989586621679488623"
	><span class="hs-identifier hs-var"
	  >maybeInlined</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-301"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (InlineVarInfo tyname name uni fun ann)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488619"
	><span class="hs-identifier hs-var"
	  >reconstructed</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-302"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488619"
	><span class="hs-identifier hs-var"
	  >reconstructed</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-303"
      ></span
      ><span
      >
</span
      ><span id="line-304"
      ></span
      ><span class="hs-comment"
      >{- Note [Processing order of call site inlining]
We have two options on how we process terms for the call site inliner:

1. process the subterms first, then go up each node
2. process the whole term first, then process the subterms

Depending on which option we choose we get different results after one `inline` pass. For example:

For the `letFunConstMulti` test:

let
  constFun :: Integer -&gt; Integer -&gt; Integer
  constFun = \x y -&gt; x
in  constFun (constFun 3 5)

With option 1, we first look at the subterms `constFun 3` and `5`. The application of `constFun` to
3 is safe, so it is applied and beta reduced, turning

constFun (constFun 3 5) to constFun ((\y -&gt; 3) 5)

Then, we look at the term constFun ((\y -&gt; 3) 5). I.e., application of constFun to ((\y -&gt; 3) 5).
Because the argument ((\y -&gt; 3) 5) is an application, it is considered unsafe.
So no application applies here and the golden file returns:

let
  constFun :: Integer -&gt; Integer -&gt; Integer
  constFun = \x y -&gt; x
in  constFun ((\y -&gt; 3) 5)

With option 2, we first look at `constFun (constFun 3 5)`. The application of constFun to
(constFun 3 5) is unsafe because the argument (constFun 3 5) is an application.
So no application applies here and we move on to the subterm (constFun 3 5). Application of constFun
3 to the argument 5 is safe. Thus

constFun 3 5 ==&gt; (((\x y -&gt; x) 3) 5) ==&gt; (\x -&gt; x) 3 and again application of 3 is safe and is
applied and beta reduced to 3.

So in this case, we get more reduction in 1 pass with option 2. However, in some cases we get
more reduction in 1 pass with option 1. Consider the `letOverAppMulti` test case (with unconditional
inlining already done):

let
    idFun :: Integer -&gt; Integer
    idFun = \y -&gt; y
    k :: (Integer -&gt; Integer) -&gt; (Integer -&gt; Integer)
    k = \x -&gt; idFun
in (k (k idFun)) 6

With option 1, we look at the subterms (k idFun) and 6 first. The argument idFun is a variable that
is safe to beta reduce, so

k idFun reduces to (\x -&gt; idFun) idFun which reduces to idFun

Now we have the term k idFun 6. Applying k to idFun is safe so it is reduced to idFun. idFun 6
reduces to 6.

With option 2, we look at the whole term (k (k idFun)) 6. The argument (k idFun) is an application
and thus it is unsafe. No inlining happens here. Then we look at the subterm (k idFun), again it can
be reduced to idFun and we have

let
    idFun :: Integer -&gt; Integer
    idFun = \y -&gt; y
    k :: (Integer -&gt; Integer) -&gt; (Integer -&gt; Integer)
    k = \x -&gt; idFun
in (k idFun) 6

in the golden file in 1 inline pass.

We can see from this eg that we are not reducing as much because the arguments are unsafe,
frequently because they are applications. So if we process the arguments first, then we will be
reducing the most in 1 pass. Thus, how we process the terms is actually the third option:

First, split the term into an application context. Then, process the head and arguments of the
application context. If the head is a variable, consider call site inlining, starting with the whole
term, but with the head (the rhs of the variable) and the arguments already processed.

-}</span
      ><span
      >
</span
      ><span id="line-382"
      ></span
      ><span
      >
</span
      ><span id="line-383"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Run the inliner on a single non-recursive let binding.</span
	></span
      ><span
      >
</span
      ><span id="line-384"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#processSingleBinding"
	><span class="hs-identifier hs-type"
	  >processSingleBinding</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-385"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488240"
      ><span class="annot"
	><a href="#local-6989586621679488240"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488241"
      ><span class="annot"
	><a href="#local-6989586621679488241"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488242"
      ><span class="annot"
	><a href="#local-6989586621679488242"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488243"
      ><span class="annot"
	><a href="#local-6989586621679488243"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488244"
      ><span class="annot"
	><a href="#local-6989586621679488244"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-386"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488240"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488241"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488242"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488243"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-387"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488240"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488241"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488242"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488243"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488244"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-388"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ The body of the let binding.</span
	></span
      ><span
      >
</span
      ><span id="line-389"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Binding"
	><span class="hs-identifier hs-type"
	  >Binding</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488240"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488241"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488242"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488243"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488244"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-390"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ The binding.</span
	></span
      ><span
      >
</span
      ><span id="line-391"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488240"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488241"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488242"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488243"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488244"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Binding"
	><span class="hs-identifier hs-type"
	  >Binding</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488240"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488241"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488242"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488243"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488244"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-392"
      ></span
      ><span id="processSingleBinding"
      ><span class="annot"
	><span class="annottext"
	  >processSingleBinding :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; Binding tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#processSingleBinding"
	  ><span class="hs-identifier hs-var hs-var"
	    >processSingleBinding</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488649"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488649"
	  ><span class="hs-identifier hs-var"
	    >body</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-393"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#TermBind"
	><span class="hs-identifier hs-type"
	  >TermBind</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488651"
      ><span class="annot"
	><span class="annottext"
	  >Strictness
</span
	  ><a href="#local-6989586621679488651"
	  ><span class="hs-identifier hs-var"
	    >s</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488652"
      ><span class="annot"
	><span class="annottext"
	  >v :: VarDecl tyname name uni ann
</span
	  ><a href="#local-6989586621679488652"
	  ><span class="hs-identifier hs-var"
	    >v</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#VarDecl"
	><span class="hs-identifier hs-type"
	  >VarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488654"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488654"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488655"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679488655"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span id="local-6989586621679488656"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488656"
	  ><span class="hs-identifier hs-var"
	    >rhs0</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-394"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- we want to do unconditional inline if possible</span
      ><span
      >
</span
      ><span id="line-395"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ann
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; ann
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddSubst"
	><span class="hs-identifier hs-var"
	  >maybeAddSubst</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488649"
	><span class="hs-identifier hs-var"
	  >body</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488654"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
</span
	><a href="#local-6989586621679488651"
	><span class="hs-identifier hs-var"
	  >s</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488655"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488656"
	><span class="hs-identifier hs-var"
	  >rhs0</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineM
  tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
-&gt; (Maybe (Term tyname name uni fun ann)
    -&gt; InlineM
         tyname name uni fun ann (Maybe (Binding tyname name uni fun ann)))
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a b.
ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  a
-&gt; (a
    -&gt; ReaderT
         (InlineInfo tyname name uni fun ann)
         (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
         b)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3E%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-396"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- this binding is going to be unconditionally inlined</span
      ><span
      >
</span
      ><span id="line-397"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-398"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488658"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488658"
	  ><span class="hs-identifier hs-var"
	    >rhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-399"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- when we encounter a binding, we add it to</span
      ><span
      >
</span
      ><span id="line-400"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- the global map `Utils.NonRecInScopeSet`.</span
      ><span
      >
</span
      ><span id="line-401"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- The `varRhs` added to the map has been unconditionally inlined.</span
      ><span
      >
</span
      ><span id="line-402"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- When we check the body of the let binding we look in this map for</span
      ><span
      >
</span
      ><span id="line-403"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- call site inlining.</span
      ><span
      >
</span
      ><span id="line-404"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- We don't remove the binding because we decide *at the call site*</span
      ><span
      >
</span
      ><span id="line-405"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- whether we want to inline, and it may be called more than once.</span
      ><span
      >
</span
      ><span id="line-406"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>(InlinerState tyname name uni fun ann
 -&gt; InlinerState tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span
	><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#modify%27"
	><span class="hs-identifier hs-var"
	  >modify'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((InlinerState tyname name uni fun ann
  -&gt; InlinerState tyname name uni fun ann)
 -&gt; ReaderT
      (InlineInfo tyname name uni fun ann)
      (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
      ())
-&gt; (InlinerState tyname name uni fun ann
    -&gt; InlinerState tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-407"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>name
-&gt; InlineVarInfo tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
forall name tyname (uni :: * -&gt; *) fun ann.
HasUnique name TermUnique =&gt;
name
-&gt; InlineVarInfo tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#extendVarInfo"
	><span class="hs-identifier hs-var"
	  >extendVarInfo</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-408"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488655"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-409"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- no need to rename here when we enter the rhs into the map. Renaming needs</span
      ><span
      >
</span
      ><span id="line-410"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- to be done at each call site, because each substituted instance has to</span
      ><span
      >
</span
      ><span id="line-411"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- have unique names</span
      ><span
      >
</span
      ><span id="line-412"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
-&gt; InlineTerm tyname name uni fun ann
-&gt; InlineVarInfo tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Strictness
-&gt; InlineTerm tyname name uni fun ann
-&gt; InlineVarInfo tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#MkVarInfo"
	><span class="hs-identifier hs-var"
	  >MkVarInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
</span
	><a href="#local-6989586621679488651"
	><span class="hs-identifier hs-var"
	  >s</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#Done"
	><span class="hs-identifier hs-var"
	  >Done</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Dupable (Term tyname name uni fun ann)
forall a. a -&gt; Dupable a
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#dupable"
	><span class="hs-identifier hs-var"
	  >dupable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488658"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-413"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Binding tyname name uni fun ann)
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Binding tyname name uni fun ann)))
-&gt; Maybe (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
-&gt; Maybe (Binding tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Binding tyname name uni fun ann
 -&gt; Maybe (Binding tyname name uni fun ann))
-&gt; Binding tyname name uni fun ann
-&gt; Maybe (Binding tyname name uni fun ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; Strictness
-&gt; VarDecl tyname name uni ann
-&gt; Term tyname name uni fun ann
-&gt; Binding tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#TermBind"
	><span class="hs-identifier hs-var"
	  >TermBind</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488654"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
</span
	><a href="#local-6989586621679488651"
	><span class="hs-identifier hs-var"
	  >s</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>VarDecl tyname name uni ann
</span
	><a href="#local-6989586621679488652"
	><span class="hs-identifier hs-var"
	  >v</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488658"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-414"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#TypeBind"
	><span class="hs-identifier hs-type"
	  >TypeBind</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488663"
      ><span class="annot"
	><span class="annottext"
	  >v :: TyVarDecl tyname ann
</span
	  ><a href="#local-6989586621679488663"
	  ><span class="hs-identifier hs-var"
	    >v</span
	    ></a
	  ></span
	></span
      ><span class="hs-glyph"
      >@</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#TyVarDecl"
	><span class="hs-identifier hs-type"
	  >TyVarDecl</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679488665"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488665"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488666"
      ><span class="annot"
	><span class="annottext"
	  >tyname
</span
	  ><a href="#local-6989586621679488666"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Kind ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span id="local-6989586621679488667"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679488667"
	  ><span class="hs-identifier hs-var"
	    >rhs</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-415"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488668"
      ><span class="annot"
	><span class="annottext"
	  >Maybe (Type tyname uni ann)
</span
	  ><a href="#local-6989586621679488668"
	  ><span class="hs-identifier hs-var"
	    >maybeRhs'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
-&gt; Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
tyname
-&gt; Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddTySubst"
	><span class="hs-identifier hs-var"
	  >maybeAddTySubst</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679488666"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488667"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-416"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Binding tyname name uni fun ann)
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Binding tyname name uni fun ann)))
-&gt; Maybe (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
-&gt; TyVarDecl tyname ann
-&gt; Type tyname uni ann
-&gt; Binding tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span
	><a href="PlutusIR.Core.Type.html#TypeBind"
	><span class="hs-identifier hs-var"
	  >TypeBind</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488665"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>TyVarDecl tyname ann
</span
	><a href="#local-6989586621679488663"
	><span class="hs-identifier hs-var"
	  >v</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type tyname uni ann -&gt; Binding tyname name uni fun ann)
-&gt; Maybe (Type tyname uni ann)
-&gt; Maybe (Binding tyname name uni fun ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
</span
	><a href="#local-6989586621679488668"
	><span class="hs-identifier hs-var"
	  >maybeRhs'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-417"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679488670"
      ><span class="annot"
	><span class="annottext"
	  >Binding tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488670"
	  ><span class="hs-identifier hs-var"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-418"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Just process all the subterms</span
      ><span
      >
</span
      ><span id="line-419"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
-&gt; Maybe (Binding tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Binding tyname name uni fun ann
 -&gt; Maybe (Binding tyname name uni fun ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Binding tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Binding tyname name uni fun ann))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WrappedMonad
     (ReaderT
        (InlineInfo tyname name uni fun ann)
        (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))))
  (Binding tyname name uni fun ann)
  (Binding tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
-&gt; Binding tyname name uni fun ann
-&gt; (Term tyname name uni fun ann
    -&gt; ReaderT
         (InlineInfo tyname name uni fun ann)
         (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
         (Term tyname name uni fun ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Binding tyname name uni fun ann)
forall (m :: * -&gt; *) s t a b.
LensLike (WrappedMonad m) s t a b -&gt; s -&gt; (a -&gt; m b) -&gt; m t
</span
	><span class="hs-identifier hs-var"
	>forMOf</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>LensLike
  (WrappedMonad
     (ReaderT
        (InlineInfo tyname name uni fun ann)
        (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))))
  (Binding tyname name uni fun ann)
  (Binding tyname name uni fun ann)
  (Term tyname name uni fun ann)
  (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun a (f :: * -&gt; *).
Applicative f =&gt;
(Term tyname name uni fun a -&gt; f (Term tyname name uni fun a))
-&gt; Binding tyname name uni fun a
-&gt; f (Binding tyname name uni fun a)
</span
	><a href="PlutusIR.Core.Plated.html#bindingSubterms"
	><span class="hs-identifier hs-var"
	  >bindingSubterms</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Binding tyname name uni fun ann
</span
	><a href="#local-6989586621679488670"
	><span class="hs-identifier hs-var"
	  >b</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-420"
      ></span
      ><span
      >
</span
      ><span id="line-421"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Check against the heuristics we have for inlining and either inline the term binding or not.
The arguments to this function are the fields of the `TermBinding` being processed.
Nothing means that we are inlining the term:
  * we have extended the substitution, and
  * we are removing the binding (hence we return Nothing). -}</span
	></span
      ><span
      >
</span
      ><span id="line-426"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddSubst"
	><span class="hs-identifier hs-type"
	  >maybeAddSubst</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-427"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488314"
      ><span class="annot"
	><a href="#local-6989586621679488314"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488315"
      ><span class="annot"
	><a href="#local-6989586621679488315"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488316"
      ><span class="annot"
	><a href="#local-6989586621679488316"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488317"
      ><span class="annot"
	><a href="#local-6989586621679488317"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488318"
      ><span class="annot"
	><a href="#local-6989586621679488318"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-428"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-429"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-430"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-431"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Strictness"
	><span class="hs-identifier hs-type"
	  >Strictness</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-432"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-433"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-434"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-435"
      ></span
      ><span id="maybeAddSubst"
      ><span class="annot"
	><span class="annottext"
	  >maybeAddSubst :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; ann
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddSubst"
	  ><span class="hs-identifier hs-var hs-var"
	    >maybeAddSubst</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488692"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488692"
	  ><span class="hs-identifier hs-var"
	    >body</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488693"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679488693"
	  ><span class="hs-identifier hs-var"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488694"
      ><span class="annot"
	><span class="annottext"
	  >Strictness
</span
	  ><a href="#local-6989586621679488694"
	  ><span class="hs-identifier hs-var"
	    >s</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488695"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679488695"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488696"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488696"
	  ><span class="hs-identifier hs-var"
	    >rhs0</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-436"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679488697"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488697"
	  ><span class="hs-identifier hs-var"
	    >rhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Inline.html#processTerm"
	><span class="hs-identifier hs-var"
	  >processTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488696"
	><span class="hs-identifier hs-var"
	  >rhs0</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-437"
      ></span
      ><span
      >
</span
      ><span id="line-438"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- Check whether we've been told specifically to inline this</span
      ><span
      >
</span
      ><span id="line-439"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679488698"
      ><span class="annot"
	><span class="annottext"
	  >InlineHints name ann
</span
	  ><a href="#local-6989586621679488698"
	  ><span class="hs-identifier hs-var"
	    >hints</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting
  (InlineHints name ann)
  (InlineInfo tyname name uni fun ann)
  (InlineHints name ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (InlineHints name ann)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span
	><span class="hs-identifier hs-var"
	>view</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting
  (InlineHints name ann)
  (InlineInfo tyname name uni fun ann)
  (InlineHints name ann)
forall tyname name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Functor f =&gt;
(InlineHints name ann -&gt; f (InlineHints name ann))
-&gt; InlineInfo tyname name uni fun ann
-&gt; f (InlineInfo tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#iiHints"
	><span class="hs-identifier hs-var"
	  >iiHints</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-440"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineHints name ann -&gt; ann -&gt; name -&gt; Inline
forall name a. InlineHints name a -&gt; a -&gt; name -&gt; Inline
</span
	><a href="../../plutus-core/src/PlutusCore.Annotation.html#shouldInline"
	><span class="hs-identifier hs-var"
	  >shouldInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineHints name ann
</span
	><a href="#local-6989586621679488698"
	><span class="hs-identifier hs-var"
	  >hints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><a href="#local-6989586621679488693"
	><span class="hs-identifier hs-var"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488695"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-441"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Inline
</span
	><a href="../../plutus-core/src/PlutusCore.Annotation.html#AlwaysInline"
	><span class="hs-identifier hs-var"
	  >AlwaysInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-442"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- if we've been told specifically, then do it right away</span
      ><span
      >
</span
      ><span id="line-443"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>InlineTerm tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall b.
InlineTerm tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Maybe b)
</span
	><a href="#local-6989586621679488703"
	><span class="hs-identifier hs-var"
	  >extendAndDrop</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#Done"
	><span class="hs-identifier hs-var"
	  >Done</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Dupable (Term tyname name uni fun ann)
 -&gt; InlineTerm tyname name uni fun ann)
-&gt; Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Dupable (Term tyname name uni fun ann)
forall a. a -&gt; Dupable a
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#dupable"
	><span class="hs-identifier hs-var"
	  >dupable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488697"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-444"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488704"
      ><span class="annot"
	><span class="annottext"
	  >Inline
</span
	  ><a href="#local-6989586621679488704"
	  ><span class="hs-identifier hs-var"
	    >hint</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-445"
      ></span
      ><span
      >      </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679488705"
      ><span class="annot"
	><span class="annottext"
	  >safeToInline :: Bool
</span
	  ><a href="#local-6989586621679488705"
	  ><span class="hs-identifier hs-var hs-var"
	    >safeToInline</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Inline
</span
	><a href="#local-6989586621679488704"
	><span class="hs-identifier hs-var"
	  >hint</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Inline -&gt; Inline -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Inline
</span
	><a href="../../plutus-core/src/PlutusCore.Annotation.html#SafeToInline"
	><span class="hs-identifier hs-var"
	  >SafeToInline</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-446"
      ></span
      ><span
      >       </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  Bool
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span
	><a href="https://hackage.haskell.org/package/extra-1.8/docs/src/Control.Monad.Extra.html#ifM"
	><span class="hs-identifier hs-var"
	  >ifM</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-447"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Bool
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     Bool
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Bool
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#shouldUnconditionallyInline"
	><span class="hs-identifier hs-var"
	  >shouldUnconditionallyInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679488705"
	><span class="hs-identifier hs-var"
	  >safeToInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
</span
	><a href="#local-6989586621679488694"
	><span class="hs-identifier hs-var"
	  >s</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488695"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488697"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488692"
	><span class="hs-identifier hs-var"
	  >body</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-448"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>InlineTerm tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall b.
InlineTerm tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Maybe b)
</span
	><a href="#local-6989586621679488703"
	><span class="hs-identifier hs-var"
	  >extendAndDrop</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#Done"
	><span class="hs-identifier hs-var"
	  >Done</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Dupable (Term tyname name uni fun ann)
 -&gt; InlineTerm tyname name uni fun ann)
-&gt; Dupable (Term tyname name uni fun ann)
-&gt; InlineTerm tyname name uni fun ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Dupable (Term tyname name uni fun ann)
forall a. a -&gt; Dupable a
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#dupable"
	><span class="hs-identifier hs-var"
	  >dupable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488697"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-449"
      ></span
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Term tyname name uni fun ann)
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679488697"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-450"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-451"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679488703"
	><span class="hs-identifier hs-type"
	  >extendAndDrop</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-452"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488380"
      ><span class="annot"
	><a href="#local-6989586621679488380"
	  ><span class="hs-identifier hs-type"
	    >b</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-453"
      ></span
      ><span
      >       </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineTerm"
	><span class="hs-identifier hs-type"
	  >InlineTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-454"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488314"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488315"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488316"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488317"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488318"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488380"
	><span class="hs-identifier hs-type"
	  >b</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-455"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679488703"
      ><span class="annot"
	><span class="annottext"
	  >extendAndDrop :: forall b.
InlineTerm tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann (Maybe b)
</span
	  ><a href="#local-6989586621679488703"
	  ><span class="hs-identifier hs-var hs-var"
	    >extendAndDrop</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488714"
      ><span class="annot"
	><span class="annottext"
	  >InlineTerm tyname name uni fun ann
</span
	  ><a href="#local-6989586621679488714"
	  ><span class="hs-identifier hs-var"
	    >t</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(InlinerState tyname name uni fun ann
 -&gt; InlinerState tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span
	><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#modify%27"
	><span class="hs-identifier hs-var"
	  >modify'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>name
-&gt; InlineTerm tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
forall name tyname (uni :: * -&gt; *) fun ann.
HasUnique name TermUnique =&gt;
name
-&gt; InlineTerm tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#extendTerm"
	><span class="hs-identifier hs-var"
	  >extendTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679488695"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineTerm tyname name uni fun ann
</span
	><a href="#local-6989586621679488714"
	><span class="hs-identifier hs-var"
	  >t</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  ()
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe b)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe b)
forall a b.
ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
  a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     b
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%3E%3E"
	><span class="hs-operator hs-var"
	  >&gt;&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe b
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     (Maybe b)
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe b
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-456"
      ></span
      ><span
      >
</span
      ><span id="line-457"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Check against the inlining heuristics for types and either inline it, returning Nothing, or
just return the type without inlining.
We only inline if (1) the type is used at most once OR (2) it's a `trivialType`. -}</span
	></span
      ><span
      >
</span
      ><span id="line-460"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddTySubst"
	><span class="hs-identifier hs-type"
	  >maybeAddTySubst</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-461"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679488346"
      ><span class="annot"
	><a href="#local-6989586621679488346"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488347"
      ><span class="annot"
	><a href="#local-6989586621679488347"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488348"
      ><span class="annot"
	><a href="#local-6989586621679488348"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488349"
      ><span class="annot"
	><a href="#local-6989586621679488349"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488350"
      ><span class="annot"
	><a href="#local-6989586621679488350"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-462"
      ></span
      ><span
      >   </span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488346"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488347"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488348"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488349"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-463"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488346"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-464"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ The type variable</span
	></span
      ><span
      >
</span
      ><span id="line-465"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	><span class="hs-identifier hs-type"
	  >Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488346"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488348"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488350"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-466"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^  The value of the type variable.</span
	></span
      ><span
      >
</span
      ><span id="line-467"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488346"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488347"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488348"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488349"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488350"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Core.Type.html#Type"
	><span class="hs-identifier hs-type"
	  >Type</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488346"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488348"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679488350"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-468"
      ></span
      ><span id="maybeAddTySubst"
      ><span class="annot"
	><span class="annottext"
	  >maybeAddTySubst :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
tyname
-&gt; Type tyname uni ann
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
</span
	  ><a href="PlutusIR.Transform.Inline.Inline.html#maybeAddTySubst"
	  ><span class="hs-identifier hs-var hs-var"
	    >maybeAddTySubst</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488739"
      ><span class="annot"
	><span class="annottext"
	  >tyname
</span
	  ><a href="#local-6989586621679488739"
	  ><span class="hs-identifier hs-var"
	    >tn</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679488740"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679488740"
	  ><span class="hs-identifier hs-var"
	    >rhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-469"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621679488741"
      ><span class="annot"
	><span class="annottext"
	  >Usages
</span
	  ><a href="#local-6989586621679488741"
	  ><span class="hs-identifier hs-var"
	    >usgs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting Usages (InlineInfo tyname name uni fun ann) Usages
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     Usages
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span
	><span class="hs-identifier hs-var"
	>view</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting Usages (InlineInfo tyname name uni fun ann) Usages
forall tyname name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Functor f =&gt;
(Usages -&gt; f Usages)
-&gt; InlineInfo tyname name uni fun ann
-&gt; f (InlineInfo tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#iiUsages"
	><span class="hs-identifier hs-var"
	  >iiUsages</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-470"
      ></span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- No need for multiple phases here</span
      ><span
      >
</span
      ><span id="line-471"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679488743"
      ><span class="annot"
	><span class="annottext"
	  >typeUsedAtMostOnce :: Bool
</span
	  ><a href="#local-6989586621679488743"
	  ><span class="hs-identifier hs-var hs-var"
	    >typeUsedAtMostOnce</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname -&gt; Usages -&gt; Int
forall n unique. HasUnique n unique =&gt; n -&gt; Usages -&gt; Int
</span
	><a href="PlutusIR.Analysis.Usages.html#getUsageCount"
	><span class="hs-identifier hs-var"
	  >Usages.getUsageCount</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679488739"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Usages
</span
	><a href="#local-6989586621679488741"
	><span class="hs-identifier hs-var"
	  >usgs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      >
</span
      ><span id="line-472"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679488743"
	><span class="hs-identifier hs-var"
	  >typeUsedAtMostOnce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Bool -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%7C%7C"
	><span class="hs-operator hs-var"
	  >||</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann -&gt; Bool
forall tyname (uni :: * -&gt; *) ann. Type tyname uni ann -&gt; Bool
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#trivialType"
	><span class="hs-identifier hs-var"
	  >trivialType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488740"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-473"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-474"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>(InlinerState tyname name uni fun ann
 -&gt; InlinerState tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span
	><a href="https://hackage.haskell.org/package/mtl-2.3.1/docs/src/Control.Monad.State.Class.html#modify%27"
	><span class="hs-identifier hs-var"
	  >modify'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>tyname
-&gt; Type tyname uni ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
forall tyname (uni :: * -&gt; *) ann name fun.
HasUnique tyname TypeUnique =&gt;
tyname
-&gt; Type tyname uni ann
-&gt; InlinerState tyname name uni fun ann
-&gt; InlinerState tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#extendType"
	><span class="hs-identifier hs-var"
	  >extendType</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679488739"
	><span class="hs-identifier hs-var"
	  >tn</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488740"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-475"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-476"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) (QuoteT Identity))
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Type tyname uni ann)
 -&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann)))
-&gt; Maybe (Type tyname uni ann)
-&gt; InlineM tyname name uni fun ann (Maybe (Type tyname uni ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann -&gt; Maybe (Type tyname uni ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679488740"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-477"
      ></span
      ></pre
    ></body
  ></html
>

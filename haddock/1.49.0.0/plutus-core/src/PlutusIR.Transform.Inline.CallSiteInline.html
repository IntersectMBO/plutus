<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE ConstraintKinds  #-}</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE FlexibleContexts #-}</span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE GADTs            #-}</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE LambdaCase       #-}</span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TypeFamilies     #-}</span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- |
Call site inlining machinery. We inline if the size of the inlined result is not larger.
See Note [Inlining and beta reduction of functions].
-}</span
	></span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusIR.Transform.Inline.CallSiteInline</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.html"
	><span class="hs-identifier"
	  >PlutusCore</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>PLC</span
	></span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.html"
	><span class="hs-identifier"
	  >PlutusCore.Rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.html#rename"
	><span class="hs-identifier"
	  >rename</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-15"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.Internal.html"
	><span class="hs-identifier"
	  >PlutusCore.Rename.Internal</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.Internal.html#Dupable"
	><span class="hs-identifier"
	  >Dupable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.Internal.html#Dupable"
	><span class="hs-identifier"
	  >Dupable</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-16"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Size.html"
	><span class="hs-identifier"
	  >PlutusIR.Analysis.Size</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Size.html#Size"
	><span class="hs-identifier"
	  >Size</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Analysis.Size.html#termSize"
	><span class="hs-identifier"
	  >termSize</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-17"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html"
	><span class="hs-identifier"
	  >PlutusIR.Contexts</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-18"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.html"
	><span class="hs-identifier"
	  >PlutusIR.Core</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-19"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Subst.html"
	><span class="hs-identifier"
	  >PlutusIR.Subst</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-20"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html"
	><span class="hs-identifier"
	  >PlutusIR.Transform.Inline.Utils</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-21"
      ></span
      ><span
      >
</span
      ><span id="line-22"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Control.Lens</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="hs-identifier"
	>view</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-23"
      ></span
      ><span
      >
</span
      ><span id="line-24"
      ></span
      ><span class="hs-comment"
      >{- Note [Inlining and beta reduction of functions]

We inline if its cost and size are acceptable.

For size, we compare the sizes (in terms of AST nodes before and after the inlining and beta
reduction), and inline only if it does not increase the size. In the above example, we count
the number of AST nodes in `f a b` and in `a`. The latter is smaller, which means inlining
reduces the size.

We care about program size increases primarily because it
affects the size of the serialized script, which appears on chain and must be paid for.
This is different to many compilers which care about this also because e.g. larger ASTs
slow down compilation. We care about this too, but the serialized size is the main driver for us.

The number of AST nodes is an approximate rather than a precise measure. It correlates,
but doesn't directly map to the size of the serialised script. Different kinds of AST nodes
may take different number of bits to encode; in particular, a `Constant` node always
counts as one AST node, but the constant in it can be of arbitrary size. Then, would it be
better to use the size of the serialised term, instead of the number of AST nodes? Not
necessarily, because other transformations, such as CSE, may change the size further;
specifically, if a large constant occurs multiple times in a program, it may get CSE'd.

In general there's no reliable way to precisely predict the size impact of an inlining
decision, and we believe the number of AST nodes is in fact a good approximation.

For cost, we check whether the RHS (in this example, `\x. \y -&gt; x`) has a small cost.
If the RHS has a non-zero arity, then the cost is always small (since a lambda or a type
abstraction is already a value). This may not be the case if the arity is zero.

For effect-safety, we require: (1) the RHS be pure, i.e., evaluating it is guaranteed to
not have side effects; (2) all arguments be pure, since otherwise it is unsafe to
perform beta reduction.

-}</span
      ><span
      >
</span
      ><span id="line-58"
      ></span
      ><span
      >
</span
      ><span id="line-59"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{- | Apply the RHS of the given variable to the given arguments, and beta-reduce
the application, if possible.
-}</span
	></span
      ><span
      >
</span
      ><span id="line-62"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.CallSiteInline.html#applyAndBetaReduce"
	><span class="hs-identifier hs-type"
	  >applyAndBetaReduce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-63"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679474051"
      ><span class="annot"
	><a href="#local-6989586621679474051"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474052"
      ><span class="annot"
	><a href="#local-6989586621679474052"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474053"
      ><span class="annot"
	><a href="#local-6989586621679474053"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474054"
      ><span class="annot"
	><a href="#local-6989586621679474054"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474056"
      ><span class="annot"
	><a href="#local-6989586621679474056"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span class="hs-operator"
      >.</span
      ><span
      >
</span
      ><span id="line-64"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      >
</span
      ><span id="line-65"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The rhs of the variable, should have been renamed already</span
	></span
      ><span
      >
</span
      ><span id="line-66"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-67"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The arguments, already processed</span
	></span
      ><span
      >
</span
      ><span id="line-68"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier hs-type"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-69"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-70"
      ></span
      ><span id="applyAndBetaReduce"
      ><span class="annot"
	><span class="annottext"
	  >applyAndBetaReduce :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	  ><a href="PlutusIR.Transform.Inline.CallSiteInline.html#applyAndBetaReduce"
	  ><span class="hs-identifier hs-var hs-var"
	    >applyAndBetaReduce</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474265"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474265"
	  ><span class="hs-identifier hs-var"
	    >rhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474266"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474266"
	  ><span class="hs-identifier hs-var"
	    >args0</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-71"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474267"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-72"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-73"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier hs-type"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-74"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-75"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679474267"
      ><span class="annot"
	><span class="annottext"
	  >go :: Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	  ><a href="#local-6989586621679474267"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474268"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474268"
	  ><span class="hs-identifier hs-var"
	    >acc</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474269"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474269"
	  ><span class="hs-identifier hs-var"
	    >args</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474268"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474269"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-76"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-type"
	  >LamAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474271"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679474271"
	  ><span class="hs-identifier hs-var"
	    >_ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474272"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679474272"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474273"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679474273"
	  ><span class="hs-identifier hs-var"
	    >_ty</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474274"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474274"
	  ><span class="hs-identifier hs-var"
	    >tm</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TermAppContext"
	><span class="hs-identifier hs-type"
	  >TermAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474276"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474276"
	  ><span class="hs-identifier hs-var"
	    >arg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474277"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474277"
	  ><span class="hs-identifier hs-var"
	    >args'</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-77"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474278"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679474278"
	  ><span class="hs-keyword hs-var"
	    >safe</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
</span
	><a href="#local-6989586621679474279"
	><span class="hs-identifier hs-var"
	  >safeToBetaReduce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679474272"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474276"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474274"
	><span class="hs-identifier hs-var"
	  >tm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-78"
      ></span
      ><span
      >          </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679474278"
	><span class="hs-keyword hs-var"
	  >safe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- we only do substitution if it is safe to beta reduce</span
      ><span
      >
</span
      ><span id="line-79"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-80"
      ></span
      ><span
      >              </span
      ><span id="local-6989586621679474280"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474280"
	  ><span class="hs-identifier hs-var"
	    >acc'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-81"
      ></span
      ><span
      >                </span
      ><span class="annot"
      ><span class="annottext"
	>(name
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Term tyname name uni fun ann)
forall (m :: * -&gt; *) name tyname (uni :: * -&gt; *) fun ann.
Monad m =&gt;
(name -&gt; m (Maybe (Term tyname name uni fun ann)))
-&gt; Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Subst.html#termSubstNamesM"
	><span class="hs-identifier hs-var"
	  >termSubstNamesM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- substitute the term param with the arg in the function body</span
      ><span
      >
</span
      ><span id="line-82"
      ></span
      ><span
      >                  </span
      ><span class="hs-comment"
      >-- rename before substitution to ensure global uniqueness (may not be needed but</span
      ><span
      >
</span
      ><span id="line-83"
      ></span
      ><span
      >                  </span
      ><span class="hs-comment"
      >-- no harm in renaming just to be sure)</span
      ><span
      >
</span
      ><span id="line-84"
      ></span
      ><span
      >                  </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679474282"
      ><span class="annot"
	><span class="annottext"
	  >name
</span
	  ><a href="#local-6989586621679474282"
	  ><span class="hs-identifier hs-var"
	    >tmName</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679474282"
	><span class="hs-identifier hs-var"
	  >tmName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name -&gt; name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>name
</span
	><a href="#local-6989586621679474272"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; Maybe (Term tyname name uni fun ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Term tyname name uni fun ann)
forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
forall (m :: * -&gt; *).
MonadQuote m =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#rename"
	><span class="hs-identifier hs-var"
	  >PLC.rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474276"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-85"
      ></span
      ><span
      >                  </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474274"
	><span class="hs-identifier hs-var"
	  >tm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- drop the beta reduced term lambda</span
      ><span
      >
</span
      ><span id="line-86"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="#local-6989586621679474267"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474280"
	><span class="hs-identifier hs-var"
	  >acc'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474277"
	><span class="hs-identifier hs-var"
	  >args'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-87"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- if it is not safe to beta reduce, just return the processed application</span
      ><span
      >
</span
      ><span id="line-88"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Term tyname name uni fun ann)
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; (Term tyname name uni fun ann
    -&gt; Maybe (Term tyname name uni fun ann))
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#fillAppContext"
	><span class="hs-identifier hs-var"
	  >fillAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474268"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474269"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-89"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#TyAbs"
	><span class="hs-identifier hs-type"
	  >TyAbs</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474287"
      ><span class="annot"
	><span class="annottext"
	  >ann
</span
	  ><a href="#local-6989586621679474287"
	  ><span class="hs-identifier hs-var"
	    >_ann</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474288"
      ><span class="annot"
	><span class="annottext"
	  >tyname
</span
	  ><a href="#local-6989586621679474288"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474289"
      ><span class="annot"
	><span class="annottext"
	  >Kind ann
</span
	  ><a href="#local-6989586621679474289"
	  ><span class="hs-identifier hs-var"
	    >_kd</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474290"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474290"
	  ><span class="hs-identifier hs-var"
	    >tm</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TypeAppContext"
	><span class="hs-identifier hs-type"
	  >TypeAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474292"
      ><span class="annot"
	><span class="annottext"
	  >Type tyname uni ann
</span
	  ><a href="#local-6989586621679474292"
	  ><span class="hs-identifier hs-var"
	    >arg</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474293"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474293"
	  ><span class="hs-identifier hs-var"
	    >args'</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-90"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474294"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474294"
	  ><span class="hs-identifier hs-var"
	    >acc'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      >
</span
      ><span id="line-91"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>(tyname
 -&gt; ReaderT
      (InlineInfo tyname name uni fun ann)
      (StateT (InlinerState tyname name uni fun ann) Quote)
      (Maybe (Type tyname uni ann)))
-&gt; Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Term tyname name uni fun ann)
forall (m :: * -&gt; *) tyname (uni :: * -&gt; *) ann name fun.
Monad m =&gt;
(tyname -&gt; m (Maybe (Type tyname uni ann)))
-&gt; Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span
	><a href="PlutusIR.Subst.html#termSubstTyNamesM"
	><span class="hs-identifier hs-var"
	  >termSubstTyNamesM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- substitute the type param with the arg</span
      ><span
      >
</span
      ><span id="line-92"
      ></span
      ><span
      >              </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679474296"
      ><span class="annot"
	><span class="annottext"
	  >tyname
</span
	  ><a href="#local-6989586621679474296"
	  ><span class="hs-identifier hs-var"
	    >tyName</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679474296"
	><span class="hs-identifier hs-var"
	  >tyName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname -&gt; tyname -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>tyname
</span
	><a href="#local-6989586621679474288"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann -&gt; Maybe (Type tyname uni ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Type tyname uni ann -&gt; Maybe (Type tyname uni ann))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Type tyname uni ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Type tyname uni ann))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Type tyname uni ann)
forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
forall (m :: * -&gt; *).
MonadQuote m =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#rename"
	><span class="hs-identifier hs-var"
	  >PLC.rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Type tyname uni ann
</span
	><a href="#local-6989586621679474292"
	><span class="hs-identifier hs-var"
	  >arg</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Type tyname uni ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Type tyname uni ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-93"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474290"
	><span class="hs-identifier hs-var"
	  >tm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-comment"
      >-- drop the beta reduced type lambda</span
      ><span
      >
</span
      ><span id="line-94"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="#local-6989586621679474267"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474294"
	><span class="hs-identifier hs-var"
	  >acc'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474293"
	><span class="hs-identifier hs-var"
	  >args'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-95"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- term/type argument mismatch, don't inline</span
      ><span
      >
</span
      ><span id="line-96"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#LamAbs"
	><span class="hs-identifier hs-type"
	  >LamAbs</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TypeAppContext"
	><span class="hs-identifier hs-type"
	  >TypeAppContext</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-97"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#TyAbs"
	><span class="hs-identifier hs-type"
	  >TyAbs</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#TermAppContext"
	><span class="hs-identifier hs-type"
	  >TermAppContext</span
	  ></a
	></span
      ><span class="hs-special"
      >{</span
      ><span class="hs-special"
      >}</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-98"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- no more lambda abstraction, just return the processed application</span
      ><span
      >
</span
      ><span id="line-99"
      ></span
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Term tyname name uni fun ann)
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; (Term tyname name uni fun ann
    -&gt; Maybe (Term tyname name uni fun ann))
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Term tyname name uni fun ann
 -&gt; InlineM
      tyname name uni fun ann (Maybe (Term tyname name uni fun ann)))
-&gt; Term tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; Term tyname name uni fun ann
</span
	><a href="PlutusIR.Contexts.html#fillAppContext"
	><span class="hs-identifier hs-var"
	  >fillAppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474268"
	><span class="hs-identifier hs-var"
	  >acc</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474269"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-100"
      ></span
      ><span
      >
</span
      ><span id="line-101"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- Is it safe to turn `(\a -&gt; body) arg` into `body [a := arg]`?</span
      ><span
      >
</span
      ><span id="line-102"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- The criteria is the same as the criteria for inlining `a` in</span
      ><span
      >
</span
      ><span id="line-103"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- `let !a = arg in body`.</span
      ><span
      >
</span
      ><span id="line-104"
      ></span
      ><span
      >      </span
      ><span class="annot"
      ><a href="#local-6989586621679474279"
	><span class="hs-identifier hs-type"
	  >safeToBetaReduce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-105"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- `a`</span
      ><span
      >
</span
      ><span id="line-106"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-107"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- `arg`</span
      ><span
      >
</span
      ><span id="line-108"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-109"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- the body `a` will be beta reduced in</span
      ><span
      >
</span
      ><span id="line-110"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-111"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474051"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474052"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474053"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474054"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474056"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-112"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621679474279"
      ><span class="annot"
	><span class="annottext"
	  >safeToBetaReduce :: name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
</span
	  ><a href="#local-6989586621679474279"
	  ><span class="hs-identifier hs-var hs-var"
	    >safeToBetaReduce</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Bool
-&gt; Strictness
-&gt; name
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#shouldUnconditionallyInline"
	><span class="hs-identifier hs-var"
	  >shouldUnconditionallyInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
</span
	><a href="PlutusIR.Core.Type.html#Strict"
	><span class="hs-identifier hs-var"
	  >Strict</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-113"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="#local-6989586621679474267"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474265"
	><span class="hs-identifier hs-var"
	  >rhs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474266"
	><span class="hs-identifier hs-var"
	  >args0</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-114"
      ></span
      ><span
      >
</span
      ><span id="line-115"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Consider inlining a variable. For applications, consider whether to apply and beta reduce.</span
	></span
      ><span
      >
</span
      ><span id="line-116"
      ></span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.CallSiteInline.html#callSiteInline"
	><span class="hs-identifier hs-type"
	  >callSiteInline</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      >
</span
      ><span id="line-117"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679474149"
      ><span class="annot"
	><a href="#local-6989586621679474149"
	  ><span class="hs-identifier hs-type"
	    >tyname</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474150"
      ><span class="annot"
	><a href="#local-6989586621679474150"
	  ><span class="hs-identifier hs-type"
	    >name</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474151"
      ><span class="annot"
	><a href="#local-6989586621679474151"
	  ><span class="hs-identifier hs-type"
	    >uni</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474152"
      ><span class="annot"
	><a href="#local-6989586621679474152"
	  ><span class="hs-identifier hs-type"
	    >fun</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474154"
      ><span class="annot"
	><a href="#local-6989586621679474154"
	  ><span class="hs-identifier hs-type"
	    >ann</span
	    ></a
	  ></span
	></span
      ><span class="hs-operator"
      >.</span
      ><span
      >
</span
      ><span id="line-118"
      ></span
      ><span
      >  </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InliningConstraints"
	><span class="hs-identifier hs-type"
	  >InliningConstraints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      >
</span
      ><span id="line-119"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The term size if it were not inlined.</span
	></span
      ><span
      >
</span
      ><span id="line-120"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Size.html#Size"
	><span class="hs-identifier hs-type"
	  >Size</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-121"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The `Utils.VarInfo` of the variable (the head of the term).</span
	></span
      ><span
      >
</span
      ><span id="line-122"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineVarInfo"
	><span class="hs-identifier hs-type"
	  >InlineVarInfo</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-123"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | The application context of the term, already processed.</span
	></span
      ><span
      >
</span
      ><span id="line-124"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Contexts.html#AppContext"
	><span class="hs-identifier hs-type"
	  >AppContext</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><span id="line-125"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineM"
	><span class="hs-identifier hs-type"
	  >InlineM</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Maybe"
	><span class="hs-identifier hs-type"
	  >Maybe</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-126"
      ></span
      ><span id="callSiteInline"
      ><span class="annot"
	><span class="annottext"
	  >callSiteInline :: forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Size
-&gt; InlineVarInfo tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	  ><a href="PlutusIR.Transform.Inline.CallSiteInline.html#callSiteInline"
	  ><span class="hs-identifier hs-var hs-var"
	    >callSiteInline</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474334"
      ><span class="annot"
	><span class="annottext"
	  >Size
</span
	  ><a href="#local-6989586621679474334"
	  ><span class="hs-identifier hs-var"
	    >processedTSize</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
</span
	><a href="#local-6989586621679474335"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-127"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-128"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679474335"
      ><span class="annot"
	><span class="annottext"
	  >go :: InlineVarInfo tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
</span
	  ><a href="#local-6989586621679474335"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474336"
      ><span class="annot"
	><span class="annottext"
	  >InlineVarInfo tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474336"
	  ><span class="hs-identifier hs-var"
	    >varInfo</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679474337"
      ><span class="annot"
	><span class="annottext"
	  >AppContext tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474337"
	  ><span class="hs-identifier hs-var"
	    >args</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-129"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      >
</span
      ><span id="line-130"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474338"
      ><span class="annot"
	><span class="annottext"
	  >defAsInlineTerm :: InlineTerm tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474338"
	  ><span class="hs-identifier hs-var hs-var"
	    >defAsInlineTerm</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann
-&gt; InlineTerm tyname name uni fun ann
forall tyname name (uni :: * -&gt; *) fun ann.
InlineVarInfo tyname name uni fun ann
-&gt; InlineTerm tyname name uni fun ann
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#varRhs"
	><span class="hs-identifier hs-var"
	  >varRhs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann
</span
	><a href="#local-6989586621679474336"
	><span class="hs-identifier hs-var"
	  >varInfo</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-131"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><a href="#local-6989586621679474340"
	><span class="hs-identifier hs-type"
	  >inlineTermToTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#InlineTerm"
	><span class="hs-identifier hs-type"
	  >InlineTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-132"
      ></span
      ><span
      >              </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusIR.Core.Type.html#Term"
	><span class="hs-identifier hs-type"
	  >Term</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474149"
	><span class="hs-identifier hs-type"
	  >tyname</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474150"
	><span class="hs-identifier hs-type"
	  >name</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474151"
	><span class="hs-identifier hs-type"
	  >uni</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474152"
	><span class="hs-identifier hs-type"
	  >fun</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679474154"
	><span class="hs-identifier hs-type"
	  >ann</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-133"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474340"
      ><span class="annot"
	><span class="annottext"
	  >inlineTermToTerm :: InlineTerm tyname name uni fun ann -&gt; Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474340"
	  ><span class="hs-identifier hs-var hs-var"
	    >inlineTermToTerm</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="PlutusIR.Transform.Inline.Utils.html#Done"
	><span class="hs-identifier hs-type"
	  >Done</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="../../plutus-core/src/PlutusCore.Rename.Internal.html#Dupable"
	><span class="hs-identifier hs-type"
	  >Dupable</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474342"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474342"
	  ><span class="hs-identifier hs-var"
	    >var</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474342"
	><span class="hs-identifier hs-var"
	  >var</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-134"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- extract out the rhs without renaming, we only rename</span
      ><span
      >
</span
      ><span id="line-135"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- when we know there's substitution</span
      ><span
      >
</span
      ><span id="line-136"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474343"
      ><span class="annot"
	><span class="annottext"
	  >headRhs :: Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474343"
	  ><span class="hs-identifier hs-var hs-var"
	    >headRhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineTerm tyname name uni fun ann -&gt; Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474340"
	><span class="hs-identifier hs-var"
	  >inlineTermToTerm</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineTerm tyname name uni fun ann
</span
	><a href="#local-6989586621679474338"
	><span class="hs-identifier hs-var"
	  >defAsInlineTerm</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-137"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- The definition itself will be inlined, so we need to check that the cost</span
      ><span
      >
</span
      ><span id="line-138"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- of that is acceptable. Note that we do _not_ check the cost of the _body_.</span
      ><span
      >
</span
      ><span id="line-139"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- We would have paid that regardless.</span
      ><span
      >
</span
      ><span id="line-140"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- Consider e.g. `let y = \x. f x`. We pay the cost of the `f x` at</span
      ><span
      >
</span
      ><span id="line-141"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- every call site regardless. The work that is being duplicated is</span
      ><span
      >
</span
      ><span id="line-142"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- the work for the lambda.</span
      ><span
      >
</span
      ><span id="line-143"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474344"
      ><span class="annot"
	><span class="annottext"
	  >costIsOk :: Bool
</span
	  ><a href="#local-6989586621679474344"
	  ><span class="hs-identifier hs-var hs-var"
	    >costIsOk</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann -&gt; Bool
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann -&gt; Bool
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#costIsAcceptable"
	><span class="hs-identifier hs-var"
	  >costIsAcceptable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474343"
	><span class="hs-identifier hs-var"
	  >headRhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-144"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- check if binding is pure to avoid duplicated effects.</span
      ><span
      >
</span
      ><span id="line-145"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- For strict bindings we can't accidentally make any effects happen less often</span
      ><span
      >
</span
      ><span id="line-146"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- than it would have before, but we can make it happen more often.</span
      ><span
      >
</span
      ><span id="line-147"
      ></span
      ><span
      >        </span
      ><span class="hs-comment"
      >-- We could potentially do this safely in non-conservative mode.</span
      ><span
      >
</span
      ><span id="line-148"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679474346"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679474346"
	  ><span class="hs-identifier hs-var"
	    >rhsPure</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Strictness
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Strictness
-&gt; Term tyname name uni fun ann
-&gt; InlineM tyname name uni fun ann Bool
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#isTermBindingPure"
	><span class="hs-identifier hs-var"
	  >isTermBindingPure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann -&gt; Strictness
forall tyname name (uni :: * -&gt; *) fun ann.
InlineVarInfo tyname name uni fun ann -&gt; Strictness
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#varStrictness"
	><span class="hs-identifier hs-var"
	  >varStrictness</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>InlineVarInfo tyname name uni fun ann
</span
	><a href="#local-6989586621679474336"
	><span class="hs-identifier hs-var"
	  >varInfo</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474343"
	><span class="hs-identifier hs-var"
	  >headRhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-149"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679474349"
      ><span class="annot"
	><span class="annottext"
	  >Size
</span
	  ><a href="#local-6989586621679474349"
	  ><span class="hs-identifier hs-var"
	    >thresh</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting Size (InlineInfo tyname name uni fun ann) Size
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     Size
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span
	><span class="hs-identifier hs-var"
	>view</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Getting Size (InlineInfo tyname name uni fun ann) Size
forall tyname name (uni :: * -&gt; *) fun ann (f :: * -&gt; *).
Functor f =&gt;
(Size -&gt; f Size)
-&gt; InlineInfo tyname name uni fun ann
-&gt; f (InlineInfo tyname name uni fun ann)
</span
	><a href="PlutusIR.Transform.Inline.Utils.html#iiInlineCallsiteGrowth"
	><span class="hs-identifier hs-var"
	  >iiInlineCallsiteGrowth</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-150"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679474344"
	><span class="hs-identifier hs-var"
	  >costIsOk</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Bool -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%26%26"
	><span class="hs-operator hs-var"
	  >&amp;&amp;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679474346"
	><span class="hs-identifier hs-var"
	  >rhsPure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-151"
      ></span
      ><span
      >          </span
      ><span class="hs-comment"
      >-- rename the rhs of the variable before any substitution</span
      ><span
      >
</span
      ><span id="line-152"
      ></span
      ><span
      >          </span
      ><span id="local-6989586621679474352"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474352"
	  ><span class="hs-identifier hs-var"
	    >renamedRhs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Term tyname name uni fun ann)
forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
forall (m :: * -&gt; *).
MonadQuote m =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span
	><a href="../../plutus-core/src/PlutusCore.Rename.html#rename"
	><span class="hs-identifier hs-var"
	  >rename</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474343"
	><span class="hs-identifier hs-var"
	  >headRhs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-153"
      ></span
      ><span
      >          </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall tyname name (uni :: * -&gt; *) fun ann.
InliningConstraints tyname name uni fun =&gt;
Term tyname name uni fun ann
-&gt; AppContext tyname name uni fun ann
-&gt; InlineM
     tyname name uni fun ann (Maybe (Term tyname name uni fun ann))
</span
	><a href="PlutusIR.Transform.Inline.CallSiteInline.html#applyAndBetaReduce"
	><span class="hs-identifier hs-var"
	  >applyAndBetaReduce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474352"
	><span class="hs-identifier hs-var"
	  >renamedRhs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>AppContext tyname name uni fun ann
</span
	><a href="#local-6989586621679474337"
	><span class="hs-identifier hs-var"
	  >args</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) Quote)
  (Maybe (Term tyname name uni fun ann))
-&gt; (Maybe (Term tyname name uni fun ann)
    -&gt; ReaderT
         (InlineInfo tyname name uni fun ann)
         (StateT (InlinerState tyname name uni fun ann) Quote)
         (Maybe (Term tyname name uni fun ann)))
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall a b.
ReaderT
  (InlineInfo tyname name uni fun ann)
  (StateT (InlinerState tyname name uni fun ann) Quote)
  a
-&gt; (a
    -&gt; ReaderT
         (InlineInfo tyname name uni fun ann)
         (StateT (InlinerState tyname name uni fun ann) Quote)
         b)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#%3E%3E%3D"
	><span class="hs-operator hs-var"
	  >&gt;&gt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span class="hs-glyph"
      >case</span
      ><span
      >
</span
      ><span id="line-154"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-type"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679474353"
      ><span class="annot"
	><span class="annottext"
	  >Term tyname name uni fun ann
</span
	  ><a href="#local-6989586621679474353"
	  ><span class="hs-identifier hs-var"
	    >inlined</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-155"
      ></span
      ><span
      >              </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-comment"
      >-- Inline only if the size is no bigger than not inlining plus threshold.</span
      ><span
      >
</span
      ><span id="line-156"
      ></span
      ><span
      >                  </span
      ><span id="local-6989586621679474354"
      ><span class="annot"
	><span class="annottext"
	  >sizeIsOk :: Bool
</span
	  ><a href="#local-6989586621679474354"
	  ><span class="hs-identifier hs-var hs-var"
	    >sizeIsOk</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann -&gt; Size
forall tyname name (uni :: * -&gt; *) fun ann.
Term tyname name uni fun ann -&gt; Size
</span
	><a href="PlutusIR.Analysis.Size.html#termSize"
	><span class="hs-identifier hs-var"
	  >termSize</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474353"
	><span class="hs-identifier hs-var"
	  >inlined</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size -&gt; Size -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size
</span
	><a href="#local-6989586621679474334"
	><span class="hs-identifier hs-var"
	  >processedTSize</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size -&gt; Size -&gt; Size
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size -&gt; Size -&gt; Size
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#max"
	><span class="hs-identifier hs-var"
	  >max</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Size
</span
	><a href="#local-6989586621679474349"
	><span class="hs-identifier hs-var"
	  >thresh</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-157"
      ></span
      ><span
      >              </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Maybe (Term tyname name uni fun ann)
 -&gt; ReaderT
      (InlineInfo tyname name uni fun ann)
      (StateT (InlinerState tyname name uni fun ann) Quote)
      (Maybe (Term tyname name uni fun ann)))
-&gt; Maybe (Term tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679474354"
	><span class="hs-identifier hs-var"
	  >sizeIsOk</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
-&gt; Maybe (Term tyname name uni fun ann)
forall a. a -&gt; Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Just"
	><span class="hs-identifier hs-var"
	  >Just</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Term tyname name uni fun ann
</span
	><a href="#local-6989586621679474353"
	><span class="hs-identifier hs-var"
	  >inlined</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-158"
      ></span
      ><span
      >            </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-159"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     (Maybe (Term tyname name uni fun ann))
forall a.
a
-&gt; ReaderT
     (InlineInfo tyname name uni fun ann)
     (StateT (InlinerState tyname name uni fun ann) Quote)
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Maybe (Term tyname name uni fun ann)
forall a. Maybe a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.2.1/docs/src/GHC.Maybe.html#Nothing"
	><span class="hs-identifier hs-var"
	  >Nothing</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-160"
      ></span
      ></pre
    ></body
  ></html
>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE TypeApplications #-}</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusCore.Generators.QuickCheck.Split</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html"
	><span class="hs-identifier"
	  >Control.Monad</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Bifunctor.html"
	><span class="hs-identifier"
	  >Data.Bifunctor</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Coerce.html"
	><span class="hs-identifier"
	  >Data.Coerce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Prim.html#coerce"
	><span class="hs-identifier"
	  >coerce</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-8"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.List.html"
	><span class="hs-identifier"
	  >Data.List</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.OldList.html#sortBy"
	><span class="hs-identifier"
	  >sortBy</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-9"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Ord.html"
	><span class="hs-identifier"
	  >Data.Ord</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Ord.html#comparing"
	><span class="hs-identifier"
	  >comparing</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-10"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Test.QuickCheck</span
	></span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Up to what length a list is considered \&quot;short\&quot;.</span
	></span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-type"
	  >smallLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span id="smallLength"
      ><span class="annot"
	><span class="annottext"
	  >smallLength :: Int
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	  ><span class="hs-identifier hs-var hs-var"
	    >smallLength</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>6</span
	></span
      ><span
      >
</span
      ><span id="line-15"
      ></span
      ><span
      >
</span
      ><span id="line-16"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Generate a sublist of the given size of the given list. Preserves the order of elements.</span
	></span
      ><span
      >
</span
      ><span id="line-17"
      ></span
      ><span id="local-6989586621679274174"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#sublistN"
	  ><span class="hs-identifier hs-type"
	    >sublistN</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	  ><span class="hs-identifier hs-type"
	    >Int</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274174"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274174"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-18"
      ></span
      ><span id="sublistN"
      ><span class="annot"
	><span class="annottext"
	  >sublistN :: forall a. Int -&gt; [a] -&gt; Gen [a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#sublistN"
	  ><span class="hs-identifier hs-var hs-var"
	    >sublistN</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274310"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274310"
	  ><span class="hs-identifier hs-var"
	    >lenRes</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-19"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, a)] -&gt; [a]) -&gt; Gen [(Int, a)] -&gt; Gen [a]
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>((Int, a) -&gt; a) -&gt; [(Int, a)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#map"
	><span class="hs-identifier hs-var"
	  >map</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int, a) -&gt; a
forall a b. (a, b) -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Tuple.html#snd"
	><span class="hs-identifier hs-var"
	  >snd</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, a)] -&gt; [a])
-&gt; ([(Int, a)] -&gt; [(Int, a)]) -&gt; [(Int, a)] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int, a) -&gt; (Int, a) -&gt; Ordering) -&gt; [(Int, a)] -&gt; [(Int, a)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.OldList.html#sortBy"
	><span class="hs-identifier hs-var"
	  >sortBy</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>((Int, a) -&gt; Int) -&gt; (Int, a) -&gt; (Int, a) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Ord.html#comparing"
	><span class="hs-identifier hs-var"
	  >comparing</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int, a) -&gt; Int
forall a b. (a, b) -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Tuple.html#fst"
	><span class="hs-identifier hs-var"
	  >fst</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, a)] -&gt; [(Int, a)])
-&gt; ([(Int, a)] -&gt; [(Int, a)]) -&gt; [(Int, a)] -&gt; [(Int, a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [(Int, a)] -&gt; [(Int, a)]
forall a. Int -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#take"
	><span class="hs-identifier hs-var"
	  >take</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274310"
	><span class="hs-identifier hs-var"
	  >lenRes</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-20"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>(Gen [(Int, a)] -&gt; Gen [a])
-&gt; ([a] -&gt; Gen [(Int, a)]) -&gt; [a] -&gt; Gen [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[(Int, a)] -&gt; Gen [(Int, a)]
forall a. [a] -&gt; Gen [a]
</span
	><span class="hs-identifier hs-var"
	>shuffle</span
	></span
      ><span
      >
</span
      ><span id="line-21"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, a)] -&gt; Gen [(Int, a)])
-&gt; ([a] -&gt; [(Int, a)]) -&gt; [a] -&gt; Gen [(Int, a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zip"
	><span class="hs-identifier hs-var"
	  >zip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-22"
      ></span
      ><span
      >
</span
      ><span id="line-23"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>-- | Calculate the maximum number of chunks to split a list of the given list into.</span
	></span
      ><span
      >
</span
      ><span id="line-24"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#toMaxChunkNumber"
	><span class="hs-identifier hs-type"
	  >toMaxChunkNumber</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-25"
      ></span
      ><span id="toMaxChunkNumber"
      ><span class="annot"
	><span class="annottext"
	  >toMaxChunkNumber :: Int -&gt; Int
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#toMaxChunkNumber"
	  ><span class="hs-identifier hs-var hs-var"
	    >toMaxChunkNumber</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274317"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274317"
	  ><span class="hs-identifier hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-26"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- For short lists we take the maximum number of chunks to be the length of the list,</span
      ><span
      >
</span
      ><span id="line-27"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- i.e. the maximum number of chunks grows at a maximum speed for short lists.</span
      ><span
      >
</span
      ><span id="line-28"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274317"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      >              </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274317"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-29"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- For longer lists the maximum number of chunks grows slower. We don't really want to split a</span
      ><span
      >
</span
      ><span id="line-30"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- 50-element list into each of 1..50 number of chunks.</span
      ><span
      >
</span
      ><span id="line-31"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274317"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#%5E"
	><span class="hs-operator hs-var"
	  >^</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274317"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#div"
	><span class="hs-operator hs-var"
	  >`div`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-32"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- For long lists it grows even slower.</span
      ><span
      >
</span
      ><span id="line-33"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      >                       </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#round"
	><span class="hs-identifier hs-var"
	  >round</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >@</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	><span class="hs-identifier hs-type"
	  >Double</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Float.html#sqrt"
	><span class="hs-identifier hs-var"
	  >sqrt</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274317"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-34"
      ></span
      ><span
      >
</span
      ><span id="line-35"
      ></span
      ><span class="hs-comment"
      >-- | Calculate the number of ways to divide a list of length @len@ into @chunkNum@ chunks.</span
      ><span
      >
</span
      ><span id="line-36"
      ></span
      ><span class="hs-comment"
      >-- Equals to @C(len - 1, chunksNum - 1)@.</span
      ><span
      >
</span
      ><span id="line-37"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkNumber"
	><span class="hs-identifier hs-type"
	  >toChunkNumber</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-38"
      ></span
      ><span id="toChunkNumber"
      ><span class="annot"
	><span class="annottext"
	  >toChunkNumber :: Int -&gt; Int -&gt; Int
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkNumber"
	  ><span class="hs-identifier hs-var hs-var"
	    >toChunkNumber</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274325"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274325"
	  ><span class="hs-identifier hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274326"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274326"
	  ><span class="hs-identifier hs-var"
	    >chunkNum</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-39"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#product"
	><span class="hs-identifier hs-var"
	  >product</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274325"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274325"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274325"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274326"
	><span class="hs-identifier hs-var"
	  >chunkNum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#div"
	><span class="hs-operator hs-var"
	  >`div`</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-40"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#product"
	><span class="hs-identifier hs-var"
	  >product</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274326"
	><span class="hs-identifier hs-var"
	  >chunkNum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274326"
	><span class="hs-identifier hs-var"
	  >chunkNum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-41"
      ></span
      ><span
      >
</span
      ><span id="line-42"
      ></span
      ><span class="hs-comment"
      >-- | Return a list of pairs, each of which consists of</span
      ><span
      >
</span
      ><span id="line-43"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-44"
      ></span
      ><span class="hs-comment"
      >-- 1. the frequency at which a chunk length needs to be picked by the generation machinery</span
      ><span
      >
</span
      ><span id="line-45"
      ></span
      ><span class="hs-comment"
      >-- 2. the chunk length itself</span
      ><span
      >
</span
      ><span id="line-46"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-47"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies (-1)</span
      ><span
      >
</span
      ><span id="line-48"
      ></span
      ><span class="hs-comment"
      >-- []</span
      ><span
      >
</span
      ><span id="line-49"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies 0</span
      ><span
      >
</span
      ><span id="line-50"
      ></span
      ><span class="hs-comment"
      >-- []</span
      ><span
      >
</span
      ><span id="line-51"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies 1</span
      ><span
      >
</span
      ><span id="line-52"
      ></span
      ><span class="hs-comment"
      >-- [(1,1)]</span
      ><span
      >
</span
      ><span id="line-53"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies 5</span
      ><span
      >
</span
      ><span id="line-54"
      ></span
      ><span class="hs-comment"
      >-- [(1,1),(4,2),(6,3),(4,4),(1,5)]</span
      ><span
      >
</span
      ><span id="line-55"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies 10</span
      ><span
      >
</span
      ><span id="line-56"
      ></span
      ><span class="hs-comment"
      >-- [(3,1),(6,2),(9,3),(12,4),(15,5),(18,6),(21,7)]</span
      ><span
      >
</span
      ><span id="line-57"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunkFrequencies 50</span
      ><span
      >
</span
      ><span id="line-58"
      ></span
      ><span class="hs-comment"
      >-- [(3,1),(4,2),(5,3),(6,4),(7,5),(8,6),(9,7),(10,8),(11,9),(12,10),(13,11),(14,12),(15,13)]</span
      ><span
      >
</span
      ><span id="line-59"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkFrequencies"
	><span class="hs-identifier hs-type"
	  >toChunkFrequencies</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-60"
      ></span
      ><span id="toChunkFrequencies"
      ><span class="annot"
	><span class="annottext"
	  >toChunkFrequencies :: Int -&gt; [(Int, Int)]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkFrequencies"
	  ><span class="hs-identifier hs-var hs-var"
	    >toChunkFrequencies</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274329"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274329"
	  ><span class="hs-identifier hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      >
</span
      ><span id="line-61"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- For short lists we calculate exact chunk numbers and use those as frequencies in order to get</span
      ><span
      >
</span
      ><span id="line-62"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- uniform distribution of list lengths (which does not lead to uniform distribution of lengths</span
      ><span
      >
</span
      ><span id="line-63"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- of subtrees, since subtrees with small total count of elements get generated much more often</span
      ><span
      >
</span
      ><span id="line-64"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- than those with a big total count of elements, particularly because the latter contain the</span
      ><span
      >
</span
      ><span id="line-65"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- former).</span
      ><span
      >
</span
      ><span id="line-66"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274329"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3C%3D"
	><span class="hs-operator hs-var"
	  >&lt;=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#smallLength"
	><span class="hs-identifier hs-var"
	  >smallLength</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; (Int, Int)) -&gt; [Int] -&gt; [(Int, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#map"
	><span class="hs-identifier hs-var"
	  >map</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621679274330"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274330"
	  ><span class="hs-identifier hs-var"
	    >num</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkNumber"
	><span class="hs-identifier hs-var"
	  >toChunkNumber</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274329"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274330"
	><span class="hs-identifier hs-var"
	  >num</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274330"
	><span class="hs-identifier hs-var"
	  >num</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274331"
	><span class="hs-identifier hs-var"
	  >chunks</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-67"
      ></span
      ><span
      >    </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#otherwise"
	><span class="hs-identifier hs-var"
	  >otherwise</span
	  ></a
	></span
      ><span
      >          </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-68"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-comment"
      >-- The probability of &quot;splitting&quot; a list into a single sublist (i.e. simply 'pure') is</span
      ><span
      >
</span
      ><span id="line-69"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- about 3%.</span
      ><span
      >
</span
      ><span id="line-70"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679274333"
      ><span class="annot"
	><span class="annottext"
	  >singleElemProb :: Int
</span
	  ><a href="#local-6989586621679274333"
	  ><span class="hs-identifier hs-var hs-var"
	    >singleElemProb</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>3</span
	></span
      ><span
      >
</span
      ><span id="line-71"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- Computing @delta@ in order for each subsequent chunk length to get picked a bit more</span
      ><span
      >
</span
      ><span id="line-72"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- likely, so that we generate longer forests more often when we can. For not-too-long</span
      ><span
      >
</span
      ><span id="line-73"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- lists the frequencies add up to roughly 100. For long lists the sum of frequencies</span
      ><span
      >
</span
      ><span id="line-74"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- can be significantly greater than 100 making the chance of generating a single</span
      ><span
      >
</span
      ><span id="line-75"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- sublist less than 3%.</span
      ><span
      >
</span
      ><span id="line-76"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679274339"
      ><span class="annot"
	><span class="annottext"
	  >deltaN :: Int
</span
	  ><a href="#local-6989586621679274339"
	  ><span class="hs-identifier hs-var hs-var"
	    >deltaN</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274340"
	><span class="hs-identifier hs-var"
	  >chunkMax</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274340"
	><span class="hs-identifier hs-var"
	  >chunkMax</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#div"
	><span class="hs-operator hs-var"
	  >`div`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>2</span
	></span
      ><span
      >
</span
      ><span id="line-77"
      ></span
      ><span
      >            </span
      ><span id="local-6989586621679274348"
      ><span class="annot"
	><span class="annottext"
	  >delta :: Int
</span
	  ><a href="#local-6989586621679274348"
	  ><span class="hs-identifier hs-var hs-var"
	    >delta</span
	    ></a
	  ></span
	></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#max"
	><span class="hs-identifier hs-var"
	  >max</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>100</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274340"
	><span class="hs-identifier hs-var"
	  >chunkMax</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274333"
	><span class="hs-identifier hs-var"
	  >singleElemProb</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#div"
	><span class="hs-operator hs-var"
	  >`div`</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274339"
	><span class="hs-identifier hs-var"
	  >deltaN</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-78"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >in</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; [Int] -&gt; [(Int, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zip"
	><span class="hs-identifier hs-var"
	  >zip</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Int) -&gt; Int -&gt; [Int]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#iterate"
	><span class="hs-identifier hs-var"
	  >iterate</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274348"
	><span class="hs-identifier hs-var"
	  >delta</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274333"
	><span class="hs-identifier hs-var"
	  >singleElemProb</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274331"
	><span class="hs-identifier hs-var"
	  >chunks</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-79"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-80"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679274340"
      ><span class="annot"
	><span class="annottext"
	  >chunkMax :: Int
</span
	  ><a href="#local-6989586621679274340"
	  ><span class="hs-identifier hs-var hs-var"
	    >chunkMax</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toMaxChunkNumber"
	><span class="hs-identifier hs-var"
	  >toMaxChunkNumber</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274329"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-81"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679274331"
      ><span class="annot"
	><span class="annottext"
	  >chunks :: [Int]
</span
	  ><a href="#local-6989586621679274331"
	  ><span class="hs-identifier hs-var hs-var"
	    >chunks</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274340"
	><span class="hs-identifier hs-var"
	  >chunkMax</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-82"
      ></span
      ><span
      >
</span
      ><span id="line-83"
      ></span
      ><span class="hs-comment"
      >-- | Split the given list in chunks. The length of each chunk, apart from the final one, is taken</span
      ><span
      >
</span
      ><span id="line-84"
      ></span
      ><span class="hs-comment"
      >-- from the first argument.</span
      ><span
      >
</span
      ><span id="line-85"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-86"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; toChunks [3, 1] &quot;abcdef&quot;</span
      ><span
      >
</span
      ><span id="line-87"
      ></span
      ><span class="hs-comment"
      >-- [&quot;abc&quot;,&quot;d&quot;,&quot;ef&quot;]</span
      ><span
      >
</span
      ><span id="line-88"
      ></span
      ><span id="local-6989586621679274212"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunks"
	  ><span class="hs-identifier hs-type"
	    >toChunks</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	  ><span class="hs-identifier hs-type"
	    >Int</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274212"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274212"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-89"
      ></span
      ><span id="toChunks"
      ><span class="annot"
	><span class="annottext"
	  >toChunks :: forall a. [Int] -&gt; [a] -&gt; [[a]]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunks"
	  ><span class="hs-identifier hs-var hs-var"
	    >toChunks</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      >       </span
      ><span id="local-6989586621679274354"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274354"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274354"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-90"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunks"
	><span class="hs-identifier hs-var"
	  >toChunks</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679274355"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274355"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274356"
      ><span class="annot"
	><span class="annottext"
	  >[Int]
</span
	  ><a href="#local-6989586621679274356"
	  ><span class="hs-identifier hs-var"
	    >ns</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span id="local-6989586621679274357"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274357"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274358"
	><span class="hs-identifier hs-var"
	  >chunk</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [[a]] -&gt; [[a]]
forall a. a -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-var"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; [a] -&gt; [[a]]
forall a. [Int] -&gt; [a] -&gt; [[a]]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunks"
	><span class="hs-identifier hs-var"
	  >toChunks</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274356"
	><span class="hs-identifier hs-var"
	  >ns</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274359"
	><span class="hs-identifier hs-var"
	  >xs'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-91"
      ></span
      ><span
      >    </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679274358"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274358"
	  ><span class="hs-identifier hs-var"
	    >chunk</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679274359"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274359"
	  ><span class="hs-identifier hs-var"
	    >xs'</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#splitAt"
	><span class="hs-identifier hs-var"
	  >splitAt</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274355"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274357"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-92"
      ></span
      ><span
      >
</span
      ><span id="line-93"
      ></span
      ><span class="hs-comment"
      >-- | Split a list into the given number of chunks. Concatenating the resulting lists gives back the</span
      ><span
      >
</span
      ><span id="line-94"
      ></span
      ><span class="hs-comment"
      >-- original one. Doesn't generate empty chunks.</span
      ><span
      >
</span
      ><span id="line-95"
      ></span
      ><span id="local-6989586621679274216"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1In"
	  ><span class="hs-identifier hs-type"
	    >multiSplit1In</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	  ><span class="hs-identifier hs-type"
	    >Int</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274216"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >NonEmptyList</span
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621679274216"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-96"
      ></span
      ><span id="multiSplit1In"
      ><span class="annot"
	><span class="annottext"
	  >multiSplit1In :: forall a. Int -&gt; [a] -&gt; Gen [NonEmptyList a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1In"
	  ><span class="hs-identifier hs-var hs-var"
	    >multiSplit1In</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      >        </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[NonEmptyList a] -&gt; Gen [NonEmptyList a]
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-97"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1In"
	><span class="hs-identifier hs-var"
	  >multiSplit1In</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274374"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274374"
	  ><span class="hs-identifier hs-var"
	    >chunkNum</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274375"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274375"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-98"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679274377"
      ><span class="annot"
	><span class="annottext"
	  >len :: Int
</span
	  ><a href="#local-6989586621679274377"
	  ><span class="hs-identifier hs-var hs-var"
	    >len</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274375"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-99"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Pick a list of breakpoints.</span
      ><span
      >
</span
      ><span id="line-100"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274379"
      ><span class="annot"
	><span class="annottext"
	  >[Int]
</span
	  ><a href="#local-6989586621679274379"
	  ><span class="hs-identifier hs-var"
	    >breakpoints</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [Int] -&gt; Gen [Int]
forall a. Int -&gt; [a] -&gt; Gen [a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#sublistN"
	><span class="hs-identifier hs-var"
	  >sublistN</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274374"
	><span class="hs-identifier hs-var"
	  >chunkNum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274377"
	><span class="hs-identifier hs-var"
	  >len</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-101"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Turn the list of breakpoints into a list of chunk lengths.</span
      ><span
      >
</span
      ><span id="line-102"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621679274382"
      ><span class="annot"
	><span class="annottext"
	  >chunkLens :: [Int]
</span
	  ><a href="#local-6989586621679274382"
	  ><span class="hs-identifier hs-var hs-var"
	    >chunkLens</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Int -&gt; Int) -&gt; [Int] -&gt; [Int] -&gt; [Int]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#zipWith"
	><span class="hs-identifier hs-var"
	  >zipWith</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274379"
	><span class="hs-identifier hs-var"
	  >breakpoints</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-var"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274379"
	><span class="hs-identifier hs-var"
	  >breakpoints</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-103"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Chop the argument into chunks according to the list of chunk lengths.</span
      ><span
      >
</span
      ><span id="line-104"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[NonEmptyList a] -&gt; Gen [NonEmptyList a]
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([NonEmptyList a] -&gt; Gen [NonEmptyList a])
-&gt; ([[a]] -&gt; [NonEmptyList a]) -&gt; [[a]] -&gt; Gen [NonEmptyList a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[[a]] -&gt; [NonEmptyList a]
forall a b. Coercible a b =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Prim.html#coerce"
	><span class="hs-identifier hs-var"
	  >coerce</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([[a]] -&gt; Gen [NonEmptyList a]) -&gt; [[a]] -&gt; Gen [NonEmptyList a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; [a] -&gt; [[a]]
forall a. [Int] -&gt; [a] -&gt; [[a]]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunks"
	><span class="hs-identifier hs-var"
	  >toChunks</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int]
</span
	><a href="#local-6989586621679274382"
	><span class="hs-identifier hs-var"
	  >chunkLens</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274375"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-105"
      ></span
      ><span
      >
</span
      ><span id="line-106"
      ></span
      ><span class="hs-comment"
      >-- | Split a list into chunks at random. Concatenating the resulting lists gives back the original</span
      ><span
      >
</span
      ><span id="line-107"
      ></span
      ><span class="hs-comment"
      >-- one. Doesn't generate empty chunks.</span
      ><span
      >
</span
      ><span id="line-108"
      ></span
      ><span id="local-6989586621679274227"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1"
	  ><span class="hs-identifier hs-type"
	    >multiSplit1</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274227"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >NonEmptyList</span
	  ></span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621679274227"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-109"
      ></span
      ><span id="multiSplit1"
      ><span class="annot"
	><span class="annottext"
	  >multiSplit1 :: forall a. [a] -&gt; Gen [NonEmptyList a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1"
	  ><span class="hs-identifier hs-var hs-var"
	    >multiSplit1</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274392"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274392"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-110"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Pick a number of chunks.</span
      ><span
      >
</span
      ><span id="line-111"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274393"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621679274393"
	  ><span class="hs-identifier hs-var"
	    >chunkNum</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[(Int, Gen Int)] -&gt; Gen Int
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span
	><span class="hs-identifier hs-var"
	>frequency</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, Gen Int)] -&gt; Gen Int)
-&gt; (Int -&gt; [(Int, Gen Int)]) -&gt; Int -&gt; Gen Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int, Int) -&gt; (Int, Gen Int)) -&gt; [(Int, Int)] -&gt; [(Int, Gen Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#map"
	><span class="hs-identifier hs-var"
	  >map</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Gen Int) -&gt; (Int, Int) -&gt; (Int, Gen Int)
forall a b. (a -&gt; b) -&gt; (Int, a) -&gt; (Int, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Gen Int
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([(Int, Int)] -&gt; [(Int, Gen Int)])
-&gt; (Int -&gt; [(Int, Int)]) -&gt; Int -&gt; [(Int, Gen Int)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [(Int, Int)]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#toChunkFrequencies"
	><span class="hs-identifier hs-var"
	  >toChunkFrequencies</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Int -&gt; Gen Int) -&gt; Int -&gt; Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274392"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-112"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; [a] -&gt; Gen [NonEmptyList a]
forall a. Int -&gt; [a] -&gt; Gen [NonEmptyList a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1In"
	><span class="hs-identifier hs-var"
	  >multiSplit1In</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274393"
	><span class="hs-identifier hs-var"
	  >chunkNum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274392"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-113"
      ></span
      ><span
      >
</span
      ><span id="line-114"
      ></span
      ><span class="hs-comment"
      >-- | Return the left and the right halves of the given list. The first argument controls whether</span
      ><span
      >
</span
      ><span id="line-115"
      ></span
      ><span class="hs-comment"
      >-- the middle element of a list having an odd length goes into the left half or the right one.</span
      ><span
      >
</span
      ><span id="line-116"
      ></span
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><span id="line-117"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve True [1 :: Int]</span
      ><span
      >
</span
      ><span id="line-118"
      ></span
      ><span class="hs-comment"
      >-- ([1],[])</span
      ><span
      >
</span
      ><span id="line-119"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve True [1, 2 :: Int]</span
      ><span
      >
</span
      ><span id="line-120"
      ></span
      ><span class="hs-comment"
      >-- ([1],[2])</span
      ><span
      >
</span
      ><span id="line-121"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve True [1, 2, 3 :: Int]</span
      ><span
      >
</span
      ><span id="line-122"
      ></span
      ><span class="hs-comment"
      >-- ([1,2],[3])</span
      ><span
      >
</span
      ><span id="line-123"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve False [1 :: Int]</span
      ><span
      >
</span
      ><span id="line-124"
      ></span
      ><span class="hs-comment"
      >-- ([],[1])</span
      ><span
      >
</span
      ><span id="line-125"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve False [1, 2 :: Int]</span
      ><span
      >
</span
      ><span id="line-126"
      ></span
      ><span class="hs-comment"
      >-- ([1],[2])</span
      ><span
      >
</span
      ><span id="line-127"
      ></span
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; halve False [1, 2, 3 :: Int]</span
      ><span
      >
</span
      ><span id="line-128"
      ></span
      ><span class="hs-comment"
      >-- ([1],[2,3])</span
      ><span
      >
</span
      ><span id="line-129"
      ></span
      ><span id="local-6989586621679274232"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#halve"
	  ><span class="hs-identifier hs-type"
	    >halve</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	  ><span class="hs-identifier hs-type"
	    >Bool</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274232"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>(</span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274232"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span class="hs-special"
	>,</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274232"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span class="hs-special"
	>)</span
	></span
      ><span
      >
</span
      ><span id="line-130"
      ></span
      ><span id="halve"
      ><span class="annot"
	><span class="annottext"
	  >halve :: forall a. Bool -&gt; [a] -&gt; ([a], [a])
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#halve"
	  ><span class="hs-identifier hs-var hs-var"
	    >halve</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274396"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274396"
	  ><span class="hs-identifier hs-var"
	    >isOddToLeft</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274397"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274397"
	  ><span class="hs-identifier hs-var"
	    >xs0</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a] -&gt; ([a], [a])
forall {a} {a}. [a] -&gt; [a] -&gt; ([a], [a])
</span
	><a href="#local-6989586621679274398"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274397"
	><span class="hs-identifier hs-var"
	  >xs0</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274397"
	><span class="hs-identifier hs-var"
	  >xs0</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-131"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274398"
      ><span class="annot"
	><span class="annottext"
	  >go :: [a] -&gt; [a] -&gt; ([a], [a])
</span
	  ><a href="#local-6989586621679274398"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274401"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274401"
	  ><span class="hs-identifier hs-var"
	    >xsFast</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679274402"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274402"
	  ><span class="hs-identifier hs-var"
	    >x</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274403"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274403"
	  ><span class="hs-identifier hs-var"
	    >xsSlow</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >               </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Bifunctor.html#first"
	><span class="hs-identifier hs-var"
	  >first</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274402"
	><span class="hs-identifier hs-var"
	  >x</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-var"
	  >:</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(([a], [a]) -&gt; ([a], [a])) -&gt; ([a], [a]) -&gt; ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a] -&gt; ([a], [a])
</span
	><a href="#local-6989586621679274398"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274401"
	><span class="hs-identifier hs-var"
	  >xsFast</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274403"
	><span class="hs-identifier hs-var"
	  >xsSlow</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-132"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679274398"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >              </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679274405"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274405"
	  ><span class="hs-identifier hs-var"
	    >x</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274406"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274406"
	  ><span class="hs-identifier hs-var"
	    >xsSlow</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274396"
	><span class="hs-identifier hs-var"
	  >isOddToLeft</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274405"
	><span class="hs-identifier hs-var"
	  >x</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274406"
	><span class="hs-identifier hs-var"
	  >xsSlow</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-133"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679274398"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><span class="hs-identifier"
	>_</span
	></span
      ><span
      >                </span
      ><span id="local-6989586621679274407"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274407"
	  ><span class="hs-identifier hs-var"
	    >xsSlow</span
	    ></a
	  ></span
	></span
      ><span
      >                     </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274407"
	><span class="hs-identifier hs-var"
	  >xsSlow</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-134"
      ></span
      ><span
      >
</span
      ><span id="line-135"
      ></span
      ><span class="hs-comment"
      >-- | Insert a value into a list an arbitrary number of times. The first argument controls whether</span
      ><span
      >
</span
      ><span id="line-136"
      ></span
      ><span class="hs-comment"
      >-- to allow inserting at the beginning of the list, the second argument is the probability of</span
      ><span
      >
</span
      ><span id="line-137"
      ></span
      ><span class="hs-comment"
      >-- inserting an element at the end of the list.</span
      ><span
      >
</span
      ><span id="line-138"
      ></span
      ><span class="annot"
      ><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferRight"
	><span class="hs-identifier hs-type"
	  >insertManyPreferRight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><span id="local-6989586621679274241"
      ><span class="annot"
	><a href="#local-6989586621679274241"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	></span
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	><span class="hs-identifier hs-type"
	  >Double</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="#local-6989586621679274241"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><a href="#local-6989586621679274241"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier hs-type"
	>Gen</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><a href="#local-6989586621679274241"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-139"
      ></span
      ><span id="insertManyPreferRight"
      ><span class="annot"
	><span class="annottext"
	  >insertManyPreferRight :: forall a. Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferRight"
	  ><span class="hs-identifier hs-var hs-var"
	    >insertManyPreferRight</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274420"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274420"
	  ><span class="hs-identifier hs-var"
	    >keepPrefix</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274421"
      ><span class="annot"
	><span class="annottext"
	  >Double
</span
	  ><a href="#local-6989586621679274421"
	  ><span class="hs-identifier hs-var"
	    >lastProb</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274422"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274422"
	  ><span class="hs-identifier hs-var"
	    >y</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274423"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274423"
	  ><span class="hs-identifier hs-var"
	    >xs0</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; [a] -&gt; Gen [a]
</span
	><a href="#local-6989586621679274424"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274420"
	><span class="hs-identifier hs-var"
	  >keepPrefix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274425"
	><span class="hs-identifier hs-var"
	  >initWeight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274423"
	><span class="hs-identifier hs-var"
	  >xs0</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-140"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- The weight of the &quot;insert @y@ operation&quot; operation at the beginning of the list.</span
      ><span
      >
</span
      ><span id="line-141"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274425"
      ><span class="annot"
	><span class="annottext"
	  >initWeight :: Double
</span
	  ><a href="#local-6989586621679274425"
	  ><span class="hs-identifier hs-var hs-var"
	    >initWeight</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><span class="hs-number"
	>10</span
	></span
      ><span
      >
</span
      ><span id="line-142"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- How more likely we're to insert an element when moving one element forward in the list.</span
      ><span
      >
</span
      ><span id="line-143"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Should we make it dependent on the length of the list? Maybe it's fine.</span
      ><span
      >
</span
      ><span id="line-144"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274430"
      ><span class="annot"
	><span class="annottext"
	  >scaling :: Double
</span
	  ><a href="#local-6989586621679274430"
	  ><span class="hs-identifier hs-var hs-var"
	    >scaling</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><span class="hs-number"
	>1.1</span
	></span
      ><span
      >
</span
      ><span id="line-145"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- The weight of the &quot;insert @y@ operation&quot; operation at the end of the list.</span
      ><span
      >
</span
      ><span id="line-146"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274438"
      ><span class="annot"
	><span class="annottext"
	  >topWeight :: Double
</span
	  ><a href="#local-6989586621679274438"
	  ><span class="hs-identifier hs-var hs-var"
	    >topWeight</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274430"
	><span class="hs-identifier hs-var"
	  >scaling</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Float.html#%2A%2A"
	><span class="hs-operator hs-var"
	  >**</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#fromIntegral"
	><span class="hs-identifier hs-var"
	  >fromIntegral</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274423"
	><span class="hs-identifier hs-var"
	  >xs0</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274425"
	><span class="hs-identifier hs-var"
	  >initWeight</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-147"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- The weight of the &quot;do nothing&quot; operation.</span
      ><span
      >
</span
      ><span id="line-148"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274454"
      ><span class="annot"
	><span class="annottext"
	  >noopWeight :: Int
</span
	  ><a href="#local-6989586621679274454"
	  ><span class="hs-identifier hs-var hs-var"
	    >noopWeight</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Int
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#floor"
	><span class="hs-identifier hs-var"
	  >floor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274438"
	><span class="hs-identifier hs-var"
	  >topWeight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><span class="hs-number"
	>1</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#%2F"
	><span class="hs-operator hs-var"
	  >/</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274421"
	><span class="hs-identifier hs-var"
	  >lastProb</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-149"
      ></span
      ><span
      >
</span
      ><span id="line-150"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><a href="#local-6989586621679274424"
	><span class="hs-identifier hs-type"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	><span class="hs-identifier hs-type"
	  >Bool</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	><span class="hs-identifier hs-type"
	  >Double</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><a href="#local-6989586621679274241"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier hs-type"
	>Gen</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><a href="#local-6989586621679274241"
	><span class="hs-identifier hs-type"
	  >a</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-151"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274424"
      ><span class="annot"
	><span class="annottext"
	  >go :: Bool -&gt; Double -&gt; [a] -&gt; Gen [a]
</span
	  ><a href="#local-6989586621679274424"
	  ><span class="hs-identifier hs-var hs-var"
	    >go</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274457"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274457"
	  ><span class="hs-identifier hs-var"
	    >keep</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274458"
      ><span class="annot"
	><span class="annottext"
	  >Double
</span
	  ><a href="#local-6989586621679274458"
	  ><span class="hs-identifier hs-var"
	    >weight</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274459"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274459"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-152"
      ></span
      ><span
      >        </span
      ><span id="local-6989586621679274460"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274460"
	  ><span class="hs-identifier hs-var"
	    >doCons</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[(Int, Gen Bool)] -&gt; Gen Bool
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span
	><span class="hs-identifier hs-var"
	>frequency</span
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Int
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Real.html#floor"
	><span class="hs-identifier hs-var"
	  >floor</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274458"
	><span class="hs-identifier hs-var"
	  >weight</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Gen Bool
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621679274454"
	><span class="hs-identifier hs-var"
	  >noopWeight</span
	  ></a
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Gen Bool
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#False"
	><span class="hs-identifier hs-var"
	  >False</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-153"
      ></span
      ><span
      >        </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274460"
	><span class="hs-identifier hs-var"
	  >doCons</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-154"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- If we don't want to insert elements into the head of the list, then we simply ignore</span
      ><span
      >
</span
      ><span id="line-155"
      ></span
      ><span
      >            </span
      ><span class="hs-comment"
      >-- the generated one and carry on. Ugly, but works.</span
      ><span
      >
</span
      ><span id="line-156"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274422"
	><span class="hs-identifier hs-var"
	  >y</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274457"
	><span class="hs-identifier hs-var"
	  >keep</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; [a]) -&gt; Gen [a] -&gt; Gen [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; [a] -&gt; Gen [a]
</span
	><a href="#local-6989586621679274424"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274457"
	><span class="hs-identifier hs-var"
	  >keep</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274458"
	><span class="hs-identifier hs-var"
	  >weight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274459"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-157"
      ></span
      ><span
      >            </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274459"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><span id="line-158"
      ></span
      ><span
      >                </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      >      </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Gen [a]
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-159"
      ></span
      ><span
      >                </span
      ><span id="local-6989586621679274462"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274462"
	  ><span class="hs-identifier hs-var"
	    >x</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-type"
	  >:</span
	  ></a
	></span
      ><span
      > </span
      ><span id="local-6989586621679274463"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274463"
	  ><span class="hs-identifier hs-var"
	    >xs'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274462"
	><span class="hs-identifier hs-var"
	  >x</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#%3A"
	><span class="hs-glyph hs-var"
	  >:</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; [a]) -&gt; Gen [a] -&gt; Gen [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; [a] -&gt; Gen [a]
</span
	><a href="#local-6989586621679274424"
	><span class="hs-identifier hs-var"
	  >go</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274458"
	><span class="hs-identifier hs-var"
	  >weight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2A"
	><span class="hs-operator hs-var"
	  >*</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274430"
	><span class="hs-identifier hs-var"
	  >scaling</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274463"
	><span class="hs-identifier hs-var"
	  >xs'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-160"
      ></span
      ><span
      >
</span
      ><span id="line-161"
      ></span
      ><span class="hs-comment"
      >-- | Insert a value into a list an arbitrary number of times. The first argument controls whether</span
      ><span
      >
</span
      ><span id="line-162"
      ></span
      ><span class="hs-comment"
      >-- to allow inserting at the end of the list, the second argument is the probability of</span
      ><span
      >
</span
      ><span id="line-163"
      ></span
      ><span class="hs-comment"
      >-- inserting an element at the beginning of the list.</span
      ><span
      >
</span
      ><span id="line-164"
      ></span
      ><span id="local-6989586621679274464"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferLeft"
	  ><span class="hs-identifier hs-type"
	    >insertManyPreferLeft</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Bool"
	  ><span class="hs-identifier hs-type"
	    >Bool</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	  ><span class="hs-identifier hs-type"
	    >Double</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621679274464"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274464"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274464"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-165"
      ></span
      ><span id="insertManyPreferLeft"
      ><span class="annot"
	><span class="annottext"
	  >insertManyPreferLeft :: forall a. Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferLeft"
	  ><span class="hs-identifier hs-var hs-var"
	    >insertManyPreferLeft</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274467"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274467"
	  ><span class="hs-identifier hs-var"
	    >keepSuffix</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274468"
      ><span class="annot"
	><span class="annottext"
	  >Double
</span
	  ><a href="#local-6989586621679274468"
	  ><span class="hs-identifier hs-var"
	    >headProb</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274469"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274469"
	  ><span class="hs-identifier hs-var"
	    >y</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      >
</span
      ><span id="line-166"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; [a]) -&gt; Gen [a] -&gt; Gen [a]
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#reverse"
	><span class="hs-identifier hs-var"
	  >reverse</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Gen [a] -&gt; Gen [a]) -&gt; ([a] -&gt; Gen [a]) -&gt; [a] -&gt; Gen [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
forall a. Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferRight"
	><span class="hs-identifier hs-var"
	  >insertManyPreferRight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274467"
	><span class="hs-identifier hs-var"
	  >keepSuffix</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274468"
	><span class="hs-identifier hs-var"
	  >headProb</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274469"
	><span class="hs-identifier hs-var"
	  >y</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; Gen [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; Gen [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#reverse"
	><span class="hs-identifier hs-var"
	  >reverse</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-167"
      ></span
      ><span
      >
</span
      ><span id="line-168"
      ></span
      ><span class="hs-comment"
      >-- | Insert a value into a list an arbitrary number of times. The first argument is the probability</span
      ><span
      >
</span
      ><span id="line-169"
      ></span
      ><span class="hs-comment"
      >-- of inserting an element at an end of the list (i.e. either the beginning or the end, not</span
      ><span
      >
</span
      ><span id="line-170"
      ></span
      ><span class="hs-comment"
      >-- combined). See 'multiSplit1' for what this function allows us to do.</span
      ><span
      >
</span
      ><span id="line-171"
      ></span
      ><span id="local-6989586621679274250"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferEnds"
	  ><span class="hs-identifier hs-type"
	    >insertManyPreferEnds</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	  ><span class="hs-identifier hs-type"
	    >Double</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><a href="#local-6989586621679274250"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274250"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274250"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-172"
      ></span
      ><span class="hs-comment"
      >-- Cut the list in half, insert into the left half skewing generation towards the beginning, insert</span
      ><span
      >
</span
      ><span id="line-173"
      ></span
      ><span class="hs-comment"
      >-- into the right half skewing generation towards the end, then append the results of those two</span
      ><span
      >
</span
      ><span id="line-174"
      ></span
      ><span class="hs-comment"
      >-- operations, so that we get a list where additional elements are more likely to occur close to</span
      ><span
      >
</span
      ><span id="line-175"
      ></span
      ><span class="hs-comment"
      >-- the sides.</span
      ><span
      >
</span
      ><span id="line-176"
      ></span
      ><span id="insertManyPreferEnds"
      ><span class="annot"
	><span class="annottext"
	  >insertManyPreferEnds :: forall a. Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferEnds"
	  ><span class="hs-identifier hs-var hs-var"
	    >insertManyPreferEnds</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274481"
      ><span class="annot"
	><span class="annottext"
	  >Double
</span
	  ><a href="#local-6989586621679274481"
	  ><span class="hs-identifier hs-var"
	    >endProb</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274482"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621679274482"
	  ><span class="hs-identifier hs-var"
	    >y</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274483"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274483"
	  ><span class="hs-identifier hs-var"
	    >xs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-177"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- In order not to get skewed results we sometimes put the middle element of the list into its</span
      ><span
      >
</span
      ><span id="line-178"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- first half and sometimes into its second half.</span
      ><span
      >
</span
      ><span id="line-179"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274484"
      ><span class="annot"
	><span class="annottext"
	  >Bool
</span
	  ><a href="#local-6989586621679274484"
	  ><span class="hs-identifier hs-var"
	    >isOddToLeft</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Gen Bool
forall a. Arbitrary a =&gt; Gen a
</span
	><span class="hs-identifier hs-var"
	>arbitrary</span
	></span
      ><span
      >
</span
      ><span id="line-180"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span id="local-6989586621679274486"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274486"
	  ><span class="hs-identifier hs-var"
	    >xsL</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span id="local-6989586621679274487"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274487"
	  ><span class="hs-identifier hs-var"
	    >xsR</span
	    ></a
	  ></span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; [a] -&gt; ([a], [a])
forall a. Bool -&gt; [a] -&gt; ([a], [a])
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#halve"
	><span class="hs-identifier hs-var"
	  >halve</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="#local-6989586621679274484"
	><span class="hs-identifier hs-var"
	  >isOddToLeft</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274483"
	><span class="hs-identifier hs-var"
	  >xs</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-181"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- If the list has even length, then it was cut into two halves of equal length meaning one slot</span
      ><span
      >
</span
      ><span id="line-182"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- for to put an element in appears twice: at the end of the left half and at the beginning of</span
      ><span
      >
</span
      ><span id="line-183"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- the right one. Hence in order to avoid skeweness we don't put anything into this slot at the</span
      ><span
      >
</span
      ><span id="line-184"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- end of the left half.</span
      ><span
      >
</span
      ><span id="line-185"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- Maybe we do want to skew generation to favor the middle of the list like we do for its ends,</span
      ><span
      >
</span
      ><span id="line-186"
      ></span
      ><span
      >    </span
      ><span class="hs-comment"
      >-- but then we need to do that intentionally and systematically, not randomly and a little bit.</span
      ><span
      >
</span
      ><span id="line-187"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274488"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274488"
	  ><span class="hs-identifier hs-var"
	    >xsL'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
forall a. Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferLeft"
	><span class="hs-identifier hs-var"
	  >insertManyPreferLeft</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274486"
	><span class="hs-identifier hs-var"
	  >xsL</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%2F%3D"
	><span class="hs-operator hs-var"
	  >/=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#length"
	><span class="hs-identifier hs-var"
	  >length</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274487"
	><span class="hs-identifier hs-var"
	  >xsR</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274481"
	><span class="hs-identifier hs-var"
	  >endProb</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274482"
	><span class="hs-identifier hs-var"
	  >y</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274486"
	><span class="hs-identifier hs-var"
	  >xsL</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-188"
      ></span
      ><span
      >    </span
      ><span id="local-6989586621679274490"
      ><span class="annot"
	><span class="annottext"
	  >[a]
</span
	  ><a href="#local-6989586621679274490"
	  ><span class="hs-identifier hs-var"
	    >xsR'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
forall a. Bool -&gt; Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferRight"
	><span class="hs-identifier hs-var"
	  >insertManyPreferRight</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#True"
	><span class="hs-identifier hs-var"
	  >True</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274481"
	><span class="hs-identifier hs-var"
	  >endProb</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621679274482"
	><span class="hs-identifier hs-var"
	  >y</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274487"
	><span class="hs-identifier hs-var"
	  >xsR</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-189"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Gen [a]
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; Gen [a]) -&gt; [a] -&gt; Gen [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274488"
	><span class="hs-identifier hs-var"
	  >xsL'</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a]
</span
	><a href="#local-6989586621679274490"
	><span class="hs-identifier hs-var"
	  >xsR'</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-190"
      ></span
      ><span
      >
</span
      ><span id="line-191"
      ></span
      ><span class="hs-comment"
      >-- | Split a list into chunks at random. Concatenating the resulting lists gives back the original</span
      ><span
      >
</span
      ><span id="line-192"
      ></span
      ><span class="hs-comment"
      >-- one. Generates empty chunks. The first argument is the probability of generating at least one</span
      ><span
      >
</span
      ><span id="line-193"
      ></span
      ><span class="hs-comment"
      >-- empty chunk as the first element of the resulting list. It is also the probability of generating</span
      ><span
      >
</span
      ><span id="line-194"
      ></span
      ><span class="hs-comment"
      >-- an empty chunk as the last element of the resulting list. The probability of generating empty</span
      ><span
      >
</span
      ><span id="line-195"
      ></span
      ><span class="hs-comment"
      >-- chunks decreases as we go from either of the ends of the resulting list (this is so that we are</span
      ><span
      >
</span
      ><span id="line-196"
      ></span
      ><span class="hs-comment"
      >-- more likely to hit a corner case related to handling elements at the beginning or the end of a</span
      ><span
      >
</span
      ><span id="line-197"
      ></span
      ><span class="hs-comment"
      >-- list).</span
      ><span
      >
</span
      ><span id="line-198"
      ></span
      ><span id="local-6989586621679274255"
      ><span class="annot"
	><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit0"
	  ><span class="hs-identifier hs-type"
	    >multiSplit0</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>::</span
	><span
	> </span
	><span class="annot"
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Double"
	  ><span class="hs-identifier hs-type"
	    >Double</span
	    ></a
	  ></span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274255"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span
	> </span
	><span class="hs-glyph"
	>-&gt;</span
	><span
	> </span
	><span class="annot"
	><span class="hs-identifier hs-type"
	  >Gen</span
	  ></span
	><span
	> </span
	><span class="hs-special"
	>[</span
	><span class="hs-special"
	>[</span
	><span class="annot"
	><a href="#local-6989586621679274255"
	  ><span class="hs-identifier hs-type"
	    >a</span
	    ></a
	  ></span
	><span class="hs-special"
	>]</span
	><span class="hs-special"
	>]</span
	></span
      ><span
      >
</span
      ><span id="line-199"
      ></span
      ><span id="multiSplit0"
      ><span class="annot"
	><span class="annottext"
	  >multiSplit0 :: forall a. Double -&gt; [a] -&gt; Gen [[a]]
</span
	  ><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit0"
	  ><span class="hs-identifier hs-var hs-var"
	    >multiSplit0</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621679274494"
      ><span class="annot"
	><span class="annottext"
	  >Double
</span
	  ><a href="#local-6989586621679274494"
	  ><span class="hs-identifier hs-var"
	    >endProb</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[a] -&gt; Gen [NonEmptyList a]
forall a. [a] -&gt; Gen [NonEmptyList a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#multiSplit1"
	><span class="hs-identifier hs-var"
	  >multiSplit1</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([a] -&gt; Gen [NonEmptyList a])
-&gt; ([NonEmptyList a] -&gt; Gen [[a]]) -&gt; [a] -&gt; Gen [[a]]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Control.Monad.html#%3E%3D%3E"
	><span class="hs-operator hs-var"
	  >&gt;=&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double -&gt; [a] -&gt; [[a]] -&gt; Gen [[a]]
forall a. Double -&gt; a -&gt; [a] -&gt; Gen [a]
</span
	><a href="PlutusCore.Generators.QuickCheck.Split.html#insertManyPreferEnds"
	><span class="hs-identifier hs-var"
	  >insertManyPreferEnds</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Double
</span
	><a href="#local-6989586621679274494"
	><span class="hs-identifier hs-var"
	  >endProb</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([[a]] -&gt; Gen [[a]])
-&gt; ([NonEmptyList a] -&gt; [[a]]) -&gt; [NonEmptyList a] -&gt; Gen [[a]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[NonEmptyList a] -&gt; [[a]]
forall a b. Coercible a b =&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Prim.html#coerce"
	><span class="hs-identifier hs-var"
	  >coerce</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-200"
      ></span
      ></pre
    ></body
  ></html
>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE BangPatterns #-}</span
      ><span
      >
</span
      ><span id="line-2"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TemplateHaskell #-}</span
      ><span
      >
</span
      ><span id="line-3"
      ></span
      ><span class="hs-pragma"
      >{-# LANGUAGE TypeApplications #-}</span
      ><span
      >
</span
      ><span id="line-4"
      ></span
      ><span
      >
</span
      ><span id="line-5"
      ></span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >PlutusTx.Data.List.TH</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><span id="line-6"
      ></span
      ><span
      >
</span
      ><span id="line-7"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.html"
	><span class="hs-identifier"
	  >Data.Set</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.Internal.html#Set"
	><span class="hs-identifier"
	  >Set</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-8"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.html"
	><span class="hs-identifier"
	  >Data.Set</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>Set</span
	></span
      ><span
      >
</span
      ><span id="line-9"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html"
	><span class="hs-identifier"
	  >Data.Traversable</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier"
	  >for</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-10"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.html"
	><span class="hs-identifier"
	  >Language.Haskell.TH</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>TH</span
	></span
      ><span
      >
</span
      ><span id="line-11"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusTx.Data.List.html"
	><span class="hs-identifier"
	  >PlutusTx.Data.List</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="annot"
      ><span class="hs-identifier"
	>List</span
	></span
      ><span
      >
</span
      ><span id="line-12"
      ></span
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Prelude.html"
	><span class="hs-identifier"
	  >Prelude</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-13"
      ></span
      ><span
      >
</span
      ><span id="line-14"
      ></span
      ><span class="annot"
      ><span class="hs-comment"
	>{-| Generate variables bound to the given indices of a @BuiltinList@.

Sample Usage:

 @
   f :: List Integer -&gt; Integer
   f list =
   $( destructList
        &quot;s&quot;
        (Set.fromList [1, 4, 5])
        'list
        [|s1 + s4 + s5|]
    )
 @

This computes the sum of list elements at indices 1, 4 and 5. -}</span
	></span
      ><span
      >
</span
      ><span id="line-30"
      ></span
      ><span class="annot"
      ><a href="PlutusTx.Data.List.TH.html#destructList"
	><span class="hs-identifier hs-type"
	  >destructList</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-31"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#String"
	><span class="hs-identifier hs-type"
	  >String</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-32"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ Prefix of the generated bindings</span
	></span
      ><span
      >
</span
      ><span id="line-33"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.Internal.html#Set"
	><span class="hs-identifier hs-type"
	  >Set</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Types.html#Int"
	><span class="hs-identifier hs-type"
	  >Int</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-34"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ Element ids you need, starting from 0</span
	></span
      ><span
      >
</span
      ><span id="line-35"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Syntax.html#Name"
	><span class="hs-identifier hs-type"
	  >TH.Name</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-36"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ The builtin list to destruct</span
	></span
      ><span
      >
</span
      ><span id="line-37"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#ExpQ"
	><span class="hs-identifier hs-type"
	  >TH.ExpQ</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-38"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="hs-comment"
	>-- ^ The computation that consumes the elements</span
	></span
      ><span
      >
</span
      ><span id="line-39"
      ></span
      ><span
      >  </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#ExpQ"
	><span class="hs-identifier hs-type"
	  >TH.ExpQ</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-40"
      ></span
      ><span id="destructList"
      ><span class="annot"
	><span class="annottext"
	  >destructList :: String -&gt; Set Int -&gt; Name -&gt; ExpQ -&gt; ExpQ
</span
	  ><a href="PlutusTx.Data.List.TH.html#destructList"
	  ><span class="hs-identifier hs-var hs-var"
	    >destructList</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621680094278"
      ><span class="annot"
	><span class="annottext"
	  >String
</span
	  ><a href="#local-6989586621680094278"
	  ><span class="hs-identifier hs-var"
	    >p</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621680094279"
      ><span class="annot"
	><span class="annottext"
	  >Set Int
</span
	  ><a href="#local-6989586621680094279"
	  ><span class="hs-identifier hs-var"
	    >is</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621680094280"
      ><span class="annot"
	><span class="annottext"
	  >Name
</span
	  ><a href="#local-6989586621680094280"
	  ><span class="hs-identifier hs-var"
	    >n</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621680094281"
      ><span class="annot"
	><span class="annottext"
	  >ExpQ
</span
	  ><a href="#local-6989586621680094281"
	  ><span class="hs-identifier hs-var"
	    >k</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-41"
      ></span
      ><span
      >  </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span id="local-6989586621680094287"
      ><span class="annot"
	><span class="annottext"
	  >strict :: Name -&gt; Q Pat
</span
	  ><a href="#local-6989586621680094287"
	  ><span class="hs-identifier hs-var hs-var"
	    >strict</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Q Pat -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; m Pat -&gt; m Pat
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#bangP"
	><span class="hs-identifier hs-var"
	  >TH.bangP</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Q Pat -&gt; Q Pat) -&gt; (Name -&gt; Q Pat) -&gt; Name -&gt; Q Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#varP"
	><span class="hs-identifier hs-var"
	  >TH.varP</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-42"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621680094294"
      ><span class="annot"
	><span class="annottext"
	  >nonstrict :: Name -&gt; Q Pat
</span
	  ><a href="#local-6989586621680094294"
	  ><span class="hs-identifier hs-var hs-var"
	    >nonstrict</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Q Pat -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; m Pat -&gt; m Pat
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#tildeP"
	><span class="hs-identifier hs-var"
	  >TH.tildeP</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Q Pat -&gt; Q Pat) -&gt; (Name -&gt; Q Pat) -&gt; Name -&gt; Q Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#varP"
	><span class="hs-identifier hs-var"
	  >TH.varP</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-43"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621680094297"
      ><span class="annot"
	><span class="annottext"
	  >elemName :: a -&gt; Name
</span
	  ><a href="#local-6989586621680094297"
	  ><span class="hs-identifier hs-var hs-var"
	    >elemName</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span id="local-6989586621680094298"
      ><span class="annot"
	><span class="annottext"
	  >a
</span
	  ><a href="#local-6989586621680094298"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; Name
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Syntax.html#mkName"
	><span class="hs-identifier hs-var"
	  >TH.mkName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(String -&gt; Name) -&gt; String -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String
</span
	><a href="#local-6989586621680094278"
	><span class="hs-identifier hs-var"
	  >p</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>a
</span
	><a href="#local-6989586621680094298"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-44"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621680094300"
      ><span class="annot"
	><span class="annottext"
	  >[Name]
</span
	  ><a href="#local-6989586621680094300"
	  ><span class="hs-identifier hs-var"
	    >tailNames</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; Q Name) -&gt; Q [Name]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int -&gt; Int
forall a. Ord a =&gt; Set a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#maximum"
	><span class="hs-identifier hs-var"
	  >maximum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int
</span
	><a href="#local-6989586621680094279"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; Q Name) -&gt; Q [Name]) -&gt; (Int -&gt; Q Name) -&gt; Q [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621680094302"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621680094302"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Syntax.html#newName"
	><span class="hs-identifier hs-var"
	  >TH.newName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>String
</span
	><span class="hs-string"
	>&quot;tail&quot;</span
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Show.html#show"
	><span class="hs-identifier hs-var"
	  >show</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094302"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-45"
      ></span
      ><span
      >  </span
      ><span id="local-6989586621680094303"
      ><span class="annot"
	><span class="annottext"
	  >[Dec]
</span
	  ><a href="#local-6989586621680094303"
	  ><span class="hs-identifier hs-var"
	    >decs</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([[[Dec]]] -&gt; [Dec]) -&gt; Q [[[Dec]]] -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#fmap"
	><span class="hs-identifier hs-var"
	  >fmap</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[[Dec]] -&gt; [Dec]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#concat"
	><span class="hs-identifier hs-var"
	  >concat</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([[Dec]] -&gt; [Dec]) -&gt; ([[[Dec]]] -&gt; [[Dec]]) -&gt; [[[Dec]]] -&gt; [Dec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[[[Dec]]] -&gt; [[Dec]]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#concat"
	><span class="hs-identifier hs-var"
	  >concat</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Q [[[Dec]]] -&gt; Q [Dec])
-&gt; ((Int -&gt; Q [[Dec]]) -&gt; Q [[[Dec]]])
-&gt; (Int -&gt; Q [[Dec]])
-&gt; Q [Dec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#."
	><span class="hs-operator hs-var"
	  >.</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Int] -&gt; (Int -&gt; Q [[Dec]]) -&gt; Q [[[Dec]]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#for"
	><span class="hs-identifier hs-var"
	  >for</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >..</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int -&gt; Int
forall a. Ord a =&gt; Set a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#maximum"
	><span class="hs-identifier hs-var"
	  >maximum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int
</span
	><a href="#local-6989586621680094279"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>((Int -&gt; Q [[Dec]]) -&gt; Q [Dec]) -&gt; (Int -&gt; Q [[Dec]]) -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >\</span
      ><span id="local-6989586621680094305"
      ><span class="annot"
	><span class="annottext"
	  >Int
</span
	  ><a href="#local-6989586621680094305"
	  ><span class="hs-identifier hs-var"
	    >i</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-keyword"
      >do</span
      ><span
      >
</span
      ><span id="line-46"
      ></span
      ><span
      >    </span
      ><span class="hs-keyword"
      >let</span
      ><span
      >
</span
      ><span id="line-47"
      ></span
      ><span
      >      </span
      ><span class="hs-comment"
      >-- if tailx is only used once, make it non-strict so that it can be inlined</span
      ><span
      >
</span
      ><span id="line-48"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621680094309"
      ><span class="annot"
	><span class="annottext"
	  >tailStrictness :: Name -&gt; Q Pat
</span
	  ><a href="#local-6989586621680094309"
	  ><span class="hs-identifier hs-var hs-var"
	    >tailStrictness</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.Internal.html#member"
	><span class="hs-identifier hs-var"
	  >Set.member</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#%2B"
	><span class="hs-operator hs-var"
	  >+</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int
</span
	><a href="#local-6989586621680094279"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
</span
	><a href="#local-6989586621680094287"
	><span class="hs-identifier hs-var"
	  >strict</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
</span
	><a href="#local-6989586621680094294"
	><span class="hs-identifier hs-var"
	  >nonstrict</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-49"
      ></span
      ><span
      >      </span
      ><span id="local-6989586621680094318"
      ><span class="annot"
	><span class="annottext"
	  >n' :: Name
</span
	  ><a href="#local-6989586621680094318"
	  ><span class="hs-identifier hs-var hs-var"
	    >n'</span
	    ></a
	  ></span
	></span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%3D%3D"
	><span class="hs-operator hs-var"
	  >==</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>0</span
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621680094280"
	><span class="hs-identifier hs-var"
	  >n</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Name]
</span
	><a href="#local-6989586621680094300"
	><span class="hs-identifier hs-var"
	  >tailNames</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Name] -&gt; Int -&gt; Name
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#%21%21"
	><span class="hs-operator hs-var"
	  >!!</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Num.html#-"
	><span class="hs-glyph hs-var"
	  >-</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><span class="hs-number"
	>1</span
	></span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><span id="line-50"
      ></span
      ><span
      >    </span
      ><span class="annot"
      ><span class="annottext"
	>[Q [Dec]] -&gt; Q [[Dec]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Traversable.html#sequence"
	><span class="hs-identifier hs-var"
	  >sequence</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>([Q [Dec]] -&gt; Q [[Dec]]) -&gt; [Q [Dec]] -&gt; Q [[Dec]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%24"
	><span class="hs-operator hs-var"
	  >$</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-51"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >[</span
      ><span
      > </span
      ><span class="hs-special"
      >[d|</span
      ><span class="hs-special"
      >$</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
</span
	><a href="#local-6989586621680094287"
	><span class="hs-identifier hs-var"
	  >strict</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Name
forall {a}. Show a =&gt; a -&gt; Name
</span
	><a href="#local-6989586621680094297"
	><span class="hs-identifier hs-var"
	  >elemName</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusTx.Data.List.html#head"
	><span class="hs-identifier hs-type"
	  >List.head</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >$</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; ExpQ
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#varE"
	><span class="hs-identifier hs-var"
	  >TH.varE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621680094318"
	><span class="hs-identifier hs-var"
	  >n'</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >|]</span
      ><span
      >
</span
      ><span id="line-52"
      ></span
      ><span
      >      </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/containers-0.6.7/docs/src/Data.Set.Internal.html#member"
	><span class="hs-identifier hs-var"
	  >Set.member</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int
</span
	><a href="#local-6989586621680094279"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-53"
      ></span
      ><span
      >      </span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-54"
      ></span
      ><span
      >        </span
      ><span class="annot"
      ><span class="annottext"
	>[Q [Dec]] -&gt; [Q [Dec]] -&gt; [Q [Dec]]
forall a. [a] -&gt; [a] -&gt; [a]
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#%2B%2B"
	><span class="hs-operator hs-var"
	  >++</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span
      > </span
      ><span class="hs-special"
      >[d|</span
      ><span class="hs-special"
      >$</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; Q Pat
</span
	><a href="#local-6989586621680094309"
	><span class="hs-identifier hs-var"
	  >tailStrictness</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>[Name]
</span
	><a href="#local-6989586621680094300"
	><span class="hs-identifier hs-var"
	  >tailNames</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Name] -&gt; Int -&gt; Name
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.List.html#%21%21"
	><span class="hs-operator hs-var"
	  >!!</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="annot"
      ><a href="PlutusTx.Data.List.html#tail"
	><span class="hs-identifier hs-type"
	  >List.tail</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >$</span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Name -&gt; ExpQ
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#varE"
	><span class="hs-identifier hs-var"
	  >TH.varE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Name
</span
	><a href="#local-6989586621680094318"
	><span class="hs-identifier hs-var"
	  >n'</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >|]</span
      ><span
      >
</span
      ><span id="line-55"
      ></span
      ><span
      >           </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int
</span
	><a href="#local-6989586621680094305"
	><span class="hs-identifier hs-var"
	  >i</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span
	><a href="https://hackage.haskell.org/package/ghc-prim-0.10.0/docs/src/GHC.Classes.html#%2F%3D"
	><span class="hs-operator hs-var"
	  >/=</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int -&gt; Int
forall a. Ord a =&gt; Set a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Foldable.html#maximum"
	><span class="hs-identifier hs-var"
	  >maximum</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>Set Int
</span
	><a href="#local-6989586621680094279"
	><span class="hs-identifier hs-var"
	  >is</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-56"
      ></span
      ><span
      >           </span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><span id="line-57"
      ></span
      ><span
      >  </span
      ><span class="annot"
      ><span class="annottext"
	>[Q Dec] -&gt; ExpQ -&gt; ExpQ
forall (m :: * -&gt; *). Quote m =&gt; [m Dec] -&gt; m Exp -&gt; m Exp
</span
	><a href="https://hackage.haskell.org/package/template-haskell-2.20.0.0/docs/src/Language.Haskell.TH.Lib.Internal.html#letE"
	><span class="hs-identifier hs-var"
	  >TH.letE</span
	  ></a
	></span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="annot"
      ><span class="annottext"
	>Dec -&gt; Q Dec
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/GHC.Base.html#pure"
	><span class="hs-identifier hs-var"
	  >pure</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>(Dec -&gt; Q Dec) -&gt; [Dec] -&gt; [Q Dec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span
	><a href="https://hackage.haskell.org/package/base-4.18.3.0/docs/src/Data.Functor.html#%3C%24%3E"
	><span class="hs-operator hs-var"
	  >&lt;$&gt;</span
	  ></a
	></span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>[Dec]
</span
	><a href="#local-6989586621680094303"
	><span class="hs-identifier hs-var"
	  >decs</span
	  ></a
	></span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="annot"
      ><span class="annottext"
	>ExpQ
</span
	><a href="#local-6989586621680094281"
	><span class="hs-identifier hs-var"
	  >k</span
	  ></a
	></span
      ><span
      >
</span
      ><span id="line-58"
      ></span
      ></pre
    ></body
  ></html
>

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Type.BetaNBE</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>Type.BetaNBE</h1>
    <section>
      <pre class="Agda"><a id="46" class="Keyword">module</a> <a id="53" href="Type.BetaNBE.html" class="Module">Type.BetaNBE</a> <a id="66" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda">
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Function.html" class="Module">Function</a> <a id="115" class="Keyword">using</a> <a id="121" class="Symbol">(</a><a id="122" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="125" class="Symbol">;</a><a id="126" href="Function.Base.html#704" class="Function">id</a><a id="128" class="Symbol">)</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="151" class="Keyword">using</a> <a id="157" class="Symbol">(</a><a id="158" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a><a id="161" class="Symbol">;</a><a id="162" href="Data.Vec.Base.html#1155" class="InductiveConstructor">[]</a><a id="164" class="Symbol">;</a><a id="165" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">_∷_</a><a id="168" class="Symbol">)</a> <a id="170" class="Keyword">renaming</a> <a id="179" class="Symbol">(</a><a id="180" href="Data.Vec.Base.html#2955" class="Function">map</a> <a id="184" class="Symbol">to</a> <a id="187" class="Function">vmap</a><a id="191" class="Symbol">)</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Data.List.html" class="Module">Data.List</a> <a id="215" class="Keyword">using</a> <a id="221" class="Symbol">(</a><a id="222" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="226" class="Symbol">;</a><a id="227" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="229" class="Symbol">;</a><a id="230" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="233" class="Symbol">;</a><a id="234" href="Data.List.Base.html#1634" class="Function">map</a><a id="237" class="Symbol">)</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="260" class="Keyword">using</a> <a id="266" class="Symbol">(</a><a id="267" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a><a id="270" class="Symbol">;</a><a id="271" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="275" class="Symbol">;</a><a id="276" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="280" class="Symbol">)</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Utils.html" class="Module">Utils</a> <a id="301" class="Keyword">using</a> <a id="307" class="Symbol">(</a><a id="308" href="Utils.html#11123" class="Datatype">Kind</a><a id="312" class="Symbol">;</a><a id="313" href="Utils.html#11142" class="InductiveConstructor">*</a><a id="314" class="Symbol">;</a><a id="315" href="Utils.html#11215" class="InductiveConstructor Operator">_⇒_</a><a id="318" class="Symbol">;</a><a id="319" href="Utils.html#11177" class="InductiveConstructor">♯</a><a id="320" class="Symbol">)</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Type.html" class="Module">Type</a> <a id="339" class="Keyword">using</a> <a id="345" class="Symbol">(</a><a id="346" href="Type.html#515" class="Datatype">Ctx⋆</a><a id="350" class="Symbol">;</a><a id="351" href="Type.html#545" class="InductiveConstructor Operator">_,⋆_</a><a id="355" class="Symbol">;</a><a id="356" href="Type.html#1704" class="Datatype Operator">_⊢⋆_</a><a id="360" class="Symbol">;</a><a id="361" href="Type.html#887" class="Datatype Operator">_∋⋆_</a><a id="365" class="Symbol">;</a><a id="366" href="Type.html#921" class="InductiveConstructor">Z</a><a id="367" class="Symbol">;</a><a id="368" href="Type.html#960" class="InductiveConstructor">S</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" href="Type.html#1704" class="Module Operator">_⊢⋆_</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a> <a id="409" class="Keyword">using</a> <a id="415" class="Symbol">(</a><a id="416" href="Type.BetaNormal.html#1043" class="Datatype Operator">_⊢Nf⋆_</a><a id="422" class="Symbol">;</a><a id="423" href="Type.BetaNormal.html#1112" class="Datatype Operator">_⊢Ne⋆_</a><a id="429" class="Symbol">;</a><a id="430" href="Type.BetaNormal.html#2082" class="Function">renNf</a><a id="435" class="Symbol">;</a><a id="436" href="Type.BetaNormal.html#2134" class="Function">renNe</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">open</a> <a id="448" href="Type.BetaNormal.html#1043" class="Module Operator">_⊢Nf⋆_</a>
<a id="455" class="Keyword">open</a> <a id="460" href="Type.BetaNormal.html#1112" class="Module Operator">_⊢Ne⋆_</a>
<a id="467" class="Keyword">open</a> <a id="472" class="Keyword">import</a> <a id="479" href="Type.RenamingSubstitution.html" class="Module">Type.RenamingSubstitution</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Type.RenamingSubstitution.html#1606" class="Function">Ren</a><a id="515" class="Symbol">)</a>
<a id="517" class="Keyword">import</a> <a id="524" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a> <a id="546" class="Symbol">as</a> <a id="549" class="Module">Syn</a>
<a id="553" class="Keyword">import</a> <a id="560" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a> <a id="582" class="Symbol">as</a> <a id="585" class="Module">Nf</a>
</pre>
<p>Values are defined by induction on kind. At kind # and * they are
inert and defined to be just normal forms. At function kind they are
either neutral or Kripke functions</p>

<pre class="Agda"><a id="Val"></a><a id="768" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="772" class="Symbol">:</a> <a id="774" href="Type.html#515" class="Datatype">Ctx⋆</a> <a id="779" class="Symbol">→</a> <a id="781" href="Utils.html#11123" class="Datatype">Kind</a> <a id="786" class="Symbol">→</a> <a id="788" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="792" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="796" href="Type.BetaNBE.html#796" class="Bound">Φ</a> <a id="798" href="Utils.html#11142" class="InductiveConstructor">*</a>       <a id="806" class="Symbol">=</a> <a id="808" href="Type.BetaNBE.html#796" class="Bound">Φ</a> <a id="810" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="815" href="Utils.html#11142" class="InductiveConstructor">*</a>
<a id="817" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="821" href="Type.BetaNBE.html#821" class="Bound">Φ</a> <a id="823" href="Utils.html#11177" class="InductiveConstructor">♯</a>       <a id="831" class="Symbol">=</a> <a id="833" href="Type.BetaNBE.html#821" class="Bound">Φ</a> <a id="835" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="840" href="Utils.html#11177" class="InductiveConstructor">♯</a>
<a id="842" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="846" href="Type.BetaNBE.html#846" class="Bound">Φ</a> <a id="848" class="Symbol">(</a><a id="849" href="Type.BetaNBE.html#849" class="Bound">σ</a> <a id="851" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="853" href="Type.BetaNBE.html#853" class="Bound">τ</a><a id="854" class="Symbol">)</a> <a id="856" class="Symbol">=</a> <a id="858" href="Type.BetaNBE.html#846" class="Bound">Φ</a> <a id="860" href="Type.BetaNormal.html#1112" class="Datatype Operator">⊢Ne⋆</a> <a id="865" class="Symbol">(</a><a id="866" href="Type.BetaNBE.html#849" class="Bound">σ</a> <a id="868" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="870" href="Type.BetaNBE.html#853" class="Bound">τ</a><a id="871" class="Symbol">)</a> <a id="873" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="875" class="Symbol">∀</a> <a id="877" class="Symbol">{</a><a id="878" href="Type.BetaNBE.html#878" class="Bound">Ψ</a><a id="879" class="Symbol">}</a> <a id="881" class="Symbol">→</a> <a id="883" href="Type.RenamingSubstitution.html#1606" class="Function">Ren</a> <a id="887" href="Type.BetaNBE.html#846" class="Bound">Φ</a> <a id="889" href="Type.BetaNBE.html#878" class="Bound">Ψ</a> <a id="891" class="Symbol">→</a> <a id="893" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="897" href="Type.BetaNBE.html#878" class="Bound">Ψ</a> <a id="899" href="Type.BetaNBE.html#849" class="Bound">σ</a> <a id="901" class="Symbol">→</a> <a id="903" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="907" href="Type.BetaNBE.html#878" class="Bound">Ψ</a> <a id="909" href="Type.BetaNBE.html#853" class="Bound">τ</a>
</pre>
<p>We can embed neutral terms into values at any kind using reflect.
reflect is quite simple in this version of NBE and not mutually
defined with reify.</p>

<pre class="Agda"><a id="reflect"></a><a id="1071" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="1079" class="Symbol">:</a> <a id="1081" class="Symbol">∀{</a><a id="1083" href="Type.BetaNBE.html#1083" class="Bound">Φ</a> <a id="1085" href="Type.BetaNBE.html#1085" class="Bound">σ</a><a id="1086" class="Symbol">}</a> <a id="1088" class="Symbol">→</a> <a id="1090" href="Type.BetaNBE.html#1083" class="Bound">Φ</a> <a id="1092" href="Type.BetaNormal.html#1112" class="Datatype Operator">⊢Ne⋆</a> <a id="1097" href="Type.BetaNBE.html#1085" class="Bound">σ</a> <a id="1099" class="Symbol">→</a> <a id="1101" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1105" href="Type.BetaNBE.html#1083" class="Bound">Φ</a> <a id="1107" href="Type.BetaNBE.html#1085" class="Bound">σ</a>
<a id="1109" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="1117" class="Symbol">{</a><a id="1118" class="Argument">σ</a> <a id="1120" class="Symbol">=</a> <a id="1122" href="Utils.html#11177" class="InductiveConstructor">♯</a><a id="1123" class="Symbol">}</a>     <a id="1129" href="Type.BetaNBE.html#1129" class="Bound">n</a> <a id="1131" class="Symbol">=</a> <a id="1133" href="Type.BetaNormal.html#1493" class="InductiveConstructor">ne</a> <a id="1136" href="Type.BetaNBE.html#1129" class="Bound">n</a>
<a id="1138" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="1146" class="Symbol">{</a><a id="1147" class="Argument">σ</a> <a id="1149" class="Symbol">=</a> <a id="1151" href="Utils.html#11142" class="InductiveConstructor">*</a><a id="1152" class="Symbol">}</a>     <a id="1158" href="Type.BetaNBE.html#1158" class="Bound">n</a> <a id="1160" class="Symbol">=</a> <a id="1162" href="Type.BetaNormal.html#1493" class="InductiveConstructor">ne</a> <a id="1165" href="Type.BetaNBE.html#1158" class="Bound">n</a>
<a id="1167" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="1175" class="Symbol">{</a><a id="1176" class="Argument">σ</a> <a id="1178" class="Symbol">=</a> <a id="1180" href="Type.BetaNBE.html#1180" class="Bound">σ</a> <a id="1182" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="1184" href="Type.BetaNBE.html#1184" class="Bound">τ</a><a id="1185" class="Symbol">}</a> <a id="1187" href="Type.BetaNBE.html#1187" class="Bound">n</a> <a id="1189" class="Symbol">=</a> <a id="1191" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1196" href="Type.BetaNBE.html#1187" class="Bound">n</a>
</pre>
<p>A shorthand for creating a new fresh variable as a value which we need
in reify</p>

<pre class="Agda"><a id="fresh"></a><a id="1288" href="Type.BetaNBE.html#1288" class="Function">fresh</a> <a id="1294" class="Symbol">:</a> <a id="1296" class="Symbol">∀</a> <a id="1298" class="Symbol">{</a><a id="1299" href="Type.BetaNBE.html#1299" class="Bound">Φ</a> <a id="1301" href="Type.BetaNBE.html#1301" class="Bound">σ</a><a id="1302" class="Symbol">}</a> <a id="1304" class="Symbol">→</a> <a id="1306" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1310" class="Symbol">(</a><a id="1311" href="Type.BetaNBE.html#1299" class="Bound">Φ</a> <a id="1313" href="Type.html#545" class="InductiveConstructor Operator">,⋆</a> <a id="1316" href="Type.BetaNBE.html#1301" class="Bound">σ</a><a id="1317" class="Symbol">)</a> <a id="1319" href="Type.BetaNBE.html#1301" class="Bound">σ</a>
<a id="1321" href="Type.BetaNBE.html#1288" class="Function">fresh</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="1337" class="Symbol">(</a><a id="1338" href="Type.BetaNormal.html#1147" class="InductiveConstructor">`</a> <a id="1340" href="Type.html#921" class="InductiveConstructor">Z</a><a id="1341" class="Symbol">)</a>
</pre>
<p>Renaming for values</p>

<pre class="Agda"><a id="renVal"></a><a id="1373" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1380" class="Symbol">:</a> <a id="1382" class="Symbol">∀</a> <a id="1384" class="Symbol">{</a><a id="1385" href="Type.BetaNBE.html#1385" class="Bound">σ</a> <a id="1387" href="Type.BetaNBE.html#1387" class="Bound">Φ</a> <a id="1389" href="Type.BetaNBE.html#1389" class="Bound">Ψ</a><a id="1390" class="Symbol">}</a> <a id="1392" class="Symbol">→</a> <a id="1394" href="Type.RenamingSubstitution.html#1606" class="Function">Ren</a> <a id="1398" href="Type.BetaNBE.html#1387" class="Bound">Φ</a> <a id="1400" href="Type.BetaNBE.html#1389" class="Bound">Ψ</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1408" href="Type.BetaNBE.html#1387" class="Bound">Φ</a> <a id="1410" href="Type.BetaNBE.html#1385" class="Bound">σ</a> <a id="1412" class="Symbol">→</a> <a id="1414" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1418" href="Type.BetaNBE.html#1389" class="Bound">Ψ</a> <a id="1420" href="Type.BetaNBE.html#1385" class="Bound">σ</a>
<a id="1422" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1429" class="Symbol">{</a><a id="1430" href="Utils.html#11142" class="InductiveConstructor">*</a><a id="1431" class="Symbol">}</a>     <a id="1437" href="Type.BetaNBE.html#1437" class="Bound">ψ</a> <a id="1439" href="Type.BetaNBE.html#1439" class="Bound">n</a>        <a id="1448" class="Symbol">=</a> <a id="1450" href="Type.BetaNormal.html#2082" class="Function">renNf</a> <a id="1456" href="Type.BetaNBE.html#1437" class="Bound">ψ</a> <a id="1458" href="Type.BetaNBE.html#1439" class="Bound">n</a>
<a id="1460" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1467" class="Symbol">{</a><a id="1468" href="Utils.html#11177" class="InductiveConstructor">♯</a><a id="1469" class="Symbol">}</a>     <a id="1475" href="Type.BetaNBE.html#1475" class="Bound">ψ</a> <a id="1477" href="Type.BetaNBE.html#1477" class="Bound">n</a>        <a id="1486" class="Symbol">=</a> <a id="1488" href="Type.BetaNormal.html#2082" class="Function">renNf</a> <a id="1494" href="Type.BetaNBE.html#1475" class="Bound">ψ</a> <a id="1496" href="Type.BetaNBE.html#1477" class="Bound">n</a>
<a id="1498" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1505" class="Symbol">{</a><a id="1506" href="Type.BetaNBE.html#1506" class="Bound">σ</a> <a id="1508" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="1510" href="Type.BetaNBE.html#1510" class="Bound">τ</a><a id="1511" class="Symbol">}</a> <a id="1513" href="Type.BetaNBE.html#1513" class="Bound">ψ</a> <a id="1515" class="Symbol">(</a><a id="1516" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1521" href="Type.BetaNBE.html#1521" class="Bound">n</a><a id="1522" class="Symbol">)</a> <a id="1524" class="Symbol">=</a> <a id="1526" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Type.BetaNormal.html#2134" class="Function">renNe</a> <a id="1538" href="Type.BetaNBE.html#1513" class="Bound">ψ</a> <a id="1540" href="Type.BetaNBE.html#1521" class="Bound">n</a><a id="1541" class="Symbol">)</a>
<a id="1543" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1550" class="Symbol">{</a><a id="1551" href="Type.BetaNBE.html#1551" class="Bound">σ</a> <a id="1553" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="1555" href="Type.BetaNBE.html#1555" class="Bound">τ</a><a id="1556" class="Symbol">}</a> <a id="1558" href="Type.BetaNBE.html#1558" class="Bound">ψ</a> <a id="1560" class="Symbol">(</a><a id="1561" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1566" href="Type.BetaNBE.html#1566" class="Bound">f</a><a id="1567" class="Symbol">)</a> <a id="1569" class="Symbol">=</a> <a id="1571" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1576" class="Symbol">λ</a> <a id="1578" href="Type.BetaNBE.html#1578" class="Bound">ρ&#39;</a> <a id="1581" class="Symbol">→</a>  <a id="1584" href="Type.BetaNBE.html#1566" class="Bound">f</a> <a id="1586" class="Symbol">(</a><a id="1587" href="Type.BetaNBE.html#1578" class="Bound">ρ&#39;</a> <a id="1590" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1592" href="Type.BetaNBE.html#1558" class="Bound">ψ</a><a id="1593" class="Symbol">)</a>
</pre>
<p>Weakening for values</p>

<pre class="Agda"><a id="weakenVal"></a><a id="1626" href="Type.BetaNBE.html#1626" class="Function">weakenVal</a> <a id="1636" class="Symbol">:</a> <a id="1638" class="Symbol">∀</a> <a id="1640" class="Symbol">{</a><a id="1641" href="Type.BetaNBE.html#1641" class="Bound">σ</a> <a id="1643" href="Type.BetaNBE.html#1643" class="Bound">Φ</a> <a id="1645" href="Type.BetaNBE.html#1645" class="Bound">K</a><a id="1646" class="Symbol">}</a> <a id="1648" class="Symbol">→</a> <a id="1650" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1654" href="Type.BetaNBE.html#1643" class="Bound">Φ</a> <a id="1656" href="Type.BetaNBE.html#1641" class="Bound">σ</a> <a id="1658" class="Symbol">→</a> <a id="1660" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1664" class="Symbol">(</a><a id="1665" href="Type.BetaNBE.html#1643" class="Bound">Φ</a> <a id="1667" href="Type.html#545" class="InductiveConstructor Operator">,⋆</a> <a id="1670" href="Type.BetaNBE.html#1645" class="Bound">K</a><a id="1671" class="Symbol">)</a> <a id="1673" href="Type.BetaNBE.html#1641" class="Bound">σ</a>
<a id="1675" href="Type.BetaNBE.html#1626" class="Function">weakenVal</a> <a id="1685" class="Symbol">=</a> <a id="1687" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="1694" href="Type.html#960" class="InductiveConstructor">S</a>
</pre>
<p>Reify takes a value and yields a normal form.</p>

<pre class="Agda"><a id="reify"></a><a id="1752" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1758" class="Symbol">:</a> <a id="1760" class="Symbol">∀</a> <a id="1762" class="Symbol">{</a><a id="1763" href="Type.BetaNBE.html#1763" class="Bound">σ</a> <a id="1765" href="Type.BetaNBE.html#1765" class="Bound">Φ</a><a id="1766" class="Symbol">}</a> <a id="1768" class="Symbol">→</a> <a id="1770" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="1774" href="Type.BetaNBE.html#1765" class="Bound">Φ</a> <a id="1776" href="Type.BetaNBE.html#1763" class="Bound">σ</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Type.BetaNBE.html#1765" class="Bound">Φ</a> <a id="1782" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="1787" href="Type.BetaNBE.html#1763" class="Bound">σ</a>
<a id="1789" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1795" class="Symbol">{</a><a id="1796" href="Utils.html#11142" class="InductiveConstructor">*</a><a id="1797" class="Symbol">}</a>     <a id="1803" href="Type.BetaNBE.html#1803" class="Bound">n</a>         <a id="1813" class="Symbol">=</a> <a id="1815" href="Type.BetaNBE.html#1803" class="Bound">n</a>
<a id="1817" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1823" class="Symbol">{</a><a id="1824" href="Utils.html#11177" class="InductiveConstructor">♯</a><a id="1825" class="Symbol">}</a>     <a id="1831" href="Type.BetaNBE.html#1831" class="Bound">n</a>         <a id="1841" class="Symbol">=</a> <a id="1843" href="Type.BetaNBE.html#1831" class="Bound">n</a>
<a id="1845" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1851" class="Symbol">{</a><a id="1852" href="Type.BetaNBE.html#1852" class="Bound">σ</a> <a id="1854" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="1856" href="Type.BetaNBE.html#1856" class="Bound">τ</a><a id="1857" class="Symbol">}</a> <a id="1859" class="Symbol">(</a><a id="1860" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1865" href="Type.BetaNBE.html#1865" class="Bound">n</a><a id="1866" class="Symbol">)</a>  <a id="1869" class="Symbol">=</a> <a id="1871" href="Type.BetaNormal.html#1493" class="InductiveConstructor">ne</a> <a id="1874" href="Type.BetaNBE.html#1865" class="Bound">n</a>
<a id="1876" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1882" class="Symbol">{</a><a id="1883" href="Type.BetaNBE.html#1883" class="Bound">σ</a> <a id="1885" href="Utils.html#11215" class="InductiveConstructor Operator">⇒</a> <a id="1887" href="Type.BetaNBE.html#1887" class="Bound">τ</a><a id="1888" class="Symbol">}</a> <a id="1890" class="Symbol">(</a><a id="1891" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1896" href="Type.BetaNBE.html#1896" class="Bound">f</a><a id="1897" class="Symbol">)</a>  <a id="1900" class="Symbol">=</a> <a id="1902" href="Type.BetaNormal.html#1433" class="InductiveConstructor">ƛ</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Type.BetaNBE.html#1896" class="Bound">f</a> <a id="1914" href="Type.html#960" class="InductiveConstructor">S</a> <a id="1916" href="Type.BetaNBE.html#1288" class="Function">fresh</a><a id="1921" class="Symbol">))</a> <a id="1924" class="Comment">-- has a name been lost here?</a>
</pre>
<p>An environment is a mapping from variables to values</p>

<pre class="Agda"><a id="Env"></a><a id="2017" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2021" class="Symbol">:</a> <a id="2023" href="Type.html#515" class="Datatype">Ctx⋆</a> <a id="2028" class="Symbol">→</a> <a id="2030" href="Type.html#515" class="Datatype">Ctx⋆</a> <a id="2035" class="Symbol">→</a> <a id="2037" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2041" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2045" href="Type.BetaNBE.html#2045" class="Bound">Ψ</a> <a id="2047" href="Type.BetaNBE.html#2047" class="Bound">Φ</a> <a id="2049" class="Symbol">=</a> <a id="2051" class="Symbol">∀{</a><a id="2053" href="Type.BetaNBE.html#2053" class="Bound">J</a><a id="2054" class="Symbol">}</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Type.BetaNBE.html#2045" class="Bound">Ψ</a> <a id="2060" href="Type.html#887" class="Datatype Operator">∋⋆</a> <a id="2063" href="Type.BetaNBE.html#2053" class="Bound">J</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="2071" href="Type.BetaNBE.html#2047" class="Bound">Φ</a> <a id="2073" href="Type.BetaNBE.html#2053" class="Bound">J</a>
</pre>
<p>‘cons’ for environments</p>

<pre class="Agda"><a id="_,,⋆_"></a><a id="2109" href="Type.BetaNBE.html#2109" class="Function Operator">_,,⋆_</a> <a id="2115" class="Symbol">:</a> <a id="2117" class="Symbol">∀{</a><a id="2119" href="Type.BetaNBE.html#2119" class="Bound">Ψ</a> <a id="2121" href="Type.BetaNBE.html#2121" class="Bound">Φ</a><a id="2122" class="Symbol">}</a> <a id="2124" class="Symbol">→</a> <a id="2126" class="Symbol">(</a><a id="2127" href="Type.BetaNBE.html#2127" class="Bound">σ</a> <a id="2129" class="Symbol">:</a> <a id="2131" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2135" href="Type.BetaNBE.html#2121" class="Bound">Φ</a> <a id="2137" href="Type.BetaNBE.html#2119" class="Bound">Ψ</a><a id="2138" class="Symbol">)</a> <a id="2140" class="Symbol">→</a> <a id="2142" class="Symbol">∀{</a><a id="2144" href="Type.BetaNBE.html#2144" class="Bound">K</a><a id="2145" class="Symbol">}(</a><a id="2147" href="Type.BetaNBE.html#2147" class="Bound">A</a> <a id="2149" class="Symbol">:</a> <a id="2151" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="2155" href="Type.BetaNBE.html#2119" class="Bound">Ψ</a> <a id="2157" href="Type.BetaNBE.html#2144" class="Bound">K</a><a id="2158" class="Symbol">)</a> <a id="2160" class="Symbol">→</a> <a id="2162" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2166" class="Symbol">(</a><a id="2167" href="Type.BetaNBE.html#2121" class="Bound">Φ</a> <a id="2169" href="Type.html#545" class="InductiveConstructor Operator">,⋆</a> <a id="2172" href="Type.BetaNBE.html#2144" class="Bound">K</a><a id="2173" class="Symbol">)</a> <a id="2175" href="Type.BetaNBE.html#2119" class="Bound">Ψ</a>
<a id="2177" class="Symbol">(</a><a id="2178" href="Type.BetaNBE.html#2178" class="Bound">σ</a> <a id="2180" href="Type.BetaNBE.html#2109" class="Function Operator">,,⋆</a> <a id="2184" href="Type.BetaNBE.html#2184" class="Bound">A</a><a id="2185" class="Symbol">)</a> <a id="2187" href="Type.html#921" class="InductiveConstructor">Z</a>     <a id="2193" class="Symbol">=</a> <a id="2195" href="Type.BetaNBE.html#2184" class="Bound">A</a>
<a id="2197" class="Symbol">(</a><a id="2198" href="Type.BetaNBE.html#2198" class="Bound">σ</a> <a id="2200" href="Type.BetaNBE.html#2109" class="Function Operator">,,⋆</a> <a id="2204" href="Type.BetaNBE.html#2204" class="Bound">A</a><a id="2205" class="Symbol">)</a> <a id="2207" class="Symbol">(</a><a id="2208" href="Type.html#960" class="InductiveConstructor">S</a> <a id="2210" href="Type.BetaNBE.html#2210" class="Bound">α</a><a id="2211" class="Symbol">)</a> <a id="2213" class="Symbol">=</a> <a id="2215" href="Type.BetaNBE.html#2198" class="Bound">σ</a> <a id="2217" href="Type.BetaNBE.html#2210" class="Bound">α</a>
</pre>
<pre class="Agda"><a id="exte"></a><a id="2228" href="Type.BetaNBE.html#2228" class="Function">exte</a> <a id="2233" class="Symbol">:</a> <a id="2235" class="Symbol">∀</a> <a id="2237" class="Symbol">{</a><a id="2238" href="Type.BetaNBE.html#2238" class="Bound">Φ</a> <a id="2240" href="Type.BetaNBE.html#2240" class="Bound">Ψ</a><a id="2241" class="Symbol">}</a> <a id="2243" class="Symbol">→</a> <a id="2245" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2249" href="Type.BetaNBE.html#2238" class="Bound">Φ</a> <a id="2251" href="Type.BetaNBE.html#2240" class="Bound">Ψ</a> <a id="2253" class="Symbol">→</a> <a id="2255" class="Symbol">(∀</a> <a id="2258" class="Symbol">{</a><a id="2259" href="Type.BetaNBE.html#2259" class="Bound">K</a><a id="2260" class="Symbol">}</a> <a id="2262" class="Symbol">→</a> <a id="2264" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="2268" class="Symbol">(</a><a id="2269" href="Type.BetaNBE.html#2238" class="Bound">Φ</a> <a id="2271" href="Type.html#545" class="InductiveConstructor Operator">,⋆</a> <a id="2274" href="Type.BetaNBE.html#2259" class="Bound">K</a><a id="2275" class="Symbol">)</a> <a id="2277" class="Symbol">(</a><a id="2278" href="Type.BetaNBE.html#2240" class="Bound">Ψ</a> <a id="2280" href="Type.html#545" class="InductiveConstructor Operator">,⋆</a> <a id="2283" href="Type.BetaNBE.html#2259" class="Bound">K</a><a id="2284" class="Symbol">))</a>
<a id="2287" href="Type.BetaNBE.html#2228" class="Function">exte</a> <a id="2292" href="Type.BetaNBE.html#2292" class="Bound">η</a> <a id="2294" class="Symbol">=</a> <a id="2296" class="Symbol">(</a><a id="2297" href="Type.BetaNBE.html#1626" class="Function">weakenVal</a> <a id="2307" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2309" href="Type.BetaNBE.html#2292" class="Bound">η</a><a id="2310" class="Symbol">)</a> <a id="2312" href="Type.BetaNBE.html#2109" class="Function Operator">,,⋆</a> <a id="2316" href="Type.BetaNBE.html#1288" class="Function">fresh</a>
<a id="2322" class="Comment">{-
-- this version would be more analogous to ext and exts but would
-- require changing some proofs for terms
exte η Z      = fresh
exte η (S α)  = weakenVal (η α)
-}</a>
</pre>

<p>Application for values. As values at function type can be semantic
functions or neutral terms we need this function to unpack them. If
the function is neutral we create a neutral application by reifying
the value and applying the neutral application constructor, then we
refect the neutral application into a value. If the function is a
semantic function we apply it to the identity renaming and then to
the argument. In this case, the function and argument are in the same
context so we do not need the Kripke extension, hence the identity
renaming.</p>

<pre class="Agda"><a id="_·V_"></a><a id="3052" href="Type.BetaNBE.html#3052" class="Function Operator">_·V_</a> <a id="3057" class="Symbol">:</a> <a id="3059" class="Symbol">∀{</a><a id="3061" href="Type.BetaNBE.html#3061" class="Bound">Φ</a> <a id="3063" href="Type.BetaNBE.html#3063" class="Bound">K</a> <a id="3065" href="Type.BetaNBE.html#3065" class="Bound">J</a><a id="3066" class="Symbol">}</a> <a id="3068" class="Symbol">→</a> <a id="3070" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3074" href="Type.BetaNBE.html#3061" class="Bound">Φ</a> <a id="3076" class="Symbol">(</a><a id="3077" href="Type.BetaNBE.html#3063" class="Bound">K</a> <a id="3079" class="InductiveConstructor Operator">⇒</a> <a id="3081" href="Type.BetaNBE.html#3065" class="Bound">J</a><a id="3082" class="Symbol">)</a> <a id="3084" class="Symbol">→</a> <a id="3086" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3090" href="Type.BetaNBE.html#3061" class="Bound">Φ</a> <a id="3092" href="Type.BetaNBE.html#3063" class="Bound">K</a> <a id="3094" class="Symbol">→</a> <a id="3096" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3100" href="Type.BetaNBE.html#3061" class="Bound">Φ</a> <a id="3102" href="Type.BetaNBE.html#3065" class="Bound">J</a>
<a id="3104" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3109" href="Type.BetaNBE.html#3109" class="Bound">n</a> <a id="3111" href="Type.BetaNBE.html#3052" class="Function Operator">·V</a> <a id="3114" href="Type.BetaNBE.html#3114" class="Bound">v</a> <a id="3116" class="Symbol">=</a> <a id="3118" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="3126" class="Symbol">(</a><a id="3127" href="Type.BetaNBE.html#3109" class="Bound">n</a> <a id="3129" href="Type.BetaNormal.html#1191" class="InductiveConstructor Operator">·</a> <a id="3131" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3137" href="Type.BetaNBE.html#3114" class="Bound">v</a><a id="3138" class="Symbol">)</a>
<a id="3140" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3145" href="Type.BetaNBE.html#3145" class="Bound">f</a> <a id="3147" href="Type.BetaNBE.html#3052" class="Function Operator">·V</a> <a id="3150" href="Type.BetaNBE.html#3150" class="Bound">v</a> <a id="3152" class="Symbol">=</a> <a id="3154" href="Type.BetaNBE.html#3145" class="Bound">f</a> <a id="3156" href="Function.Base.html#704" class="Function">id</a> <a id="3159" href="Type.BetaNBE.html#3150" class="Bound">v</a>
</pre>
<p>Evaluation a term in an environment yields a value. The most
interesting cases are ƛ where we introduce a new Kripke function that
will evaluate when it receives an argument and Π/μ where we need to go
under the binder and extend the environment before evaluating and
reifying.</p>

<pre class="Agda"><a id="eval"></a><a id="3449" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3454" class="Symbol">:</a> <a id="3456" class="Symbol">∀{</a><a id="3458" href="Type.BetaNBE.html#3458" class="Bound">Φ</a> <a id="3460" href="Type.BetaNBE.html#3460" class="Bound">Ψ</a> <a id="3462" href="Type.BetaNBE.html#3462" class="Bound">K</a><a id="3463" class="Symbol">}</a> <a id="3465" class="Symbol">→</a> <a id="3467" href="Type.BetaNBE.html#3460" class="Bound">Ψ</a> <a id="3469" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="3472" href="Type.BetaNBE.html#3462" class="Bound">K</a> <a id="3474" class="Symbol">→</a> <a id="3476" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="3480" href="Type.BetaNBE.html#3460" class="Bound">Ψ</a> <a id="3482" href="Type.BetaNBE.html#3458" class="Bound">Φ</a> <a id="3484" class="Symbol">→</a> <a id="3486" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3490" href="Type.BetaNBE.html#3458" class="Bound">Φ</a> <a id="3492" href="Type.BetaNBE.html#3462" class="Bound">K</a>

<a id="eval-List"></a><a id="3495" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="3505" class="Symbol">:</a> <a id="3507" class="Symbol">∀{</a><a id="3509" href="Type.BetaNBE.html#3509" class="Bound">Φ</a> <a id="3511" href="Type.BetaNBE.html#3511" class="Bound">Ψ</a> <a id="3513" href="Type.BetaNBE.html#3513" class="Bound">K</a><a id="3514" class="Symbol">}</a> <a id="3516" class="Symbol">→</a> <a id="3518" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3523" class="Symbol">(</a><a id="3524" href="Type.BetaNBE.html#3511" class="Bound">Ψ</a> <a id="3526" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="3529" href="Type.BetaNBE.html#3513" class="Bound">K</a><a id="3530" class="Symbol">)</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="3538" href="Type.BetaNBE.html#3511" class="Bound">Ψ</a> <a id="3540" href="Type.BetaNBE.html#3509" class="Bound">Φ</a> <a id="3542" class="Symbol">→</a> <a id="3544" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3554" href="Type.BetaNBE.html#3509" class="Bound">Φ</a> <a id="3556" href="Type.BetaNBE.html#3513" class="Bound">K</a><a id="3557" class="Symbol">)</a>
<a id="eval-VecList"></a><a id="3559" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="3572" class="Symbol">:</a> <a id="3574" class="Symbol">∀{</a><a id="3576" href="Type.BetaNBE.html#3576" class="Bound">Φ</a> <a id="3578" href="Type.BetaNBE.html#3578" class="Bound">Ψ</a> <a id="3580" href="Type.BetaNBE.html#3580" class="Bound">K</a> <a id="3582" href="Type.BetaNBE.html#3582" class="Bound">n</a><a id="3583" class="Symbol">}</a> <a id="3585" class="Symbol">→</a> <a id="3587" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="3591" class="Symbol">(</a><a id="3592" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3597" class="Symbol">(</a><a id="3598" href="Type.BetaNBE.html#3578" class="Bound">Ψ</a> <a id="3600" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="3603" href="Type.BetaNBE.html#3580" class="Bound">K</a><a id="3604" class="Symbol">))</a> <a id="3607" href="Type.BetaNBE.html#3582" class="Bound">n</a> <a id="3609" class="Symbol">→</a> <a id="3611" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="3615" href="Type.BetaNBE.html#3578" class="Bound">Ψ</a> <a id="3617" href="Type.BetaNBE.html#3576" class="Bound">Φ</a> <a id="3619" class="Symbol">→</a> <a id="3621" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="3625" class="Symbol">(</a><a id="3626" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3631" class="Symbol">(</a><a id="3632" href="Type.BetaNBE.html#768" class="Function">Val</a> <a id="3636" href="Type.BetaNBE.html#3576" class="Bound">Φ</a> <a id="3638" href="Type.BetaNBE.html#3580" class="Bound">K</a><a id="3639" class="Symbol">))</a> <a id="3642" href="Type.BetaNBE.html#3582" class="Bound">n</a>

<a id="3645" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3650" class="Symbol">(</a><a id="3651" href="Type.html#1797" class="InductiveConstructor">`</a> <a id="3653" href="Type.BetaNBE.html#3653" class="Bound">α</a><a id="3654" class="Symbol">)</a>     <a id="3660" href="Type.BetaNBE.html#3660" class="Bound">η</a> <a id="3662" class="Symbol">=</a> <a id="3664" href="Type.BetaNBE.html#3660" class="Bound">η</a> <a id="3666" href="Type.BetaNBE.html#3653" class="Bound">α</a>
<a id="3668" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3673" class="Symbol">(</a><a id="3674" href="Type.html#1839" class="InductiveConstructor">Π</a> <a id="3676" href="Type.BetaNBE.html#3676" class="Bound">B</a><a id="3677" class="Symbol">)</a>     <a id="3683" href="Type.BetaNBE.html#3683" class="Bound">η</a> <a id="3685" class="Symbol">=</a> <a id="3687" href="Type.BetaNormal.html#1312" class="InductiveConstructor">Π</a> <a id="3689" class="Symbol">(</a><a id="3690" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3696" class="Symbol">(</a><a id="3697" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3702" href="Type.BetaNBE.html#3676" class="Bound">B</a> <a id="3704" class="Symbol">(</a><a id="3705" href="Type.BetaNBE.html#2228" class="Function">exte</a> <a id="3710" href="Type.BetaNBE.html#3683" class="Bound">η</a><a id="3711" class="Symbol">)))</a>
<a id="3715" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3720" class="Symbol">(</a><a id="3721" href="Type.BetaNBE.html#3721" class="Bound">A</a> <a id="3723" href="Type.html#1889" class="InductiveConstructor Operator">⇒</a> <a id="3725" href="Type.BetaNBE.html#3725" class="Bound">B</a><a id="3726" class="Symbol">)</a>   <a id="3730" href="Type.BetaNBE.html#3730" class="Bound">η</a> <a id="3732" class="Symbol">=</a> <a id="3734" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3746" href="Type.BetaNBE.html#3721" class="Bound">A</a> <a id="3748" href="Type.BetaNBE.html#3730" class="Bound">η</a><a id="3749" class="Symbol">)</a> <a id="3751" href="Type.BetaNormal.html#1366" class="InductiveConstructor Operator">⇒</a> <a id="3753" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3759" class="Symbol">(</a><a id="3760" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3765" href="Type.BetaNBE.html#3725" class="Bound">B</a> <a id="3767" href="Type.BetaNBE.html#3730" class="Bound">η</a><a id="3768" class="Symbol">)</a>
<a id="3770" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3775" class="Symbol">(</a><a id="3776" href="Type.html#1950" class="InductiveConstructor">ƛ</a> <a id="3778" href="Type.BetaNBE.html#3778" class="Bound">B</a><a id="3779" class="Symbol">)</a>     <a id="3785" href="Type.BetaNBE.html#3785" class="Bound">η</a> <a id="3787" class="Symbol">=</a> <a id="3789" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3794" class="Symbol">λ</a> <a id="3796" href="Type.BetaNBE.html#3796" class="Bound">ρ</a> <a id="3798" href="Type.BetaNBE.html#3798" class="Bound">v</a> <a id="3800" class="Symbol">→</a> <a id="3802" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3807" href="Type.BetaNBE.html#3778" class="Bound">B</a> <a id="3809" class="Symbol">((</a><a id="3811" href="Type.BetaNBE.html#1373" class="Function">renVal</a> <a id="3818" href="Type.BetaNBE.html#3796" class="Bound">ρ</a> <a id="3820" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3822" href="Type.BetaNBE.html#3785" class="Bound">η</a><a id="3823" class="Symbol">)</a> <a id="3825" href="Type.BetaNBE.html#2109" class="Function Operator">,,⋆</a> <a id="3829" href="Type.BetaNBE.html#3798" class="Bound">v</a><a id="3830" class="Symbol">)</a>
<a id="3832" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3837" class="Symbol">(</a><a id="3838" href="Type.BetaNBE.html#3838" class="Bound">A</a> <a id="3840" href="Type.html#2004" class="InductiveConstructor Operator">·</a> <a id="3842" href="Type.BetaNBE.html#3842" class="Bound">B</a><a id="3843" class="Symbol">)</a>   <a id="3847" href="Type.BetaNBE.html#3847" class="Bound">η</a> <a id="3849" class="Symbol">=</a> <a id="3851" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3856" href="Type.BetaNBE.html#3838" class="Bound">A</a> <a id="3858" href="Type.BetaNBE.html#3847" class="Bound">η</a> <a id="3860" href="Type.BetaNBE.html#3052" class="Function Operator">·V</a> <a id="3863" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3868" href="Type.BetaNBE.html#3842" class="Bound">B</a> <a id="3870" href="Type.BetaNBE.html#3847" class="Bound">η</a>
<a id="3872" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3877" class="Symbol">(</a><a id="3878" href="Type.html#2069" class="InductiveConstructor">μ</a> <a id="3880" href="Type.BetaNBE.html#3880" class="Bound">A</a> <a id="3882" href="Type.BetaNBE.html#3882" class="Bound">B</a><a id="3883" class="Symbol">)</a>   <a id="3887" href="Type.BetaNBE.html#3887" class="Bound">η</a> <a id="3889" class="Symbol">=</a> <a id="3891" href="Type.BetaNormal.html#1571" class="InductiveConstructor">μ</a> <a id="3893" class="Symbol">(</a><a id="3894" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3900" class="Symbol">(</a><a id="3901" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3906" href="Type.BetaNBE.html#3880" class="Bound">A</a> <a id="3908" href="Type.BetaNBE.html#3887" class="Bound">η</a><a id="3909" class="Symbol">))</a> <a id="3912" class="Symbol">(</a><a id="3913" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="3919" class="Symbol">(</a><a id="3920" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3925" href="Type.BetaNBE.html#3882" class="Bound">B</a> <a id="3927" href="Type.BetaNBE.html#3887" class="Bound">η</a><a id="3928" class="Symbol">))</a>
<a id="3931" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3936" class="Symbol">(</a><a id="3937" href="Type.html#2151" class="InductiveConstructor">^</a> <a id="3939" href="Type.BetaNBE.html#3939" class="Bound">x</a><a id="3940" class="Symbol">)</a>     <a id="3946" href="Type.BetaNBE.html#3946" class="Bound">η</a> <a id="3948" class="Symbol">=</a> <a id="3950" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="3958" class="Symbol">(</a><a id="3959" href="Type.BetaNormal.html#1264" class="InductiveConstructor">^</a> <a id="3961" href="Type.BetaNBE.html#3939" class="Bound">x</a><a id="3962" class="Symbol">)</a>
<a id="3964" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3969" class="Symbol">(</a><a id="3970" href="Type.html#2193" class="InductiveConstructor">con</a> <a id="3974" href="Type.BetaNBE.html#3974" class="Bound">c</a><a id="3975" class="Symbol">)</a>   <a id="3979" href="Type.BetaNBE.html#3979" class="Bound">η</a> <a id="3981" class="Symbol">=</a> <a id="3983" href="Type.BetaNormal.html#1542" class="InductiveConstructor">con</a> <a id="3987" class="Symbol">(</a><a id="3988" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="3993" href="Type.BetaNBE.html#3974" class="Bound">c</a> <a id="3995" href="Type.BetaNBE.html#3979" class="Bound">η</a><a id="3996" class="Symbol">)</a>
<a id="3998" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="4003" class="Symbol">(</a><a id="4004" href="Type.html#2261" class="InductiveConstructor">SOP</a> <a id="4008" href="Type.BetaNBE.html#4008" class="Bound">Tss</a><a id="4011" class="Symbol">)</a> <a id="4013" href="Type.BetaNBE.html#4013" class="Bound">η</a> <a id="4015" class="Symbol">=</a> <a id="4017" href="Type.BetaNormal.html#1661" class="InductiveConstructor">SOP</a> <a id="4021" class="Symbol">(</a><a id="4022" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="4035" href="Type.BetaNBE.html#4008" class="Bound">Tss</a> <a id="4039" href="Type.BetaNBE.html#4013" class="Bound">η</a><a id="4040" class="Symbol">)</a>

<a id="4043" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="4053" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4056" href="Type.BetaNBE.html#4056" class="Bound">η</a> <a id="4058" class="Symbol">=</a> <a id="4060" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="4063" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="4073" class="Symbol">(</a><a id="4074" href="Type.BetaNBE.html#4074" class="Bound">x</a> <a id="4076" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4078" href="Type.BetaNBE.html#4078" class="Bound">xs</a><a id="4080" class="Symbol">)</a> <a id="4082" href="Type.BetaNBE.html#4082" class="Bound">η</a> <a id="4084" class="Symbol">=</a> <a id="4086" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="4091" href="Type.BetaNBE.html#4074" class="Bound">x</a> <a id="4093" href="Type.BetaNBE.html#4082" class="Bound">η</a> <a id="4095" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4097" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="4107" href="Type.BetaNBE.html#4078" class="Bound">xs</a> <a id="4110" href="Type.BetaNBE.html#4082" class="Bound">η</a>
<a id="4112" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="4125" href="Data.Vec.Base.html#1155" class="InductiveConstructor">[]</a> <a id="4128" href="Type.BetaNBE.html#4128" class="Bound">η</a> <a id="4130" class="Symbol">=</a> <a id="4132" href="Data.Vec.Base.html#1155" class="InductiveConstructor">[]</a>
<a id="4135" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="4148" class="Symbol">(</a><a id="4149" href="Type.BetaNBE.html#4149" class="Bound">Ts</a> <a id="4152" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">∷</a> <a id="4154" href="Type.BetaNBE.html#4154" class="Bound">Tss</a><a id="4157" class="Symbol">)</a> <a id="4159" href="Type.BetaNBE.html#4159" class="Bound">η</a> <a id="4161" class="Symbol">=</a> <a id="4163" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="4173" href="Type.BetaNBE.html#4149" class="Bound">Ts</a> <a id="4176" href="Type.BetaNBE.html#4159" class="Bound">η</a> <a id="4178" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">∷</a> <a id="4180" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="4193" href="Type.BetaNBE.html#4154" class="Bound">Tss</a> <a id="4197" href="Type.BetaNBE.html#4159" class="Bound">η</a>
</pre>
<p>Identity environment</p>

<pre class="Agda"><a id="idEnv"></a><a id="4230" href="Type.BetaNBE.html#4230" class="Function">idEnv</a> <a id="4236" class="Symbol">:</a> <a id="4238" class="Symbol">∀</a> <a id="4240" href="Type.BetaNBE.html#4240" class="Bound">Φ</a> <a id="4242" class="Symbol">→</a> <a id="4244" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="4248" href="Type.BetaNBE.html#4240" class="Bound">Φ</a> <a id="4250" href="Type.BetaNBE.html#4240" class="Bound">Φ</a>
<a id="4252" href="Type.BetaNBE.html#4230" class="Function">idEnv</a> <a id="4258" href="Type.BetaNBE.html#4258" class="Bound">Φ</a> <a id="4260" class="Symbol">=</a> <a id="4262" href="Type.BetaNBE.html#1071" class="Function">reflect</a> <a id="4270" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4272" href="Type.BetaNormal.html#1147" class="InductiveConstructor">`</a>
</pre>
<p>Normalisating a term yields a normal form. We evaluate in the identity
environment to yield a value in the same context as the original term
and then reify to yield a normal form</p>

<pre class="Agda"><a id="nf"></a><a id="4463" href="Type.BetaNBE.html#4463" class="Function">nf</a> <a id="4466" class="Symbol">:</a> <a id="4468" class="Symbol">∀{</a><a id="4470" href="Type.BetaNBE.html#4470" class="Bound">Φ</a> <a id="4472" href="Type.BetaNBE.html#4472" class="Bound">K</a><a id="4473" class="Symbol">}</a> <a id="4475" class="Symbol">→</a> <a id="4477" href="Type.BetaNBE.html#4470" class="Bound">Φ</a> <a id="4479" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="4482" href="Type.BetaNBE.html#4472" class="Bound">K</a> <a id="4484" class="Symbol">→</a> <a id="4486" href="Type.BetaNBE.html#4470" class="Bound">Φ</a> <a id="4488" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="4493" href="Type.BetaNBE.html#4472" class="Bound">K</a>
<a id="4495" href="Type.BetaNBE.html#4463" class="Function">nf</a> <a id="4498" href="Type.BetaNBE.html#4498" class="Bound">t</a> <a id="4500" class="Symbol">=</a> <a id="4502" href="Type.BetaNBE.html#1752" class="Function">reify</a> <a id="4508" class="Symbol">(</a><a id="4509" href="Type.BetaNBE.html#3449" class="Function">eval</a> <a id="4514" href="Type.BetaNBE.html#4498" class="Bound">t</a> <a id="4516" class="Symbol">(</a><a id="4517" href="Type.BetaNBE.html#4230" class="Function">idEnv</a> <a id="4523" class="Symbol">_))</a>

<a id="nf-VecList"></a><a id="4528" href="Type.BetaNBE.html#4528" class="Function">nf-VecList</a> <a id="4539" class="Symbol">:</a>  <a id="4542" class="Symbol">∀{</a><a id="4544" href="Type.BetaNBE.html#4544" class="Bound">Φ</a> <a id="4546" href="Type.BetaNBE.html#4546" class="Bound">K</a> <a id="4548" href="Type.BetaNBE.html#4548" class="Bound">n</a><a id="4549" class="Symbol">}</a> <a id="4551" class="Symbol">→</a> <a id="4553" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="4557" class="Symbol">(</a><a id="4558" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4563" class="Symbol">(</a><a id="4564" href="Type.BetaNBE.html#4544" class="Bound">Φ</a> <a id="4566" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="4569" href="Type.BetaNBE.html#4546" class="Bound">K</a><a id="4570" class="Symbol">))</a> <a id="4573" href="Type.BetaNBE.html#4548" class="Bound">n</a> <a id="4575" class="Symbol">→</a> <a id="4577" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="4581" class="Symbol">(</a><a id="4582" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4587" class="Symbol">(</a><a id="4588" href="Type.BetaNBE.html#4544" class="Bound">Φ</a> <a id="4590" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="4595" href="Type.BetaNBE.html#4546" class="Bound">K</a><a id="4596" class="Symbol">))</a> <a id="4599" href="Type.BetaNBE.html#4548" class="Bound">n</a>
<a id="4601" href="Type.BetaNBE.html#4528" class="Function">nf-VecList</a> <a id="4612" href="Type.BetaNBE.html#4612" class="Bound">Tss</a> <a id="4616" class="Symbol">=</a>  <a id="4619" href="Type.BetaNBE.html#187" class="Function">vmap</a> <a id="4624" class="Symbol">(</a><a id="4625" href="Data.List.Base.html#1634" class="Function">map</a> <a id="4629" href="Type.BetaNBE.html#1752" class="Function">reify</a><a id="4634" class="Symbol">)</a> <a id="4636" class="Symbol">(</a><a id="4637" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="4650" href="Type.BetaNBE.html#4612" class="Bound">Tss</a> <a id="4654" class="Symbol">(</a><a id="4655" href="Type.BetaNBE.html#4230" class="Function">idEnv</a> <a id="4661" class="Symbol">_))</a>
</pre>
<p>Some properties relating uses of lookup on VecList-functions with List-functions</p>

<pre class="Agda"><a id="4756" class="Keyword">module</a> <a id="4763" href="Type.BetaNBE.html#4763" class="Module">_</a> <a id="4765" class="Keyword">where</a>

  <a id="4774" class="Keyword">open</a> <a id="4779" class="Keyword">import</a> <a id="4786" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="4795" class="Keyword">using</a> <a id="4801" class="Symbol">(</a><a id="4802" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a><a id="4805" class="Symbol">;</a><a id="4806" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="4810" class="Symbol">;</a><a id="4811" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a><a id="4814" class="Symbol">)</a>
  <a id="4818" class="Keyword">open</a> <a id="4823" class="Keyword">import</a> <a id="4830" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="4839" class="Keyword">using</a> <a id="4845" class="Symbol">(</a><a id="4846" href="Data.Vec.Base.html#1676" class="Function">lookup</a><a id="4852" class="Symbol">)</a>
  <a id="4856" class="Keyword">open</a> <a id="4861" class="Keyword">import</a> <a id="4868" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="4906" class="Keyword">using</a> <a id="4912" class="Symbol">(</a><a id="4913" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="4916" class="Symbol">;</a><a id="4917" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="4921" class="Symbol">;</a> <a id="4923" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="4927" class="Symbol">;</a> <a id="4929" href="Relation.Binary.PropositionalEquality.Core.html#1576" class="Function">cong₂</a><a id="4934" class="Symbol">)</a>


  <a id="4940" href="Type.BetaNBE.html#4940" class="Function">lookup-eval-VecList</a> <a id="4960" class="Symbol">:</a> <a id="4962" class="Symbol">∀</a> <a id="4964" class="Symbol">{</a><a id="4965" href="Type.BetaNBE.html#4965" class="Bound">Φ</a> <a id="4967" href="Type.BetaNBE.html#4967" class="Bound">Ψ</a> <a id="4969" href="Type.BetaNBE.html#4969" class="Bound">n</a><a id="4970" class="Symbol">}</a>
              <a id="4986" class="Symbol">→</a> <a id="4988" class="Symbol">(</a><a id="4989" href="Type.BetaNBE.html#4989" class="Bound">e</a> <a id="4991" class="Symbol">:</a> <a id="4993" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="4997" href="Type.BetaNBE.html#4969" class="Bound">n</a><a id="4998" class="Symbol">)</a>
              <a id="5014" class="Symbol">→</a> <a id="5016" class="Symbol">(</a><a id="5017" href="Type.BetaNBE.html#5017" class="Bound">Tss</a> <a id="5021" class="Symbol">:</a> <a id="5023" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="5027" class="Symbol">(</a><a id="5028" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5033" class="Symbol">(</a><a id="5034" href="Type.BetaNBE.html#4967" class="Bound">Ψ</a> <a id="5036" href="Type.html#1704" class="Datatype Operator">⊢⋆</a> <a id="5039" href="Utils.html#11142" class="InductiveConstructor">*</a><a id="5040" class="Symbol">))</a> <a id="5043" href="Type.BetaNBE.html#4969" class="Bound">n</a><a id="5044" class="Symbol">)</a>
              <a id="5060" class="Symbol">→</a> <a id="5062" class="Symbol">(</a><a id="5063" href="Type.BetaNBE.html#5063" class="Bound">η</a> <a id="5065" class="Symbol">:</a> <a id="5067" href="Type.BetaNBE.html#2017" class="Function">Env</a> <a id="5071" href="Type.BetaNBE.html#4967" class="Bound">Ψ</a> <a id="5073" href="Type.BetaNBE.html#4965" class="Bound">Φ</a><a id="5074" class="Symbol">)</a>
                <a id="5092" class="Comment">--------------------------------------------</a>
              <a id="5151" class="Symbol">→</a> <a id="5153" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="5160" class="Symbol">(</a><a id="5161" href="Type.BetaNBE.html#3559" class="Function">eval-VecList</a> <a id="5174" href="Type.BetaNBE.html#5017" class="Bound">Tss</a> <a id="5178" href="Type.BetaNBE.html#5063" class="Bound">η</a><a id="5179" class="Symbol">)</a> <a id="5181" href="Type.BetaNBE.html#4989" class="Bound">e</a> <a id="5183" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5185" href="Type.BetaNBE.html#3495" class="Function">eval-List</a> <a id="5195" class="Symbol">(</a><a id="5196" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="5203" href="Type.BetaNBE.html#5017" class="Bound">Tss</a> <a id="5207" href="Type.BetaNBE.html#4989" class="Bound">e</a><a id="5208" class="Symbol">)</a> <a id="5210" href="Type.BetaNBE.html#5063" class="Bound">η</a>
  <a id="5214" href="Type.BetaNBE.html#4940" class="Function">lookup-eval-VecList</a> <a id="5234" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a> <a id="5239" class="Symbol">(_</a> <a id="5242" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">∷</a> <a id="5244" class="Symbol">_)</a> <a id="5247" href="Type.BetaNBE.html#5247" class="Bound">η</a> <a id="5249" class="Symbol">=</a> <a id="5251" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="5258" href="Type.BetaNBE.html#4940" class="Function">lookup-eval-VecList</a> <a id="5278" class="Symbol">(</a><a id="5279" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a> <a id="5283" href="Type.BetaNBE.html#5283" class="Bound">e</a><a id="5284" class="Symbol">)</a> <a id="5286" class="Symbol">(_</a> <a id="5289" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">∷</a> <a id="5291" href="Type.BetaNBE.html#5291" class="Bound">Tss</a><a id="5294" class="Symbol">)</a> <a id="5296" href="Type.BetaNBE.html#5296" class="Bound">η</a> <a id="5298" class="Symbol">=</a> <a id="5300" href="Type.BetaNBE.html#4940" class="Function">lookup-eval-VecList</a> <a id="5320" href="Type.BetaNBE.html#5283" class="Bound">e</a> <a id="5322" href="Type.BetaNBE.html#5291" class="Bound">Tss</a> <a id="5326" href="Type.BetaNBE.html#5296" class="Bound">η</a>
</pre>

    </section>
  </body>
</html>
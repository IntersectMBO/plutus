<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Program Evaluators</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>Program Evaluators</h1>
    <section>
      <h1 id="evaluators-for-programs">Evaluators for Programs</h1>

<pre class="Agda"><a id="79" class="Keyword">module</a> <a id="86" href="Evaluator.Program.html" class="Module">Evaluator.Program</a> <a id="104" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Function.html" class="Module">Function</a> <a id="152" class="Keyword">using</a> <a id="158" class="Symbol">(</a><a id="159" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="162" class="Symbol">;</a><a id="163" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="166" class="Symbol">)</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.String.html" class="Module">Data.String</a> <a id="192" class="Keyword">using</a> <a id="198" class="Symbol">(</a><a id="199" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="205" class="Symbol">;</a><a id="206" href="Data.String.Base.html#2425" class="Function Operator">_++_</a><a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Product.html" class="Module">Data.Product</a> <a id="266" class="Keyword">using</a> <a id="272" class="Symbol">(</a><a id="273" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="274" class="Symbol">)</a> <a id="276" class="Keyword">renaming</a> <a id="285" class="Symbol">(</a><a id="286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="290" class="Symbol">to</a> <a id="293" class="InductiveConstructor Operator">_,,_</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="322" class="Keyword">using</a> <a id="328" class="Symbol">(</a><a id="329" href="Data.Empty.html#914" class="Function">⊥</a><a id="330" class="Symbol">)</a>

<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Type.html" class="Module">Type</a> <a id="350" class="Keyword">using</a> <a id="356" class="Symbol">(</a><a id="357" href="Type.html#515" class="Datatype">Ctx⋆</a><a id="361" class="Symbol">;</a><a id="362" href="Type.html#534" class="InductiveConstructor">∅</a><a id="363" class="Symbol">;</a><a id="364" href="Type.html#545" class="InductiveConstructor Operator">_,⋆_</a><a id="368" class="Symbol">)</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Check.html" class="Module">Check</a> <a id="388" class="Keyword">using</a> <a id="394" class="Symbol">(</a><a id="395" href="Check.html#2131" class="Datatype">TypeError</a><a id="404" class="Symbol">;</a><a id="405" href="Check.html#17848" class="Function">inferType</a><a id="414" class="Symbol">;</a><a id="415" href="Check.html#8676" class="Function">inferKind</a><a id="424" class="Symbol">;</a><a id="425" href="Check.html#3308" class="Function">decKind</a><a id="432" class="Symbol">;</a><a id="433" href="Check.html#8600" class="Function">checkKind</a><a id="442" class="Symbol">;</a><a id="443" href="Check.html#17754" class="Function">checkType</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" href="Check.html#2131" class="Module">TypeError</a> <a id="469" class="Comment">-- Bring all TypeError constructors in scope.</a>

<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Scoped.Extrication.html" class="Module">Scoped.Extrication</a> <a id="547" class="Keyword">using</a> <a id="553" class="Symbol">(</a><a id="554" href="Scoped.Extrication.html#1316" class="Function">extricateNf⋆</a><a id="566" class="Symbol">;</a><a id="567" href="Scoped.Extrication.html#3031" class="Function">extricate</a><a id="576" class="Symbol">)</a>
<a id="578" class="Keyword">open</a> <a id="583" class="Keyword">import</a> <a id="590" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a> <a id="606" class="Keyword">using</a> <a id="612" class="Symbol">(</a><a id="613" href="Type.BetaNormal.html#1043" class="Datatype Operator">_⊢Nf⋆_</a><a id="619" class="Symbol">)</a>
<a id="621" class="Keyword">import</a> <a id="628" href="Untyped.html" class="Module">Untyped</a> <a id="636" class="Symbol">as</a> <a id="639" class="Module">U</a> <a id="641" class="Keyword">using</a> <a id="647" class="Symbol">(</a><a id="648" href="Untyped.html#1677" class="Datatype Operator">_⊢</a><a id="650" class="Symbol">;</a><a id="651" href="Untyped.html#6731" class="Function">scopeCheckU0</a><a id="663" class="Symbol">;</a><a id="664" href="Untyped.html#5424" class="Function">extricateU0</a><a id="675" class="Symbol">;</a><a id="676" href="Untyped.html#6914" class="Function">decUTm</a><a id="682" class="Symbol">)</a>
<a id="684" class="Keyword">import</a> <a id="691" href="Untyped.CEKWithCost.html" class="Module">Untyped.CEKWithCost</a> <a id="711" class="Symbol">as</a> <a id="714" class="Module">U</a> <a id="716" class="Keyword">using</a> <a id="722" class="Symbol">(</a><a id="723" href="Untyped.CEKWithCost.html#6609" class="Function">stepperC</a><a id="731" class="Symbol">)</a>
<a id="733" class="Keyword">open</a> <a id="738" class="Keyword">import</a> <a id="745" href="Cost.Base.html" class="Module">Cost.Base</a>
<a id="755" class="Keyword">open</a> <a id="760" class="Keyword">import</a> <a id="767" href="Cost.html" class="Module">Cost</a> <a id="772" class="Keyword">using</a> <a id="778" class="Symbol">(</a><a id="779" href="Cost.html#1956" class="Record">ExBudget</a><a id="787" class="Symbol">;</a><a id="788" href="Cost.html#4635" class="Function">machineParameters</a><a id="805" class="Symbol">;</a><a id="806" href="Cost.html#6828" class="Function">tallyingMachineParameters</a><a id="831" class="Symbol">;</a><a id="832" href="Cost.html#4849" class="Function">countingReport</a><a id="846" class="Symbol">;</a><a id="847" href="Cost.html#7079" class="Function">tallyingReport</a><a id="861" class="Symbol">;</a><a id="862" href="Cost.html#3595" class="Function">CostModel</a><a id="871" class="Symbol">)</a>
<a id="873" class="Keyword">open</a> <a id="878" class="Keyword">import</a> <a id="885" href="Cost.Raw.html" class="Module">Cost.Raw</a> <a id="894" class="Keyword">using</a> <a id="900" class="Symbol">(</a><a id="901" href="Cost.Raw.html#6132" class="Function">RawCostModel</a><a id="913" class="Symbol">)</a>
<a id="915" class="Keyword">open</a> <a id="920" class="Keyword">import</a> <a id="927" href="Cost.Model.html" class="Module">Cost.Model</a> <a id="938" class="Keyword">using</a> <a id="944" class="Symbol">(</a><a id="945" href="Cost.Model.html#10274" class="Function">createMap</a><a id="954" class="Symbol">)</a>
<a id="956" class="Keyword">import</a> <a id="963" href="RawU.html" class="Module">RawU</a> <a id="968" class="Symbol">as</a> <a id="971" class="Module">U</a> <a id="973" class="Keyword">using</a> <a id="979" class="Symbol">(</a><a id="980" href="RawU.html#8077" class="Datatype">Untyped</a><a id="987" class="Symbol">)</a>

<a id="990" class="Keyword">open</a> <a id="995" class="Keyword">import</a> <a id="1002" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="1014" class="Symbol">as</a> <a id="1017" class="Module">U</a> <a id="1019" class="Keyword">using</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Untyped.CEK.html#25070" class="Function">stepper</a><a id="1033" class="Symbol">;</a><a id="1034" href="Untyped.CEK.html#1258" class="Datatype">Stack</a><a id="1039" class="Symbol">;</a><a id="1040" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a><a id="1041" class="Symbol">;</a><a id="1042" href="Untyped.CEK.html#1361" class="Datatype">Env</a><a id="1045" class="Symbol">;</a><a id="1046" href="Untyped.CEK.html#1385" class="InductiveConstructor">[]</a><a id="1048" class="Symbol">;</a><a id="1049" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="1054" class="Symbol">)</a>
<a id="1056" class="Keyword">open</a> <a id="1061" href="Untyped.CEK.html#3620" class="Module">U.State</a>

<a id="1070" class="Keyword">open</a> <a id="1075" class="Keyword">import</a> <a id="1082" href="Raw.html" class="Module">Raw</a> <a id="1086" class="Keyword">using</a> <a id="1092" class="Symbol">(</a><a id="1093" href="Raw.html#1474" class="Datatype">RawTm</a><a id="1098" class="Symbol">;</a><a id="1099" href="Raw.html#810" class="Datatype">RawTy</a><a id="1104" class="Symbol">;</a><a id="1105" href="Raw.html#5815" class="Function">rawPrinter</a><a id="1115" class="Symbol">;</a><a id="1116" href="Raw.html#4786" class="Function">rawTyPrinter</a><a id="1128" class="Symbol">;</a><a id="1129" href="Raw.html#2720" class="Function">decRTy</a><a id="1135" class="Symbol">;</a><a id="1136" href="Raw.html#3533" class="Function">decRTm</a><a id="1142" class="Symbol">)</a>
<a id="1144" class="Keyword">open</a> <a id="1149" class="Keyword">import</a> <a id="1156" href="Scoped.html" class="Module">Scoped</a> <a id="1163" class="Keyword">using</a> <a id="1169" class="Symbol">(</a><a id="1170" href="Scoped.html#7729" class="Postulate">FreeVariableError</a><a id="1187" class="Symbol">;</a><a id="1188" href="Scoped.html#7824" class="Datatype">ScopeError</a><a id="1198" class="Symbol">;</a><a id="1199" href="Scoped.html#7873" class="InductiveConstructor">freeVariableError</a><a id="1216" class="Symbol">;</a><a id="1217" href="Scoped.html#11006" class="Function">extricateScopeTy</a><a id="1233" class="Symbol">;</a><a id="1234" href="Scoped.html#6896" class="Datatype">ScopedTm</a><a id="1242" class="Symbol">;</a><a id="1243" href="Scoped.html#1414" class="Datatype">Weirdℕ</a><a id="1249" class="Symbol">;</a><a id="1250" href="Scoped.html#9771" class="Function">scopeCheckTm</a><a id="1262" class="Symbol">;</a><a id="1263" href="Scoped.html#4359" class="Function">shifter</a><a id="1270" class="Symbol">;</a><a id="1271" href="Scoped.html#6018" class="Function">unshifter</a><a id="1280" class="Symbol">;</a><a id="1281" href="Scoped.html#12026" class="Function">extricateScope</a><a id="1295" class="Symbol">;</a><a id="1296" href="Scoped.html#5193" class="Function">unshifterTy</a><a id="1307" class="Symbol">;</a><a id="1308" href="Scoped.html#8556" class="Function">scopeCheckTy</a><a id="1320" class="Symbol">;</a><a id="1321" href="Scoped.html#3558" class="Function">shifterTy</a><a id="1330" class="Symbol">)</a>
<a id="1332" class="Keyword">open</a> <a id="1337" href="Scoped.html#1414" class="Module">Weirdℕ</a> <a id="1344" class="Comment">-- Bring Weirdℕ constructors in scope</a>
<a id="1382" class="Keyword">open</a> <a id="1387" class="Keyword">import</a> <a id="1394" href="Utils.html" class="Module">Utils</a> <a id="1400" class="Keyword">using</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Utils.html#1133" class="Datatype">Either</a><a id="1413" class="Symbol">;</a><a id="1414" href="Utils.html#1166" class="InductiveConstructor">inj₁</a><a id="1418" class="Symbol">;</a><a id="1419" href="Utils.html#1190" class="InductiveConstructor">inj₂</a><a id="1423" class="Symbol">;</a><a id="1424" href="Utils.html#3704" class="Function">withE</a><a id="1429" class="Symbol">;</a><a id="1430" href="Utils.html#10849" class="Datatype">Kind</a><a id="1434" class="Symbol">;</a><a id="1435" href="Utils.html#10868" class="InductiveConstructor">*</a><a id="1436" class="Symbol">;</a><a id="1437" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="1442" class="Symbol">;</a><a id="1443" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1450" class="Symbol">;</a><a id="1451" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1455" class="Symbol">;</a><a id="1456" href="Utils.html#2870" class="Record">Monad</a><a id="1461" class="Symbol">;</a><a id="1462" href="Utils.html#4363" class="Datatype">RuntimeError</a><a id="1474" class="Symbol">;</a><a id="1475" href="Utils.html#3819" class="Function">dec2Either</a><a id="1485" class="Symbol">;</a><a id="1486" href="Utils.html#4009" class="InductiveConstructor Operator">_,_</a><a id="1489" class="Symbol">)</a>
<a id="1491" class="Keyword">open</a> <a id="1496" href="Utils.html#4363" class="Module">RuntimeError</a>
<a id="1509" class="Keyword">open</a> <a id="1514" href="Utils.html#2870" class="Module">Monad</a> <a id="1520" class="Symbol"></a>

<a id="1529" class="Keyword">open</a> <a id="1534" class="Keyword">import</a> <a id="1541" href="Algorithmic.html" class="Module">Algorithmic</a> <a id="1553" class="Keyword">using</a> <a id="1559" class="Symbol">(</a><a id="1560" href="Algorithmic.html#5495" class="Datatype Operator">_⊢_</a><a id="1563" class="Symbol">;</a><a id="1564" href="Algorithmic.html#1685" class="InductiveConstructor">∅</a><a id="1565" class="Symbol">;</a><a id="1566" href="Algorithmic.html#7839" class="InductiveConstructor">error</a><a id="1571" class="Symbol">)</a>

<a id="1574" class="Keyword">open</a> <a id="1579" class="Keyword">import</a> <a id="1586" href="Algorithmic.CK.html" class="Module">Algorithmic.CK</a> <a id="1601" class="Keyword">using</a> <a id="1607" class="Symbol">(</a><a id="1608" href="Algorithmic.CK.html#4610" class="Function">stepper</a><a id="1615" class="Symbol">;</a><a id="1616" href="Algorithmic.CK.html#1313" class="Datatype">State</a><a id="1621" class="Symbol">;</a><a id="1622" href="Algorithmic.CK.html#1126" class="Datatype">Stack</a><a id="1627" class="Symbol">;</a><a id="1628" href="Algorithmic.CK.html#1177" class="InductiveConstructor">ε</a><a id="1629" class="Symbol">)</a>
<a id="1631" class="Keyword">open</a> <a id="1636" href="Algorithmic.CK.html#1313" class="Module">Algorithmic.CK.State</a>

<a id="1658" class="Keyword">open</a> <a id="1663" class="Keyword">import</a> <a id="1670" href="Algorithmic.CEK.html" class="Module">Algorithmic.CEK</a> <a id="1686" class="Keyword">using</a> <a id="1692" class="Symbol">(</a><a id="1693" href="Algorithmic.CEK.html#20817" class="Function">stepper</a><a id="1700" class="Symbol">;</a><a id="1701" href="Algorithmic.CEK.html#18422" class="Datatype">State</a><a id="1706" class="Symbol">;</a><a id="1707" href="Algorithmic.CEK.html#18291" class="Datatype">Stack</a><a id="1712" class="Symbol">;</a><a id="1713" href="Algorithmic.CEK.html#18343" class="InductiveConstructor">ε</a><a id="1714" class="Symbol">;</a><a id="1715" href="Algorithmic.CEK.html#1843" class="Datatype">Env</a><a id="1718" class="Symbol">;</a><a id="1719" href="Algorithmic.CEK.html#3836" class="InductiveConstructor">[]</a><a id="1721" class="Symbol">)</a>
<a id="1723" class="Keyword">open</a> <a id="1728" href="Algorithmic.CEK.html#18422" class="Module">Algorithmic.CEK.State</a>

<a id="1751" class="Keyword">open</a> <a id="1756" class="Keyword">import</a> <a id="1763" href="Algorithmic.Erasure.html" class="Module">Algorithmic.Erasure</a> <a id="1783" class="Keyword">using</a> <a id="1789" class="Symbol">(</a><a id="1790" href="Algorithmic.Erasure.html#2235" class="Function">erase</a><a id="1795" class="Symbol">)</a>
<a id="1797" class="Keyword">import</a> <a id="1804" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a> <a id="1827" class="Symbol">as</a> <a id="1830" class="Module">L</a> <a id="1832" class="Keyword">using</a><a id="1837" class="Symbol">(</a><a id="1838" href="Algorithmic.Evaluation.html#2112" class="Function">stepper</a><a id="1845" class="Symbol">)</a>

<a id="1848" class="Keyword">open</a> <a id="1853" class="Keyword">import</a> <a id="1860" href="Evaluator.Base.html" class="Module">Evaluator.Base</a> <a id="1875" class="Keyword">using</a> <a id="1881" class="Symbol">(</a><a id="1882" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a><a id="1887" class="Symbol">;</a><a id="1888" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a><a id="1901" class="Symbol">;</a><a id="1902" href="Evaluator.Base.html#3064" class="Function">maxsteps</a><a id="1910" class="Symbol">;</a><a id="1911" href="Evaluator.Base.html#799" class="Postulate">prettyPrintUTm</a><a id="1925" class="Symbol">;</a><a id="1926" href="Evaluator.Base.html#732" class="Postulate">prettyPrintTm</a><a id="1939" class="Symbol">;</a><a id="1940" href="Evaluator.Base.html#765" class="Postulate">prettyPrintTy</a><a id="1953" class="Symbol">;</a><a id="1954" href="Evaluator.Base.html#487" class="Postulate">ParseError</a><a id="1964" class="Symbol">)</a>
<a id="1966" class="Keyword">open</a> <a id="1971" href="Evaluator.Base.html#1243" class="Module">ERROR</a>
</pre>
<h2 id="imports-from-haskell">Imports from Haskell</h2>

<pre class="Agda"><a id="2011" class="Symbol">{-#</a> <a id="2015" class="Keyword">FOREIGN</a> <a id="2023" class="Pragma">GHC</a> <a id="2027" class="Pragma">import</a> <a id="2034" class="Pragma">PlutusCore.Executable.Common</a>  <a id="2064" class="Symbol">#-}</a>
<a id="2068" class="Symbol">{-#</a> <a id="2072" class="Keyword">FOREIGN</a> <a id="2080" class="Pragma">GHC</a> <a id="2084" class="Pragma">import</a> <a id="2091" class="Pragma">PlutusCore.Executable.Parsers</a> <a id="2121" class="Symbol">#-}</a>

<a id="2126" class="Keyword">postulate</a>
   <a id="Format"></a><a id="2139" href="Evaluator.Program.html#2139" class="Postulate">Format</a> <a id="2146" class="Symbol">:</a> <a id="2148" href="Agda.Primitive.html#388" class="Primitive">Set</a>
   <a id="Input"></a><a id="2155" href="Evaluator.Program.html#2155" class="Postulate">Input</a> <a id="2161" class="Symbol">:</a> <a id="2163" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="2168" class="Symbol">{-#</a> <a id="2172" class="Keyword">COMPILE</a> <a id="2180" class="Keyword">GHC</a> <a id="2184" href="Evaluator.Program.html#2139" class="Postulate">Format</a> <a id="2191" class="Pragma">=</a> <a id="2193" class="Pragma">type</a> <a id="2198" class="Pragma">Format</a> <a id="2205" class="Symbol">#-}</a>
<a id="2209" class="Symbol">{-#</a> <a id="2213" class="Keyword">COMPILE</a> <a id="2221" class="Keyword">GHC</a> <a id="2225" href="Evaluator.Program.html#2155" class="Postulate">Input</a> <a id="2231" class="Pragma">=</a> <a id="2233" class="Pragma">type</a> <a id="2238" class="Pragma">Input</a> <a id="2244" class="Symbol">#-}</a>

<a id="2249" class="Keyword">postulate</a>
  <a id="ProgramN"></a><a id="2261" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="2270" class="Symbol">:</a> <a id="2272" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="Program"></a><a id="2278" href="Evaluator.Program.html#2278" class="Postulate">Program</a> <a id="2286" class="Symbol">:</a> <a id="2288" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="convP"></a><a id="2294" href="Evaluator.Program.html#2294" class="Postulate">convP</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="Evaluator.Program.html#2278" class="Postulate">Program</a> <a id="2310" class="Symbol">→</a> <a id="2312" href="Raw.html#1474" class="Datatype">RawTm</a>
  <a id="deBruijnify"></a><a id="2320" href="Evaluator.Program.html#2320" class="Postulate">deBruijnify</a> <a id="2332" class="Symbol">:</a> <a id="2334" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="2343" class="Symbol">→</a> <a id="2345" href="Utils.html#1133" class="Datatype">Either</a> <a id="2352" href="Scoped.html#7729" class="Postulate">FreeVariableError</a> <a id="2370" href="Evaluator.Program.html#2278" class="Postulate">Program</a>

  <a id="ProgramNU"></a><a id="2381" href="Evaluator.Program.html#2381" class="Postulate">ProgramNU</a> <a id="2391" class="Symbol">:</a> <a id="2393" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="ProgramU"></a><a id="2399" href="Evaluator.Program.html#2399" class="Postulate">ProgramU</a> <a id="2408" class="Symbol">:</a> <a id="2410" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="deBruijnifyU"></a><a id="2416" href="Evaluator.Program.html#2416" class="Postulate">deBruijnifyU</a> <a id="2429" class="Symbol">:</a> <a id="2431" href="Evaluator.Program.html#2381" class="Postulate">ProgramNU</a> <a id="2441" class="Symbol">→</a> <a id="2443" href="Utils.html#1133" class="Datatype">Either</a> <a id="2450" href="Scoped.html#7729" class="Postulate">FreeVariableError</a> <a id="2468" href="Evaluator.Program.html#2399" class="Postulate">ProgramU</a>
  <a id="convPU"></a><a id="2479" href="Evaluator.Program.html#2479" class="Postulate">convPU</a> <a id="2486" class="Symbol">:</a> <a id="2488" href="Evaluator.Program.html#2399" class="Postulate">ProgramU</a> <a id="2497" class="Symbol">→</a> <a id="2499" href="RawU.html#8077" class="Datatype">U.Untyped</a>

<a id="2510" class="Symbol">{-#</a> <a id="2514" class="Keyword">FOREIGN</a> <a id="2522" class="Pragma">GHC</a> <a id="2526" class="Pragma">import</a> <a id="2533" class="Pragma">PlutusCore.DeBruijn</a> <a id="2553" class="Symbol">#-}</a>
<a id="2557" class="Symbol">{-#</a> <a id="2561" class="Keyword">FOREIGN</a> <a id="2569" class="Pragma">GHC</a> <a id="2573" class="Pragma">import</a> <a id="2580" class="Pragma">qualified</a> <a id="2590" class="Pragma">UntypedPlutusCore</a> <a id="2608" class="Pragma">as</a> <a id="2611" class="Pragma">U</a> <a id="2613" class="Symbol">#-}</a>
<a id="2617" class="Symbol">{-#</a> <a id="2621" class="Keyword">FOREIGN</a> <a id="2629" class="Pragma">GHC</a> <a id="2633" class="Pragma">import</a> <a id="2640" class="Pragma">qualified</a> <a id="2650" class="Pragma">UntypedPlutusCore.Parser</a> <a id="2675" class="Pragma">as</a> <a id="2678" class="Pragma">U</a> <a id="2680" class="Symbol">#-}</a>
<a id="2684" class="Symbol">{-#</a> <a id="2688" class="Keyword">FOREIGN</a> <a id="2696" class="Pragma">GHC</a> <a id="2700" class="Pragma">import</a> <a id="2707" class="Pragma">qualified</a> <a id="2717" class="Pragma">FFI.Untyped</a> <a id="2729" class="Pragma">as</a> <a id="2732" class="Pragma">U</a> <a id="2734" class="Symbol">#-}</a>
<a id="2738" class="Symbol">{-#</a> <a id="2742" class="Keyword">FOREIGN</a> <a id="2750" class="Pragma">GHC</a> <a id="2754" class="Pragma">import</a> <a id="2761" class="Pragma">Raw</a> <a id="2765" class="Symbol">#-}</a>
<a id="2769" class="Symbol">{-#</a> <a id="2773" class="Keyword">FOREIGN</a> <a id="2781" class="Pragma">GHC</a> <a id="2785" class="Pragma">import</a> <a id="2792" class="Pragma">PlutusCore</a> <a id="2803" class="Symbol">#-}</a>
<a id="2807" class="Symbol">{-#</a> <a id="2811" class="Keyword">FOREIGN</a> <a id="2819" class="Pragma">GHC</a> <a id="2823" class="Pragma">import</a> <a id="2830" class="Pragma">Data.Bifunctor</a> <a id="2845" class="Symbol">#-}</a>
<a id="2849" class="Symbol">{-#</a> <a id="2853" class="Keyword">FOREIGN</a> <a id="2861" class="Pragma">GHC</a> <a id="2865" class="Pragma">import</a> <a id="2872" class="Pragma">Data.Functor</a> <a id="2885" class="Symbol">#-}</a>
<a id="2889" class="Symbol">{-#</a> <a id="2893" class="Keyword">FOREIGN</a> <a id="2901" class="Pragma">GHC</a> <a id="2905" class="Pragma">import</a> <a id="2912" class="Pragma">Data.Either</a> <a id="2924" class="Symbol">#-}</a>
<a id="2928" class="Symbol">{-#</a> <a id="2932" class="Keyword">FOREIGN</a> <a id="2940" class="Pragma">GHC</a> <a id="2944" class="Pragma">import</a> <a id="2951" class="Pragma">Control.Monad.Trans.Except</a> <a id="2978" class="Symbol">#-}</a>

<a id="2983" class="Symbol">{-#</a> <a id="2987" class="Keyword">COMPILE</a> <a id="2995" class="Keyword">GHC</a> <a id="2999" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="3008" class="Pragma">=</a> <a id="3010" class="Pragma">type</a> <a id="3015" class="Pragma">PlutusCore.Program</a> <a id="3034" class="Pragma">TyName</a> <a id="3041" class="Pragma">Name</a> <a id="3046" class="Pragma">DefaultUni</a> <a id="3057" class="Pragma">DefaultFun</a> <a id="3068" class="Pragma">PlutusCore.SrcSpan</a> <a id="3087" class="Symbol">#-}</a>
<a id="3091" class="Symbol">{-#</a> <a id="3095" class="Keyword">COMPILE</a> <a id="3103" class="Keyword">GHC</a> <a id="3107" href="Evaluator.Program.html#2278" class="Postulate">Program</a> <a id="3115" class="Pragma">=</a> <a id="3117" class="Pragma">type</a> <a id="3122" class="Pragma">PlutusCore.Program</a> <a id="3141" class="Pragma">NamedTyDeBruijn</a> <a id="3157" class="Pragma">NamedDeBruijn</a> <a id="3171" class="Pragma">DefaultUni</a> <a id="3182" class="Pragma">DefaultFun</a> <a id="3193" class="Pragma">()</a> <a id="3196" class="Symbol">#-}</a>
<a id="3200" class="Symbol">{-#</a> <a id="3204" class="Keyword">COMPILE</a> <a id="3212" class="Keyword">GHC</a> <a id="3216" href="Evaluator.Program.html#2294" class="Postulate">convP</a> <a id="3222" class="Pragma">=</a> <a id="3224" class="Pragma">convP</a> <a id="3230" class="Symbol">#-}</a>
<a id="3234" class="Symbol">{-#</a> <a id="3238" class="Keyword">COMPILE</a> <a id="3246" class="Keyword">GHC</a> <a id="3250" href="Evaluator.Program.html#2320" class="Postulate">deBruijnify</a> <a id="3262" class="Pragma">=</a> <a id="3264" class="Pragma">\</a> <a id="3266" class="Pragma">(Program</a> <a id="3275" class="Pragma">ann</a> <a id="3279" class="Pragma">ver</a> <a id="3283" class="Pragma">tm)</a> <a id="3287" class="Pragma">-&gt;</a> <a id="3290" class="Pragma">second</a> <a id="3297" class="Pragma">(void</a> <a id="3303" class="Pragma">.</a> <a id="3305" class="Pragma">Program</a> <a id="3313" class="Pragma">ann</a> <a id="3317" class="Pragma">ver)</a> <a id="3322" class="Pragma">.</a> <a id="3324" class="Pragma">runExcept</a> <a id="3334" class="Pragma">$</a> <a id="3336" class="Pragma">deBruijnTerm</a> <a id="3349" class="Pragma">tm</a> <a id="3352" class="Symbol">#-}</a>

<a id="3357" class="Symbol">{-#</a> <a id="3361" class="Keyword">COMPILE</a> <a id="3369" class="Keyword">GHC</a> <a id="3373" href="Evaluator.Program.html#2381" class="Postulate">ProgramNU</a> <a id="3383" class="Pragma">=</a> <a id="3385" class="Pragma">type</a> <a id="3390" class="Pragma">U.Program</a> <a id="3400" class="Pragma">Name</a> <a id="3405" class="Pragma">DefaultUni</a> <a id="3416" class="Pragma">DefaultFun</a> <a id="3427" class="Pragma">PlutusCore.SrcSpan</a> <a id="3446" class="Symbol">#-}</a>
<a id="3450" class="Symbol">{-#</a> <a id="3454" class="Keyword">COMPILE</a> <a id="3462" class="Keyword">GHC</a> <a id="3466" href="Evaluator.Program.html#2399" class="Postulate">ProgramU</a> <a id="3475" class="Pragma">=</a> <a id="3477" class="Pragma">type</a> <a id="3482" class="Pragma">U.Program</a> <a id="3492" class="Pragma">NamedDeBruijn</a> <a id="3506" class="Pragma">DefaultUni</a> <a id="3517" class="Pragma">DefaultFun</a> <a id="3528" class="Pragma">()</a> <a id="3531" class="Symbol">#-}</a>
<a id="3535" class="Symbol">{-#</a> <a id="3539" class="Keyword">COMPILE</a> <a id="3547" class="Keyword">GHC</a> <a id="3551" href="Evaluator.Program.html#2416" class="Postulate">deBruijnifyU</a> <a id="3564" class="Pragma">=</a> <a id="3566" class="Pragma">\</a> <a id="3568" class="Pragma">(U.Program</a> <a id="3579" class="Pragma">ann</a> <a id="3583" class="Pragma">ver</a> <a id="3587" class="Pragma">tm)</a> <a id="3591" class="Pragma">-&gt;</a> <a id="3594" class="Pragma">second</a> <a id="3601" class="Pragma">(void</a> <a id="3607" class="Pragma">.</a> <a id="3609" class="Pragma">U.Program</a> <a id="3619" class="Pragma">ann</a> <a id="3623" class="Pragma">ver)</a> <a id="3628" class="Pragma">.</a> <a id="3630" class="Pragma">runExcept</a> <a id="3640" class="Pragma">$</a> <a id="3642" class="Pragma">U.deBruijnTerm</a> <a id="3657" class="Pragma">tm</a> <a id="3660" class="Symbol">#-}</a>
<a id="3664" class="Symbol">{-#</a> <a id="3668" class="Keyword">COMPILE</a> <a id="3676" class="Keyword">GHC</a> <a id="3680" href="Evaluator.Program.html#2479" class="Postulate">convPU</a> <a id="3687" class="Pragma">=</a> <a id="3689" class="Pragma">U.convP</a> <a id="3697" class="Symbol">#-}</a>

<a id="3702" class="Symbol">{-#</a> <a id="3706" class="Keyword">FOREIGN</a> <a id="3714" class="Pragma">GHC</a> <a id="3718" class="Pragma">import</a> <a id="3725" class="Pragma">FFI.Opts</a> <a id="3734" class="Symbol">#-}</a>
</pre>
<h2 id="evaluators">Evaluators</h2>

<pre class="Agda"><a id="3762" class="Keyword">data</a> <a id="BudgetMode"></a><a id="3767" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="3778" class="Symbol">(</a><a id="3779" href="Evaluator.Program.html#3779" class="Bound">A</a> <a id="3781" class="Symbol">:</a> <a id="3783" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3786" class="Symbol">)</a> <a id="3788" class="Symbol">:</a> <a id="3790" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3794" class="Keyword">where</a>
  <a id="BudgetMode.Silent"></a><a id="3802" href="Evaluator.Program.html#3802" class="InductiveConstructor">Silent</a>   <a id="3811" class="Symbol">:</a> <a id="3813" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="3824" href="Evaluator.Program.html#3779" class="Bound">A</a>
  <a id="BudgetMode.Counting"></a><a id="3828" href="Evaluator.Program.html#3828" class="InductiveConstructor">Counting</a> <a id="3837" class="Symbol">:</a> <a id="3839" href="Evaluator.Program.html#3779" class="Bound">A</a> <a id="3841" class="Symbol">→</a> <a id="3843" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="3854" href="Evaluator.Program.html#3779" class="Bound">A</a>
  <a id="BudgetMode.Tallying"></a><a id="3858" href="Evaluator.Program.html#3858" class="InductiveConstructor">Tallying</a> <a id="3867" class="Symbol">:</a> <a id="3869" href="Evaluator.Program.html#3779" class="Bound">A</a> <a id="3871" class="Symbol">→</a> <a id="3873" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="3884" href="Evaluator.Program.html#3779" class="Bound">A</a>

<a id="3887" class="Symbol">{-#</a> <a id="3891" class="Keyword">COMPILE</a> <a id="3899" class="Keyword">GHC</a> <a id="3903" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="3914" class="Pragma">=</a> <a id="3916" class="Pragma">data</a> <a id="3921" class="Pragma">BudgetMode</a> <a id="3932" class="Pragma">(Silent</a> <a id="3940" class="Pragma">|</a> <a id="3942" class="Pragma">Counting</a> <a id="3951" class="Pragma">|</a> <a id="3953" class="Pragma">Tallying)</a> <a id="3963" class="Symbol">#-}</a>

<a id="3968" class="Keyword">data</a> <a id="EvalMode"></a><a id="3973" href="Evaluator.Program.html#3973" class="Datatype">EvalMode</a> <a id="3982" class="Symbol">:</a> <a id="3984" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3988" class="Keyword">where</a>
  <a id="EvalMode.U"></a><a id="3996" href="Evaluator.Program.html#3996" class="InductiveConstructor">U</a> <a id="EvalMode.TL"></a><a id="3998" href="Evaluator.Program.html#3998" class="InductiveConstructor">TL</a> <a id="EvalMode.TCK"></a><a id="4001" href="Evaluator.Program.html#4001" class="InductiveConstructor">TCK</a> <a id="EvalMode.TCEK"></a><a id="4005" href="Evaluator.Program.html#4005" class="InductiveConstructor">TCEK</a> <a id="4010" class="Symbol">:</a> <a id="4012" href="Evaluator.Program.html#3973" class="Datatype">EvalMode</a>

<a id="4022" class="Symbol">{-#</a> <a id="4026" class="Keyword">COMPILE</a> <a id="4034" class="Keyword">GHC</a> <a id="4038" href="Evaluator.Program.html#3973" class="Datatype">EvalMode</a> <a id="4047" class="Pragma">=</a> <a id="4049" class="Pragma">data</a> <a id="4054" class="Pragma">EvalMode</a> <a id="4063" class="Pragma">(U</a> <a id="4066" class="Pragma">|</a> <a id="4068" class="Pragma">TL</a> <a id="4071" class="Pragma">|</a> <a id="4073" class="Pragma">TCK</a> <a id="4077" class="Pragma">|</a> <a id="4079" class="Pragma">TCEK)</a> <a id="4085" class="Symbol">#-}</a>

<a id="parsePLC"></a><a id="4090" href="Evaluator.Program.html#4090" class="Function">parsePLC</a> <a id="4099" class="Symbol">:</a> <a id="4101" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="4110" class="Symbol">→</a> <a id="4112" href="Utils.html#1133" class="Datatype">Either</a> <a id="4119" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="4125" class="Symbol">(</a><a id="4126" href="Scoped.html#6896" class="Datatype">ScopedTm</a> <a id="4135" href="Scoped.html#1439" class="InductiveConstructor">Z</a><a id="4136" class="Symbol">)</a>
<a id="4138" href="Evaluator.Program.html#4090" class="Function">parsePLC</a> <a id="4147" href="Evaluator.Program.html#4147" class="Bound">namedprog</a> <a id="4157" class="Symbol">=</a> <a id="4159" class="Keyword">do</a>
  <a id="4164" href="Evaluator.Program.html#4164" class="Bound">prog</a> <a id="4169" href="Utils.html#2945" class="Field Operator">←</a> <a id="4171" href="Utils.html#3704" class="Function">withE</a> <a id="4177" class="Symbol">(</a><a id="4178" href="Evaluator.Base.html#1326" class="InductiveConstructor">ERROR.scopeError</a> <a id="4195" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4197" href="Scoped.html#7873" class="InductiveConstructor">freeVariableError</a><a id="4214" class="Symbol">)</a> <a id="4216" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4218" href="Evaluator.Program.html#2320" class="Postulate">deBruijnify</a> <a id="4230" href="Evaluator.Program.html#4147" class="Bound">namedprog</a>
  <a id="4242" href="Utils.html#3704" class="Function">withE</a> <a id="4248" href="Evaluator.Base.html#1326" class="InductiveConstructor">scopeError</a> <a id="4259" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4261" href="Scoped.html#9771" class="Function">scopeCheckTm</a> <a id="4274" class="Symbol">{</a><a id="4275" class="Number">0</a><a id="4276" class="Symbol">}{</a><a id="4278" href="Scoped.html#1439" class="InductiveConstructor">Z</a><a id="4279" class="Symbol">}</a> <a id="4281" class="Symbol">(</a><a id="4282" href="Scoped.html#4359" class="Function">shifter</a> <a id="4290" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="4292" class="Symbol">(</a><a id="4293" href="Evaluator.Program.html#2294" class="Postulate">convP</a> <a id="4299" href="Evaluator.Program.html#4164" class="Bound">prog</a><a id="4303" class="Symbol">))</a>
  <a id="4308" class="Comment">-- ^ FIXME: this should have an interface that guarantees that the</a>
  <a id="4377" class="Comment">-- shifter is run</a>

<a id="parseUPLC"></a><a id="4396" href="Evaluator.Program.html#4396" class="Function">parseUPLC</a> <a id="4406" class="Symbol">:</a> <a id="4408" href="Evaluator.Program.html#2381" class="Postulate">ProgramNU</a> <a id="4418" class="Symbol">→</a> <a id="4420" href="Utils.html#1133" class="Datatype">Either</a> <a id="4427" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="4433" class="Symbol">(</a><a id="4434" href="Data.Empty.html#914" class="Function">⊥</a> <a id="4436" href="Untyped.html#1677" class="Datatype Operator">U.⊢</a><a id="4439" class="Symbol">)</a>
<a id="4441" href="Evaluator.Program.html#4396" class="Function">parseUPLC</a> <a id="4451" href="Evaluator.Program.html#4451" class="Bound">namedprog</a> <a id="4461" class="Symbol">=</a> <a id="4463" class="Keyword">do</a>
  <a id="4468" href="Evaluator.Program.html#4468" class="Bound">prog</a> <a id="4473" href="Utils.html#2945" class="Field Operator">←</a> <a id="4475" href="Utils.html#3704" class="Function">withE</a> <a id="4481" class="Symbol">(</a><a id="4482" href="Evaluator.Base.html#1326" class="InductiveConstructor">ERROR.scopeError</a> <a id="4499" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4501" href="Scoped.html#7873" class="InductiveConstructor">freeVariableError</a><a id="4518" class="Symbol">)</a> <a id="4520" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4522" href="Evaluator.Program.html#2416" class="Postulate">deBruijnifyU</a> <a id="4535" href="Evaluator.Program.html#4451" class="Bound">namedprog</a>
  <a id="4547" href="Utils.html#3704" class="Function">withE</a> <a id="4553" href="Evaluator.Base.html#1326" class="InductiveConstructor">scopeError</a> <a id="4564" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4566" href="Untyped.html#6731" class="Function">U.scopeCheckU0</a> <a id="4581" class="Symbol">(</a><a id="4582" href="Evaluator.Program.html#2479" class="Postulate">convPU</a> <a id="4589" href="Evaluator.Program.html#4468" class="Bound">prog</a><a id="4593" class="Symbol">)</a>

<a id="typeCheckPLC"></a><a id="4596" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="4609" class="Symbol">:</a> <a id="4611" href="Scoped.html#6896" class="Datatype">ScopedTm</a> <a id="4620" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="4622" class="Symbol">→</a> <a id="4624" href="Utils.html#1133" class="Datatype">Either</a> <a id="4631" href="Check.html#2131" class="Datatype">TypeError</a> <a id="4641" class="Symbol">(</a><a id="4642" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="4644" class="Symbol">(</a><a id="4645" class="InductiveConstructor">∅</a> <a id="4647" href="Type.BetaNormal.html#1043" class="Datatype Operator">⊢Nf⋆</a> <a id="4652" href="Utils.html#10868" class="InductiveConstructor">*</a><a id="4653" class="Symbol">)</a> <a id="4655" class="Symbol">(</a><a id="4656" class="InductiveConstructor">∅</a> <a id="4658" href="Algorithmic.html#5495" class="Datatype Operator">⊢_</a><a id="4660" class="Symbol">))</a>
<a id="4663" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="4676" href="Evaluator.Program.html#4676" class="Bound">t</a> <a id="4678" class="Symbol">=</a> <a id="4680" href="Check.html#17848" class="Function">inferType</a> <a id="4690" class="Symbol">_</a> <a id="4692" href="Evaluator.Program.html#4676" class="Bound">t</a>
</pre>
<p>Check if the term is an error term, and in that case return an ERROR.</p>

<p>This is used when evaluation of the reduction semantics has ended</p>

<pre class="Agda"><a id="checkError"></a><a id="4841" href="Evaluator.Program.html#4841" class="Function">checkError</a> <a id="4852" class="Symbol">:</a> <a id="4854" class="Symbol">∀{</a><a id="4856" href="Evaluator.Program.html#4856" class="Bound">A</a><a id="4857" class="Symbol">}</a> <a id="4859" class="Symbol">→</a> <a id="4861" class="InductiveConstructor">∅</a> <a id="4863" href="Algorithmic.html#5495" class="Datatype Operator">⊢</a> <a id="4865" href="Evaluator.Program.html#4856" class="Bound">A</a> <a id="4867" class="Symbol">→</a> <a id="4869" href="Utils.html#1133" class="Datatype">Either</a> <a id="4876" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="4882" class="Symbol">(</a><a id="4883" class="InductiveConstructor">∅</a> <a id="4885" href="Algorithmic.html#5495" class="Datatype Operator">⊢</a> <a id="4887" href="Evaluator.Program.html#4856" class="Bound">A</a> <a id="4889" class="Symbol">)</a>
<a id="4891" href="Evaluator.Program.html#4841" class="Function">checkError</a> <a id="4902" class="Symbol">(</a><a id="4903" href="Algorithmic.html#7839" class="InductiveConstructor">error</a> <a id="4909" class="Symbol">_)</a> <a id="4912" class="Symbol">=</a> <a id="4914" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="4919" class="Symbol">(</a><a id="4920" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="4933" href="Utils.html#4416" class="InductiveConstructor">userError</a><a id="4942" class="Symbol">)</a>
<a id="4944" href="Evaluator.Program.html#4841" class="CatchallClause Function">checkError</a><a id="4954" class="CatchallClause"> </a><a id="4955" href="Evaluator.Program.html#4955" class="CatchallClause Bound">t</a>         <a id="4965" class="Symbol">=</a> <a id="4967" href="Utils.html#2917" class="Field">return</a> <a id="4974" href="Evaluator.Program.html#4955" class="Bound">t</a>

<a id="executePLC"></a><a id="4977" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="4988" class="Symbol">:</a> <a id="4990" href="Evaluator.Program.html#3973" class="Datatype">EvalMode</a> <a id="4999" class="Symbol">→</a> <a id="5001" href="Scoped.html#6896" class="Datatype">ScopedTm</a> <a id="5010" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="5012" class="Symbol">→</a> <a id="5014" href="Utils.html#1133" class="Datatype">Either</a> <a id="5021" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="5027" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="5034" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="5045" href="Evaluator.Program.html#3996" class="InductiveConstructor">U</a> <a id="5047" href="Evaluator.Program.html#5047" class="Bound">t</a> <a id="5049" class="Symbol">=</a> <a id="5051" class="Keyword">do</a>
  <a id="5056" class="Symbol">(</a><a id="5057" href="Evaluator.Program.html#5057" class="Bound">A</a> <a id="5059" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5062" href="Evaluator.Program.html#5062" class="Bound">t</a><a id="5063" class="Symbol">)</a> <a id="5065" href="Utils.html#2945" class="Field Operator">←</a> <a id="5067" href="Utils.html#3704" class="Function">withE</a> <a id="5073" class="Symbol">(λ</a> <a id="5076" href="Evaluator.Program.html#5076" class="Bound">e</a> <a id="5078" class="Symbol">→</a> <a id="5080" href="Evaluator.Base.html#1263" class="InductiveConstructor">typeError</a> <a id="5090" class="Symbol">(</a><a id="5091" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a> <a id="5105" href="Evaluator.Program.html#5076" class="Bound">e</a><a id="5106" class="Symbol">))</a> <a id="5109" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5111" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="5124" href="Evaluator.Program.html#5047" class="Bound">t</a>
  <a id="5128" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="5130" href="Evaluator.Program.html#5130" class="Bound">V</a> <a id="5132" href="Utils.html#2945" class="Field Operator">←</a> <a id="5134" href="Utils.html#3704" class="Function">withE</a> <a id="5140" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5153" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5155" href="Untyped.CEK.html#25070" class="Function">U.stepper</a> <a id="5165" href="Evaluator.Base.html#3064" class="Function">maxsteps</a> <a id="5174" class="Symbol">(</a><a id="5175" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="5177" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="5179" href="Untyped.CEK.html#1385" class="InductiveConstructor">[]</a> <a id="5182" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="5184" href="Algorithmic.Erasure.html#2235" class="Function">erase</a> <a id="5190" href="Evaluator.Program.html#5062" class="Bound">t</a><a id="5191" class="Symbol">)</a>
    <a id="5197" class="Keyword">where</a> <a id="5203" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>  <a id="5206" class="Symbol">→</a> <a id="5208" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="5213" class="Symbol">(</a><a id="5214" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5227" href="Utils.html#4416" class="InductiveConstructor">userError</a><a id="5236" class="Symbol">)</a>
          <a id="5248" class="CatchallClause Symbol">_</a>  <a id="5251" class="Symbol">→</a> <a id="5253" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="5258" class="Symbol">(</a><a id="5259" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5272" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="5280" class="Symbol">)</a>
<a id="5282" class="Comment">{-
just t&#39; ← withE runtimeError $ U.stepper maxsteps (ε ; [] ▻ erase t)
    where nothing → inj₁ (runtimeError userError)
    -}</a>
  <a id="5413" href="Utils.html#2917" class="Field">return</a> <a id="5420" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5422" href="Evaluator.Base.html#799" class="Postulate">prettyPrintUTm</a> <a id="5437" class="Symbol">(</a><a id="5438" href="Untyped.html#5424" class="Function">U.extricateU0</a> <a id="5452" class="Symbol">(</a><a id="5453" href="Untyped.CEK.html#2527" class="Function">U.discharge</a> <a id="5465" href="Evaluator.Program.html#5130" class="Bound">V</a><a id="5466" class="Symbol">))</a>
<a id="5469" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="5480" href="Evaluator.Program.html#3998" class="InductiveConstructor">TL</a> <a id="5483" href="Evaluator.Program.html#5483" class="Bound">t</a> <a id="5485" class="Symbol">=</a> <a id="5487" class="Keyword">do</a>
  <a id="5492" class="Symbol">(</a><a id="5493" href="Evaluator.Program.html#5493" class="Bound">A</a> <a id="5495" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5498" href="Evaluator.Program.html#5498" class="Bound">t</a><a id="5499" class="Symbol">)</a> <a id="5501" href="Utils.html#2945" class="Field Operator">←</a> <a id="5503" href="Utils.html#3704" class="Function">withE</a> <a id="5509" class="Symbol">(λ</a> <a id="5512" href="Evaluator.Program.html#5512" class="Bound">e</a> <a id="5514" class="Symbol">→</a> <a id="5516" href="Evaluator.Base.html#1263" class="InductiveConstructor">typeError</a> <a id="5526" class="Symbol">(</a><a id="5527" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a> <a id="5541" href="Evaluator.Program.html#5512" class="Bound">e</a><a id="5542" class="Symbol">))</a> <a id="5545" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5547" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="5560" href="Evaluator.Program.html#5483" class="Bound">t</a>
  <a id="5564" href="Evaluator.Program.html#5564" class="Bound">t&#39;</a> <a id="5567" href="Utils.html#2945" class="Field Operator">←</a> <a id="5569" class="Symbol">(</a><a id="5570" href="Utils.html#3704" class="Function">withE</a> <a id="5576" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5589" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5591" href="Algorithmic.Evaluation.html#2112" class="Function">L.stepper</a> <a id="5601" href="Evaluator.Program.html#5498" class="Bound">t</a> <a id="5603" href="Evaluator.Base.html#3064" class="Function">maxsteps</a><a id="5611" class="Symbol">)</a> <a id="5613" href="Utils.html#2945" class="Field Operator">&gt;&gt;=</a> <a id="5617" href="Evaluator.Program.html#4841" class="Function">checkError</a>
  <a id="5630" href="Utils.html#2917" class="Field">return</a> <a id="5637" class="Symbol">(</a><a id="5638" href="Evaluator.Base.html#732" class="Postulate">prettyPrintTm</a> <a id="5652" class="Symbol">(</a><a id="5653" href="Scoped.html#6018" class="Function">unshifter</a> <a id="5663" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="5665" class="Symbol">(</a><a id="5666" href="Scoped.html#12026" class="Function">extricateScope</a> <a id="5681" class="Symbol">(</a><a id="5682" href="Scoped.Extrication.html#3031" class="Function">extricate</a> <a id="5692" href="Evaluator.Program.html#5564" class="Bound">t&#39;</a><a id="5694" class="Symbol">))))</a>
<a id="5699" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="5710" href="Evaluator.Program.html#4001" class="InductiveConstructor">TCK</a> <a id="5714" href="Evaluator.Program.html#5714" class="Bound">t</a> <a id="5716" class="Symbol">=</a> <a id="5718" class="Keyword">do</a>
  <a id="5723" class="Symbol">(</a><a id="5724" href="Evaluator.Program.html#5724" class="Bound">A</a> <a id="5726" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5729" href="Evaluator.Program.html#5729" class="Bound">t</a><a id="5730" class="Symbol">)</a> <a id="5732" href="Utils.html#2945" class="Field Operator">←</a> <a id="5734" href="Utils.html#3704" class="Function">withE</a> <a id="5740" class="Symbol">(λ</a> <a id="5743" href="Evaluator.Program.html#5743" class="Bound">e</a> <a id="5745" class="Symbol">→</a> <a id="5747" href="Evaluator.Base.html#1263" class="InductiveConstructor">typeError</a> <a id="5757" class="Symbol">(</a><a id="5758" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a> <a id="5772" href="Evaluator.Program.html#5743" class="Bound">e</a><a id="5773" class="Symbol">))</a> <a id="5776" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5778" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="5791" href="Evaluator.Program.html#5714" class="Bound">t</a>
  <a id="5795" href="Algorithmic.CK.html#1470" class="InductiveConstructor">□</a> <a id="5797" class="Symbol">{</a><a id="5798" class="Argument">t</a> <a id="5800" class="Symbol">=</a> <a id="5802" href="Evaluator.Program.html#5802" class="Bound">t</a><a id="5803" class="Symbol">}</a> <a id="5805" href="Evaluator.Program.html#5805" class="Bound">v</a> <a id="5807" href="Utils.html#2945" class="Field Operator">←</a> <a id="5809" href="Utils.html#3704" class="Function">withE</a> <a id="5815" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5828" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5830" href="Algorithmic.CK.html#4610" class="Function">Algorithmic.CK.stepper</a> <a id="5853" href="Evaluator.Base.html#3064" class="Function">maxsteps</a> <a id="5862" class="Symbol">(</a><a id="5863" href="Algorithmic.CK.html#1177" class="InductiveConstructor">ε</a> <a id="5865" href="Algorithmic.CK.html#1348" class="InductiveConstructor Operator">▻</a> <a id="5867" href="Evaluator.Program.html#5729" class="Bound">t</a><a id="5868" class="Symbol">)</a>
    <a id="5874" class="Keyword">where</a> <a id="5880" href="Algorithmic.CK.html#1510" class="InductiveConstructor">◆</a> <a id="5882" class="Symbol">_</a>  <a id="5885" class="Symbol">→</a> <a id="5887" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="5892" class="Symbol">(</a><a id="5893" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5906" href="Utils.html#4416" class="InductiveConstructor">userError</a><a id="5915" class="Symbol">)</a>
          <a id="5927" class="CatchallClause Symbol">_</a>    <a id="5932" class="Symbol">→</a> <a id="5934" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="5939" class="Symbol">(</a><a id="5940" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="5953" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="5961" class="Symbol">)</a>
  <a id="5965" href="Utils.html#2917" class="Field">return</a> <a id="5972" class="Symbol">(</a><a id="5973" href="Evaluator.Base.html#732" class="Postulate">prettyPrintTm</a> <a id="5987" class="Symbol">(</a><a id="5988" href="Scoped.html#6018" class="Function">unshifter</a> <a id="5998" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="6000" class="Symbol">(</a><a id="6001" href="Scoped.html#12026" class="Function">extricateScope</a> <a id="6016" class="Symbol">(</a><a id="6017" href="Scoped.Extrication.html#3031" class="Function">extricate</a> <a id="6027" href="Evaluator.Program.html#5802" class="Bound">t</a><a id="6028" class="Symbol">))))</a>
<a id="6033" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="6044" href="Evaluator.Program.html#4005" class="InductiveConstructor">TCEK</a> <a id="6049" href="Evaluator.Program.html#6049" class="Bound">t</a> <a id="6051" class="Symbol">=</a> <a id="6053" class="Keyword">do</a>
  <a id="6058" class="Symbol">(</a><a id="6059" href="Evaluator.Program.html#6059" class="Bound">A</a> <a id="6061" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="6064" href="Evaluator.Program.html#6064" class="Bound">t</a><a id="6065" class="Symbol">)</a> <a id="6067" href="Utils.html#2945" class="Field Operator">←</a> <a id="6069" href="Utils.html#3704" class="Function">withE</a> <a id="6075" class="Symbol">(λ</a> <a id="6078" href="Evaluator.Program.html#6078" class="Bound">e</a> <a id="6080" class="Symbol">→</a> <a id="6082" href="Evaluator.Base.html#1263" class="InductiveConstructor">typeError</a> <a id="6092" class="Symbol">(</a><a id="6093" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a> <a id="6107" href="Evaluator.Program.html#6078" class="Bound">e</a><a id="6108" class="Symbol">))</a> <a id="6111" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6113" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="6126" href="Evaluator.Program.html#6049" class="Bound">t</a>
  <a id="6130" href="Algorithmic.CEK.html#18579" class="InductiveConstructor">□</a> <a id="6132" href="Evaluator.Program.html#6132" class="Bound">V</a> <a id="6134" href="Utils.html#2945" class="Field Operator">←</a> <a id="6136" href="Utils.html#3704" class="Function">withE</a> <a id="6142" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="6155" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6157" href="Algorithmic.CEK.html#20817" class="Function">Algorithmic.CEK.stepper</a> <a id="6181" href="Evaluator.Base.html#3064" class="Function">maxsteps</a> <a id="6190" class="Symbol">(</a><a id="6191" href="Algorithmic.CEK.html#18343" class="InductiveConstructor">ε</a> <a id="6193" href="Algorithmic.CEK.html#18457" class="InductiveConstructor Operator">;</a> <a id="6195" href="Algorithmic.CEK.html#3836" class="InductiveConstructor">[]</a> <a id="6198" href="Algorithmic.CEK.html#18457" class="InductiveConstructor Operator">▻</a> <a id="6200" href="Evaluator.Program.html#6064" class="Bound">t</a><a id="6201" class="Symbol">)</a>
    <a id="6207" class="Keyword">where</a> <a id="6213" href="Algorithmic.CEK.html#18607" class="InductiveConstructor">◆</a> <a id="6215" class="Symbol">_</a>  <a id="6218" class="Symbol">→</a> <a id="6220" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="6225" class="Symbol">(</a><a id="6226" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="6239" href="Utils.html#4416" class="InductiveConstructor">userError</a><a id="6248" class="Symbol">)</a>
          <a id="6260" class="CatchallClause Symbol">_</a>    <a id="6265" class="Symbol">→</a> <a id="6267" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="6272" class="Symbol">(</a><a id="6273" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="6286" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="6294" class="Symbol">)</a>
  <a id="6298" href="Utils.html#2917" class="Field">return</a> <a id="6305" class="Symbol">(</a><a id="6306" href="Evaluator.Base.html#732" class="Postulate">prettyPrintTm</a> <a id="6320" class="Symbol">(</a><a id="6321" href="Scoped.html#6018" class="Function">unshifter</a> <a id="6331" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="6333" class="Symbol">(</a><a id="6334" href="Scoped.html#12026" class="Function">extricateScope</a> <a id="6349" class="Symbol">(</a><a id="6350" href="Scoped.Extrication.html#3031" class="Function">extricate</a> <a id="6360" class="Symbol">(</a><a id="6361" href="Algorithmic.CEK.html#4039" class="Function">Algorithmic.CEK.discharge</a> <a id="6387" href="Evaluator.Program.html#6132" class="Bound">V</a><a id="6388" class="Symbol">)))))</a>

<a id="showUPLCResult"></a><a id="6395" href="Evaluator.Program.html#6395" class="Function">showUPLCResult</a> <a id="6410" class="Symbol">:</a> <a id="6412" href="Untyped.CEK.html#3620" class="Datatype">U.State</a> <a id="6420" class="Symbol">→</a> <a id="6422" href="Utils.html#1133" class="Datatype">Either</a> <a id="6429" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="6435" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="6442" href="Evaluator.Program.html#6395" class="Function">showUPLCResult</a> <a id="6457" class="Symbol">(</a><a id="6458" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="6460" href="Evaluator.Program.html#6460" class="Bound">V</a><a id="6461" class="Symbol">)</a> <a id="6463" class="Symbol">=</a> <a id="6465" href="Utils.html#2917" class="Field">return</a> <a id="6472" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6474" href="Evaluator.Base.html#799" class="Postulate">prettyPrintUTm</a> <a id="6489" class="Symbol">(</a><a id="6490" href="Untyped.html#5424" class="Function">U.extricateU0</a> <a id="6504" class="Symbol">(</a><a id="6505" href="Untyped.CEK.html#2527" class="Function">U.discharge</a> <a id="6517" href="Evaluator.Program.html#6460" class="Bound">V</a><a id="6518" class="Symbol">))</a>
<a id="6521" href="Evaluator.Program.html#6395" class="Function">showUPLCResult</a> <a id="6536" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>     <a id="6542" class="Symbol">=</a> <a id="6544" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="6549" class="Symbol">(</a><a id="6550" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="6563" href="Utils.html#4416" class="InductiveConstructor">userError</a><a id="6572" class="Symbol">)</a>
<a id="6574" href="Evaluator.Program.html#6395" class="CatchallClause Function">showUPLCResult</a><a id="6588" class="CatchallClause"> </a><a id="6589" class="CatchallClause Symbol">_</a>     <a id="6595" class="Symbol">=</a> <a id="6597" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="6602" class="Symbol">(</a><a id="6603" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="6616" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="6624" class="Symbol">)</a>

<a id="executeUPLCwithMP"></a><a id="6627" href="Evaluator.Program.html#6627" class="Function">executeUPLCwithMP</a> <a id="6645" class="Symbol">:</a> <a id="6647" class="Symbol">∀{</a><a id="6649" href="Evaluator.Program.html#6649" class="Bound">A</a><a id="6650" class="Symbol">}</a> <a id="6652" class="Symbol">→</a> <a id="6654" href="Cost.Raw.html#6132" class="Function">RawCostModel</a> <a id="6667" class="Symbol">→</a> <a id="6669" class="Symbol">(</a><a id="6670" href="Cost.html#3595" class="Function">CostModel</a> <a id="6680" class="Symbol">→</a> <a id="6682" href="Cost.Base.html#2053" class="Record">MachineParameters</a> <a id="6700" href="Evaluator.Program.html#6649" class="Bound">A</a><a id="6701" class="Symbol">)</a> <a id="6703" class="Symbol">→</a> <a id="6705" class="Symbol">(</a><a id="6706" href="Evaluator.Program.html#6649" class="Bound">A</a> <a id="6708" class="Symbol">→</a> <a id="6710" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="6716" class="Symbol">)</a> <a id="6718" class="Symbol">→</a> <a id="6720" href="Data.Empty.html#914" class="Function">⊥</a> <a id="6722" href="Untyped.html#1677" class="Datatype Operator">U.⊢</a> <a id="6726" class="Symbol">→</a> <a id="6728" href="Utils.html#1133" class="Datatype">Either</a> <a id="6735" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="6741" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="6748" href="Evaluator.Program.html#6627" class="Function">executeUPLCwithMP</a> <a id="6766" class="Symbol">(</a><a id="6767" href="Evaluator.Program.html#6767" class="Bound">cekMachineCosts</a> <a id="6783" href="Utils.html#5107" class="InductiveConstructor Operator">,</a> <a id="6785" href="Evaluator.Program.html#6785" class="Bound">rawmodel</a><a id="6793" class="Symbol">)</a> <a id="6795" href="Evaluator.Program.html#6795" class="Bound">mkMP</a> <a id="6800" href="Evaluator.Program.html#6800" class="Bound">report</a> <a id="6807" href="Evaluator.Program.html#6807" class="Bound">t</a> <a id="6809" class="Keyword">with</a> <a id="6814" href="Cost.Model.html#10274" class="Function">createMap</a> <a id="6824" href="Evaluator.Program.html#6785" class="Bound">rawmodel</a>
<a id="6833" class="Symbol">...</a> <a id="6837" class="Symbol">|</a> <a id="6839" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6844" href="Evaluator.Program.html#6844" class="Bound">model</a> <a id="6850" class="Symbol">=</a> <a id="6852" class="Keyword">do</a>
    <a id="6859" class="Keyword">let</a> <a id="6863" href="Evaluator.Program.html#6863" class="Bound">machineparam</a> <a id="6876" class="Symbol">=</a> <a id="6878" class="Bound">mkMP</a> <a id="6883" class="Symbol">(</a><a id="6884" class="Bound">cekMachineCosts</a> <a id="6900" href="Utils.html#5107" class="InductiveConstructor Operator">,</a> <a id="6902" href="Evaluator.Program.html#6844" class="Bound">model</a><a id="6907" class="Symbol">)</a>
    <a id="6913" class="Keyword">let</a> <a id="6917" class="Symbol">(</a><a id="6918" href="Evaluator.Program.html#6918" class="Bound">ev</a> <a id="6921" href="Utils.html#4009" class="InductiveConstructor Operator">,</a> <a id="6923" href="Evaluator.Program.html#6923" class="Bound">exBudget</a><a id="6931" class="Symbol">)</a> <a id="6933" class="Symbol">=</a> <a id="6935" href="Untyped.CEKWithCost.html#6609" class="Function">U.stepperC</a> <a id="6946" href="Evaluator.Program.html#6863" class="Bound">machineparam</a> <a id="6959" href="Evaluator.Base.html#3064" class="Function">maxsteps</a> <a id="6968" class="Symbol">(</a><a id="6969" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="6971" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="6973" href="Untyped.CEK.html#1385" class="InductiveConstructor">[]</a> <a id="6976" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="6978" class="Bound">t</a><a id="6979" class="Symbol">)</a>
    <a id="6985" href="Evaluator.Program.html#6985" class="Bound">x</a> <a id="6987" href="Utils.html#2945" class="Field Operator">←</a> <a id="6989" href="Utils.html#3704" class="Function">withE</a> <a id="6995" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="7008" href="Evaluator.Program.html#6918" class="Bound">ev</a>
    <a id="7015" href="Evaluator.Program.html#7015" class="Bound">r</a> <a id="7017" href="Utils.html#2945" class="Field Operator">←</a> <a id="7019" href="Evaluator.Program.html#6395" class="Function">showUPLCResult</a> <a id="7034" href="Evaluator.Program.html#6985" class="Bound">x</a>
    <a id="7040" href="Utils.html#2917" class="Field">return</a> <a id="7047" class="Symbol">(</a><a id="7048" href="Evaluator.Program.html#7015" class="Bound">r</a> <a id="7050" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="7053" class="Bound">report</a> <a id="7060" href="Evaluator.Program.html#6923" class="Bound">exBudget</a><a id="7068" class="Symbol">)</a>
<a id="7070" class="Symbol">...</a> <a id="7074" class="Symbol">|</a> <a id="7076" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7084" class="Symbol">=</a> <a id="7086" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="7091" class="Symbol">(</a><a id="7092" href="Evaluator.Base.html#1398" class="InductiveConstructor">jsonError</a> <a id="7102" class="String">&quot;while processing parameters.&quot;</a><a id="7132" class="Symbol">)</a>

<a id="executeUPLC"></a><a id="7135" href="Evaluator.Program.html#7135" class="Function">executeUPLC</a> <a id="7147" class="Symbol">:</a> <a id="7149" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="7160" href="Cost.Raw.html#6132" class="Function">RawCostModel</a> <a id="7173" class="Symbol">→</a> <a id="7175" href="Data.Empty.html#914" class="Function">⊥</a> <a id="7177" href="Untyped.html#1677" class="Datatype Operator">U.⊢</a> <a id="7181" class="Symbol">→</a> <a id="7183" href="Utils.html#1133" class="Datatype">Either</a> <a id="7190" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="7196" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7203" href="Evaluator.Program.html#7135" class="Function">executeUPLC</a> <a id="7215" href="Evaluator.Program.html#3802" class="InductiveConstructor">Silent</a> <a id="7222" href="Evaluator.Program.html#7222" class="Bound">t</a> <a id="7224" class="Symbol">=</a> <a id="7226" class="Symbol">(</a><a id="7227" href="Utils.html#3704" class="Function">withE</a> <a id="7233" href="Evaluator.Base.html#1360" class="InductiveConstructor">runtimeError</a> <a id="7246" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7248" href="Untyped.CEK.html#25070" class="Function">U.stepper</a> <a id="7258" href="Evaluator.Base.html#3064" class="Function">maxsteps</a> <a id="7267" class="Symbol">(</a><a id="7268" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="7270" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7272" href="Untyped.CEK.html#1385" class="InductiveConstructor">[]</a> <a id="7275" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7277" href="Evaluator.Program.html#7222" class="Bound">t</a><a id="7278" class="Symbol">))</a> <a id="7281" href="Utils.html#2945" class="Field Operator">&gt;&gt;=</a> <a id="7285" href="Evaluator.Program.html#6395" class="Function">showUPLCResult</a>
<a id="7300" href="Evaluator.Program.html#7135" class="Function">executeUPLC</a> <a id="7312" class="Symbol">(</a><a id="7313" href="Evaluator.Program.html#3828" class="InductiveConstructor">Counting</a> <a id="7322" href="Evaluator.Program.html#7322" class="Bound">rcm</a><a id="7325" class="Symbol">)</a> <a id="7327" href="Evaluator.Program.html#7327" class="Bound">t</a> <a id="7329" class="Symbol">=</a> <a id="7331" href="Evaluator.Program.html#6627" class="Function">executeUPLCwithMP</a> <a id="7349" href="Evaluator.Program.html#7322" class="Bound">rcm</a> <a id="7353" href="Cost.html#4635" class="Function">machineParameters</a> <a id="7371" href="Cost.html#4849" class="Function">countingReport</a> <a id="7386" href="Evaluator.Program.html#7327" class="Bound">t</a>
<a id="7388" href="Evaluator.Program.html#7135" class="Function">executeUPLC</a> <a id="7400" class="Symbol">(</a><a id="7401" href="Evaluator.Program.html#3858" class="InductiveConstructor">Tallying</a> <a id="7410" href="Evaluator.Program.html#7410" class="Bound">rcm</a><a id="7413" class="Symbol">)</a> <a id="7415" href="Evaluator.Program.html#7415" class="Bound">t</a> <a id="7417" class="Symbol">=</a> <a id="7419" href="Evaluator.Program.html#6627" class="Function">executeUPLCwithMP</a> <a id="7437" href="Evaluator.Program.html#7410" class="Bound">rcm</a> <a id="7441" href="Cost.html#6828" class="Function">tallyingMachineParameters</a> <a id="7467" href="Cost.html#7079" class="Function">tallyingReport</a> <a id="7482" href="Evaluator.Program.html#7415" class="Bound">t</a>

<a id="evalProgramNU"></a><a id="7485" href="Evaluator.Program.html#7485" class="Function">evalProgramNU</a> <a id="7499" class="Symbol">:</a> <a id="7501" href="Evaluator.Program.html#3767" class="Datatype">BudgetMode</a> <a id="7512" href="Cost.Raw.html#6132" class="Function">RawCostModel</a> <a id="7525" class="Symbol">→</a> <a id="7527" href="Evaluator.Program.html#2381" class="Postulate">ProgramNU</a> <a id="7537" class="Symbol">→</a> <a id="7539" href="Utils.html#1133" class="Datatype">Either</a> <a id="7546" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="7552" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7559" href="Evaluator.Program.html#7485" class="Function">evalProgramNU</a> <a id="7573" href="Evaluator.Program.html#7573" class="Bound">bm</a> <a id="7576" href="Evaluator.Program.html#7576" class="Bound">namedprog</a> <a id="7586" class="Symbol">=</a> <a id="7588" class="Keyword">do</a>
  <a id="7593" href="Evaluator.Program.html#7593" class="Bound">t</a> <a id="7595" href="Utils.html#2945" class="Field Operator">←</a> <a id="7597" href="Evaluator.Program.html#4396" class="Function">parseUPLC</a> <a id="7607" href="Evaluator.Program.html#7576" class="Bound">namedprog</a>
  <a id="7619" href="Evaluator.Program.html#7135" class="Function">executeUPLC</a> <a id="7631" href="Evaluator.Program.html#7573" class="Bound">bm</a> <a id="7634" href="Evaluator.Program.html#7593" class="Bound">t</a>

<a id="evalProgramN"></a><a id="7637" href="Evaluator.Program.html#7637" class="Function">evalProgramN</a> <a id="7650" class="Symbol">:</a> <a id="7652" href="Evaluator.Program.html#3973" class="Datatype">EvalMode</a> <a id="7661" class="Symbol">→</a> <a id="7663" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="7672" class="Symbol">→</a> <a id="7674" href="Utils.html#1133" class="Datatype">Either</a> <a id="7681" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="7687" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7694" href="Evaluator.Program.html#7637" class="Function">evalProgramN</a> <a id="7707" href="Evaluator.Program.html#7707" class="Bound">m</a> <a id="7709" href="Evaluator.Program.html#7709" class="Bound">namedprog</a> <a id="7719" class="Symbol">=</a> <a id="7721" class="Keyword">do</a>
  <a id="7726" class="Comment">{-
  -- some debugging code
  prog ← withE (ERROR.scopeError ∘ freeVariableError) $ deBruijnify namedprog
  let shiftedprog = shifter Z (convP prog)
  scopedprog ← withE scopeError $ scopeCheckTm {0}{Z} shiftedprog
  let extricatedprog = extricateScope scopedprog
  let unshiftedprog = unshifter Z extricatedprog
  return (&quot;orginal: &quot; ++ rawPrinter (convP prog) ++ &quot;\n&quot; ++
          &quot;shifted: &quot; ++ rawPrinter shiftedprog ++ &quot;\n&quot; ++
          &quot;instrinsically scoped: &quot; ++ Scoped.ugly scopedprog ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawPrinter extricatedprog ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawPrinter unshiftedprog ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTm unshiftedprog ++ &quot;\n&quot;)
   -}</a>
   <a id="8431" href="Evaluator.Program.html#8431" class="Bound">t</a> <a id="8433" href="Utils.html#2945" class="Field Operator">←</a> <a id="8435" href="Evaluator.Program.html#4090" class="Function">parsePLC</a> <a id="8444" href="Evaluator.Program.html#7709" class="Bound">namedprog</a>
   <a id="8457" href="Evaluator.Program.html#4977" class="Function">executePLC</a> <a id="8468" href="Evaluator.Program.html#7707" class="Bound">m</a> <a id="8470" href="Evaluator.Program.html#8431" class="Bound">t</a>

<a id="typeCheckProgramN"></a><a id="8473" href="Evaluator.Program.html#8473" class="Function">typeCheckProgramN</a> <a id="8491" class="Symbol">:</a> <a id="8493" href="Evaluator.Program.html#2261" class="Postulate">ProgramN</a> <a id="8502" class="Symbol">→</a> <a id="8504" href="Utils.html#1133" class="Datatype">Either</a> <a id="8511" href="Evaluator.Base.html#1243" class="Datatype">ERROR</a> <a id="8517" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="8524" href="Evaluator.Program.html#8473" class="Function">typeCheckProgramN</a> <a id="8542" href="Evaluator.Program.html#8542" class="Bound">namedprog</a> <a id="8552" class="Symbol">=</a> <a id="8554" class="Keyword">do</a>
  <a id="8559" href="Evaluator.Program.html#8559" class="Bound">t</a> <a id="8561" href="Utils.html#2945" class="Field Operator">←</a> <a id="8563" href="Evaluator.Program.html#4090" class="Function">parsePLC</a> <a id="8572" href="Evaluator.Program.html#8542" class="Bound">namedprog</a>
  <a id="8584" class="Symbol">(</a><a id="8585" href="Evaluator.Program.html#8585" class="Bound">A</a> <a id="8587" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="8590" class="Symbol">_)</a> <a id="8593" href="Utils.html#2945" class="Field Operator">←</a> <a id="8595" href="Utils.html#3704" class="Function">withE</a> <a id="8601" class="Symbol">(λ</a> <a id="8604" href="Evaluator.Program.html#8604" class="Bound">e</a> <a id="8606" class="Symbol">→</a> <a id="8608" href="Evaluator.Base.html#1263" class="InductiveConstructor">typeError</a> <a id="8618" class="Symbol">(</a><a id="8619" href="Evaluator.Base.html#1464" class="Function">uglyTypeError</a> <a id="8633" href="Evaluator.Program.html#8604" class="Bound">e</a><a id="8634" class="Symbol">)</a> <a id="8636" class="Symbol">)</a> <a id="8638" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8640" href="Evaluator.Program.html#4596" class="Function">typeCheckPLC</a> <a id="8653" href="Evaluator.Program.html#8559" class="Bound">t</a>
<a id="8655" class="Comment">{-
  -- some debugging code
  let extricatedtype = extricateScopeTy (extricateNf⋆ A)
  let unshiftedtype = unshifterTy Z extricatedtype
  return (&quot;original: &quot; ++ &quot;???&quot; ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawTyPrinter extricatedtype ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawTyPrinter unshiftedtype ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTy unshiftedtype ++ &quot;\n&quot;)
 -}</a>
  <a id="9035" href="Utils.html#2917" class="Field">return</a> <a id="9042" class="Symbol">(</a><a id="9043" href="Evaluator.Base.html#765" class="Postulate">prettyPrintTy</a> <a id="9057" class="Symbol">(</a><a id="9058" href="Scoped.html#5193" class="Function">unshifterTy</a> <a id="9070" href="Scoped.html#1439" class="InductiveConstructor">Z</a> <a id="9072" class="Symbol">(</a><a id="9073" href="Scoped.html#11006" class="Function">extricateScopeTy</a> <a id="9090" class="Symbol">(</a><a id="9091" href="Scoped.Extrication.html#1316" class="Function">extricateNf⋆</a> <a id="9104" href="Evaluator.Program.html#8585" class="Bound">A</a><a id="9105" class="Symbol">))))</a>
</pre>

    </section>
  </body>
</html>
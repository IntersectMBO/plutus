<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>VerifiedCompilation.UCaseReduce</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>VerifiedCompilation.UCaseReduce</h1>
    <section>
      <h1 id="case-reduce-translation-phase">Case-Reduce Translation Phase</h1>
<pre class="Agda"><a id="98" class="Keyword">module</a> <a id="105" href="VerifiedCompilation.UCaseReduce.html" class="Module">VerifiedCompilation.UCaseReduce</a> <a id="137" class="Keyword">where</a>

</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Untyped.Equality.html" class="Module">Untyped.Equality</a> <a id="193" class="Keyword">using</a> <a id="199" class="Symbol">(</a><a id="200" href="Untyped.Equality.html#2127" class="Record">DecEq</a><a id="205" class="Symbol">;</a> <a id="207" href="Untyped.Equality.html#2163" class="Field Operator">_≟_</a><a id="210" class="Symbol">;</a><a id="211" href="Untyped.Equality.html#3568" class="Function">decPointwise</a><a id="223" class="Symbol">)</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="VerifiedCompilation.UntypedViews.html" class="Module">VerifiedCompilation.UntypedViews</a> <a id="270" class="Keyword">using</a> <a id="276" class="Symbol">(</a><a id="277" href="VerifiedCompilation.UntypedViews.html#1354" class="Function">Pred</a><a id="281" class="Symbol">;</a> <a id="283" href="VerifiedCompilation.UntypedViews.html#6066" class="Function">isCase?</a><a id="290" class="Symbol">;</a> <a id="292" href="VerifiedCompilation.UntypedViews.html#2680" class="Function">isApp?</a><a id="298" class="Symbol">;</a> <a id="300" href="VerifiedCompilation.UntypedViews.html#1964" class="Function">isLambda?</a><a id="309" class="Symbol">;</a> <a id="311" href="VerifiedCompilation.UntypedViews.html#3465" class="Function">isForce?</a><a id="319" class="Symbol">;</a> <a id="321" href="VerifiedCompilation.UntypedViews.html#6911" class="Function">isBuiltin?</a><a id="331" class="Symbol">;</a> <a id="333" href="VerifiedCompilation.UntypedViews.html#5283" class="Function">isConstr?</a><a id="342" class="Symbol">;</a> <a id="344" href="VerifiedCompilation.UntypedViews.html#4153" class="Function">isDelay?</a><a id="352" class="Symbol">;</a> <a id="354" href="VerifiedCompilation.UntypedViews.html#7886" class="Function">isTerm?</a><a id="361" class="Symbol">;</a> <a id="363" href="VerifiedCompilation.UntypedViews.html#1528" class="Function">isVar?</a><a id="369" class="Symbol">;</a> <a id="371" href="VerifiedCompilation.UntypedViews.html#8051" class="Function">allTerms?</a><a id="380" class="Symbol">;</a> <a id="382" href="VerifiedCompilation.UntypedViews.html#5985" class="InductiveConstructor">iscase</a><a id="388" class="Symbol">;</a> <a id="390" href="VerifiedCompilation.UntypedViews.html#2626" class="InductiveConstructor">isapp</a><a id="395" class="Symbol">;</a> <a id="397" href="VerifiedCompilation.UntypedViews.html#1912" class="InductiveConstructor">islambda</a><a id="405" class="Symbol">;</a> <a id="407" href="VerifiedCompilation.UntypedViews.html#3415" class="InductiveConstructor">isforce</a><a id="414" class="Symbol">;</a> <a id="416" href="VerifiedCompilation.UntypedViews.html#6857" class="InductiveConstructor">isbuiltin</a><a id="425" class="Symbol">;</a> <a id="427" href="VerifiedCompilation.UntypedViews.html#5208" class="InductiveConstructor">isconstr</a><a id="435" class="Symbol">;</a> <a id="437" href="VerifiedCompilation.UntypedViews.html#7856" class="InductiveConstructor">isterm</a><a id="443" class="Symbol">;</a> <a id="445" href="VerifiedCompilation.UntypedViews.html#8008" class="InductiveConstructor">allterms</a><a id="453" class="Symbol">;</a> <a id="455" href="VerifiedCompilation.UntypedViews.html#4103" class="InductiveConstructor">isdelay</a><a id="462" class="Symbol">;</a> <a id="464" href="VerifiedCompilation.UntypedViews.html#1494" class="InductiveConstructor">isvar</a><a id="469" class="Symbol">)</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="VerifiedCompilation.UntypedTranslation.html" class="Module">VerifiedCompilation.UntypedTranslation</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="VerifiedCompilation.UntypedTranslation.html#1652" class="Datatype">Translation</a><a id="540" class="Symbol">;</a> <a id="542" href="VerifiedCompilation.UntypedTranslation.html#4042" class="Function">translation?</a><a id="554" class="Symbol">;</a> <a id="556" href="VerifiedCompilation.UntypedTranslation.html#1603" class="Function">Relation</a><a id="564" class="Symbol">;</a> <a id="566" href="VerifiedCompilation.UntypedTranslation.html#11001" class="Function">convert</a><a id="573" class="Symbol">;</a> <a id="575" href="VerifiedCompilation.UntypedTranslation.html#12253" class="Function">reflexive</a><a id="584" class="Symbol">)</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">_×-dec_</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Untyped.html" class="Module">Untyped</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Untyped.html#1605" class="Datatype Operator">_⊢</a><a id="660" class="Symbol">;</a> <a id="662" href="Untyped.html#1803" class="InductiveConstructor">case</a><a id="666" class="Symbol">;</a> <a id="668" href="Untyped.html#1851" class="InductiveConstructor">builtin</a><a id="675" class="Symbol">;</a> <a id="677" href="Untyped.html#1672" class="InductiveConstructor Operator">_·_</a><a id="680" class="Symbol">;</a> <a id="682" href="Untyped.html#1696" class="InductiveConstructor">force</a><a id="687" class="Symbol">;</a> <a id="689" href="Untyped.html#1630" class="InductiveConstructor">`</a><a id="690" class="Symbol">;</a> <a id="692" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a><a id="693" class="Symbol">;</a> <a id="695" href="Untyped.html#1716" class="InductiveConstructor">delay</a><a id="700" class="Symbol">;</a> <a id="702" href="Untyped.html#1736" class="InductiveConstructor">con</a><a id="705" class="Symbol">;</a> <a id="707" href="Untyped.html#1756" class="InductiveConstructor">constr</a><a id="713" class="Symbol">;</a> <a id="715" href="Untyped.html#1883" class="InductiveConstructor">error</a><a id="720" class="Symbol">;</a> <a id="722" href="Untyped.html#7393" class="Function">con-integer</a><a id="733" class="Symbol">)</a>
<a id="735" class="Keyword">import</a> <a id="742" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="780" class="Symbol">as</a> <a id="783" class="Module">Eq</a>
<a id="786" class="Keyword">open</a> <a id="791" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="794" class="Keyword">using</a> <a id="800" class="Symbol">(</a><a id="801" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="804" class="Symbol">;</a> <a id="806" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="867" class="Keyword">using</a> <a id="873" class="Symbol">(</a><a id="874" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a><a id="879" class="Symbol">;</a> <a id="881" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="884" class="Symbol">;</a> <a id="886" href="Relation.Binary.PropositionalEquality.Core.html#1989" class="Function">subst</a><a id="891" class="Symbol">)</a>
<a id="893" class="Keyword">open</a> <a id="898" class="Keyword">import</a> <a id="905" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="917" class="Keyword">using</a> <a id="923" class="Symbol">(</a><a id="924" href="Untyped.CEK.html#22505" class="Function">lookup?</a><a id="931" class="Symbol">;</a> <a id="933" href="Untyped.CEK.html#22638" class="Function">lookup?-deterministic</a><a id="954" class="Symbol">)</a>
<a id="956" class="Keyword">open</a> <a id="961" class="Keyword">import</a> <a id="968" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="977" class="Keyword">using</a> <a id="983" class="Symbol">(</a><a id="984" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a><a id="987" class="Symbol">;</a> <a id="989" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="993" class="Symbol">;</a> <a id="995" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a><a id="998" class="Symbol">)</a>
<a id="1000" class="Keyword">open</a> <a id="1005" class="Keyword">import</a> <a id="1012" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1021" class="Keyword">using</a> <a id="1027" class="Symbol">(</a><a id="1028" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1029" class="Symbol">;</a> <a id="1031" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="1035" class="Symbol">;</a> <a id="1037" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="1040" class="Symbol">)</a>
<a id="1042" class="Keyword">open</a> <a id="1047" class="Keyword">import</a> <a id="1054" href="Data.List.html" class="Module">Data.List</a> <a id="1064" class="Keyword">using</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="1075" class="Symbol">;</a> <a id="1077" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="1080" class="Symbol">;</a> <a id="1082" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="1084" class="Symbol">;</a> <a id="1086" href="Data.List.Base.html#5205" class="Function Operator">[_]</a><a id="1089" class="Symbol">)</a>
<a id="1091" class="Keyword">open</a> <a id="1096" class="Keyword">import</a> <a id="1103" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1114" class="Keyword">using</a> <a id="1120" class="Symbol">(</a><a id="1121" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="1126" class="Symbol">;</a> <a id="1128" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1132" class="Symbol">;</a> <a id="1134" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1141" class="Symbol">)</a>
<a id="1143" class="Keyword">open</a> <a id="1148" class="Keyword">import</a> <a id="1155" href="Data.List.Relation.Binary.Pointwise.Base.html" class="Module">Data.List.Relation.Binary.Pointwise.Base</a> <a id="1196" class="Keyword">using</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Data.List.Relation.Binary.Pointwise.Base.html#884" class="Datatype">Pointwise</a><a id="1212" class="Symbol">)</a>
<a id="1214" class="Keyword">import</a> <a id="1221" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1237" class="Symbol">as</a> <a id="1240" class="Module">Binary</a> <a id="1247" class="Keyword">using</a> <a id="1253" class="Symbol">(</a><a id="1254" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a><a id="1263" class="Symbol">)</a>
<a id="1265" class="Keyword">open</a> <a id="1270" class="Keyword">import</a> <a id="1277" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1294" class="Keyword">using</a> <a id="1300" class="Symbol">(</a><a id="1301" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a><a id="1304" class="Symbol">;</a> <a id="1306" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a><a id="1309" class="Symbol">;</a> <a id="1311" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a><a id="1313" class="Symbol">;</a> <a id="1315" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬_</a><a id="1317" class="Symbol">)</a>
<a id="1319" class="Keyword">open</a> <a id="1324" class="Keyword">import</a> <a id="1331" href="Data.Product.html" class="Module">Data.Product</a> <a id="1344" class="Keyword">using</a> <a id="1350" class="Symbol">(</a><a id="1351" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="1354" class="Symbol">)</a>
<a id="1356" class="Keyword">open</a> <a id="1361" class="Keyword">import</a> <a id="1368" href="RawU.html" class="Module">RawU</a> <a id="1373" class="Keyword">using</a> <a id="1379" class="Symbol">(</a><a id="1380" href="RawU.html#8843" class="Function">tag2TyTag</a><a id="1389" class="Symbol">;</a> <a id="1391" href="RawU.html#8032" class="InductiveConstructor">tmCon</a><a id="1396" class="Symbol">)</a>
<a id="1398" class="Keyword">open</a> <a id="1403" class="Keyword">import</a> <a id="1410" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a> <a id="1427" class="Keyword">using</a> <a id="1433" class="Symbol">(</a><a id="1434" href="Agda.Builtin.Int.html#245" class="Datatype">Int</a><a id="1437" class="Symbol">)</a>
<a id="1439" class="Keyword">open</a> <a id="1444" class="Keyword">import</a> <a id="1451" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="1462" class="Keyword">using</a> <a id="1468" class="Symbol">(</a><a id="1469" href="Data.Empty.html#914" class="Function">⊥</a><a id="1470" class="Symbol">)</a>
<a id="1472" class="Keyword">open</a> <a id="1477" class="Keyword">import</a> <a id="1484" href="Function.html" class="Module">Function</a> <a id="1493" class="Keyword">using</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Function.Base.html#4042" class="Function Operator">case_of_</a><a id="1508" class="Symbol">)</a>
<a id="1510" class="Keyword">open</a> <a id="1515" class="Keyword">import</a> <a id="1522" href="VerifiedCompilation.Certificate.html" class="Module">VerifiedCompilation.Certificate</a> <a id="1554" class="Keyword">using</a> <a id="1560" class="Symbol">(</a><a id="1561" href="VerifiedCompilation.Certificate.html#4068" class="Datatype">ProofOrCE</a><a id="1570" class="Symbol">;</a> <a id="1572" href="VerifiedCompilation.Certificate.html#3856" class="InductiveConstructor">ce</a><a id="1574" class="Symbol">;</a> <a id="1576" href="VerifiedCompilation.Certificate.html#3823" class="InductiveConstructor">proof</a><a id="1581" class="Symbol">;</a> <a id="1583" href="VerifiedCompilation.Certificate.html#2518" class="InductiveConstructor">caseReduceT</a><a id="1594" class="Symbol">)</a>
<a id="1596" class="Keyword">open</a> <a id="1601" class="Keyword">import</a> <a id="1608" href="Untyped.Reduction.html" class="Module">Untyped.Reduction</a> <a id="1626" class="Keyword">using</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Untyped.Reduction.html#4231" class="Function">iterApp</a><a id="1640" class="Symbol">)</a>
</pre>
<h2 id="translation-relation">Translation Relation</h2>

<pre class="Agda"><a id="1676" class="Keyword">data</a> <a id="CaseReduce"></a><a id="1681" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="1692" class="Symbol">:</a> <a id="1694" href="VerifiedCompilation.UntypedTranslation.html#1603" class="Function">Relation</a> <a id="1703" class="Keyword">where</a>
  <a id="CaseReduce.casereduce"></a><a id="1711" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="1722" class="Symbol">:</a> <a id="1724" class="Symbol">{</a><a id="1725" href="VerifiedCompilation.UCaseReduce.html#1725" class="Bound">X</a> <a id="1727" class="Symbol">:</a> <a id="1729" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1730" class="Symbol">}</a> <a id="1732" class="Symbol">{</a><a id="1733" href="VerifiedCompilation.UCaseReduce.html#1733" class="Bound">x</a> <a id="1735" class="Symbol">:</a> <a id="1737" href="VerifiedCompilation.UCaseReduce.html#1725" class="Bound">X</a> <a id="1739" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1740" class="Symbol">}</a> <a id="1742" class="Symbol">{</a> <a id="1744" href="VerifiedCompilation.UCaseReduce.html#1744" class="Bound">x&#39;</a> <a id="1747" class="Symbol">:</a> <a id="1749" href="VerifiedCompilation.UCaseReduce.html#1725" class="Bound">X</a> <a id="1751" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1752" class="Symbol">}</a> <a id="1754" class="Symbol">{</a><a id="1755" href="VerifiedCompilation.UCaseReduce.html#1755" class="Bound">vs</a> <a id="1758" href="VerifiedCompilation.UCaseReduce.html#1758" class="Bound">xs</a> <a id="1761" class="Symbol">:</a> <a id="1763" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1768" class="Symbol">(</a><a id="1769" href="VerifiedCompilation.UCaseReduce.html#1725" class="Bound">X</a> <a id="1771" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1772" class="Symbol">)}</a> <a id="1775" class="Symbol">{</a><a id="1776" href="VerifiedCompilation.UCaseReduce.html#1776" class="Bound">i</a> <a id="1778" class="Symbol">:</a> <a id="1780" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1781" class="Symbol">}</a>
                         <a id="1808" class="Symbol">→</a> <a id="1810" href="Untyped.CEK.html#22505" class="Function">lookup?</a> <a id="1818" href="VerifiedCompilation.UCaseReduce.html#1776" class="Bound">i</a> <a id="1820" href="VerifiedCompilation.UCaseReduce.html#1758" class="Bound">xs</a> <a id="1823" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1825" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1830" href="VerifiedCompilation.UCaseReduce.html#1733" class="Bound">x</a>
                         <a id="1857" class="Symbol">→</a> <a id="1859" href="VerifiedCompilation.UntypedTranslation.html#1652" class="Datatype">Translation</a> <a id="1871" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="1882" class="Symbol">(</a><a id="1883" href="Untyped.Reduction.html#4231" class="Function">iterApp</a> <a id="1891" href="VerifiedCompilation.UCaseReduce.html#1733" class="Bound">x</a> <a id="1893" href="VerifiedCompilation.UCaseReduce.html#1755" class="Bound">vs</a><a id="1895" class="Symbol">)</a> <a id="1897" href="VerifiedCompilation.UCaseReduce.html#1744" class="Bound">x&#39;</a>
                         <a id="1925" class="Symbol">→</a> <a id="1927" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="1938" class="Symbol">(</a><a id="1939" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="1944" class="Symbol">(</a><a id="1945" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="1952" href="VerifiedCompilation.UCaseReduce.html#1776" class="Bound">i</a> <a id="1954" href="VerifiedCompilation.UCaseReduce.html#1755" class="Bound">vs</a><a id="1956" class="Symbol">)</a> <a id="1958" href="VerifiedCompilation.UCaseReduce.html#1758" class="Bound">xs</a><a id="1960" class="Symbol">)</a> <a id="1962" href="VerifiedCompilation.UCaseReduce.html#1744" class="Bound">x&#39;</a>
</pre>
<h2 id="decision-procedure">Decision Procedure</h2>

<pre class="Agda"><a id="isCaseReduce?"></a><a id="1996" href="VerifiedCompilation.UCaseReduce.html#1996" class="Function">isCaseReduce?</a> <a id="2010" class="Symbol">:</a> <a id="2012" class="Symbol">{</a><a id="2013" href="VerifiedCompilation.UCaseReduce.html#2013" class="Bound">X</a> <a id="2015" class="Symbol">:</a> <a id="2017" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2018" class="Symbol">}</a> <a id="2020" class="Symbol">→</a> <a id="2022" class="Symbol">(</a><a id="2023" href="VerifiedCompilation.UCaseReduce.html#2023" class="Bound">ast</a> <a id="2027" href="VerifiedCompilation.UCaseReduce.html#2027" class="Bound">ast&#39;</a> <a id="2032" class="Symbol">:</a> <a id="2034" href="VerifiedCompilation.UCaseReduce.html#2013" class="Bound">X</a> <a id="2036" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="2037" class="Symbol">)</a> <a id="2039" class="Symbol">→</a> <a id="2041" href="VerifiedCompilation.Certificate.html#4068" class="Datatype">ProofOrCE</a> <a id="2051" class="Symbol">(</a><a id="2052" href="VerifiedCompilation.UntypedTranslation.html#1652" class="Datatype">Translation</a> <a id="2064" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="2075" class="Symbol">{</a><a id="2076" href="VerifiedCompilation.UCaseReduce.html#2013" class="Bound">X</a><a id="2077" class="Symbol">}</a> <a id="2079" href="VerifiedCompilation.UCaseReduce.html#2023" class="Bound">ast</a> <a id="2083" href="VerifiedCompilation.UCaseReduce.html#2027" class="Bound">ast&#39;</a><a id="2087" class="Symbol">)</a>

<a id="justEq"></a><a id="2090" href="VerifiedCompilation.UCaseReduce.html#2090" class="Function">justEq</a> <a id="2097" class="Symbol">:</a> <a id="2099" class="Symbol">{</a><a id="2100" href="VerifiedCompilation.UCaseReduce.html#2100" class="Bound">X</a> <a id="2102" class="Symbol">:</a> <a id="2104" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2107" class="Symbol">}</a> <a id="2109" class="Symbol">{</a><a id="2110" href="VerifiedCompilation.UCaseReduce.html#2110" class="Bound">x</a> <a id="2112" href="VerifiedCompilation.UCaseReduce.html#2112" class="Bound">x₁</a> <a id="2115" class="Symbol">:</a> <a id="2117" href="VerifiedCompilation.UCaseReduce.html#2100" class="Bound">X</a><a id="2118" class="Symbol">}</a> <a id="2120" class="Symbol">→</a> <a id="2122" class="Symbol">(</a><a id="2123" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2128" href="VerifiedCompilation.UCaseReduce.html#2110" class="Bound">x</a><a id="2129" class="Symbol">)</a> <a id="2131" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2133" class="Symbol">(</a><a id="2134" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2139" href="VerifiedCompilation.UCaseReduce.html#2112" class="Bound">x₁</a><a id="2141" class="Symbol">)</a> <a id="2143" class="Symbol">→</a> <a id="2145" href="VerifiedCompilation.UCaseReduce.html#2110" class="Bound">x</a> <a id="2147" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2149" href="VerifiedCompilation.UCaseReduce.html#2112" class="Bound">x₁</a>
<a id="2152" href="VerifiedCompilation.UCaseReduce.html#2090" class="Function">justEq</a> <a id="2159" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2164" class="Symbol">=</a> <a id="2166" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="2172" class="Symbol">{-#</a> <a id="2176" class="Keyword">TERMINATING</a> <a id="2188" class="Symbol">#-}</a>
<a id="isCR?"></a><a id="2192" href="VerifiedCompilation.UCaseReduce.html#2192" class="Function">isCR?</a> <a id="2198" class="Symbol">:</a> <a id="2200" class="Symbol">{</a><a id="2201" href="VerifiedCompilation.UCaseReduce.html#2201" class="Bound">X</a> <a id="2203" class="Symbol">:</a> <a id="2205" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2206" class="Symbol">}</a> <a id="2208" class="Symbol">→</a> <a id="2210" class="Symbol">(</a><a id="2211" href="VerifiedCompilation.UCaseReduce.html#2211" class="Bound">ast</a> <a id="2215" href="VerifiedCompilation.UCaseReduce.html#2215" class="Bound">ast&#39;</a> <a id="2220" class="Symbol">:</a> <a id="2222" href="VerifiedCompilation.UCaseReduce.html#2201" class="Bound">X</a> <a id="2224" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="2225" class="Symbol">)</a> <a id="2227" class="Symbol">→</a> <a id="2229" href="VerifiedCompilation.Certificate.html#4068" class="Datatype">ProofOrCE</a> <a id="2239" class="Symbol">(</a><a id="2240" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="2251" href="VerifiedCompilation.UCaseReduce.html#2211" class="Bound">ast</a> <a id="2255" href="VerifiedCompilation.UCaseReduce.html#2215" class="Bound">ast&#39;</a><a id="2259" class="Symbol">)</a>
<a id="2261" href="VerifiedCompilation.UCaseReduce.html#2192" class="Function">isCR?</a> <a id="2267" href="VerifiedCompilation.UCaseReduce.html#2267" class="Bound">ast</a> <a id="2271" href="VerifiedCompilation.UCaseReduce.html#2271" class="Bound">ast&#39;</a> <a id="2276" class="Keyword">with</a> <a id="2281" class="Symbol">(</a><a id="2282" href="VerifiedCompilation.UntypedViews.html#6066" class="Function">isCase?</a> <a id="2290" class="Symbol">(</a><a id="2291" href="VerifiedCompilation.UntypedViews.html#5283" class="Function">isConstr?</a> <a id="2301" href="VerifiedCompilation.UntypedViews.html#8051" class="Function">allTerms?</a><a id="2310" class="Symbol">)</a> <a id="2312" href="VerifiedCompilation.UntypedViews.html#8051" class="Function">allTerms?</a><a id="2321" class="Symbol">)</a> <a id="2323" href="VerifiedCompilation.UCaseReduce.html#2267" class="Bound">ast</a>
<a id="2327" class="Symbol">...</a> <a id="2331" class="Symbol">|</a> <a id="2333" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="2336" href="VerifiedCompilation.UCaseReduce.html#2336" class="Bound">¬p</a> <a id="2339" class="Symbol">=</a> <a id="2341" href="VerifiedCompilation.Certificate.html#4144" class="InductiveConstructor">ce</a> <a id="2344" class="Symbol">(λ</a> <a id="2347" class="Symbol">{</a> <a id="2349" class="Symbol">(</a><a id="2350" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="2361" class="Symbol">_</a> <a id="2363" class="Symbol">_)</a> <a id="2366" class="Symbol">→</a> <a id="2368" href="VerifiedCompilation.UCaseReduce.html#2336" class="Bound">¬p</a> <a id="2371" class="Symbol">(</a><a id="2372" href="VerifiedCompilation.UntypedViews.html#5985" class="InductiveConstructor">iscase</a> <a id="2379" class="Symbol">(</a><a id="2380" href="VerifiedCompilation.UntypedViews.html#5208" class="InductiveConstructor">isconstr</a> <a id="2389" class="Symbol">_</a> <a id="2391" class="Symbol">(</a><a id="2392" href="VerifiedCompilation.UntypedViews.html#8008" class="InductiveConstructor">allterms</a> <a id="2401" class="Symbol">_))</a> <a id="2405" class="Symbol">(</a><a id="2406" href="VerifiedCompilation.UntypedViews.html#8008" class="InductiveConstructor">allterms</a> <a id="2415" class="Symbol">_))}</a> <a id="2420" class="Symbol">)</a> <a id="2422" href="VerifiedCompilation.Certificate.html#2518" class="InductiveConstructor">caseReduceT</a> <a id="2434" class="Bound">ast</a> <a id="2438" class="Bound">ast&#39;</a>
<a id="2443" class="Symbol">...</a> <a id="2447" class="Symbol">|</a> <a id="2449" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2453" class="Symbol">(</a><a id="2454" href="VerifiedCompilation.UntypedViews.html#5985" class="InductiveConstructor">iscase</a> <a id="2461" class="Symbol">(</a><a id="2462" href="VerifiedCompilation.UntypedViews.html#5208" class="InductiveConstructor">isconstr</a> <a id="2471" href="VerifiedCompilation.UCaseReduce.html#2471" class="Bound">i</a> <a id="2473" class="Symbol">(</a><a id="2474" href="VerifiedCompilation.UntypedViews.html#8008" class="InductiveConstructor">allterms</a> <a id="2483" href="VerifiedCompilation.UCaseReduce.html#2483" class="Bound">vs</a><a id="2485" class="Symbol">))</a> <a id="2488" class="Symbol">(</a><a id="2489" href="VerifiedCompilation.UntypedViews.html#8008" class="InductiveConstructor">allterms</a> <a id="2498" href="VerifiedCompilation.UCaseReduce.html#2498" class="Bound">xs</a><a id="2500" class="Symbol">))</a> <a id="2503" class="Keyword">with</a> <a id="2508" href="Untyped.CEK.html#22505" class="Function">lookup?</a> <a id="2516" href="VerifiedCompilation.UCaseReduce.html#2471" class="Bound">i</a> <a id="2518" href="VerifiedCompilation.UCaseReduce.html#2498" class="Bound">xs</a> <a id="2521" class="Keyword">in</a> <a id="2524" class="Argument">xv</a>
<a id="2527" class="Symbol">...</a>          <a id="2540" class="Symbol">|</a> <a id="2542" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2550" class="Symbol">=</a> <a id="2552" href="VerifiedCompilation.Certificate.html#4144" class="InductiveConstructor">ce</a> <a id="2555" class="Symbol">(λ</a> <a id="2558" class="Symbol">{</a> <a id="2560" class="Symbol">(</a><a id="2561" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="2572" href="VerifiedCompilation.UCaseReduce.html#2572" class="Bound">p</a> <a id="2574" class="Symbol">_)</a> <a id="2577" class="Symbol">→</a> <a id="2579" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="2584" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="2590" class="Symbol">(</a><a id="2591" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2595" href="VerifiedCompilation.UCaseReduce.html#2524" class="Bound">xv</a><a id="2597" class="Symbol">)</a> <a id="2599" href="VerifiedCompilation.UCaseReduce.html#2572" class="Bound">p</a> <a id="2601" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="2604" class="Symbol">λ</a> <a id="2606" class="Symbol">{</a> <a id="2608" class="Symbol">()</a> <a id="2611" class="Symbol">}}</a> <a id="2614" class="Symbol">)</a> <a id="2616" href="VerifiedCompilation.Certificate.html#2518" class="InductiveConstructor">caseReduceT</a> <a id="2628" class="Bound">ast</a> <a id="2632" class="Bound">ast&#39;</a>
<a id="2637" class="Symbol">...</a>          <a id="2650" class="Symbol">|</a> <a id="2652" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2657" href="VerifiedCompilation.UCaseReduce.html#2657" class="Bound">x</a> <a id="2659" class="Keyword">with</a> <a id="2664" href="VerifiedCompilation.UCaseReduce.html#1996" class="Function">isCaseReduce?</a> <a id="2678" class="Symbol">(</a><a id="2679" href="Untyped.Reduction.html#4231" class="Function">iterApp</a> <a id="2687" href="VerifiedCompilation.UCaseReduce.html#2657" class="Bound">x</a> <a id="2689" class="Bound">vs</a><a id="2691" class="Symbol">)</a> <a id="2693" class="Bound">ast&#39;</a>
<a id="2698" class="Symbol">...</a>                  <a id="2719" class="Symbol">|</a> <a id="2721" href="VerifiedCompilation.Certificate.html#4112" class="InductiveConstructor">proof</a> <a id="2727" href="VerifiedCompilation.UCaseReduce.html#2727" class="Bound">p</a> <a id="2729" class="Symbol">=</a> <a id="2731" href="VerifiedCompilation.Certificate.html#4112" class="InductiveConstructor">proof</a> <a id="2737" class="Symbol">(</a><a id="2738" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="2749" href="VerifiedCompilation.UCaseReduce.html#2524" class="Bound">xv</a> <a id="2752" href="VerifiedCompilation.UCaseReduce.html#2727" class="Bound">p</a><a id="2753" class="Symbol">)</a>
<a id="2755" class="Symbol">...</a>                  <a id="2776" class="Symbol">|</a> <a id="2778" href="VerifiedCompilation.Certificate.html#4144" class="InductiveConstructor">ce</a> <a id="2781" href="VerifiedCompilation.UCaseReduce.html#2781" class="Bound">¬t</a> <a id="2784" href="VerifiedCompilation.UCaseReduce.html#2784" class="Bound">t</a> <a id="2786" href="VerifiedCompilation.UCaseReduce.html#2786" class="Bound">b</a> <a id="2788" href="VerifiedCompilation.UCaseReduce.html#2788" class="Bound">a</a> <a id="2790" class="Symbol">=</a> <a id="2792" href="VerifiedCompilation.Certificate.html#4144" class="InductiveConstructor">ce</a> <a id="2795" class="Symbol">(λ</a> <a id="2798" class="Symbol">{</a> <a id="2800" class="Symbol">(</a><a id="2801" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="2812" href="VerifiedCompilation.UCaseReduce.html#2812" class="Bound">p</a> <a id="2814" href="VerifiedCompilation.UCaseReduce.html#2814" class="Bound">t</a><a id="2815" class="Symbol">)</a> <a id="2817" class="Symbol">→</a> <a id="2819" href="VerifiedCompilation.UCaseReduce.html#2781" class="Bound">¬t</a> <a id="2822" class="Symbol">(</a><a id="2823" href="Relation.Binary.PropositionalEquality.Core.html#1989" class="Function">subst</a> <a id="2829" class="Symbol">(λ</a> <a id="2832" href="VerifiedCompilation.UCaseReduce.html#2832" class="Bound">x</a> <a id="2834" class="Symbol">→</a> <a id="2836" href="VerifiedCompilation.UntypedTranslation.html#1652" class="Datatype">Translation</a> <a id="2848" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="2859" class="Symbol">(</a><a id="2860" href="Untyped.Reduction.html#4231" class="Function">iterApp</a> <a id="2868" href="VerifiedCompilation.UCaseReduce.html#2832" class="Bound">x</a> <a id="2870" class="Bound">vs</a><a id="2872" class="Symbol">)</a> <a id="2874" class="Bound">ast&#39;</a><a id="2878" class="Symbol">)</a> <a id="2880" class="Symbol">(</a><a id="2881" href="VerifiedCompilation.UCaseReduce.html#2090" class="Function">justEq</a> <a id="2888" class="Symbol">(</a><a id="2889" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="2895" class="Symbol">(</a><a id="2896" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2900" href="VerifiedCompilation.UCaseReduce.html#2812" class="Bound">p</a><a id="2901" class="Symbol">)</a> <a id="2903" href="VerifiedCompilation.UCaseReduce.html#2524" class="Bound">xv</a><a id="2905" class="Symbol">))</a> <a id="2908" href="VerifiedCompilation.UCaseReduce.html#2814" class="Bound">t</a><a id="2909" class="Symbol">)})</a> <a id="2913" href="VerifiedCompilation.UCaseReduce.html#2784" class="Bound">t</a> <a id="2915" href="VerifiedCompilation.UCaseReduce.html#2786" class="Bound">b</a> <a id="2917" href="VerifiedCompilation.UCaseReduce.html#2788" class="Bound">a</a>

<a id="2920" href="VerifiedCompilation.UCaseReduce.html#1996" class="Function">isCaseReduce?</a> <a id="2934" class="Symbol">=</a> <a id="2936" href="VerifiedCompilation.UntypedTranslation.html#4042" class="Function">translation?</a> <a id="2949" href="VerifiedCompilation.Certificate.html#2518" class="InductiveConstructor">caseReduceT</a> <a id="2961" href="VerifiedCompilation.UCaseReduce.html#2192" class="Function">isCR?</a>

<a id="UCaseReduce"></a><a id="2968" href="VerifiedCompilation.UCaseReduce.html#2968" class="Function">UCaseReduce</a> <a id="2980" class="Symbol">=</a> <a id="2982" href="VerifiedCompilation.UntypedTranslation.html#1652" class="Datatype">Translation</a> <a id="2994" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a>

</pre>
<h2 id="an-example">An Example:</h2>

<p>(program 1.1.0
  (case (constr 1 (con integer 12) (con integer 42)) (lam x (lam y x)) (lam x (lam y (case (constr 0 (con integer 99)) y))) )
)</p>

<p>becomes:</p>

<p>(program 1.1.0 [ (con integer 42) (con integer 99) ])</p>

<p>_Compiler version: _</p>
<pre class="Agda">
</pre>
<p>This simple example applies the rule once, and works</p>
<pre class="Agda">
<a id="ast₁"></a><a id="3323" href="VerifiedCompilation.UCaseReduce.html#3323" class="Function">ast₁</a> <a id="3328" class="Symbol">:</a> <a id="3330" class="Number">1</a> <a id="3332" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="3334" href="VerifiedCompilation.UCaseReduce.html#3323" class="Function">ast₁</a> <a id="3339" class="Symbol">=</a> <a id="3341" class="Symbol">(</a><a id="3342" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="3347" class="Symbol">(</a><a id="3348" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="3355" class="Number">0</a> <a id="3357" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3359" class="Symbol">(</a><a id="3360" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3372" class="Number">99</a><a id="3374" class="Symbol">)</a> <a id="3376" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3377" class="Symbol">)</a> <a id="3379" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3381" class="Symbol">(</a><a id="3382" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="3384" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="3388" class="Symbol">)</a> <a id="3390" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3391" class="Symbol">)</a>
<a id="ast₁&#39;"></a><a id="3393" href="VerifiedCompilation.UCaseReduce.html#3393" class="Function">ast₁&#39;</a> <a id="3399" class="Symbol">:</a> <a id="3401" class="Number">1</a> <a id="3403" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="3405" href="VerifiedCompilation.UCaseReduce.html#3393" class="Function">ast₁&#39;</a> <a id="3411" class="Symbol">=</a> <a id="3413" class="Symbol">((</a><a id="3415" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="3417" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="3421" class="Symbol">)</a> <a id="3423" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="3425" class="Symbol">(</a><a id="3426" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3438" class="Number">99</a><a id="3440" class="Symbol">))</a>

<a id="3444" href="VerifiedCompilation.UCaseReduce.html#3444" class="Function">_</a> <a id="3446" class="Symbol">:</a> <a id="3448" href="VerifiedCompilation.UCaseReduce.html#1681" class="Datatype">CaseReduce</a> <a id="3459" href="VerifiedCompilation.UCaseReduce.html#3323" class="Function">ast₁</a> <a id="3464" href="VerifiedCompilation.UCaseReduce.html#3393" class="Function">ast₁&#39;</a>
<a id="3470" class="Symbol">_</a> <a id="3472" class="Symbol">=</a> <a id="3474" href="VerifiedCompilation.UCaseReduce.html#1711" class="InductiveConstructor">casereduce</a> <a id="3485" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3490" href="VerifiedCompilation.UntypedTranslation.html#12253" class="Function">reflexive</a>

</pre>
<p>The longer example definately executes in the compiler, but requires some true β-reduction to make work here.</p>
<pre class="Agda"><a id="ast"></a><a id="3619" href="VerifiedCompilation.UCaseReduce.html#3619" class="Function">ast</a> <a id="3623" class="Symbol">:</a> <a id="3625" class="Number">0</a> <a id="3627" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="3629" href="VerifiedCompilation.UCaseReduce.html#3619" class="Function">ast</a> <a id="3633" class="Symbol">=</a> <a id="3635" class="Symbol">(</a><a id="3636" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="3641" class="Symbol">(</a><a id="3642" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="3649" class="Number">1</a> <a id="3651" class="Symbol">((</a><a id="3653" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3665" class="Number">12</a><a id="3667" class="Symbol">)</a> <a id="3669" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3671" class="Symbol">(</a><a id="3672" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3684" class="Number">42</a><a id="3686" class="Symbol">)</a> <a id="3688" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3690" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3692" class="Symbol">))</a> <a id="3695" class="Symbol">(</a> <a id="3697" class="Symbol">(</a><a id="3698" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="3700" class="Symbol">(</a><a id="3701" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="3703" class="Symbol">(</a><a id="3704" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="3706" class="Symbol">(</a><a id="3707" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a> <a id="3711" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="3715" class="Symbol">))))</a> <a id="3720" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3722" class="Symbol">(</a><a id="3723" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="3725" class="Symbol">(</a><a id="3726" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="3728" class="Symbol">(</a><a id="3729" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="3734" class="Symbol">(</a><a id="3735" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="3742" class="Number">0</a> <a id="3744" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3746" class="Symbol">(</a><a id="3747" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3759" class="Number">99</a><a id="3761" class="Symbol">)</a> <a id="3763" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3764" class="Symbol">)</a> <a id="3766" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3768" class="Symbol">(</a><a id="3769" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="3771" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="3775" class="Symbol">)</a> <a id="3777" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3778" class="Symbol">)))</a> <a id="3782" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3784" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3786" class="Symbol">)</a> <a id="3788" class="Symbol">)</a>

<a id="ast&#39;"></a><a id="3791" href="VerifiedCompilation.UCaseReduce.html#3791" class="Function">ast&#39;</a> <a id="3796" class="Symbol">:</a> <a id="3798" class="Number">0</a> <a id="3800" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="3802" href="VerifiedCompilation.UCaseReduce.html#3791" class="Function">ast&#39;</a> <a id="3807" class="Symbol">=</a> <a id="3809" class="Symbol">((</a><a id="3811" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3823" class="Number">42</a><a id="3825" class="Symbol">)</a> <a id="3827" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="3829" class="Symbol">(</a><a id="3830" href="Untyped.html#7393" class="Function">con-integer</a> <a id="3842" class="Number">99</a><a id="3844" class="Symbol">))</a>

<a id="3848" class="Comment">{-
_ : CaseReduce ast ast&#39;
_ = casereduce refl {!!}
-- This would require unpacking the meaning of the lambdas and applications, not just the AST,
-- so is beyond the scope of this translation relation.
-}</a>

</pre>
<h2 id="semantic-equivalence">Semantic Equivalence</h2>

<pre class="Agda"><a id="4088" class="Keyword">open</a> <a id="4093" class="Keyword">import</a> <a id="4100" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="4112" class="Keyword">using</a> <a id="4118" class="Symbol">(</a><a id="4119" href="Untyped.CEK.html#25240" class="Function">stepper</a><a id="4126" class="Symbol">;</a> <a id="4128" href="Untyped.CEK.html#22845" class="Function">step</a><a id="4132" class="Symbol">)</a>
<a id="4134" class="Keyword">open</a> <a id="4139" class="Keyword">import</a> <a id="4146" href="Builtin.html" class="Module">Builtin</a> <a id="4154" class="Keyword">using</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="4168" class="Symbol">;</a> <a id="4170" href="Builtin.html#1470" class="InductiveConstructor">addInteger</a><a id="4180" class="Symbol">;</a> <a id="4182" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4197" class="Symbol">)</a>

<a id="ex1"></a><a id="4200" href="VerifiedCompilation.UCaseReduce.html#4200" class="Function">ex1</a> <a id="4204" class="Symbol">:</a> <a id="4206" class="Number">0</a> <a id="4208" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="4210" href="VerifiedCompilation.UCaseReduce.html#4200" class="Function">ex1</a> <a id="4214" class="Symbol">=</a> <a id="4216" class="Symbol">(((</a><a id="4219" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="4221" class="Symbol">(</a><a id="4222" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="4224" class="Symbol">(((</a><a id="4227" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="4235" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4250" class="Symbol">)</a> <a id="4252" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4254" class="Symbol">(</a><a id="4255" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="4257" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="4261" class="Symbol">))</a> <a id="4264" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4266" class="Symbol">(</a><a id="4267" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="4269" class="Symbol">(</a><a id="4270" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a> <a id="4274" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="4278" class="Symbol">))))))</a> <a id="4285" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4287" class="Symbol">(</a><a id="4288" href="Untyped.html#7393" class="Function">con-integer</a> <a id="4300" class="Number">2</a><a id="4301" class="Symbol">))</a> <a id="4304" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4306" class="Symbol">(</a><a id="4307" href="Untyped.html#7393" class="Function">con-integer</a> <a id="4319" class="Number">3</a><a id="4320" class="Symbol">)</a> <a id="4322" class="Comment">--- \× . \y . x - y ==&gt;  2 - 3</a>

<a id="ex2"></a><a id="4354" href="VerifiedCompilation.UCaseReduce.html#4354" class="Function">ex2</a> <a id="4358" class="Symbol">:</a> <a id="4360" class="Number">0</a> <a id="4362" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="4364" href="VerifiedCompilation.UCaseReduce.html#4354" class="Function">ex2</a> <a id="4368" class="Symbol">=</a> <a id="4370" class="Symbol">(((</a><a id="4373" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="4375" class="Symbol">(</a><a id="4376" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="4378" class="Symbol">(((</a><a id="4381" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="4389" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4404" class="Symbol">)</a> <a id="4406" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4408" class="Symbol">(</a><a id="4409" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="4411" class="Symbol">(</a><a id="4412" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a> <a id="4416" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="4420" class="Symbol">)))</a> <a id="4424" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4426" class="Symbol">(</a><a id="4427" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="4429" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="4433" class="Symbol">)))))</a> <a id="4439" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Untyped.html#7393" class="Function">con-integer</a> <a id="4454" class="Number">3</a><a id="4455" class="Symbol">))</a> <a id="4458" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4460" class="Symbol">(</a><a id="4461" href="Untyped.html#7393" class="Function">con-integer</a> <a id="4473" class="Number">2</a><a id="4474" class="Symbol">)</a> <a id="4476" class="Comment">--- \x . \y . y - x ==&gt; 2 - 3</a>

</pre>

    </section>
  </body>
</html>
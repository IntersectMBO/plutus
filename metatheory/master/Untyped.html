<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Untyped syntax</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>Untyped syntax</h1>
    <section>
      <pre class="Agda"><a id="49" class="Keyword">module</a> <a id="56" href="Untyped.html" class="Module">Untyped</a> <a id="64" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Utils.html" class="Module">Utils</a> <a id="109" class="Symbol">as</a> <a id="112" class="Module">U</a> <a id="114" class="Keyword">using</a> <a id="120" class="Symbol">(</a><a id="121" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="126" class="Symbol">;</a><a id="127" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="134" class="Symbol">;</a><a id="135" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="139" class="Symbol">;</a><a id="140" href="Utils.html#1654" class="Function">maybeToEither</a><a id="153" class="Symbol">;</a><a id="154" href="Utils.html#1191" class="Datatype">Either</a><a id="160" class="Symbol">;</a><a id="161" href="Utils.html#1224" class="InductiveConstructor">inj₁</a><a id="165" class="Symbol">;</a><a id="166" href="Utils.html#1248" class="InductiveConstructor">inj₂</a><a id="170" class="Symbol">;</a><a id="171" href="Utils.html#3144" class="Record">Monad</a><a id="176" class="Symbol">;</a><a id="177" href="Utils.html#7270" class="Datatype">DATA</a><a id="181" class="Symbol">;</a><a id="182" href="Utils.html#5575" class="Datatype">List</a><a id="186" class="Symbol">;</a><a id="187" href="Utils.html#5604" class="InductiveConstructor">[]</a><a id="189" class="Symbol">;</a><a id="190" href="Utils.html#5619" class="InductiveConstructor Operator">_∷_</a><a id="193" class="Symbol">;</a><a id="194" href="Utils.html#1748" class="Function">natToFin</a><a id="202" class="Symbol">)</a>
<a id="204" class="Keyword">open</a> <a id="209" href="Utils.html#3144" class="Module">Monad</a> <a id="215" class="Symbol"></a>
<a id="223" class="Keyword">import</a> <a id="230" href="Data.List.html" class="Module">Data.List</a> <a id="240" class="Symbol">as</a> <a id="243" class="Module">L</a>

<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Scoped.html" class="Module">Scoped</a> <a id="265" class="Keyword">using</a> <a id="271" class="Symbol">(</a><a id="272" href="Scoped.html#7824" class="Datatype">ScopeError</a><a id="282" class="Symbol">;</a><a id="283" href="Scoped.html#7849" class="InductiveConstructor">deBError</a><a id="291" class="Symbol">)</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Builtin.html" class="Module">Builtin</a> <a id="313" class="Keyword">using</a> <a id="319" class="Symbol">(</a><a id="320" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="327" class="Symbol">;</a><a id="328" href="Builtin.html#24229" class="Postulate">equals</a><a id="334" class="Symbol">;</a><a id="335" href="Builtin.html#34678" class="Function">decBuiltin</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">open</a> <a id="352" href="Builtin.html#1434" class="Module">Builtin.Builtin</a>

<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="401" class="Keyword">using</a> <a id="407" class="Symbol">(</a><a id="408" href="Agda.Builtin.String.html#495" class="Primitive">primStringFromList</a><a id="426" class="Symbol">;</a> <a id="428" href="Agda.Builtin.String.html#537" class="Primitive">primStringAppend</a><a id="444" class="Symbol">;</a> <a id="446" href="Agda.Builtin.String.html#585" class="Primitive">primStringEquality</a><a id="464" class="Symbol">)</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="487" class="Keyword">using</a> <a id="493" class="Symbol">(</a><a id="494" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="495" class="Symbol">;</a><a id="496" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="499" class="Symbol">;</a><a id="500" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="504" class="Symbol">;</a><a id="505" href="Data.Nat.Base.html#1801" class="Function Operator">_&lt;_</a><a id="508" class="Symbol">;</a><a id="509" href="Data.Nat.Properties.html#11421" class="Function Operator">_&lt;?_</a><a id="513" class="Symbol">)</a>
<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="536" class="Keyword">using</a> <a id="542" class="Symbol">(</a><a id="543" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a><a id="546" class="Symbol">;</a><a id="547" href="Data.Fin.Base.html#1202" class="InductiveConstructor">suc</a><a id="550" class="Symbol">;</a><a id="551" href="Data.Fin.Base.html#1181" class="InductiveConstructor">zero</a><a id="555" class="Symbol">;</a><a id="556" href="Data.Fin.Base.html#1267" class="Function">toℕ</a><a id="559" class="Symbol">;</a><a id="560" href="Data.Fin.Base.html#1958" class="Function">fromℕ&lt;</a><a id="566" class="Symbol">)</a>
<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="594" class="Keyword">using</a> <a id="600" class="Symbol">()</a> <a id="603" class="Keyword">renaming</a> <a id="612" class="Symbol">(</a><a id="613" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="618" class="Symbol">to</a> <a id="621" class="Function">showℕ</a><a id="626" class="Symbol">)</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="650" class="Keyword">using</a> <a id="656" class="Symbol">(</a><a id="657" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="661" class="Symbol">;</a><a id="662" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="666" class="Symbol">;</a><a id="667" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="672" class="Symbol">;</a><a id="673" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a><a id="676" class="Symbol">)</a>
<a id="678" class="Keyword">open</a> <a id="683" class="Keyword">import</a> <a id="690" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="703" class="Keyword">using</a> <a id="709" class="Symbol">(</a><a id="710" href="Data.Integer.Base.html#5064" class="Function Operator">_+_</a><a id="713" class="Symbol">;</a><a id="714" href="Data.Integer.Base.html#5245" class="Function Operator">_-_</a><a id="717" class="Symbol">;</a><a id="718" href="Data.Integer.Base.html#1715" class="Function Operator">∣_∣</a><a id="721" class="Symbol">;</a><a id="722" href="Data.Integer.Properties.html#2904" class="Function Operator">_≟_</a><a id="725" class="Symbol">;</a><a id="726" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="727" class="Symbol">)</a> <a id="729" class="Keyword">renaming</a> <a id="738" class="Symbol">(</a><a id="739" href="Data.Integer.Base.html#5391" class="Function Operator">_*_</a> <a id="743" class="Symbol">to</a> <a id="746" class="Function Operator">_**_</a><a id="750" class="Symbol">)</a> <a id="752" class="Comment">-- TODO: remove unnecessary imports</a>
<a id="788" class="Keyword">open</a> <a id="793" class="Keyword">import</a> <a id="800" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="817" class="Keyword">using</a> <a id="823" class="Symbol">(</a><a id="824" href="Relation.Nullary.Decidable.Core.html#1927" class="Field">does</a><a id="828" class="Symbol">;</a><a id="829" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a><a id="832" class="Symbol">;</a><a id="833" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a><a id="835" class="Symbol">)</a>
<a id="837" class="Keyword">open</a> <a id="842" class="Keyword">import</a> <a id="849" href="Data.Integer.Show.html" class="Module">Data.Integer.Show</a> <a id="867" class="Keyword">using</a> <a id="873" class="Symbol">(</a><a id="874" href="Data.Integer.Show.html#615" class="Function">show</a><a id="878" class="Symbol">)</a>
<a id="880" class="Keyword">open</a> <a id="885" class="Keyword">import</a> <a id="892" href="Data.String.html" class="Module">Data.String</a> <a id="904" class="Keyword">using</a> <a id="910" class="Symbol">(</a><a id="911" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="917" class="Symbol">;</a><a id="918" href="Data.String.Base.html#2425" class="Function Operator">_++_</a><a id="922" class="Symbol">)</a>
<a id="924" class="Keyword">open</a> <a id="929" class="Keyword">import</a> <a id="936" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="947" class="Keyword">using</a> <a id="953" class="Symbol">(</a><a id="954" href="Data.Empty.html#914" class="Function">⊥</a><a id="955" class="Symbol">)</a>
<a id="957" class="Keyword">open</a> <a id="962" class="Keyword">import</a> <a id="969" href="Utils.html" class="Module">Utils</a> <a id="975" class="Keyword">using</a> <a id="981" class="Symbol">(</a><a id="982" href="Utils.html#5337" class="Record Operator">_×_</a><a id="985" class="Symbol">;</a><a id="986" href="Utils.html#4283" class="InductiveConstructor Operator">_,_</a><a id="989" class="Symbol">)</a>
<a id="991" class="Keyword">open</a> <a id="996" class="Keyword">import</a> <a id="1003" href="RawU.html" class="Module">RawU</a> <a id="1008" class="Keyword">using</a> <a id="1014" class="Symbol">(</a><a id="1015" href="RawU.html#6247" class="Datatype">TagCon</a><a id="1021" class="Symbol">;</a><a id="1022" href="RawU.html#2405" class="Datatype">Tag</a><a id="1025" class="Symbol">;</a><a id="1026" href="RawU.html#7771" class="Function">decTagCon</a><a id="1035" class="Symbol">;</a><a id="1036" href="RawU.html#8012" class="Datatype">TmCon</a><a id="1041" class="Symbol">;</a><a id="1042" href="RawU.html#5118" class="Function">TyTag</a><a id="1047" class="Symbol">;</a><a id="1048" href="RawU.html#8077" class="Datatype">Untyped</a><a id="1055" class="Symbol">;</a><a id="1056" href="RawU.html#8032" class="InductiveConstructor">tmCon</a><a id="1061" class="Symbol">;</a><a id="1062" href="RawU.html#12107" class="Function">tmCon2TagCon</a><a id="1074" class="Symbol">;</a><a id="1075" href="RawU.html#9800" class="Function">tagCon2TmCon</a><a id="1087" class="Symbol">;</a><a id="1088" href="RawU.html#5208" class="Function Operator">⟦_⟧tag</a><a id="1094" class="Symbol">)</a>
<a id="1096" class="Keyword">open</a> <a id="1101" class="Keyword">import</a> <a id="1108" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="1126" class="Keyword">using</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Builtin.Signature.html#1821" class="Datatype Operator">_⊢♯</a><a id="1136" class="Symbol">;</a><a id="1137" href="Builtin.Signature.html#2574" class="InductiveConstructor">integer</a><a id="1144" class="Symbol">;</a><a id="1145" href="Builtin.Signature.html#2761" class="InductiveConstructor">bool</a><a id="1149" class="Symbol">;</a><a id="1150" href="Builtin.Signature.html#2671" class="InductiveConstructor">string</a><a id="1156" class="Symbol">;</a><a id="1157" href="Builtin.Signature.html#2805" class="InductiveConstructor">pdata</a><a id="1162" class="Symbol">;</a><a id="1163" href="Builtin.Signature.html#2621" class="InductiveConstructor">bytestring</a><a id="1173" class="Symbol">;</a><a id="1174" href="Builtin.Signature.html#2717" class="InductiveConstructor">unit</a><a id="1178" class="Symbol">;</a><a id="1179" href="Builtin.Signature.html#2849" class="InductiveConstructor">bls12-381-g1-element</a><a id="1199" class="Symbol">;</a><a id="1200" href="Builtin.Signature.html#2909" class="InductiveConstructor">bls12-381-g2-element</a><a id="1220" class="Symbol">;</a><a id="1221" href="Builtin.Signature.html#2969" class="InductiveConstructor">bls12-381-mlresult</a><a id="1239" class="Symbol">)</a>
<a id="1241" class="Keyword">open</a> <a id="1246" href="Builtin.Signature.html#1821" class="Module Operator">_⊢♯</a>
<a id="1250" class="Keyword">open</a> <a id="1255" class="Keyword">import</a> <a id="1262" href="Builtin.Constant.AtomicType.html" class="Module">Builtin.Constant.AtomicType</a> <a id="1290" class="Keyword">using</a> <a id="1296" class="Symbol">(</a><a id="1297" href="Builtin.Constant.AtomicType.html#570" class="Datatype">AtomicTyCon</a><a id="1308" class="Symbol">)</a>
<a id="1310" class="Keyword">open</a> <a id="1315" href="Builtin.Constant.AtomicType.html#570" class="Module">AtomicTyCon</a>

<a id="1328" class="Keyword">open</a> <a id="1333" class="Keyword">import</a> <a id="1340" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="1362" class="Keyword">open</a> <a id="1367" href="RawU.html#8077" class="Module">Untyped</a>
</pre>
<h2 id="well-scoped-syntax">Well-scoped Syntax</h2>

<p>This defines the syntax for UPLC and requires that it be “well scoped”, which
is that only variables in the context are used. The context uses de Bruijn naming,
so the variables are numbered.</p>

<pre class="Agda"><a id="1600" class="Keyword">data</a> <a id="_⊢"></a><a id="1605" href="Untyped.html#1605" class="Datatype Operator">_⊢</a> <a id="1608" class="Symbol">(</a><a id="1609" href="Untyped.html#1609" class="Bound">n</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1614" class="Symbol">)</a> <a id="1616" class="Symbol">:</a> <a id="1618" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1622" class="Keyword">where</a>
  <a id="_⊢.`"></a><a id="1630" href="Untyped.html#1630" class="InductiveConstructor">`</a>   <a id="1634" class="Symbol">:</a> <a id="1636" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1640" href="Untyped.html#1609" class="Bound">n</a> <a id="1642" class="Symbol">→</a> <a id="1644" href="Untyped.html#1609" class="Bound">n</a> <a id="1646" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.ƛ"></a><a id="1650" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a>   <a id="1654" class="Symbol">:</a> <a id="1656" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1660" href="Untyped.html#1609" class="Bound">n</a> <a id="1662" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="1664" class="Symbol">→</a> <a id="1666" href="Untyped.html#1609" class="Bound">n</a> <a id="1668" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢._·_"></a><a id="1672" href="Untyped.html#1672" class="InductiveConstructor Operator">_·_</a> <a id="1676" class="Symbol">:</a> <a id="1678" href="Untyped.html#1609" class="Bound">n</a> <a id="1680" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="1682" class="Symbol">→</a> <a id="1684" href="Untyped.html#1609" class="Bound">n</a> <a id="1686" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Untyped.html#1609" class="Bound">n</a> <a id="1692" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.force"></a><a id="1696" href="Untyped.html#1696" class="InductiveConstructor">force</a> <a id="1702" class="Symbol">:</a> <a id="1704" href="Untyped.html#1609" class="Bound">n</a> <a id="1706" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="1708" class="Symbol">→</a> <a id="1710" href="Untyped.html#1609" class="Bound">n</a> <a id="1712" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.delay"></a><a id="1716" href="Untyped.html#1716" class="InductiveConstructor">delay</a> <a id="1722" class="Symbol">:</a> <a id="1724" href="Untyped.html#1609" class="Bound">n</a> <a id="1726" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Untyped.html#1609" class="Bound">n</a> <a id="1732" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.con"></a><a id="1736" href="Untyped.html#1736" class="InductiveConstructor">con</a> <a id="1740" class="Symbol">:</a> <a id="1742" href="RawU.html#8012" class="Datatype">TmCon</a> <a id="1748" class="Symbol">→</a> <a id="1750" href="Untyped.html#1609" class="Bound">n</a> <a id="1752" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.constr"></a><a id="1756" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="1763" class="Symbol">:</a> <a id="1765" class="Symbol">(</a><a id="1766" href="Untyped.html#1766" class="Bound">i</a> <a id="1768" class="Symbol">:</a> <a id="1770" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1771" class="Symbol">)</a> <a id="1773" class="Symbol">→</a> <a id="1775" class="Symbol">(</a><a id="1776" href="Untyped.html#1776" class="Bound">xs</a> <a id="1779" class="Symbol">:</a> <a id="1781" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Untyped.html#1609" class="Bound">n</a> <a id="1791" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1792" class="Symbol">))</a> <a id="1795" class="Symbol">→</a> <a id="1797" href="Untyped.html#1609" class="Bound">n</a> <a id="1799" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.case"></a><a id="1803" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="1808" class="Symbol">:</a>  <a id="1811" class="Symbol">(</a><a id="1812" href="Untyped.html#1812" class="Bound">t</a> <a id="1814" class="Symbol">:</a> <a id="1816" href="Untyped.html#1609" class="Bound">n</a> <a id="1818" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1819" class="Symbol">)</a> <a id="1821" class="Symbol">→</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Untyped.html#1824" class="Bound">ts</a> <a id="1827" class="Symbol">:</a> <a id="1829" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="1836" class="Symbol">(</a><a id="1837" href="Untyped.html#1609" class="Bound">n</a> <a id="1839" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="1840" class="Symbol">))</a> <a id="1843" class="Symbol">→</a> <a id="1845" href="Untyped.html#1609" class="Bound">n</a> <a id="1847" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.builtin"></a><a id="1851" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="1859" class="Symbol">:</a> <a id="1861" class="Symbol">(</a><a id="1862" href="Untyped.html#1862" class="Bound">b</a> <a id="1864" class="Symbol">:</a> <a id="1866" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="1873" class="Symbol">)</a> <a id="1875" class="Symbol">→</a> <a id="1877" href="Untyped.html#1609" class="Bound">n</a> <a id="1879" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
  <a id="_⊢.error"></a><a id="1883" href="Untyped.html#1883" class="InductiveConstructor">error</a> <a id="1889" class="Symbol">:</a> <a id="1891" href="Untyped.html#1609" class="Bound">n</a> <a id="1893" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
</pre>
<pre class="Agda"><a id="1904" class="Keyword">variable</a>
  <a id="1915" href="Untyped.html#1915" class="Generalizable">t</a> <a id="1917" href="Untyped.html#1917" class="Generalizable">t&#39;</a> <a id="1920" href="Untyped.html#1920" class="Generalizable">u</a> <a id="1922" href="Untyped.html#1922" class="Generalizable">u&#39;</a> <a id="1925" class="Symbol">:</a> <a id="1927" class="Symbol">∀{</a><a id="1929" href="Untyped.html#1929" class="Bound">X</a><a id="1930" class="Symbol">}</a> <a id="1932" class="Symbol">→</a> <a id="1934" href="Untyped.html#1929" class="Bound">X</a> <a id="1936" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
</pre>
<h2 id="debug-printing">Debug printing</h2>

<pre class="Agda"><a id="uglyDATA"></a><a id="1966" href="Untyped.html#1966" class="Function">uglyDATA</a> <a id="1975" class="Symbol">:</a> <a id="1977" href="Utils.html#7270" class="Datatype">DATA</a> <a id="1982" class="Symbol">→</a> <a id="1984" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1991" href="Untyped.html#1966" class="Function">uglyDATA</a> <a id="2000" href="Untyped.html#2000" class="Bound">d</a> <a id="2002" class="Symbol">=</a> <a id="2004" class="String">&quot;(DATA)&quot;</a>

<a id="uglyTmCon"></a><a id="2014" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2024" class="Symbol">:</a> <a id="2026" href="RawU.html#8012" class="Datatype">TmCon</a> <a id="2032" class="Symbol">→</a> <a id="2034" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="2042" class="Symbol">{-#</a> <a id="2046" class="Keyword">TERMINATING</a> <a id="2058" class="Symbol">#-}</a>
<a id="uglyTmConList"></a><a id="2062" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="2076" class="Symbol">:</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Untyped.html#2079" class="Bound">t</a> <a id="2081" class="Symbol">:</a> <a id="2083" href="RawU.html#5118" class="Function">TyTag</a><a id="2088" class="Symbol">)</a> <a id="2090" class="Symbol">→</a> <a id="2092" href="RawU.html#5208" class="Function Operator">⟦</a> <a id="2094" class="InductiveConstructor">list</a> <a id="2099" href="Untyped.html#2079" class="Bound">t</a> <a id="2101" href="RawU.html#5208" class="Function Operator">⟧tag</a> <a id="2106" class="Symbol">→</a> <a id="2108" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="2115" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="2129" href="Untyped.html#2129" class="Bound">t</a> <a id="2131" href="Utils.html#5604" class="InductiveConstructor">[]</a> <a id="2134" class="Symbol">=</a> <a id="2136" class="String">&quot;&quot;</a>
<a id="2139" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="2153" href="Untyped.html#2153" class="Bound">t</a> <a id="2155" class="Symbol">(</a><a id="2156" href="Untyped.html#2156" class="Bound">x</a> <a id="2158" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="2160" href="Utils.html#5604" class="InductiveConstructor">[]</a><a id="2162" class="Symbol">)</a> <a id="2164" class="Symbol">=</a> <a id="2166" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2176" class="Symbol">(</a><a id="2177" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2183" href="Untyped.html#2153" class="Bound">t</a> <a id="2185" href="Untyped.html#2156" class="Bound">x</a><a id="2186" class="Symbol">)</a>
<a id="2188" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="2202" href="Untyped.html#2202" class="Bound">t</a> <a id="2204" class="Symbol">(</a><a id="2205" href="Untyped.html#2205" class="Bound">x</a> <a id="2207" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="2209" href="Untyped.html#2209" class="Bound">l</a> <a id="2211" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="2213" href="Untyped.html#2213" class="Bound">ls</a><a id="2215" class="Symbol">)</a> <a id="2217" class="Symbol">=</a> <a id="2219" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2229" class="Symbol">(</a><a id="2230" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2236" href="Untyped.html#2202" class="Bound">t</a> <a id="2238" href="Untyped.html#2205" class="Bound">x</a><a id="2239" class="Symbol">)</a> <a id="2241" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2244" class="String">&quot; , &quot;</a> <a id="2250" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2253" class="Symbol">(</a><a id="2254" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="2268" href="Untyped.html#2202" class="Bound">t</a> <a id="2270" class="Symbol">(</a><a id="2271" href="Untyped.html#2209" class="Bound">l</a> <a id="2273" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="2275" href="Untyped.html#2213" class="Bound">ls</a><a id="2277" class="Symbol">))</a>

<a id="2281" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2291" class="Symbol">(</a><a id="2292" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2298" href="Builtin.Signature.html#2574" class="InductiveConstructor">integer</a> <a id="2306" href="Untyped.html#2306" class="Bound">x</a><a id="2307" class="Symbol">)</a>              <a id="2322" class="Symbol">=</a> <a id="2324" class="String">&quot;(integer &quot;</a> <a id="2336" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2339" href="Data.Integer.Show.html#615" class="Function">show</a> <a id="2344" href="Untyped.html#2306" class="Bound">x</a> <a id="2346" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2349" class="String">&quot;)&quot;</a>
<a id="2353" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2363" class="Symbol">(</a><a id="2364" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2370" href="Builtin.Signature.html#2621" class="InductiveConstructor">bytestring</a> <a id="2381" href="Untyped.html#2381" class="Bound">x</a><a id="2382" class="Symbol">)</a>           <a id="2394" class="Symbol">=</a> <a id="2396" class="String">&quot;bytestring&quot;</a>
<a id="2409" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2419" class="Symbol">(</a><a id="2420" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2426" href="Builtin.Signature.html#2717" class="InductiveConstructor">unit</a> <a id="2431" class="Symbol">_)</a>                 <a id="2450" class="Symbol">=</a> <a id="2452" class="String">&quot;()&quot;</a>
<a id="2457" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2467" class="Symbol">(</a><a id="2468" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2474" href="Builtin.Signature.html#2671" class="InductiveConstructor">string</a> <a id="2481" href="Untyped.html#2481" class="Bound">s</a><a id="2482" class="Symbol">)</a>               <a id="2498" class="Symbol">=</a> <a id="2500" class="String">&quot;(string &quot;</a> <a id="2511" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2514" href="Untyped.html#2481" class="Bound">s</a> <a id="2516" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="2519" class="String">&quot;)&quot;</a>
<a id="2523" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2533" class="Symbol">(</a><a id="2534" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2540" href="Builtin.Signature.html#2761" class="InductiveConstructor">bool</a> <a id="2545" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="2550" class="Symbol">)</a>             <a id="2564" class="Symbol">=</a> <a id="2566" class="String">&quot;(bool false)&quot;</a>
<a id="2581" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2591" class="Symbol">(</a><a id="2592" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2598" href="Builtin.Signature.html#2761" class="InductiveConstructor">bool</a> <a id="2603" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2607" class="Symbol">)</a>              <a id="2622" class="Symbol">=</a> <a id="2624" class="String">&quot;(bool true)&quot;</a>
<a id="2638" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2648" class="Symbol">(</a><a id="2649" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2655" href="Builtin.Signature.html#2805" class="InductiveConstructor">pdata</a> <a id="2661" href="Untyped.html#2661" class="Bound">d</a><a id="2662" class="Symbol">)</a>                <a id="2679" class="Symbol">=</a> <a id="2681" href="Untyped.html#1966" class="Function">uglyDATA</a> <a id="2690" href="Untyped.html#2661" class="Bound">d</a>
<a id="2692" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2702" class="Symbol">(</a><a id="2703" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2709" href="Builtin.Signature.html#2849" class="InductiveConstructor">bls12-381-g1-element</a> <a id="2730" href="Untyped.html#2730" class="Bound">e</a><a id="2731" class="Symbol">)</a> <a id="2733" class="Symbol">=</a> <a id="2735" class="String">&quot;(bls12-381-g1-element ???)&quot;</a>  <a id="2765" class="Comment">-- FIXME</a>
<a id="2774" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2784" class="Symbol">(</a><a id="2785" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2791" href="Builtin.Signature.html#2909" class="InductiveConstructor">bls12-381-g2-element</a> <a id="2812" href="Untyped.html#2812" class="Bound">e</a><a id="2813" class="Symbol">)</a> <a id="2815" class="Symbol">=</a> <a id="2817" class="String">&quot;(bls12-381-g2-element ???)&quot;</a>  <a id="2847" class="Comment">-- FIXME</a>
<a id="2856" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2866" class="Symbol">(</a><a id="2867" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2873" href="Builtin.Signature.html#2969" class="InductiveConstructor">bls12-381-mlresult</a> <a id="2892" href="Untyped.html#2892" class="Bound">r</a><a id="2893" class="Symbol">)</a>   <a id="2897" class="Symbol">=</a> <a id="2899" class="String">&quot;(bls12-381-mlresult ???)&quot;</a>      <a id="2931" class="Comment">-- FIXME</a>
<a id="2940" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="2950" class="Symbol">(</a><a id="2951" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="2957" class="Symbol">(</a><a id="2958" href="Builtin.Signature.html#2130" class="InductiveConstructor">array</a> <a id="2964" href="Untyped.html#2964" class="Bound">t</a><a id="2965" class="Symbol">)</a> <a id="2967" href="Untyped.html#2967" class="Bound">xs</a><a id="2969" class="Symbol">)</a>            <a id="2982" class="Symbol">=</a> <a id="2984" class="String">&quot;(array [ something ])&quot;</a> <a id="3008" class="Comment">-- FIXME: https://github.com/IntersectMBO/plutus-private/issues/1603</a>
<a id="3077" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="3087" class="Symbol">(</a><a id="3088" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="3094" class="Symbol">(</a><a id="3095" href="Builtin.Signature.html#2070" class="InductiveConstructor">list</a> <a id="3100" href="Untyped.html#3100" class="Bound">t</a><a id="3101" class="Symbol">)</a> <a id="3103" href="Untyped.html#3103" class="Bound">xs</a><a id="3105" class="Symbol">)</a>            <a id="3118" class="Symbol">=</a> <a id="3120" class="String">&quot;(list [ &quot;</a> <a id="3131" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3134" class="Symbol">(</a><a id="3135" href="Untyped.html#2062" class="Function">uglyTmConList</a> <a id="3149" href="Untyped.html#3100" class="Bound">t</a> <a id="3151" href="Untyped.html#3103" class="Bound">xs</a><a id="3153" class="Symbol">)</a> <a id="3155" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3158" class="String">&quot; ])&quot;</a>
<a id="3164" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="3174" class="Symbol">(</a><a id="3175" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="3181" class="Symbol">(</a><a id="3182" href="Builtin.Signature.html#2191" class="InductiveConstructor">pair</a> <a id="3187" href="Untyped.html#3187" class="Bound">t</a> <a id="3189" href="Untyped.html#3189" class="Bound">u</a><a id="3190" class="Symbol">)</a> <a id="3192" class="Symbol">(</a><a id="3193" href="Untyped.html#3193" class="Bound">x</a> <a id="3195" href="Utils.html#5381" class="InductiveConstructor Operator">,</a> <a id="3197" href="Untyped.html#3197" class="Bound">y</a><a id="3198" class="Symbol">))</a>     <a id="3205" class="Symbol">=</a> <a id="3207" class="String">&quot;(pair (&quot;</a> <a id="3217" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3220" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="3230" class="Symbol">(</a><a id="3231" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="3237" href="Untyped.html#3187" class="Bound">t</a> <a id="3239" href="Untyped.html#3193" class="Bound">x</a><a id="3240" class="Symbol">)</a> <a id="3242" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3245" class="String">&quot; , &quot;</a> <a id="3251" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3254" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="3264" class="Symbol">(</a><a id="3265" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="3271" href="Untyped.html#3189" class="Bound">u</a> <a id="3273" href="Untyped.html#3197" class="Bound">y</a><a id="3274" class="Symbol">)</a> <a id="3276" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3279" class="String">&quot;) )&quot;</a>

<a id="3286" class="Symbol">{-#</a> <a id="3290" class="Keyword">FOREIGN</a> <a id="3298" class="Pragma">GHC</a> <a id="3302" class="Pragma">import</a> <a id="3309" class="Pragma">qualified</a> <a id="3319" class="Pragma">Data.Text</a> <a id="3329" class="Pragma">as</a> <a id="3332" class="Pragma">T</a> <a id="3334" class="Symbol">#-}</a>

<a id="3339" class="Keyword">postulate</a> <a id="showNat"></a><a id="3349" href="Untyped.html#3349" class="Postulate">showNat</a> <a id="3357" class="Symbol">:</a> <a id="3359" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3361" class="Symbol">→</a> <a id="3363" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="3371" class="Symbol">{-#</a> <a id="3375" class="Keyword">FOREIGN</a> <a id="3383" class="Pragma">GHC</a> <a id="3387" class="Pragma">import</a> <a id="3394" class="Pragma">qualified</a> <a id="3404" class="Pragma">Data.Text</a> <a id="3414" class="Pragma">as</a> <a id="3417" class="Pragma">T</a> <a id="3419" class="Symbol">#-}</a>
<a id="3423" class="Symbol">{-#</a> <a id="3427" class="Keyword">COMPILE</a> <a id="3435" class="Keyword">GHC</a> <a id="3439" href="Untyped.html#3349" class="Postulate">showNat</a> <a id="3447" class="Pragma">=</a> <a id="3449" class="Pragma">T.pack</a> <a id="3456" class="Pragma">.</a> <a id="3458" class="Pragma">show</a> <a id="3463" class="Symbol">#-}</a>

<a id="uglyBuiltin"></a><a id="3468" href="Untyped.html#3468" class="Function">uglyBuiltin</a> <a id="3480" class="Symbol">:</a> <a id="3482" href="Builtin.html#1434" class="Datatype">Builtin</a> <a id="3490" class="Symbol">→</a> <a id="3492" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="3499" href="Untyped.html#3468" class="Function">uglyBuiltin</a> <a id="3511" href="Builtin.html#1470" class="InductiveConstructor">addInteger</a> <a id="3522" class="Symbol">=</a> <a id="3524" class="String">&quot;addInteger&quot;</a>
<a id="3537" href="Untyped.html#3468" class="CatchallClause Function">uglyBuiltin</a><a id="3548" class="CatchallClause"> </a><a id="3549" class="CatchallClause Symbol">_</a> <a id="3551" class="Symbol">=</a> <a id="3553" class="String">&quot;other&quot;</a>
<a id="3561" class="Comment">-- FIXME: This is boring but we should fill it in</a>
<a id="3611" class="Comment">-- if we are going to start using this</a>
<a id="3650" class="Comment">-- https://github.com/IntersectMBO/plutus-private/issues/1621</a>

<a id="uglyList"></a><a id="3713" href="Untyped.html#3713" class="Function">uglyList</a> <a id="3722" class="Symbol">:</a> <a id="3724" class="Symbol">∀{</a><a id="3726" href="Untyped.html#3726" class="Bound">X</a><a id="3727" class="Symbol">}</a> <a id="3729" class="Symbol">→</a> <a id="3731" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="3738" class="Symbol">(</a><a id="3739" href="Untyped.html#3726" class="Bound">X</a> <a id="3741" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="3742" class="Symbol">)</a> <a id="3744" class="Symbol">→</a> <a id="3746" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="uglyList&#39;"></a><a id="3753" href="Untyped.html#3753" class="Function">uglyList&#39;</a> <a id="3763" class="Symbol">:</a> <a id="3765" class="Symbol">∀{</a><a id="3767" href="Untyped.html#3767" class="Bound">X</a><a id="3768" class="Symbol">}</a> <a id="3770" class="Symbol">→</a> <a id="3772" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="3779" class="Symbol">(</a><a id="3780" href="Untyped.html#3767" class="Bound">X</a> <a id="3782" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="3783" class="Symbol">)</a> <a id="3785" class="Symbol">→</a> <a id="3787" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="ugly"></a><a id="3794" href="Untyped.html#3794" class="Function">ugly</a> <a id="3799" class="Symbol">:</a> <a id="3801" class="Symbol">∀{</a><a id="3803" href="Untyped.html#3803" class="Bound">X</a><a id="3804" class="Symbol">}</a> <a id="3806" class="Symbol">→</a> <a id="3808" href="Untyped.html#3803" class="Bound">X</a> <a id="3810" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="3812" class="Symbol">→</a> <a id="3814" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="3821" href="Untyped.html#3794" class="Function">ugly</a> <a id="3826" class="Symbol">(</a><a id="3827" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="3829" href="Untyped.html#3829" class="Bound">x</a><a id="3830" class="Symbol">)</a> <a id="3832" class="Symbol">=</a> <a id="3834" class="String">&quot;(` var )&quot;</a>
<a id="3845" href="Untyped.html#3794" class="Function">ugly</a> <a id="3850" class="Symbol">(</a><a id="3851" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="3853" href="Untyped.html#3853" class="Bound">t</a><a id="3854" class="Symbol">)</a> <a id="3856" class="Symbol">=</a> <a id="3858" class="String">&quot;(ƛ &quot;</a> <a id="3864" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3867" href="Untyped.html#3794" class="Function">ugly</a> <a id="3872" href="Untyped.html#3853" class="Bound">t</a> <a id="3874" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3877" class="String">&quot;)&quot;</a>
<a id="3881" href="Untyped.html#3794" class="Function">ugly</a> <a id="3886" class="Symbol">(</a><a id="3887" href="Untyped.html#3887" class="Bound">t</a> <a id="3889" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="3891" href="Untyped.html#3891" class="Bound">u</a><a id="3892" class="Symbol">)</a> <a id="3894" class="Symbol">=</a> <a id="3896" class="String">&quot;( &quot;</a> <a id="3901" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3904" href="Untyped.html#3794" class="Function">ugly</a> <a id="3909" href="Untyped.html#3887" class="Bound">t</a> <a id="3911" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3914" class="String">&quot; · &quot;</a> <a id="3920" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3923" href="Untyped.html#3794" class="Function">ugly</a> <a id="3928" href="Untyped.html#3891" class="Bound">u</a> <a id="3930" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3933" class="String">&quot;)&quot;</a>
<a id="3937" href="Untyped.html#3794" class="Function">ugly</a> <a id="3942" class="Symbol">(</a><a id="3943" href="Untyped.html#1736" class="InductiveConstructor">con</a> <a id="3947" href="Untyped.html#3947" class="Bound">c</a><a id="3948" class="Symbol">)</a> <a id="3950" class="Symbol">=</a> <a id="3952" class="String">&quot;(con &quot;</a> <a id="3960" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3963" href="Untyped.html#2014" class="Function">uglyTmCon</a> <a id="3973" href="Untyped.html#3947" class="Bound">c</a> <a id="3975" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="3978" class="String">&quot;)&quot;</a>
<a id="3982" href="Untyped.html#3794" class="Function">ugly</a> <a id="3987" class="Symbol">(</a><a id="3988" href="Untyped.html#1696" class="InductiveConstructor">force</a> <a id="3994" href="Untyped.html#3994" class="Bound">t</a><a id="3995" class="Symbol">)</a> <a id="3997" class="Symbol">=</a> <a id="3999" class="String">&quot;(force &quot;</a> <a id="4009" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4012" href="Untyped.html#3794" class="Function">ugly</a> <a id="4017" href="Untyped.html#3994" class="Bound">t</a> <a id="4019" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4022" class="String">&quot;)&quot;</a>
<a id="4026" href="Untyped.html#3794" class="Function">ugly</a> <a id="4031" class="Symbol">(</a><a id="4032" href="Untyped.html#1716" class="InductiveConstructor">delay</a> <a id="4038" href="Untyped.html#4038" class="Bound">t</a><a id="4039" class="Symbol">)</a> <a id="4041" class="Symbol">=</a> <a id="4043" class="String">&quot;(delay &quot;</a> <a id="4053" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4056" href="Untyped.html#3794" class="Function">ugly</a> <a id="4061" href="Untyped.html#4038" class="Bound">t</a> <a id="4063" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4066" class="String">&quot;)&quot;</a>
<a id="4070" href="Untyped.html#3794" class="Function">ugly</a> <a id="4075" class="Symbol">(</a><a id="4076" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="4084" href="Untyped.html#4084" class="Bound">b</a><a id="4085" class="Symbol">)</a> <a id="4087" class="Symbol">=</a> <a id="4089" class="String">&quot;(builtin &quot;</a> <a id="4101" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4104" href="Untyped.html#3468" class="Function">uglyBuiltin</a> <a id="4116" href="Untyped.html#4084" class="Bound">b</a> <a id="4118" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4121" class="String">&quot;)&quot;</a>
<a id="4125" href="Untyped.html#3794" class="Function">ugly</a> <a id="4130" class="Symbol">(</a><a id="4131" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="4138" href="Untyped.html#4138" class="Bound">i</a> <a id="4140" href="Untyped.html#4140" class="Bound">xs</a><a id="4142" class="Symbol">)</a> <a id="4144" class="Symbol">=</a> <a id="4146" class="String">&quot;(constr &quot;</a> <a id="4157" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4160" href="Untyped.html#621" class="Function">showℕ</a> <a id="4166" href="Untyped.html#4138" class="Bound">i</a> <a id="4168" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4171" href="Untyped.html#3713" class="Function">uglyList</a> <a id="4180" href="Untyped.html#4140" class="Bound">xs</a> <a id="4183" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4186" class="String">&quot;)&quot;</a>
<a id="4190" href="Untyped.html#3794" class="Function">ugly</a> <a id="4195" class="Symbol">(</a><a id="4196" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="4201" href="Untyped.html#4201" class="Bound">x</a> <a id="4203" href="Untyped.html#4203" class="Bound">ts</a><a id="4205" class="Symbol">)</a> <a id="4207" class="Symbol">=</a> <a id="4209" class="String">&quot;(case &quot;</a> <a id="4218" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4221" href="Untyped.html#3794" class="Function">ugly</a> <a id="4226" href="Untyped.html#4201" class="Bound">x</a> <a id="4228" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4231" class="String">&quot; &quot;</a> <a id="4235" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4238" href="Untyped.html#3713" class="Function">uglyList</a> <a id="4247" href="Untyped.html#4203" class="Bound">ts</a> <a id="4250" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4253" class="String">&quot;)&quot;</a>
<a id="4257" href="Untyped.html#3794" class="Function">ugly</a> <a id="4262" href="Untyped.html#1883" class="InductiveConstructor">error</a> <a id="4268" class="Symbol">=</a> <a id="4270" class="String">&quot;error&quot;</a>

<a id="4279" href="Untyped.html#3753" class="Function">uglyList&#39;</a> <a id="4289" href="Agda.Builtin.List.html#184" class="InductiveConstructor">L.[]</a> <a id="4294" class="Symbol">=</a> <a id="4296" class="String">&quot;&quot;</a>
<a id="4299" href="Untyped.html#3753" class="Function">uglyList&#39;</a> <a id="4309" class="Symbol">(</a><a id="4310" href="Untyped.html#4310" class="Bound">x</a> <a id="4312" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">L.∷</a> <a id="4316" href="Untyped.html#4316" class="Bound">xs</a><a id="4318" class="Symbol">)</a> <a id="4320" class="Symbol">=</a> <a id="4322" href="Untyped.html#3794" class="Function">ugly</a> <a id="4327" href="Untyped.html#4310" class="Bound">x</a> <a id="4329" href="Data.String.Base.html#2425" class="Function Operator">++</a><a id="4331" class="String">&quot; , &quot;</a><a id="4336" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4339" href="Untyped.html#3753" class="Function">uglyList&#39;</a> <a id="4349" href="Untyped.html#4316" class="Bound">xs</a>

<a id="4353" href="Untyped.html#3713" class="Function">uglyList</a> <a id="4362" href="Untyped.html#4362" class="Bound">xs</a> <a id="4365" class="Symbol">=</a> <a id="4367" class="String">&quot;[&quot;</a> <a id="4371" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4374" href="Untyped.html#3753" class="Function">uglyList&#39;</a> <a id="4384" href="Untyped.html#4362" class="Bound">xs</a> <a id="4387" href="Data.String.Base.html#2425" class="Function Operator">++</a> <a id="4390" class="String">&quot;]&quot;</a>
</pre>
<h2 id="scope-checking-and-scope-extrication">Scope checking and scope extrication</h2>

<pre class="Agda"><a id="extG"></a><a id="4444" href="Untyped.html#4444" class="Function">extG</a> <a id="4449" class="Symbol">:</a> <a id="4451" class="Symbol">{</a><a id="4452" href="Untyped.html#4452" class="Bound">X</a> <a id="4454" class="Symbol">:</a> <a id="4456" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4459" class="Symbol">}</a> <a id="4461" class="Symbol">→</a> <a id="4463" class="Symbol">(</a><a id="4464" href="Untyped.html#4452" class="Bound">X</a> <a id="4466" class="Symbol">→</a> <a id="4468" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4469" class="Symbol">)</a> <a id="4471" class="Symbol">→</a> <a id="4473" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4479" href="Untyped.html#4452" class="Bound">X</a> <a id="4481" class="Symbol">→</a> <a id="4483" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="4485" href="Untyped.html#4444" class="Function">extG</a> <a id="4490" href="Untyped.html#4490" class="Bound">g</a> <a id="4492" class="Symbol">(</a><a id="4493" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4498" href="Untyped.html#4498" class="Bound">x</a><a id="4499" class="Symbol">)</a> <a id="4501" class="Symbol">=</a> <a id="4503" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4507" class="Symbol">(</a><a id="4508" href="Untyped.html#4490" class="Bound">g</a> <a id="4510" href="Untyped.html#4498" class="Bound">x</a><a id="4511" class="Symbol">)</a>
<a id="4513" href="Untyped.html#4444" class="Function">extG</a> <a id="4518" href="Untyped.html#4518" class="Bound">g</a> <a id="4520" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="4529" class="Symbol">=</a> <a id="4531" class="Number">0</a>

<a id="extricateUList"></a><a id="4534" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="4549" class="Symbol">:</a> <a id="4551" class="Symbol">{</a><a id="4552" href="Untyped.html#4552" class="Bound">n</a> <a id="4554" class="Symbol">:</a> <a id="4556" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4557" class="Symbol">}</a> <a id="4559" class="Symbol">→</a> <a id="4561" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="4568" class="Symbol">(</a><a id="4569" href="Untyped.html#4552" class="Bound">n</a> <a id="4571" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="4572" class="Symbol">)</a> <a id="4574" class="Symbol">→</a> <a id="4576" href="Utils.html#5575" class="Datatype">List</a> <a id="4581" href="RawU.html#8077" class="Datatype">Untyped</a>
<a id="extricateU"></a><a id="4589" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4600" class="Symbol">:</a> <a id="4602" class="Symbol">{</a><a id="4603" href="Untyped.html#4603" class="Bound">n</a> <a id="4605" class="Symbol">:</a> <a id="4607" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4608" class="Symbol">}</a> <a id="4610" class="Symbol">→</a> <a id="4612" href="Untyped.html#4603" class="Bound">n</a> <a id="4614" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="4616" class="Symbol">→</a> <a id="4618" href="RawU.html#8077" class="Datatype">Untyped</a>
<a id="4626" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4637" class="Symbol">(</a><a id="4638" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="4640" href="Untyped.html#4640" class="Bound">x</a><a id="4641" class="Symbol">)</a>         <a id="4651" class="Symbol">=</a> <a id="4653" href="RawU.html#8099" class="InductiveConstructor">UVar</a> <a id="4658" class="Symbol">(</a><a id="4659" href="Data.Fin.Base.html#1267" class="Function">toℕ</a> <a id="4663" href="Untyped.html#4640" class="Bound">x</a><a id="4664" class="Symbol">)</a>
<a id="4666" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4677" class="Symbol">(</a><a id="4678" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="4680" href="Untyped.html#4680" class="Bound">t</a><a id="4681" class="Symbol">)</a>         <a id="4691" class="Symbol">=</a> <a id="4693" href="RawU.html#8120" class="InductiveConstructor">ULambda</a> <a id="4701" class="Symbol">(</a><a id="4702" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4713" href="Untyped.html#4680" class="Bound">t</a><a id="4714" class="Symbol">)</a>
<a id="4716" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4727" class="Symbol">(</a><a id="4728" href="Untyped.html#4728" class="Bound">t</a> <a id="4730" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="4732" href="Untyped.html#4732" class="Bound">u</a><a id="4733" class="Symbol">)</a>       <a id="4741" class="Symbol">=</a> <a id="4743" href="RawU.html#8150" class="InductiveConstructor">UApp</a> <a id="4748" class="Symbol">(</a><a id="4749" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4760" href="Untyped.html#4728" class="Bound">t</a><a id="4761" class="Symbol">)</a> <a id="4763" class="Symbol">(</a><a id="4764" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4775" href="Untyped.html#4732" class="Bound">u</a><a id="4776" class="Symbol">)</a>
<a id="4778" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4789" class="Symbol">(</a><a id="4790" href="Untyped.html#1696" class="InductiveConstructor">force</a> <a id="4796" href="Untyped.html#4796" class="Bound">t</a><a id="4797" class="Symbol">)</a>     <a id="4803" class="Symbol">=</a> <a id="4805" href="RawU.html#8292" class="InductiveConstructor">UForce</a> <a id="4812" class="Symbol">(</a><a id="4813" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4824" href="Untyped.html#4796" class="Bound">t</a><a id="4825" class="Symbol">)</a>
<a id="4827" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4838" class="Symbol">(</a><a id="4839" href="Untyped.html#1716" class="InductiveConstructor">delay</a> <a id="4845" href="Untyped.html#4845" class="Bound">t</a><a id="4846" class="Symbol">)</a>     <a id="4852" class="Symbol">=</a> <a id="4854" href="RawU.html#8263" class="InductiveConstructor">UDelay</a> <a id="4861" class="Symbol">(</a><a id="4862" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4873" href="Untyped.html#4845" class="Bound">t</a><a id="4874" class="Symbol">)</a>
<a id="4876" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4887" class="Symbol">(</a><a id="4888" href="Untyped.html#1736" class="InductiveConstructor">con</a> <a id="4892" href="Untyped.html#4892" class="Bound">c</a><a id="4893" class="Symbol">)</a>       <a id="4901" class="Symbol">=</a> <a id="4903" href="RawU.html#8187" class="InductiveConstructor">UCon</a> <a id="4908" class="Symbol">(</a><a id="4909" href="RawU.html#12107" class="Function">tmCon2TagCon</a> <a id="4922" href="Untyped.html#4892" class="Bound">c</a><a id="4923" class="Symbol">)</a>
<a id="4925" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4936" class="Symbol">(</a><a id="4937" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="4945" href="Untyped.html#4945" class="Bound">b</a><a id="4946" class="Symbol">)</a>   <a id="4950" class="Symbol">=</a> <a id="4952" href="RawU.html#8232" class="InductiveConstructor">UBuiltin</a> <a id="4961" href="Untyped.html#4945" class="Bound">b</a>
<a id="4963" href="Untyped.html#4589" class="Function">extricateU</a> <a id="4974" href="Untyped.html#1883" class="InductiveConstructor">error</a>         <a id="4988" class="Symbol">=</a> <a id="4990" href="RawU.html#8213" class="InductiveConstructor">UError</a>
<a id="4997" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5008" class="Symbol">(</a><a id="5009" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="5016" href="Untyped.html#5016" class="Bound">i</a> <a id="5018" href="Agda.Builtin.List.html#184" class="InductiveConstructor">L.[]</a><a id="5022" class="Symbol">)</a> <a id="5024" class="Symbol">=</a> <a id="5026" href="RawU.html#8321" class="InductiveConstructor">UConstr</a> <a id="5034" href="Untyped.html#5016" class="Bound">i</a> <a id="5036" href="Utils.html#5604" class="InductiveConstructor">[]</a>
<a id="5039" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5050" class="Symbol">(</a><a id="5051" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="5058" href="Untyped.html#5058" class="Bound">i</a> <a id="5060" class="Symbol">(</a><a id="5061" href="Untyped.html#5061" class="Bound">x</a> <a id="5063" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">L.∷</a> <a id="5067" href="Untyped.html#5067" class="Bound">xs</a><a id="5069" class="Symbol">))</a> <a id="5072" class="Symbol">=</a> <a id="5074" href="RawU.html#8321" class="InductiveConstructor">UConstr</a> <a id="5082" href="Untyped.html#5058" class="Bound">i</a> <a id="5084" class="Symbol">(</a><a id="5085" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5096" href="Untyped.html#5061" class="Bound">x</a> <a id="5098" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="5100" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="5115" href="Untyped.html#5067" class="Bound">xs</a><a id="5117" class="Symbol">)</a>
<a id="5119" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5130" class="Symbol">(</a><a id="5131" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="5136" href="Untyped.html#5136" class="Bound">x</a> <a id="5138" href="Untyped.html#5138" class="Bound">xs</a><a id="5140" class="Symbol">)</a>   <a id="5144" class="Symbol">=</a> <a id="5146" href="RawU.html#8360" class="InductiveConstructor">UCase</a> <a id="5152" class="Symbol">(</a><a id="5153" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5164" href="Untyped.html#5136" class="Bound">x</a><a id="5165" class="Symbol">)</a> <a id="5167" class="Symbol">(</a><a id="5168" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="5183" href="Untyped.html#5138" class="Bound">xs</a><a id="5185" class="Symbol">)</a>

<a id="5188" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="5203" href="Agda.Builtin.List.html#184" class="InductiveConstructor">L.[]</a> <a id="5208" class="Symbol">=</a> <a id="5210" href="Utils.html#5604" class="InductiveConstructor">[]</a>
<a id="5213" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="5228" class="Symbol">(</a><a id="5229" href="Untyped.html#5229" class="Bound">x</a> <a id="5231" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">L.∷</a> <a id="5235" href="Untyped.html#5235" class="Bound">xs</a><a id="5237" class="Symbol">)</a> <a id="5239" class="Symbol">=</a> <a id="5241" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5252" href="Untyped.html#5229" class="Bound">x</a> <a id="5254" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="5256" href="Untyped.html#4534" class="Function">extricateUList</a> <a id="5271" href="Untyped.html#5235" class="Bound">xs</a>

<a id="extricateU0"></a><a id="5275" href="Untyped.html#5275" class="Function">extricateU0</a> <a id="5287" class="Symbol">:</a> <a id="5289" class="Number">0</a>  <a id="5292" href="Untyped.html#1605" class="Datatype Operator">⊢</a> <a id="5294" class="Symbol">→</a> <a id="5296" href="RawU.html#8077" class="Datatype">Untyped</a>
<a id="5304" href="Untyped.html#5275" class="Function">extricateU0</a> <a id="5316" href="Untyped.html#5316" class="Bound">t</a> <a id="5318" class="Symbol">=</a> <a id="5320" href="Untyped.html#4589" class="Function">extricateU</a> <a id="5331" href="Untyped.html#5316" class="Bound">t</a>

<a id="extG&#39;"></a><a id="5334" href="Untyped.html#5334" class="Function">extG&#39;</a> <a id="5340" class="Symbol">:</a> <a id="5342" class="Symbol">{</a><a id="5343" href="Untyped.html#5343" class="Bound">X</a> <a id="5345" class="Symbol">:</a> <a id="5347" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="5350" class="Symbol">}</a> <a id="5352" class="Symbol">→</a> <a id="5354" class="Symbol">(</a><a id="5355" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5357" class="Symbol">→</a> <a id="5359" href="Utils.html#1191" class="Datatype">Either</a> <a id="5366" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="5377" href="Untyped.html#5343" class="Bound">X</a><a id="5378" class="Symbol">)</a> <a id="5380" class="Symbol">→</a> <a id="5382" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5384" class="Symbol">→</a> <a id="5386" href="Utils.html#1191" class="Datatype">Either</a> <a id="5393" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="5404" class="Symbol">(</a><a id="5405" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5411" href="Untyped.html#5343" class="Bound">X</a><a id="5412" class="Symbol">)</a>
<a id="5414" href="Untyped.html#5334" class="Function">extG&#39;</a> <a id="5420" href="Untyped.html#5420" class="Bound">g</a> <a id="5422" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>    <a id="5430" class="Symbol">=</a> <a id="5432" href="Utils.html#3191" class="Field">return</a> <a id="5439" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5447" href="Untyped.html#5334" class="Function">extG&#39;</a> <a id="5453" href="Untyped.html#5453" class="Bound">g</a> <a id="5455" class="Symbol">(</a><a id="5456" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5460" href="Untyped.html#5460" class="Bound">n</a><a id="5461" class="Symbol">)</a> <a id="5463" class="Symbol">=</a> <a id="5465" href="Utils.html#3327" class="Function">fmap</a> <a id="5470" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5475" class="Symbol">(</a><a id="5476" href="Untyped.html#5453" class="Bound">g</a> <a id="5478" href="Untyped.html#5460" class="Bound">n</a><a id="5479" class="Symbol">)</a>


<a id="scopeCheckUList"></a><a id="5483" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="5499" class="Symbol">:</a> <a id="5501" class="Symbol">{</a><a id="5502" href="Untyped.html#5502" class="Bound">n</a> <a id="5504" class="Symbol">:</a> <a id="5506" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5507" class="Symbol">}</a> <a id="5509" class="Symbol">→</a> <a id="5511" href="Utils.html#5575" class="Datatype">List</a> <a id="5516" href="RawU.html#8077" class="Datatype">Untyped</a> <a id="5524" class="Symbol">→</a> <a id="5526" href="Utils.html#1191" class="Datatype">Either</a> <a id="5533" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="5544" class="Symbol">(</a><a id="5545" href="Agda.Builtin.List.html#147" class="Datatype">L.List</a> <a id="5552" class="Symbol">(</a><a id="5553" href="Untyped.html#5502" class="Bound">n</a> <a id="5555" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="5556" class="Symbol">))</a>
<a id="scopeCheckU"></a><a id="5559" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5571" class="Symbol">:</a> <a id="5573" class="Symbol">{</a><a id="5574" href="Untyped.html#5574" class="Bound">n</a> <a id="5576" class="Symbol">:</a> <a id="5578" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5579" class="Symbol">}</a> <a id="5581" class="Symbol">→</a> <a id="5583" href="RawU.html#8077" class="Datatype">Untyped</a> <a id="5591" class="Symbol">→</a> <a id="5593" href="Utils.html#1191" class="Datatype">Either</a> <a id="5600" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="5611" class="Symbol">(</a><a id="5612" href="Untyped.html#5574" class="Bound">n</a> <a id="5614" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="5615" class="Symbol">)</a>
<a id="5617" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5629" class="Symbol">(</a><a id="5630" href="RawU.html#8099" class="InductiveConstructor">UVar</a> <a id="5635" href="Untyped.html#5635" class="Bound">x</a><a id="5636" class="Symbol">)</a>     <a id="5642" class="Symbol">=</a> <a id="5644" href="Utils.html#3327" class="Function">fmap</a> <a id="5649" href="Untyped.html#1630" class="InductiveConstructor">`</a> <a id="5651" class="Symbol">(</a><a id="5652" href="Utils.html#1654" class="Function">maybeToEither</a> <a id="5666" href="Scoped.html#7849" class="InductiveConstructor">deBError</a> <a id="5675" class="Symbol">(</a><a id="5676" href="Utils.html#1748" class="Function">natToFin</a> <a id="5685" href="Untyped.html#5635" class="Bound">x</a><a id="5686" class="Symbol">))</a>
<a id="5689" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5701" class="Symbol">(</a><a id="5702" href="RawU.html#8120" class="InductiveConstructor">ULambda</a> <a id="5710" href="Untyped.html#5710" class="Bound">t</a><a id="5711" class="Symbol">)</a>  <a id="5714" class="Symbol">=</a> <a id="5716" href="Utils.html#3327" class="Function">fmap</a> <a id="5721" href="Untyped.html#1650" class="InductiveConstructor">ƛ</a> <a id="5723" class="Symbol">(</a><a id="5724" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5736" href="Untyped.html#5710" class="Bound">t</a><a id="5737" class="Symbol">)</a>
<a id="5739" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5751" class="Symbol">(</a><a id="5752" href="RawU.html#8150" class="InductiveConstructor">UApp</a> <a id="5757" href="Untyped.html#5757" class="Bound">t</a> <a id="5759" href="Untyped.html#5759" class="Bound">u</a><a id="5760" class="Symbol">)</a>   <a id="5764" class="Symbol">=</a> <a id="5766" class="Keyword">do</a>
  <a id="5771" href="Untyped.html#5771" class="Bound">t</a> <a id="5773" href="Utils.html#3219" class="Field Operator">←</a> <a id="5775" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5787" href="Untyped.html#5757" class="Bound">t</a>
  <a id="5791" href="Untyped.html#5791" class="Bound">u</a> <a id="5793" href="Utils.html#3219" class="Field Operator">←</a> <a id="5795" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5807" href="Untyped.html#5759" class="Bound">u</a>
  <a id="5811" href="Utils.html#3191" class="Field">return</a> <a id="5818" class="Symbol">(</a><a id="5819" href="Untyped.html#5771" class="Bound">t</a> <a id="5821" href="Untyped.html#1672" class="InductiveConstructor Operator">·</a> <a id="5823" href="Untyped.html#5791" class="Bound">u</a><a id="5824" class="Symbol">)</a>
<a id="5826" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5838" class="Symbol">(</a><a id="5839" href="RawU.html#8187" class="InductiveConstructor">UCon</a> <a id="5844" href="Untyped.html#5844" class="Bound">c</a><a id="5845" class="Symbol">)</a>       <a id="5853" class="Symbol">=</a> <a id="5855" href="Utils.html#3191" class="Field">return</a> <a id="5862" class="Symbol">(</a><a id="5863" href="Untyped.html#1736" class="InductiveConstructor">con</a> <a id="5867" class="Symbol">(</a><a id="5868" href="RawU.html#9800" class="Function">tagCon2TmCon</a> <a id="5881" href="Untyped.html#5844" class="Bound">c</a><a id="5882" class="Symbol">))</a>
<a id="5885" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5897" href="RawU.html#8213" class="InductiveConstructor">UError</a>         <a id="5912" class="Symbol">=</a> <a id="5914" href="Utils.html#3191" class="Field">return</a> <a id="5921" href="Untyped.html#1883" class="InductiveConstructor">error</a>
<a id="5927" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5939" class="Symbol">(</a><a id="5940" href="RawU.html#8232" class="InductiveConstructor">UBuiltin</a> <a id="5949" href="Untyped.html#5949" class="Bound">b</a><a id="5950" class="Symbol">)</a>   <a id="5954" class="Symbol">=</a> <a id="5956" href="Utils.html#3191" class="Field">return</a> <a id="5963" class="Symbol">(</a><a id="5964" href="Untyped.html#1851" class="InductiveConstructor">builtin</a> <a id="5972" href="Untyped.html#5949" class="Bound">b</a><a id="5973" class="Symbol">)</a>
<a id="5975" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="5987" class="Symbol">(</a><a id="5988" href="RawU.html#8263" class="InductiveConstructor">UDelay</a> <a id="5995" href="Untyped.html#5995" class="Bound">t</a><a id="5996" class="Symbol">)</a>     <a id="6002" class="Symbol">=</a> <a id="6004" href="Utils.html#3327" class="Function">fmap</a> <a id="6009" href="Untyped.html#1716" class="InductiveConstructor">delay</a> <a id="6015" class="Symbol">(</a><a id="6016" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6028" href="Untyped.html#5995" class="Bound">t</a><a id="6029" class="Symbol">)</a>
<a id="6031" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6043" class="Symbol">(</a><a id="6044" href="RawU.html#8292" class="InductiveConstructor">UForce</a> <a id="6051" href="Untyped.html#6051" class="Bound">t</a><a id="6052" class="Symbol">)</a>     <a id="6058" class="Symbol">=</a> <a id="6060" href="Utils.html#3327" class="Function">fmap</a> <a id="6065" href="Untyped.html#1696" class="InductiveConstructor">force</a> <a id="6071" class="Symbol">(</a><a id="6072" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6084" href="Untyped.html#6051" class="Bound">t</a><a id="6085" class="Symbol">)</a>
<a id="6087" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6099" class="Symbol">(</a><a id="6100" href="RawU.html#8321" class="InductiveConstructor">UConstr</a> <a id="6108" href="Untyped.html#6108" class="Bound">i</a> <a id="6110" href="Untyped.html#6110" class="Bound">ts</a><a id="6112" class="Symbol">)</a> <a id="6114" class="Symbol">=</a> <a id="6116" href="Utils.html#3327" class="Function">fmap</a> <a id="6121" class="Symbol">(</a><a id="6122" href="Untyped.html#1756" class="InductiveConstructor">constr</a> <a id="6129" href="Untyped.html#6108" class="Bound">i</a><a id="6130" class="Symbol">)</a> <a id="6132" class="Symbol">(</a><a id="6133" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="6149" href="Untyped.html#6110" class="Bound">ts</a><a id="6151" class="Symbol">)</a>
<a id="6153" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6165" class="Symbol">(</a><a id="6166" href="RawU.html#8360" class="InductiveConstructor">UCase</a> <a id="6172" href="Untyped.html#6172" class="Bound">t</a> <a id="6174" href="Untyped.html#6174" class="Bound">ts</a><a id="6176" class="Symbol">)</a>   <a id="6180" class="Symbol">=</a> <a id="6182" class="Keyword">do</a>
                 <a id="6202" href="Untyped.html#6202" class="Bound">u</a>  <a id="6205" href="Utils.html#3219" class="Field Operator">←</a> <a id="6207" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6219" href="Untyped.html#6172" class="Bound">t</a>
                 <a id="6238" href="Untyped.html#6238" class="Bound">us</a> <a id="6241" href="Utils.html#3219" class="Field Operator">←</a> <a id="6243" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="6259" href="Untyped.html#6174" class="Bound">ts</a>
                 <a id="6279" href="Utils.html#3191" class="Field">return</a> <a id="6286" class="Symbol">(</a><a id="6287" href="Untyped.html#1803" class="InductiveConstructor">case</a> <a id="6292" href="Untyped.html#6202" class="Bound">u</a> <a id="6294" href="Untyped.html#6238" class="Bound">us</a><a id="6296" class="Symbol">)</a>

<a id="6299" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="6315" href="Utils.html#5604" class="InductiveConstructor">[]</a> <a id="6318" class="Symbol">=</a> <a id="6320" href="Utils.html#1248" class="InductiveConstructor">inj₂</a> <a id="6325" href="Agda.Builtin.List.html#184" class="InductiveConstructor">L.[]</a>
<a id="6330" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="6346" class="Symbol">(</a><a id="6347" href="Untyped.html#6347" class="Bound">x</a> <a id="6349" href="Utils.html#5619" class="InductiveConstructor Operator">∷</a> <a id="6351" href="Untyped.html#6351" class="Bound">xs</a><a id="6353" class="Symbol">)</a> <a id="6355" class="Symbol">=</a> <a id="6357" class="Keyword">do</a>
                 <a id="6377" href="Untyped.html#6377" class="Bound">u</a>  <a id="6380" href="Utils.html#3219" class="Field Operator">←</a> <a id="6382" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6394" href="Untyped.html#6347" class="Bound">x</a>
                 <a id="6413" href="Untyped.html#6413" class="Bound">us</a> <a id="6416" href="Utils.html#3219" class="Field Operator">←</a> <a id="6418" href="Untyped.html#5483" class="Function">scopeCheckUList</a> <a id="6434" href="Untyped.html#6351" class="Bound">xs</a>
                 <a id="6454" href="Utils.html#3191" class="Field">return</a> <a id="6461" class="Symbol">(</a><a id="6462" href="Untyped.html#6377" class="Bound">u</a> <a id="6464" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">L.∷</a> <a id="6468" href="Untyped.html#6413" class="Bound">us</a><a id="6470" class="Symbol">)</a>

<a id="scopeCheckU0"></a><a id="6473" href="Untyped.html#6473" class="Function">scopeCheckU0</a> <a id="6486" class="Symbol">:</a> <a id="6488" href="RawU.html#8077" class="Datatype">Untyped</a> <a id="6496" class="Symbol">→</a> <a id="6498" href="Utils.html#1191" class="Datatype">Either</a> <a id="6505" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="6516" class="Symbol">(</a><a id="6517" class="Number">0</a> <a id="6519" href="Untyped.html#1605" class="Datatype Operator">⊢</a><a id="6520" class="Symbol">)</a>
<a id="6522" href="Untyped.html#6473" class="Function">scopeCheckU0</a> <a id="6535" href="Untyped.html#6535" class="Bound">t</a> <a id="6537" class="Symbol">=</a> <a id="6539" href="Untyped.html#5559" class="Function">scopeCheckU</a> <a id="6551" href="Untyped.html#6535" class="Bound">t</a>
</pre>
<h2 id="equality-checking-for-raw-terms">Equality checking for raw terms</h2>

<p>Used to compare outputs in testing</p>

<pre class="Agda"><a id="decUTm"></a><a id="6634" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6641" class="Symbol">:</a> <a id="6643" class="Symbol">(</a><a id="6644" href="Untyped.html#6644" class="Bound">t</a> <a id="6646" href="Untyped.html#6646" class="Bound">t&#39;</a> <a id="6649" class="Symbol">:</a> <a id="6651" href="RawU.html#8077" class="Datatype">Untyped</a><a id="6658" class="Symbol">)</a> <a id="6660" class="Symbol">→</a> <a id="6662" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6667" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6674" class="Symbol">(</a><a id="6675" href="RawU.html#8099" class="InductiveConstructor">UVar</a> <a id="6680" href="Untyped.html#6680" class="Bound">x</a><a id="6681" class="Symbol">)</a> <a id="6683" class="Symbol">(</a><a id="6684" href="RawU.html#8099" class="InductiveConstructor">UVar</a> <a id="6689" href="Untyped.html#6689" class="Bound">x&#39;</a><a id="6691" class="Symbol">)</a> <a id="6693" class="Symbol">=</a> <a id="6695" href="Relation.Nullary.Decidable.Core.html#1927" class="Field">does</a> <a id="6700" class="Symbol">(</a><a id="6701" href="Untyped.html#6680" class="Bound">x</a> <a id="6703" href="Data.Nat.Properties.html#3874" class="Function Operator">Data.Nat.≟</a> <a id="6714" href="Untyped.html#6680" class="Bound">x</a><a id="6715" class="Symbol">)</a>
<a id="6717" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6724" class="Symbol">(</a><a id="6725" href="RawU.html#8120" class="InductiveConstructor">ULambda</a> <a id="6733" href="Untyped.html#6733" class="Bound">t</a><a id="6734" class="Symbol">)</a> <a id="6736" class="Symbol">(</a><a id="6737" href="RawU.html#8120" class="InductiveConstructor">ULambda</a> <a id="6745" href="Untyped.html#6745" class="Bound">t&#39;</a><a id="6747" class="Symbol">)</a> <a id="6749" class="Symbol">=</a> <a id="6751" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6758" href="Untyped.html#6733" class="Bound">t</a> <a id="6760" href="Untyped.html#6745" class="Bound">t&#39;</a>
<a id="6763" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6770" class="Symbol">(</a><a id="6771" href="RawU.html#8150" class="InductiveConstructor">UApp</a> <a id="6776" href="Untyped.html#6776" class="Bound">t</a> <a id="6778" href="Untyped.html#6778" class="Bound">u</a><a id="6779" class="Symbol">)</a> <a id="6781" class="Symbol">(</a><a id="6782" href="RawU.html#8150" class="InductiveConstructor">UApp</a> <a id="6787" href="Untyped.html#6787" class="Bound">t&#39;</a> <a id="6790" href="Untyped.html#6790" class="Bound">u&#39;</a><a id="6792" class="Symbol">)</a> <a id="6794" class="Symbol">=</a> <a id="6796" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6803" href="Untyped.html#6776" class="Bound">t</a> <a id="6805" href="Untyped.html#6787" class="Bound">t&#39;</a> <a id="6808" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="6810" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6817" href="Untyped.html#6778" class="Bound">u</a> <a id="6819" href="Untyped.html#6790" class="Bound">u&#39;</a>
<a id="6822" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6829" class="Symbol">(</a><a id="6830" href="RawU.html#8187" class="InductiveConstructor">UCon</a> <a id="6835" href="Untyped.html#6835" class="Bound">c</a><a id="6836" class="Symbol">)</a> <a id="6838" class="Symbol">(</a><a id="6839" href="RawU.html#8187" class="InductiveConstructor">UCon</a> <a id="6844" href="Untyped.html#6844" class="Bound">c&#39;</a><a id="6846" class="Symbol">)</a> <a id="6848" class="Symbol">=</a> <a id="6850" href="RawU.html#7771" class="Function">decTagCon</a> <a id="6860" href="Untyped.html#6835" class="Bound">c</a> <a id="6862" href="Untyped.html#6844" class="Bound">c&#39;</a>
<a id="6865" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6872" href="RawU.html#8213" class="InductiveConstructor">UError</a> <a id="6879" href="RawU.html#8213" class="InductiveConstructor">UError</a> <a id="6886" class="Symbol">=</a> <a id="6888" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="6893" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6900" class="Symbol">(</a><a id="6901" href="RawU.html#8232" class="InductiveConstructor">UBuiltin</a> <a id="6910" href="Untyped.html#6910" class="Bound">b</a><a id="6911" class="Symbol">)</a> <a id="6913" class="Symbol">(</a><a id="6914" href="RawU.html#8232" class="InductiveConstructor">UBuiltin</a> <a id="6923" href="Untyped.html#6923" class="Bound">b&#39;</a><a id="6925" class="Symbol">)</a> <a id="6927" class="Symbol">=</a> <a id="6929" href="Relation.Nullary.Decidable.Core.html#1927" class="Field">does</a> <a id="6934" class="Symbol">(</a><a id="6935" href="Builtin.html#34678" class="Function">decBuiltin</a> <a id="6946" href="Untyped.html#6910" class="Bound">b</a> <a id="6948" href="Untyped.html#6923" class="Bound">b&#39;</a><a id="6950" class="Symbol">)</a>
<a id="6952" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6959" class="Symbol">(</a><a id="6960" href="RawU.html#8263" class="InductiveConstructor">UDelay</a> <a id="6967" href="Untyped.html#6967" class="Bound">t</a><a id="6968" class="Symbol">)</a> <a id="6970" class="Symbol">(</a><a id="6971" href="RawU.html#8263" class="InductiveConstructor">UDelay</a> <a id="6978" href="Untyped.html#6978" class="Bound">t&#39;</a><a id="6980" class="Symbol">)</a> <a id="6982" class="Symbol">=</a> <a id="6984" href="Untyped.html#6634" class="Function">decUTm</a> <a id="6991" href="Untyped.html#6967" class="Bound">t</a> <a id="6993" href="Untyped.html#6978" class="Bound">t&#39;</a>
<a id="6996" href="Untyped.html#6634" class="Function">decUTm</a> <a id="7003" class="Symbol">(</a><a id="7004" href="RawU.html#8292" class="InductiveConstructor">UForce</a> <a id="7011" href="Untyped.html#7011" class="Bound">t</a><a id="7012" class="Symbol">)</a> <a id="7014" class="Symbol">(</a><a id="7015" href="RawU.html#8292" class="InductiveConstructor">UForce</a> <a id="7022" href="Untyped.html#7022" class="Bound">t&#39;</a><a id="7024" class="Symbol">)</a> <a id="7026" class="Symbol">=</a> <a id="7028" href="Untyped.html#6634" class="Function">decUTm</a> <a id="7035" href="Untyped.html#7011" class="Bound">t</a> <a id="7037" href="Untyped.html#7022" class="Bound">t&#39;</a>
<a id="7040" href="Untyped.html#6634" class="CatchallClause Function">decUTm</a><a id="7046" class="CatchallClause"> </a><a id="7047" class="CatchallClause Symbol">_</a><a id="7048" class="CatchallClause"> </a><a id="7049" class="CatchallClause Symbol">_</a> <a id="7051" class="Symbol">=</a> <a id="7053" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
</pre>
<h2 id="haskell-uplc-to-agda-uplc">Haskell UPLC to Agda UPLC</h2>
<pre class="Agda"><a id="buildDebruijnEncoding"></a><a id="7097" href="Untyped.html#7097" class="Function">buildDebruijnEncoding</a> <a id="7119" class="Symbol">:</a> <a id="7121" class="Symbol">{</a><a id="7122" href="Untyped.html#7122" class="Bound">X</a> <a id="7124" class="Symbol">:</a> <a id="7126" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="7129" class="Symbol">}</a> <a id="7131" class="Symbol">→</a> <a id="7133" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7135" class="Symbol">→</a> <a id="7137" href="Utils.html#1191" class="Datatype">Either</a> <a id="7144" href="Scoped.html#7824" class="Datatype">ScopeError</a> <a id="7155" class="Symbol">(</a><a id="7156" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="7162" href="Untyped.html#7122" class="Bound">X</a><a id="7163" class="Symbol">)</a>
<a id="7165" href="Untyped.html#7097" class="Function">buildDebruijnEncoding</a> <a id="7187" href="Untyped.html#7187" class="Bound">x</a> <a id="7189" class="Symbol">=</a> <a id="7191" href="Untyped.html#5334" class="Function">extG&#39;</a> <a id="7197" class="Symbol">(λ</a> <a id="7200" href="Untyped.html#7200" class="Bound">_</a> <a id="7202" class="Symbol">→</a> <a id="7204" href="Utils.html#1224" class="InductiveConstructor">inj₁</a> <a id="7209" href="Scoped.html#7849" class="InductiveConstructor">deBError</a><a id="7217" class="Symbol">)</a> <a id="7219" href="Untyped.html#7187" class="Bound">x</a>

</pre>
<p>Some useful functions for making integer literals.</p>
<pre class="Agda"><a id="7281" class="Keyword">open</a> <a id="7286" class="Keyword">import</a> <a id="7293" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a> <a id="7310" class="Keyword">using</a> <a id="7316" class="Symbol">(</a><a id="7317" href="Agda.Builtin.Int.html#245" class="Datatype">Int</a><a id="7320" class="Symbol">)</a>

<a id="make-integer"></a><a id="7323" href="Untyped.html#7323" class="Function">make-integer</a> <a id="7336" class="Symbol">:</a> <a id="7338" href="RawU.html#5118" class="Function">RawU.TyTag</a>
<a id="7349" href="Untyped.html#7323" class="Function">make-integer</a> <a id="7362" class="Symbol">=</a> <a id="7364" href="RawU.html#8843" class="Function">RawU.tag2TyTag</a> <a id="7379" href="RawU.html#2429" class="InductiveConstructor">RawU.integer</a>

<a id="con-integer"></a><a id="7393" href="Untyped.html#7393" class="Function">con-integer</a> <a id="7405" class="Symbol">:</a> <a id="7407" class="Symbol">{</a><a id="7408" href="Untyped.html#7408" class="Bound">n</a> <a id="7410" class="Symbol">:</a> <a id="7412" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7413" class="Symbol">}</a> <a id="7415" class="Symbol">→</a> <a id="7417" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7419" class="Symbol">→</a> <a id="7421" href="Untyped.html#7408" class="Bound">n</a> <a id="7423" href="Untyped.html#1605" class="Datatype Operator">⊢</a>
<a id="7425" href="Untyped.html#7393" class="Function">con-integer</a> <a id="7437" href="Untyped.html#7437" class="Bound">n</a> <a id="7439" class="Symbol">=</a> <a id="7441" class="Symbol">(</a><a id="7442" href="Untyped.html#1736" class="InductiveConstructor">con</a> <a id="7446" class="Symbol">(</a><a id="7447" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="7453" href="Untyped.html#7323" class="Function">make-integer</a> <a id="7466" class="Symbol">(</a><a id="7467" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">Int.pos</a> <a id="7475" href="Untyped.html#7437" class="Bound">n</a><a id="7476" class="Symbol">)))</a>
</pre>

    </section>
  </body>
</html>
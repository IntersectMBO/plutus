<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>VerifiedCompilation.UCaseReduce</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>VerifiedCompilation.UCaseReduce</h1>
    <section>
      <h1 id="case-reduce-translation-phase">Case-Reduce Translation Phase</h1>
<pre class="Agda"><a id="98" class="Keyword">module</a> <a id="105" href="VerifiedCompilation.UCaseReduce.html" class="Module">VerifiedCompilation.UCaseReduce</a> <a id="137" class="Keyword">where</a>

</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Untyped.Equality.html" class="Module">Untyped.Equality</a> <a id="193" class="Keyword">using</a> <a id="199" class="Symbol">(</a><a id="200" href="Untyped.Equality.html#2068" class="Record">DecEq</a><a id="205" class="Symbol">;</a> <a id="207" href="Untyped.Equality.html#2104" class="Field Operator">_≟_</a><a id="210" class="Symbol">;</a><a id="211" href="Untyped.Equality.html#3525" class="Function">decPointwise</a><a id="223" class="Symbol">)</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="VerifiedCompilation.UntypedViews.html" class="Module">VerifiedCompilation.UntypedViews</a> <a id="270" class="Keyword">using</a> <a id="276" class="Symbol">(</a><a id="277" href="VerifiedCompilation.UntypedViews.html#1310" class="Function">Pred</a><a id="281" class="Symbol">;</a> <a id="283" href="VerifiedCompilation.UntypedViews.html#6068" class="Function">isCase?</a><a id="290" class="Symbol">;</a> <a id="292" href="VerifiedCompilation.UntypedViews.html#2652" class="Function">isApp?</a><a id="298" class="Symbol">;</a> <a id="300" href="VerifiedCompilation.UntypedViews.html#1930" class="Function">isLambda?</a><a id="309" class="Symbol">;</a> <a id="311" href="VerifiedCompilation.UntypedViews.html#3445" class="Function">isForce?</a><a id="319" class="Symbol">;</a> <a id="321" href="VerifiedCompilation.UntypedViews.html#6921" class="Function">isBuiltin?</a><a id="331" class="Symbol">;</a> <a id="333" href="VerifiedCompilation.UntypedViews.html#5279" class="Function">isConstr?</a><a id="342" class="Symbol">;</a> <a id="344" href="VerifiedCompilation.UntypedViews.html#4139" class="Function">isDelay?</a><a id="352" class="Symbol">;</a> <a id="354" href="VerifiedCompilation.UntypedViews.html#7904" class="Function">isTerm?</a><a id="361" class="Symbol">;</a> <a id="363" href="VerifiedCompilation.UntypedViews.html#1486" class="Function">isVar?</a><a id="369" class="Symbol">;</a> <a id="371" href="VerifiedCompilation.UntypedViews.html#8073" class="Function">allTerms?</a><a id="380" class="Symbol">;</a> <a id="382" href="VerifiedCompilation.UntypedViews.html#5987" class="InductiveConstructor">iscase</a><a id="388" class="Symbol">;</a> <a id="390" href="VerifiedCompilation.UntypedViews.html#2598" class="InductiveConstructor">isapp</a><a id="395" class="Symbol">;</a> <a id="397" href="VerifiedCompilation.UntypedViews.html#1874" class="InductiveConstructor">islambda</a><a id="405" class="Symbol">;</a> <a id="407" href="VerifiedCompilation.UntypedViews.html#3395" class="InductiveConstructor">isforce</a><a id="414" class="Symbol">;</a> <a id="416" href="VerifiedCompilation.UntypedViews.html#6867" class="InductiveConstructor">isbuiltin</a><a id="425" class="Symbol">;</a> <a id="427" href="VerifiedCompilation.UntypedViews.html#5204" class="InductiveConstructor">isconstr</a><a id="435" class="Symbol">;</a> <a id="437" href="VerifiedCompilation.UntypedViews.html#7874" class="InductiveConstructor">isterm</a><a id="443" class="Symbol">;</a> <a id="445" href="VerifiedCompilation.UntypedViews.html#8030" class="InductiveConstructor">allterms</a><a id="453" class="Symbol">;</a> <a id="455" href="VerifiedCompilation.UntypedViews.html#4089" class="InductiveConstructor">isdelay</a><a id="462" class="Symbol">;</a> <a id="464" href="VerifiedCompilation.UntypedViews.html#1456" class="InductiveConstructor">isvar</a><a id="469" class="Symbol">)</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="VerifiedCompilation.UntypedTranslation.html" class="Module">VerifiedCompilation.UntypedTranslation</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="VerifiedCompilation.UntypedTranslation.html#1635" class="Datatype">Translation</a><a id="540" class="Symbol">;</a> <a id="542" href="VerifiedCompilation.UntypedTranslation.html#4081" class="Function">translation?</a><a id="554" class="Symbol">;</a> <a id="556" href="VerifiedCompilation.UntypedTranslation.html#1565" class="Function">Relation</a><a id="564" class="Symbol">;</a> <a id="566" href="VerifiedCompilation.UntypedTranslation.html#11327" class="Function">convert</a><a id="573" class="Symbol">;</a> <a id="575" href="VerifiedCompilation.UntypedTranslation.html#12691" class="Function">reflexive</a><a id="584" class="Symbol">)</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">_×-dec_</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Untyped.html" class="Module">Untyped</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Untyped.html#1677" class="Datatype Operator">_⊢</a><a id="660" class="Symbol">;</a> <a id="662" href="Untyped.html#1875" class="InductiveConstructor">case</a><a id="666" class="Symbol">;</a> <a id="668" href="Untyped.html#1923" class="InductiveConstructor">builtin</a><a id="675" class="Symbol">;</a> <a id="677" href="Untyped.html#1744" class="InductiveConstructor Operator">_·_</a><a id="680" class="Symbol">;</a> <a id="682" href="Untyped.html#1768" class="InductiveConstructor">force</a><a id="687" class="Symbol">;</a> <a id="689" href="Untyped.html#1704" class="InductiveConstructor">`</a><a id="690" class="Symbol">;</a> <a id="692" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a><a id="693" class="Symbol">;</a> <a id="695" href="Untyped.html#1788" class="InductiveConstructor">delay</a><a id="700" class="Symbol">;</a> <a id="702" href="Untyped.html#1808" class="InductiveConstructor">con</a><a id="705" class="Symbol">;</a> <a id="707" href="Untyped.html#1828" class="InductiveConstructor">constr</a><a id="713" class="Symbol">;</a> <a id="715" href="Untyped.html#1955" class="InductiveConstructor">error</a><a id="720" class="Symbol">;</a> <a id="722" href="Untyped.html#7502" class="Function">toWellScoped</a><a id="734" class="Symbol">;</a> <a id="736" href="Untyped.html#7790" class="Function">con-integer</a><a id="747" class="Symbol">)</a>
<a id="749" class="Keyword">import</a> <a id="756" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="794" class="Symbol">as</a> <a id="797" class="Module">Eq</a>
<a id="800" class="Keyword">open</a> <a id="805" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="808" class="Keyword">using</a> <a id="814" class="Symbol">(</a><a id="815" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="818" class="Symbol">;</a> <a id="820" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="824" class="Symbol">)</a>
<a id="826" class="Keyword">open</a> <a id="831" class="Keyword">import</a> <a id="838" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="881" class="Keyword">using</a> <a id="887" class="Symbol">(</a><a id="888" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a><a id="893" class="Symbol">;</a> <a id="895" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="898" class="Symbol">;</a> <a id="900" href="Relation.Binary.PropositionalEquality.Core.html#1989" class="Function">subst</a><a id="905" class="Symbol">)</a>
<a id="907" class="Keyword">open</a> <a id="912" class="Keyword">import</a> <a id="919" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="931" class="Keyword">using</a> <a id="937" class="Symbol">(</a><a id="938" href="Untyped.CEK.html#21843" class="Function">lookup?</a><a id="945" class="Symbol">;</a> <a id="947" href="Untyped.CEK.html#21976" class="Function">lookup?-deterministic</a><a id="968" class="Symbol">)</a>
<a id="970" class="Keyword">open</a> <a id="975" class="Keyword">import</a> <a id="982" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="991" class="Keyword">using</a> <a id="997" class="Symbol">(</a><a id="998" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="999" class="Symbol">;</a> <a id="1001" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="1005" class="Symbol">;</a> <a id="1007" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="1010" class="Symbol">)</a>
<a id="1012" class="Keyword">open</a> <a id="1017" class="Keyword">import</a> <a id="1024" href="Data.List.html" class="Module">Data.List</a> <a id="1034" class="Keyword">using</a> <a id="1040" class="Symbol">(</a><a id="1041" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="1045" class="Symbol">;</a> <a id="1047" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="1050" class="Symbol">;</a> <a id="1052" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="1054" class="Symbol">;</a> <a id="1056" href="Data.List.Base.html#5205" class="Function Operator">[_]</a><a id="1059" class="Symbol">)</a>
<a id="1061" class="Keyword">open</a> <a id="1066" class="Keyword">import</a> <a id="1073" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1084" class="Keyword">using</a> <a id="1090" class="Symbol">(</a><a id="1091" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="1096" class="Symbol">;</a> <a id="1098" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1102" class="Symbol">;</a> <a id="1104" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1111" class="Symbol">)</a>
<a id="1113" class="Keyword">open</a> <a id="1118" class="Keyword">import</a> <a id="1125" href="Data.List.Relation.Binary.Pointwise.Base.html" class="Module">Data.List.Relation.Binary.Pointwise.Base</a> <a id="1166" class="Keyword">using</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Data.List.Relation.Binary.Pointwise.Base.html#884" class="Datatype">Pointwise</a><a id="1182" class="Symbol">)</a>
<a id="1184" class="Keyword">import</a> <a id="1191" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1207" class="Symbol">as</a> <a id="1210" class="Module">Binary</a> <a id="1217" class="Keyword">using</a> <a id="1223" class="Symbol">(</a><a id="1224" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a><a id="1233" class="Symbol">)</a>
<a id="1235" class="Keyword">open</a> <a id="1240" class="Keyword">import</a> <a id="1247" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1264" class="Keyword">using</a> <a id="1270" class="Symbol">(</a><a id="1271" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a><a id="1274" class="Symbol">;</a> <a id="1276" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a><a id="1279" class="Symbol">;</a> <a id="1281" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a><a id="1283" class="Symbol">;</a> <a id="1285" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬_</a><a id="1287" class="Symbol">)</a>
<a id="1289" class="Keyword">open</a> <a id="1294" class="Keyword">import</a> <a id="1301" href="Data.Product.html" class="Module">Data.Product</a> <a id="1314" class="Keyword">using</a> <a id="1320" class="Symbol">(</a><a id="1321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="1324" class="Symbol">)</a>
<a id="1326" class="Keyword">open</a> <a id="1331" class="Keyword">import</a> <a id="1338" href="RawU.html" class="Module">RawU</a> <a id="1343" class="Keyword">using</a> <a id="1349" class="Symbol">(</a><a id="1350" href="RawU.html#8843" class="Function">tag2TyTag</a><a id="1359" class="Symbol">;</a> <a id="1361" href="RawU.html#8032" class="InductiveConstructor">tmCon</a><a id="1366" class="Symbol">)</a>
<a id="1368" class="Keyword">open</a> <a id="1373" class="Keyword">import</a> <a id="1380" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a> <a id="1397" class="Keyword">using</a> <a id="1403" class="Symbol">(</a><a id="1404" href="Agda.Builtin.Int.html#245" class="Datatype">Int</a><a id="1407" class="Symbol">)</a>
<a id="1409" class="Keyword">open</a> <a id="1414" class="Keyword">import</a> <a id="1421" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="1432" class="Keyword">using</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Data.Empty.html#914" class="Function">⊥</a><a id="1440" class="Symbol">)</a>
<a id="1442" class="Keyword">open</a> <a id="1447" class="Keyword">import</a> <a id="1454" href="Function.html" class="Module">Function</a> <a id="1463" class="Keyword">using</a> <a id="1469" class="Symbol">(</a><a id="1470" href="Function.Base.html#4042" class="Function Operator">case_of_</a><a id="1478" class="Symbol">)</a>
<a id="1480" class="Keyword">open</a> <a id="1485" class="Keyword">import</a> <a id="1492" href="VerifiedCompilation.Certificate.html" class="Module">VerifiedCompilation.Certificate</a> <a id="1524" class="Keyword">using</a> <a id="1530" class="Symbol">(</a><a id="1531" href="VerifiedCompilation.Certificate.html#1112" class="Datatype">ProofOrCE</a><a id="1540" class="Symbol">;</a> <a id="1542" href="VerifiedCompilation.Certificate.html#1188" class="InductiveConstructor">ce</a><a id="1544" class="Symbol">;</a> <a id="1546" href="VerifiedCompilation.Certificate.html#1156" class="InductiveConstructor">proof</a><a id="1551" class="Symbol">;</a> <a id="1553" href="VerifiedCompilation.Certificate.html#797" class="InductiveConstructor">caseReduceT</a><a id="1564" class="Symbol">)</a>
<a id="1566" class="Keyword">open</a> <a id="1571" class="Keyword">import</a> <a id="1578" href="Untyped.Reduction.html" class="Module">Untyped.Reduction</a> <a id="1596" class="Keyword">using</a> <a id="1602" class="Symbol">(</a><a id="1603" href="Untyped.Reduction.html#4232" class="Function">iterApp</a><a id="1610" class="Symbol">)</a>
</pre>
<h2 id="translation-relation">Translation Relation</h2>

<pre class="Agda"><a id="1646" class="Keyword">data</a> <a id="CaseReduce"></a><a id="1651" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="1662" class="Symbol">:</a> <a id="1664" href="VerifiedCompilation.UntypedTranslation.html#1565" class="Function">Relation</a> <a id="1673" class="Keyword">where</a>
  <a id="CaseReduce.casereduce"></a><a id="1681" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="1692" class="Symbol">:</a> <a id="1694" class="Symbol">{</a><a id="1695" href="VerifiedCompilation.UCaseReduce.html#1695" class="Bound">X</a> <a id="1697" class="Symbol">:</a> <a id="1699" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1702" class="Symbol">}</a> <a id="1704" class="Symbol"></a> <a id="1720" class="Symbol">{</a><a id="1721" href="VerifiedCompilation.UCaseReduce.html#1721" class="Bound">x</a> <a id="1723" class="Symbol">:</a> <a id="1725" href="VerifiedCompilation.UCaseReduce.html#1695" class="Bound">X</a> <a id="1727" href="Untyped.html#1677" class="Datatype Operator">⊢</a><a id="1728" class="Symbol">}</a> <a id="1730" class="Symbol">{</a> <a id="1732" href="VerifiedCompilation.UCaseReduce.html#1732" class="Bound">x&#39;</a> <a id="1735" class="Symbol">:</a> <a id="1737" href="VerifiedCompilation.UCaseReduce.html#1695" class="Bound">X</a> <a id="1739" href="Untyped.html#1677" class="Datatype Operator">⊢</a><a id="1740" class="Symbol">}</a> <a id="1742" class="Symbol">{</a><a id="1743" href="VerifiedCompilation.UCaseReduce.html#1743" class="Bound">vs</a> <a id="1746" href="VerifiedCompilation.UCaseReduce.html#1746" class="Bound">xs</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1756" class="Symbol">(</a><a id="1757" href="VerifiedCompilation.UCaseReduce.html#1695" class="Bound">X</a> <a id="1759" href="Untyped.html#1677" class="Datatype Operator">⊢</a><a id="1760" class="Symbol">)}</a> <a id="1763" class="Symbol">{</a><a id="1764" href="VerifiedCompilation.UCaseReduce.html#1764" class="Bound">i</a> <a id="1766" class="Symbol">:</a> <a id="1768" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1769" class="Symbol">}</a>
                         <a id="1796" class="Symbol">→</a> <a id="1798" href="Untyped.CEK.html#21843" class="Function">lookup?</a> <a id="1806" href="VerifiedCompilation.UCaseReduce.html#1764" class="Bound">i</a> <a id="1808" href="VerifiedCompilation.UCaseReduce.html#1746" class="Bound">xs</a> <a id="1811" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1813" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1818" href="VerifiedCompilation.UCaseReduce.html#1721" class="Bound">x</a>
                         <a id="1845" class="Symbol">→</a> <a id="1847" href="VerifiedCompilation.UntypedTranslation.html#1635" class="Datatype">Translation</a> <a id="1859" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="1870" class="Symbol">(</a><a id="1871" href="Untyped.Reduction.html#4232" class="Function">iterApp</a> <a id="1879" href="VerifiedCompilation.UCaseReduce.html#1721" class="Bound">x</a> <a id="1881" href="VerifiedCompilation.UCaseReduce.html#1743" class="Bound">vs</a><a id="1883" class="Symbol">)</a> <a id="1885" href="VerifiedCompilation.UCaseReduce.html#1732" class="Bound">x&#39;</a>
                         <a id="1913" class="Symbol">→</a> <a id="1915" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="1926" class="Symbol">(</a><a id="1927" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="1940" href="VerifiedCompilation.UCaseReduce.html#1764" class="Bound">i</a> <a id="1942" href="VerifiedCompilation.UCaseReduce.html#1743" class="Bound">vs</a><a id="1944" class="Symbol">)</a> <a id="1946" href="VerifiedCompilation.UCaseReduce.html#1746" class="Bound">xs</a><a id="1948" class="Symbol">)</a> <a id="1950" href="VerifiedCompilation.UCaseReduce.html#1732" class="Bound">x&#39;</a>
</pre>
<h2 id="decision-procedure">Decision Procedure</h2>

<pre class="Agda"><a id="isCaseReduce?"></a><a id="1984" href="VerifiedCompilation.UCaseReduce.html#1984" class="Function">isCaseReduce?</a> <a id="1998" class="Symbol">:</a> <a id="2000" class="Symbol">{</a><a id="2001" href="VerifiedCompilation.UCaseReduce.html#2001" class="Bound">X</a> <a id="2003" class="Symbol">:</a> <a id="2005" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2008" class="Symbol">}</a> <a id="2010" class="Symbol"></a> <a id="2026" class="Symbol">→</a> <a id="2028" class="Symbol">(</a><a id="2029" href="VerifiedCompilation.UCaseReduce.html#2029" class="Bound">ast</a> <a id="2033" href="VerifiedCompilation.UCaseReduce.html#2033" class="Bound">ast&#39;</a> <a id="2038" class="Symbol">:</a> <a id="2040" href="VerifiedCompilation.UCaseReduce.html#2001" class="Bound">X</a> <a id="2042" href="Untyped.html#1677" class="Datatype Operator">⊢</a><a id="2043" class="Symbol">)</a> <a id="2045" class="Symbol">→</a> <a id="2047" href="VerifiedCompilation.Certificate.html#1112" class="Datatype">ProofOrCE</a> <a id="2057" class="Symbol">(</a><a id="2058" href="VerifiedCompilation.UntypedTranslation.html#1635" class="Datatype">Translation</a> <a id="2070" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="2081" class="Symbol">{</a><a id="2082" href="VerifiedCompilation.UCaseReduce.html#2001" class="Bound">X</a><a id="2083" class="Symbol">}</a> <a id="2085" href="VerifiedCompilation.UCaseReduce.html#2029" class="Bound">ast</a> <a id="2089" href="VerifiedCompilation.UCaseReduce.html#2033" class="Bound">ast&#39;</a><a id="2093" class="Symbol">)</a>

<a id="justEq"></a><a id="2096" href="VerifiedCompilation.UCaseReduce.html#2096" class="Function">justEq</a> <a id="2103" class="Symbol">:</a> <a id="2105" class="Symbol">{</a><a id="2106" href="VerifiedCompilation.UCaseReduce.html#2106" class="Bound">X</a> <a id="2108" class="Symbol">:</a> <a id="2110" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2113" class="Symbol">}</a> <a id="2115" class="Symbol">{</a><a id="2116" href="VerifiedCompilation.UCaseReduce.html#2116" class="Bound">x</a> <a id="2118" href="VerifiedCompilation.UCaseReduce.html#2118" class="Bound">x₁</a> <a id="2121" class="Symbol">:</a> <a id="2123" href="VerifiedCompilation.UCaseReduce.html#2106" class="Bound">X</a><a id="2124" class="Symbol">}</a> <a id="2126" class="Symbol">→</a> <a id="2128" class="Symbol">(</a><a id="2129" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2134" href="VerifiedCompilation.UCaseReduce.html#2116" class="Bound">x</a><a id="2135" class="Symbol">)</a> <a id="2137" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2139" class="Symbol">(</a><a id="2140" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2145" href="VerifiedCompilation.UCaseReduce.html#2118" class="Bound">x₁</a><a id="2147" class="Symbol">)</a> <a id="2149" class="Symbol">→</a> <a id="2151" href="VerifiedCompilation.UCaseReduce.html#2116" class="Bound">x</a> <a id="2153" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2155" href="VerifiedCompilation.UCaseReduce.html#2118" class="Bound">x₁</a>
<a id="2158" href="VerifiedCompilation.UCaseReduce.html#2096" class="Function">justEq</a> <a id="2165" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2170" class="Symbol">=</a> <a id="2172" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="2178" class="Symbol">{-#</a> <a id="2182" class="Keyword">TERMINATING</a> <a id="2194" class="Symbol">#-}</a>
<a id="isCR?"></a><a id="2198" href="VerifiedCompilation.UCaseReduce.html#2198" class="Function">isCR?</a> <a id="2204" class="Symbol">:</a> <a id="2206" class="Symbol">{</a><a id="2207" href="VerifiedCompilation.UCaseReduce.html#2207" class="Bound">X</a> <a id="2209" class="Symbol">:</a> <a id="2211" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2214" class="Symbol">}</a> <a id="2216" class="Symbol"></a> <a id="2232" class="Symbol">→</a> <a id="2234" class="Symbol">(</a><a id="2235" href="VerifiedCompilation.UCaseReduce.html#2235" class="Bound">ast</a> <a id="2239" href="VerifiedCompilation.UCaseReduce.html#2239" class="Bound">ast&#39;</a> <a id="2244" class="Symbol">:</a> <a id="2246" href="VerifiedCompilation.UCaseReduce.html#2207" class="Bound">X</a> <a id="2248" href="Untyped.html#1677" class="Datatype Operator">⊢</a><a id="2249" class="Symbol">)</a> <a id="2251" class="Symbol">→</a> <a id="2253" href="VerifiedCompilation.Certificate.html#1112" class="Datatype">ProofOrCE</a> <a id="2263" class="Symbol">(</a><a id="2264" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="2275" href="VerifiedCompilation.UCaseReduce.html#2235" class="Bound">ast</a> <a id="2279" href="VerifiedCompilation.UCaseReduce.html#2239" class="Bound">ast&#39;</a><a id="2283" class="Symbol">)</a>
<a id="2285" href="VerifiedCompilation.UCaseReduce.html#2198" class="Function">isCR?</a> <a id="2291" href="VerifiedCompilation.UCaseReduce.html#2291" class="Bound">ast</a> <a id="2295" href="VerifiedCompilation.UCaseReduce.html#2295" class="Bound">ast&#39;</a> <a id="2300" class="Keyword">with</a> <a id="2305" class="Symbol">(</a><a id="2306" href="VerifiedCompilation.UntypedViews.html#6068" class="Function">isCase?</a> <a id="2314" class="Symbol">(</a><a id="2315" href="VerifiedCompilation.UntypedViews.html#5279" class="Function">isConstr?</a> <a id="2325" href="VerifiedCompilation.UntypedViews.html#8073" class="Function">allTerms?</a><a id="2334" class="Symbol">)</a> <a id="2336" href="VerifiedCompilation.UntypedViews.html#8073" class="Function">allTerms?</a><a id="2345" class="Symbol">)</a> <a id="2347" href="VerifiedCompilation.UCaseReduce.html#2291" class="Bound">ast</a>
<a id="2351" class="Symbol">...</a> <a id="2355" class="Symbol">|</a> <a id="2357" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="2360" href="VerifiedCompilation.UCaseReduce.html#2360" class="Bound">¬p</a> <a id="2363" class="Symbol">=</a> <a id="2365" href="VerifiedCompilation.Certificate.html#1188" class="InductiveConstructor">ce</a> <a id="2368" class="Symbol">(λ</a> <a id="2371" class="Symbol">{</a> <a id="2373" class="Symbol">(</a><a id="2374" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="2385" class="Symbol">_</a> <a id="2387" class="Symbol">_)</a> <a id="2390" class="Symbol">→</a> <a id="2392" href="VerifiedCompilation.UCaseReduce.html#2360" class="Bound">¬p</a> <a id="2395" class="Symbol">(</a><a id="2396" href="VerifiedCompilation.UntypedViews.html#5987" class="InductiveConstructor">iscase</a> <a id="2403" class="Symbol">(</a><a id="2404" href="VerifiedCompilation.UntypedViews.html#5204" class="InductiveConstructor">isconstr</a> <a id="2413" class="Symbol">_</a> <a id="2415" class="Symbol">(</a><a id="2416" href="VerifiedCompilation.UntypedViews.html#8030" class="InductiveConstructor">allterms</a> <a id="2425" class="Symbol">_))</a> <a id="2429" class="Symbol">(</a><a id="2430" href="VerifiedCompilation.UntypedViews.html#8030" class="InductiveConstructor">allterms</a> <a id="2439" class="Symbol">_))}</a> <a id="2444" class="Symbol">)</a> <a id="2446" href="VerifiedCompilation.Certificate.html#797" class="InductiveConstructor">caseReduceT</a> <a id="2458" class="Bound">ast</a> <a id="2462" class="Bound">ast&#39;</a>
<a id="2467" class="Symbol">...</a> <a id="2471" class="Symbol">|</a> <a id="2473" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2477" class="Symbol">(</a><a id="2478" href="VerifiedCompilation.UntypedViews.html#5987" class="InductiveConstructor">iscase</a> <a id="2485" class="Symbol">(</a><a id="2486" href="VerifiedCompilation.UntypedViews.html#5204" class="InductiveConstructor">isconstr</a> <a id="2495" href="VerifiedCompilation.UCaseReduce.html#2495" class="Bound">i</a> <a id="2497" class="Symbol">(</a><a id="2498" href="VerifiedCompilation.UntypedViews.html#8030" class="InductiveConstructor">allterms</a> <a id="2507" href="VerifiedCompilation.UCaseReduce.html#2507" class="Bound">vs</a><a id="2509" class="Symbol">))</a> <a id="2512" class="Symbol">(</a><a id="2513" href="VerifiedCompilation.UntypedViews.html#8030" class="InductiveConstructor">allterms</a> <a id="2522" href="VerifiedCompilation.UCaseReduce.html#2522" class="Bound">xs</a><a id="2524" class="Symbol">))</a> <a id="2527" class="Keyword">with</a> <a id="2532" href="Untyped.CEK.html#21843" class="Function">lookup?</a> <a id="2540" href="VerifiedCompilation.UCaseReduce.html#2495" class="Bound">i</a> <a id="2542" href="VerifiedCompilation.UCaseReduce.html#2522" class="Bound">xs</a> <a id="2545" class="Keyword">in</a> <a id="2548" class="Argument">xv</a>
<a id="2551" class="Symbol">...</a>          <a id="2564" class="Symbol">|</a> <a id="2566" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2574" class="Symbol">=</a> <a id="2576" href="VerifiedCompilation.Certificate.html#1188" class="InductiveConstructor">ce</a> <a id="2579" class="Symbol">(λ</a> <a id="2582" class="Symbol">{</a> <a id="2584" class="Symbol">(</a><a id="2585" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="2596" href="VerifiedCompilation.UCaseReduce.html#2596" class="Bound">p</a> <a id="2598" class="Symbol">_)</a> <a id="2601" class="Symbol">→</a> <a id="2603" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="2608" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="2614" class="Symbol">(</a><a id="2615" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2619" href="VerifiedCompilation.UCaseReduce.html#2548" class="Bound">xv</a><a id="2621" class="Symbol">)</a> <a id="2623" href="VerifiedCompilation.UCaseReduce.html#2596" class="Bound">p</a> <a id="2625" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="2628" class="Symbol">λ</a> <a id="2630" class="Symbol">{</a> <a id="2632" class="Symbol">()</a> <a id="2635" class="Symbol">}}</a> <a id="2638" class="Symbol">)</a> <a id="2640" href="VerifiedCompilation.Certificate.html#797" class="InductiveConstructor">caseReduceT</a> <a id="2652" class="Bound">ast</a> <a id="2656" class="Bound">ast&#39;</a>
<a id="2661" class="Symbol">...</a>          <a id="2674" class="Symbol">|</a> <a id="2676" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2681" href="VerifiedCompilation.UCaseReduce.html#2681" class="Bound">x</a> <a id="2683" class="Keyword">with</a> <a id="2688" href="VerifiedCompilation.UCaseReduce.html#1984" class="Function">isCaseReduce?</a> <a id="2702" class="Symbol">(</a><a id="2703" href="Untyped.Reduction.html#4232" class="Function">iterApp</a> <a id="2711" href="VerifiedCompilation.UCaseReduce.html#2681" class="Bound">x</a> <a id="2713" class="Bound">vs</a><a id="2715" class="Symbol">)</a> <a id="2717" class="Bound">ast&#39;</a>
<a id="2722" class="Symbol">...</a>                  <a id="2743" class="Symbol">|</a> <a id="2745" href="VerifiedCompilation.Certificate.html#1156" class="InductiveConstructor">proof</a> <a id="2751" href="VerifiedCompilation.UCaseReduce.html#2751" class="Bound">p</a> <a id="2753" class="Symbol">=</a> <a id="2755" href="VerifiedCompilation.Certificate.html#1156" class="InductiveConstructor">proof</a> <a id="2761" class="Symbol">(</a><a id="2762" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="2773" href="VerifiedCompilation.UCaseReduce.html#2548" class="Bound">xv</a> <a id="2776" href="VerifiedCompilation.UCaseReduce.html#2751" class="Bound">p</a><a id="2777" class="Symbol">)</a>
<a id="2779" class="Symbol">...</a>                  <a id="2800" class="Symbol">|</a> <a id="2802" href="VerifiedCompilation.Certificate.html#1188" class="InductiveConstructor">ce</a> <a id="2805" href="VerifiedCompilation.UCaseReduce.html#2805" class="Bound">¬t</a> <a id="2808" href="VerifiedCompilation.UCaseReduce.html#2808" class="Bound">t</a> <a id="2810" href="VerifiedCompilation.UCaseReduce.html#2810" class="Bound">b</a> <a id="2812" href="VerifiedCompilation.UCaseReduce.html#2812" class="Bound">a</a> <a id="2814" class="Symbol">=</a> <a id="2816" href="VerifiedCompilation.Certificate.html#1188" class="InductiveConstructor">ce</a> <a id="2819" class="Symbol">(λ</a> <a id="2822" class="Symbol">{</a> <a id="2824" class="Symbol">(</a><a id="2825" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="2836" href="VerifiedCompilation.UCaseReduce.html#2836" class="Bound">p</a> <a id="2838" href="VerifiedCompilation.UCaseReduce.html#2838" class="Bound">t</a><a id="2839" class="Symbol">)</a> <a id="2841" class="Symbol">→</a> <a id="2843" href="VerifiedCompilation.UCaseReduce.html#2805" class="Bound">¬t</a> <a id="2846" class="Symbol">(</a><a id="2847" href="Relation.Binary.PropositionalEquality.Core.html#1989" class="Function">subst</a> <a id="2853" class="Symbol">(λ</a> <a id="2856" href="VerifiedCompilation.UCaseReduce.html#2856" class="Bound">x</a> <a id="2858" class="Symbol">→</a> <a id="2860" href="VerifiedCompilation.UntypedTranslation.html#1635" class="Datatype">Translation</a> <a id="2872" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="2883" class="Symbol">(</a><a id="2884" href="Untyped.Reduction.html#4232" class="Function">iterApp</a> <a id="2892" href="VerifiedCompilation.UCaseReduce.html#2856" class="Bound">x</a> <a id="2894" class="Bound">vs</a><a id="2896" class="Symbol">)</a> <a id="2898" class="Bound">ast&#39;</a><a id="2902" class="Symbol">)</a> <a id="2904" class="Symbol">(</a><a id="2905" href="VerifiedCompilation.UCaseReduce.html#2096" class="Function">justEq</a> <a id="2912" class="Symbol">(</a><a id="2913" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="2919" class="Symbol">(</a><a id="2920" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2924" href="VerifiedCompilation.UCaseReduce.html#2836" class="Bound">p</a><a id="2925" class="Symbol">)</a> <a id="2927" href="VerifiedCompilation.UCaseReduce.html#2548" class="Bound">xv</a><a id="2929" class="Symbol">))</a> <a id="2932" href="VerifiedCompilation.UCaseReduce.html#2838" class="Bound">t</a><a id="2933" class="Symbol">)})</a> <a id="2937" href="VerifiedCompilation.UCaseReduce.html#2808" class="Bound">t</a> <a id="2939" href="VerifiedCompilation.UCaseReduce.html#2810" class="Bound">b</a> <a id="2941" href="VerifiedCompilation.UCaseReduce.html#2812" class="Bound">a</a>

<a id="2944" href="VerifiedCompilation.UCaseReduce.html#1984" class="Function">isCaseReduce?</a> <a id="2958" class="Symbol">=</a> <a id="2960" href="VerifiedCompilation.UntypedTranslation.html#4081" class="Function">translation?</a> <a id="2973" href="VerifiedCompilation.Certificate.html#797" class="InductiveConstructor">caseReduceT</a> <a id="2985" href="VerifiedCompilation.UCaseReduce.html#2198" class="Function">isCR?</a>

<a id="UCaseReduce"></a><a id="2992" href="VerifiedCompilation.UCaseReduce.html#2992" class="Function">UCaseReduce</a> <a id="3004" class="Symbol">=</a> <a id="3006" href="VerifiedCompilation.UntypedTranslation.html#1635" class="Datatype">Translation</a> <a id="3018" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a>

</pre>
<h2 id="an-example">An Example:</h2>

<p>(program 1.1.0
  (case (constr 1 (con integer 12) (con integer 42)) (lam x (lam y x)) (lam x (lam y (case (constr 0 (con integer 99)) y))) )
)</p>

<p>becomes:</p>

<p>(program 1.1.0 [ (con integer 42) (con integer 99) ])</p>

<p>_Compiler version: _</p>
<pre class="Agda">
</pre>
<p>This simple example applies the rule once, and works</p>
<pre class="Agda">
<a id="ast₁"></a><a id="3347" href="VerifiedCompilation.UCaseReduce.html#3347" class="Function">ast₁</a> <a id="3352" class="Symbol">:</a> <a id="3354" class="Symbol">(</a><a id="3355" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3361" href="Data.Empty.html#914" class="Function">⊥</a><a id="3362" class="Symbol">)</a> <a id="3364" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="3366" href="VerifiedCompilation.UCaseReduce.html#3347" class="Function">ast₁</a> <a id="3371" class="Symbol">=</a> <a id="3373" class="Symbol">(</a><a id="3374" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="3379" class="Symbol">(</a><a id="3380" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="3387" class="Number">0</a> <a id="3389" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3391" class="Symbol">(</a><a id="3392" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3404" class="Number">99</a><a id="3406" class="Symbol">)</a> <a id="3408" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3409" class="Symbol">)</a> <a id="3411" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3413" class="Symbol">(</a><a id="3414" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="3416" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3423" class="Symbol">)</a> <a id="3425" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3426" class="Symbol">)</a>
<a id="ast₁&#39;"></a><a id="3428" href="VerifiedCompilation.UCaseReduce.html#3428" class="Function">ast₁&#39;</a> <a id="3434" class="Symbol">:</a> <a id="3436" class="Symbol">(</a><a id="3437" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3443" href="Data.Empty.html#914" class="Function">⊥</a><a id="3444" class="Symbol">)</a> <a id="3446" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="3448" href="VerifiedCompilation.UCaseReduce.html#3428" class="Function">ast₁&#39;</a> <a id="3454" class="Symbol">=</a> <a id="3456" class="Symbol">((</a><a id="3458" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="3460" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3467" class="Symbol">)</a> <a id="3469" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="3471" class="Symbol">(</a><a id="3472" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3484" class="Number">99</a><a id="3486" class="Symbol">))</a>

<a id="3490" href="VerifiedCompilation.UCaseReduce.html#3490" class="Function">_</a> <a id="3492" class="Symbol">:</a> <a id="3494" href="VerifiedCompilation.UCaseReduce.html#1651" class="Datatype">CaseReduce</a> <a id="3505" href="VerifiedCompilation.UCaseReduce.html#3347" class="Function">ast₁</a> <a id="3510" href="VerifiedCompilation.UCaseReduce.html#3428" class="Function">ast₁&#39;</a>
<a id="3516" class="Symbol">_</a> <a id="3518" class="Symbol">=</a> <a id="3520" href="VerifiedCompilation.UCaseReduce.html#1681" class="InductiveConstructor">casereduce</a> <a id="3531" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3536" href="VerifiedCompilation.UntypedTranslation.html#12691" class="Function">reflexive</a>

</pre>
<p>The longer example definately executes in the compiler, but requires some true β-reduction to make work here.</p>
<pre class="Agda"><a id="ast"></a><a id="3665" href="VerifiedCompilation.UCaseReduce.html#3665" class="Function">ast</a> <a id="3669" class="Symbol">:</a> <a id="3671" href="Data.Empty.html#914" class="Function">⊥</a> <a id="3673" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="3675" href="VerifiedCompilation.UCaseReduce.html#3665" class="Function">ast</a> <a id="3679" class="Symbol">=</a> <a id="3681" class="Symbol">(</a><a id="3682" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="3687" class="Symbol">(</a><a id="3688" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="3695" class="Number">1</a> <a id="3697" class="Symbol">((</a><a id="3699" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3711" class="Number">12</a><a id="3713" class="Symbol">)</a> <a id="3715" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3730" class="Number">42</a><a id="3732" class="Symbol">)</a> <a id="3734" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3736" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3738" class="Symbol">))</a> <a id="3741" class="Symbol">(</a> <a id="3743" class="Symbol">(</a><a id="3744" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="3746" class="Symbol">(</a><a id="3747" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="3749" class="Symbol">(</a><a id="3750" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="3752" class="Symbol">(</a><a id="3753" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3758" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3765" class="Symbol">))))</a> <a id="3770" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="3775" class="Symbol">(</a><a id="3776" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="3778" class="Symbol">(</a><a id="3779" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="3784" class="Symbol">(</a><a id="3785" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="3792" class="Number">0</a> <a id="3794" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3809" class="Number">99</a><a id="3811" class="Symbol">)</a> <a id="3813" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3814" class="Symbol">)</a> <a id="3816" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3818" class="Symbol">(</a><a id="3819" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="3821" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3828" class="Symbol">)</a> <a id="3830" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3831" class="Symbol">)))</a> <a id="3835" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3837" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3839" class="Symbol">)</a> <a id="3841" class="Symbol">)</a>

<a id="ast&#39;"></a><a id="3844" href="VerifiedCompilation.UCaseReduce.html#3844" class="Function">ast&#39;</a> <a id="3849" class="Symbol">:</a> <a id="3851" href="Data.Empty.html#914" class="Function">⊥</a> <a id="3853" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="3855" href="VerifiedCompilation.UCaseReduce.html#3844" class="Function">ast&#39;</a> <a id="3860" class="Symbol">=</a> <a id="3862" class="Symbol">((</a><a id="3864" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3876" class="Number">42</a><a id="3878" class="Symbol">)</a> <a id="3880" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="3882" class="Symbol">(</a><a id="3883" href="Untyped.html#7790" class="Function">con-integer</a> <a id="3895" class="Number">99</a><a id="3897" class="Symbol">))</a>

<a id="3901" class="Comment">{-
_ : CaseReduce ast ast&#39;
_ = casereduce refl {!!}
-- This would require unpacking the meaning of the lambdas and applications, not just the AST,
-- so is beyond the scope of this translation relation.
-}</a>

</pre>
<h2 id="semantic-equivalence">Semantic Equivalence</h2>

<pre class="Agda"><a id="4141" class="Keyword">open</a> <a id="4146" class="Keyword">import</a> <a id="4153" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="4165" class="Keyword">using</a> <a id="4171" class="Symbol">(</a><a id="4172" href="Untyped.CEK.html#24578" class="Function">stepper</a><a id="4179" class="Symbol">;</a> <a id="4181" href="Untyped.CEK.html#22183" class="Function">step</a><a id="4185" class="Symbol">)</a>
<a id="4187" class="Keyword">open</a> <a id="4192" class="Keyword">import</a> <a id="4199" href="Builtin.html" class="Module">Builtin</a> <a id="4207" class="Keyword">using</a> <a id="4213" class="Symbol">(</a><a id="4214" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="4221" class="Symbol">;</a> <a id="4223" href="Builtin.html#1470" class="InductiveConstructor">addInteger</a><a id="4233" class="Symbol">;</a> <a id="4235" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4250" class="Symbol">)</a>

<a id="ex1"></a><a id="4253" href="VerifiedCompilation.UCaseReduce.html#4253" class="Function">ex1</a> <a id="4257" class="Symbol">:</a> <a id="4259" href="Data.Empty.html#914" class="Function">⊥</a> <a id="4261" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="4263" href="VerifiedCompilation.UCaseReduce.html#4253" class="Function">ex1</a> <a id="4267" class="Symbol">=</a> <a id="4269" class="Symbol">(((</a><a id="4272" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="4274" class="Symbol">(</a><a id="4275" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="4277" class="Symbol">(((</a><a id="4280" href="Untyped.html#1923" class="InductiveConstructor">builtin</a> <a id="4288" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4303" class="Symbol">)</a> <a id="4305" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4307" class="Symbol">(</a><a id="4308" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="4310" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4317" class="Symbol">))</a> <a id="4320" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4322" class="Symbol">(</a><a id="4323" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="4325" class="Symbol">(</a><a id="4326" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4331" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4338" class="Symbol">))))))</a> <a id="4345" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4347" class="Symbol">(</a><a id="4348" href="Untyped.html#7790" class="Function">con-integer</a> <a id="4360" class="Number">2</a><a id="4361" class="Symbol">))</a> <a id="4364" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4366" class="Symbol">(</a><a id="4367" href="Untyped.html#7790" class="Function">con-integer</a> <a id="4379" class="Number">3</a><a id="4380" class="Symbol">)</a> <a id="4382" class="Comment">--- \× . \y . x - y ==&gt;  2 - 3</a>

<a id="ex2"></a><a id="4414" href="VerifiedCompilation.UCaseReduce.html#4414" class="Function">ex2</a> <a id="4418" class="Symbol">:</a> <a id="4420" href="Data.Empty.html#914" class="Function">⊥</a> <a id="4422" href="Untyped.html#1677" class="Datatype Operator">⊢</a>
<a id="4424" href="VerifiedCompilation.UCaseReduce.html#4414" class="Function">ex2</a> <a id="4428" class="Symbol">=</a> <a id="4430" class="Symbol">(((</a><a id="4433" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="4435" class="Symbol">(</a><a id="4436" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="4438" class="Symbol">(((</a><a id="4441" href="Untyped.html#1923" class="InductiveConstructor">builtin</a> <a id="4449" href="Builtin.html#1514" class="InductiveConstructor">subtractInteger</a><a id="4464" class="Symbol">)</a> <a id="4466" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4468" class="Symbol">(</a><a id="4469" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="4471" class="Symbol">(</a><a id="4472" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4477" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4484" class="Symbol">)))</a> <a id="4488" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4490" class="Symbol">(</a><a id="4491" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="4493" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4500" class="Symbol">)))))</a> <a id="4506" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4508" class="Symbol">(</a><a id="4509" href="Untyped.html#7790" class="Function">con-integer</a> <a id="4521" class="Number">3</a><a id="4522" class="Symbol">))</a> <a id="4525" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="4527" class="Symbol">(</a><a id="4528" href="Untyped.html#7790" class="Function">con-integer</a> <a id="4540" class="Number">2</a><a id="4541" class="Symbol">)</a> <a id="4543" class="Comment">--- \x . \y . y - x ==&gt; 2 - 3</a>

</pre>

    </section>
  </body>
</html>
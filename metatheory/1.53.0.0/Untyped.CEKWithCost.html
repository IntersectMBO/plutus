<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CEK Machine with Costs</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>CEK Machine with Costs</h1>
    <section>
      <h1 id="cek-machine-with-costs">CEK Machine with costs</h1>

<p>This module implements a CEK machine for UPLC which computes costs.</p>

<pre class="Agda"><a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Cost.Base.html" class="Module">Cost.Base</a>

<a id="174" class="Keyword">module</a> <a id="181" href="Untyped.CEKWithCost.html" class="Module">Untyped.CEKWithCost</a> <a id="201" class="Symbol">{</a><a id="202" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a> <a id="209" class="Symbol">:</a> <a id="211" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="214" class="Symbol">}(</a><a id="216" href="Untyped.CEKWithCost.html#216" class="Bound">machineParameters</a> <a id="234" class="Symbol">:</a> <a id="236" href="Cost.Base.html#2053" class="Record">MachineParameters</a> <a id="254" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a><a id="260" class="Symbol">)</a> <a id="262" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="319" class="Symbol">;</a><a id="320" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="322" class="Symbol">)</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="353" class="Symbol">;</a><a id="354" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="358" class="Symbol">;</a><a id="359" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.List.html" class="Module">Data.List</a> <a id="386" class="Keyword">using</a> <a id="392" class="Symbol">(</a><a id="393" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="397" class="Symbol">;</a><a id="398" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="400" class="Symbol">;</a><a id="401" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="404" class="Symbol">)</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">(</a><a id="434" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a><a id="437" class="Symbol">;</a><a id="438" href="Data.Vec.Base.html#1155" class="InductiveConstructor">[]</a><a id="440" class="Symbol">;</a><a id="441" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">_∷_</a><a id="444" class="Symbol">;</a><a id="445" href="Data.Vec.Base.html#8862" class="Function">reverse</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Product.html" class="Module">Data.Product</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="489" class="Symbol">)</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="541" class="Keyword">using</a> <a id="547" class="Symbol">(</a><a id="548" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="551" class="Symbol">;</a><a id="552" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="556" class="Symbol">;</a><a id="557" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="560" class="Symbol">)</a>

<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Untyped.html" class="Module">Untyped</a> <a id="583" class="Keyword">using</a> <a id="589" class="Symbol">(</a><a id="590" href="Untyped.html#1677" class="Datatype Operator">_⊢</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" href="Untyped.html#1677" class="Module Operator">_⊢</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Utils.html" class="Module">Utils</a> <a id="620" class="Keyword">using</a> <a id="626" class="Symbol">(</a><a id="627" href="Utils.html#3956" class="Record">Writer</a><a id="633" class="Symbol">;</a><a id="634" href="Utils.html#2989" class="Function Operator">_&gt;&gt;_</a><a id="638" class="Symbol">;</a><a id="639" href="Utils.html#2945" class="Field Operator">_&gt;&gt;=_</a><a id="644" class="Symbol">;</a><a id="645" href="Utils.html#2917" class="Field">return</a><a id="651" class="Symbol">;</a><a id="652" href="Data.Maybe.Base.html#1276" class="Function">maybe</a><a id="657" class="Symbol">;</a><a id="658" href="Utils.html#1133" class="Datatype">Either</a><a id="664" class="Symbol">;</a><a id="665" href="Utils.html#1166" class="InductiveConstructor">inj₁</a><a id="669" class="Symbol">;</a><a id="670" href="Utils.html#1190" class="InductiveConstructor">inj₂</a><a id="674" class="Symbol">;</a><a id="675" href="Utils.html#4363" class="Datatype">RuntimeError</a><a id="687" class="Symbol">;</a><a id="688" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="696" class="Symbol">;</a><a id="697" href="Utils.html#1270" class="Function">either</a><a id="703" class="Symbol">;</a><a id="704" href="Utils.html#2197" class="Datatype Operator">_∔_≣_</a><a id="709" class="Symbol">)</a>
<a id="711" class="Keyword">open</a> <a id="716" href="Utils.html#3956" class="Module">Writer</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="RawU.html" class="Module">RawU</a> <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="RawU.html#8032" class="InductiveConstructor">tmCon</a><a id="752" class="Symbol">)</a>
<a id="754" class="Keyword">open</a> <a id="759" class="Keyword">import</a> <a id="766" href="Builtin.html" class="Module">Builtin</a> <a id="774" class="Keyword">using</a> <a id="780" class="Symbol">(</a><a id="781" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="788" class="Symbol">;</a><a id="789" href="Builtin.html#16778" class="Function">arity</a><a id="794" class="Symbol">;</a><a id="795" href="Builtin.html#8333" class="Function">signature</a><a id="804" class="Symbol">)</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="836" class="Keyword">using</a> <a id="842" class="Symbol">(</a><a id="843" href="Builtin.Signature.html#4020" class="Function">fv</a><a id="845" class="Symbol">;</a><a id="846" href="Builtin.Signature.html#3918" class="Function">args♯</a><a id="851" class="Symbol">)</a>

<a id="854" class="Keyword">open</a> <a id="859" href="Cost.Base.html#898" class="Module">StepKind</a>
<a id="868" class="Keyword">open</a> <a id="873" href="Cost.Base.html#1635" class="Module">ExBudgetCategory</a>

<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Untyped.CEK.html" class="Module">Untyped.CEK</a>

</pre>
<h2 id="cost-monad">Cost Monad</h2>

<p>We instantiate a Writer Monad with the operations from the machine parameters</p>

<pre class="Agda"><a id="1020" class="Keyword">open</a> <a id="1025" href="Cost.Base.html#2053" class="Module">MachineParameters</a> <a id="1043" href="Untyped.CEKWithCost.html#216" class="Bound">machineParameters</a> <a id="1061" class="Keyword">renaming</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Cost.Base.html#2159" class="Field">ε</a> <a id="1073" class="Symbol">to</a> <a id="1076" class="Field">e</a><a id="1077" class="Symbol">)</a>
<a id="1079" class="Keyword">open</a> <a id="1084" href="Utils.html#4062" class="Module">Utils.WriterMonad</a> <a id="1102" href="Untyped.CEKWithCost.html#1076" class="Field">e</a> <a id="1104" href="Cost.Base.html#2174" class="Field Operator">_∙_</a>

<a id="CekM"></a><a id="1109" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1114" class="Symbol">:</a> <a id="1116" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1126" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1131" class="Symbol">=</a> <a id="1133" href="Utils.html#3956" class="Record">Writer</a> <a id="1140" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a>
</pre>
<h3 id="spending-operations">Spending operations</h3>

<p>As opposed to the production implemention, our <code class="language-plaintext highlighter-rouge">spend</code> function does not implement slippage.
Slippage is an optimization that allows the interpreter to only add costs every n steps.
Slippage is only semantically relevant in restricting mode (not currently implemented in agda),
so we do not need to consider it here.</p>

<pre class="Agda"><a id="spend"></a><a id="1499" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Cost.Base.html#898" class="Datatype">StepKind</a> <a id="1516" class="Symbol">→</a> <a id="1518" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1523" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1525" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="1531" href="Untyped.CEKWithCost.html#1531" class="Bound">st</a> <a id="1534" class="Symbol">=</a> <a id="1536" href="Utils.html#4277" class="Function">tell</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Cost.Base.html#2112" class="Field">cekMachineCost</a> <a id="1557" class="Symbol">(</a><a id="1558" href="Cost.Base.html#1711" class="InductiveConstructor">BStep</a> <a id="1564" href="Untyped.CEKWithCost.html#1531" class="Bound">st</a><a id="1566" class="Symbol">))</a>

<a id="spendStartupCost"></a><a id="1570" href="Untyped.CEKWithCost.html#1570" class="Function">spendStartupCost</a> <a id="1587" class="Symbol">:</a> <a id="1589" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1594" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1596" href="Untyped.CEKWithCost.html#1570" class="Function">spendStartupCost</a> <a id="1613" class="Symbol">=</a> <a id="1615" href="Utils.html#4277" class="Function">tell</a> <a id="1620" href="Cost.Base.html#2242" class="Function">startupCost</a>
</pre>
<p>In order to calculate the cost of executing a builtin, we obtain a vector with
the size of each constant argument using <code class="language-plaintext highlighter-rouge">extractArgSizes</code>.</p>

<p>Non-constant argument should only occur in places where the builtin is polymorphic
and should be ignored by the cost model of the corresponding builtin. Therefore,
they are added with a size of 0.</p>

<p>The function <code class="language-plaintext highlighter-rouge">extractArgSizes</code> get the arguments in inverse order, so we reverse
them in the <code class="language-plaintext highlighter-rouge">spendBuiltin</code> function.</p>

<pre class="Agda"><a id="extractConstants"></a><a id="2098" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2115" class="Symbol">:</a> <a id="2117" class="Symbol">∀{</a><a id="2119" href="Untyped.CEKWithCost.html#2119" class="Bound">b</a><a id="2120" class="Symbol">}</a>
          <a id="2132" class="Symbol">→</a> <a id="2134" class="Symbol">∀{</a><a id="2136" href="Untyped.CEKWithCost.html#2136" class="Bound">tn</a> <a id="2139" href="Untyped.CEKWithCost.html#2139" class="Bound">tm</a><a id="2141" class="Symbol">}</a> <a id="2143" class="Symbol">→</a> <a id="2145" class="Symbol">{</a><a id="2146" href="Untyped.CEKWithCost.html#2146" class="Bound">pt</a> <a id="2149" class="Symbol">:</a> <a id="2151" href="Untyped.CEKWithCost.html#2136" class="Bound">tn</a> <a id="2154" href="Utils.html#2197" class="Datatype Operator">∔</a> <a id="2156" href="Untyped.CEKWithCost.html#2139" class="Bound">tm</a> <a id="2159" href="Utils.html#2197" class="Datatype Operator">≣</a> <a id="2161" href="Builtin.Signature.html#4020" class="Function">fv</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Builtin.html#8333" class="Function">signature</a> <a id="2175" href="Untyped.CEKWithCost.html#2119" class="Bound">b</a><a id="2176" class="Symbol">)}</a>
          <a id="2189" class="Symbol">→</a> <a id="2191" class="Symbol">∀{</a><a id="2193" href="Untyped.CEKWithCost.html#2193" class="Bound">an</a> <a id="2196" href="Untyped.CEKWithCost.html#2196" class="Bound">am</a><a id="2198" class="Symbol">}</a> <a id="2200" class="Symbol">→</a> <a id="2202" class="Symbol">{</a><a id="2203" href="Untyped.CEKWithCost.html#2203" class="Bound">pa</a> <a id="2206" class="Symbol">:</a> <a id="2208" href="Untyped.CEKWithCost.html#2193" class="Bound">an</a> <a id="2211" href="Utils.html#2197" class="Datatype Operator">∔</a> <a id="2213" href="Untyped.CEKWithCost.html#2196" class="Bound">am</a> <a id="2216" href="Utils.html#2197" class="Datatype Operator">≣</a> <a id="2218" href="Builtin.Signature.html#3918" class="Function">args♯</a> <a id="2224" class="Symbol">(</a><a id="2225" href="Builtin.html#8333" class="Function">signature</a> <a id="2235" href="Untyped.CEKWithCost.html#2119" class="Bound">b</a><a id="2236" class="Symbol">)}</a>
          <a id="2249" class="Symbol">→</a> <a id="2251" href="Untyped.CEK.html#1447" class="Datatype">BApp</a> <a id="2256" href="Untyped.CEKWithCost.html#2119" class="Bound">b</a> <a id="2258" href="Untyped.CEKWithCost.html#2146" class="Bound">pt</a> <a id="2261" href="Untyped.CEKWithCost.html#2203" class="Bound">pa</a> <a id="2264" class="Symbol">→</a> <a id="2266" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="2270" href="Untyped.CEK.html#1344" class="Datatype">Value</a> <a id="2276" href="Untyped.CEKWithCost.html#2193" class="Bound">an</a>
<a id="2279" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2296" href="Untyped.CEK.html#2086" class="InductiveConstructor">base</a> <a id="2301" class="Symbol">=</a> <a id="2303" href="Data.Vec.Base.html#1155" class="InductiveConstructor">[]</a>
<a id="2306" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Untyped.CEK.html#2159" class="InductiveConstructor">app</a> <a id="2328" href="Untyped.CEKWithCost.html#2328" class="Bound">bapp</a> <a id="2333" href="Untyped.CEKWithCost.html#2333" class="Bound">v</a><a id="2334" class="Symbol">)</a> <a id="2336" class="Symbol">=</a> <a id="2338" href="Untyped.CEKWithCost.html#2333" class="Bound">v</a> <a id="2340" href="Data.Vec.Base.html#1174" class="InductiveConstructor Operator">∷</a> <a id="2342" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2359" href="Untyped.CEKWithCost.html#2328" class="Bound">bapp</a>
<a id="2364" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2381" class="Symbol">(</a><a id="2382" href="Untyped.CEK.html#2326" class="InductiveConstructor">app⋆</a> <a id="2387" href="Untyped.CEKWithCost.html#2387" class="Bound">bapp</a><a id="2391" class="Symbol">)</a> <a id="2393" class="Symbol">=</a> <a id="2395" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2412" href="Untyped.CEKWithCost.html#2387" class="Bound">bapp</a>

<a id="spendBuiltin"></a><a id="2418" href="Untyped.CEKWithCost.html#2418" class="Function">spendBuiltin</a> <a id="2431" class="Symbol">:</a> <a id="2433" class="Symbol">(</a><a id="2434" href="Untyped.CEKWithCost.html#2434" class="Bound">b</a> <a id="2436" class="Symbol">:</a> <a id="2438" href="Builtin.html#1434" class="Datatype">Builtin</a><a id="2445" class="Symbol">)</a> <a id="2447" class="Symbol">→</a> <a id="2449" href="Untyped.CEK.html#4137" class="Function">fullyAppliedBuiltin</a> <a id="2469" href="Untyped.CEKWithCost.html#2434" class="Bound">b</a> <a id="2471" class="Symbol">→</a> <a id="2473" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="2478" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2480" href="Untyped.CEKWithCost.html#2418" class="Function">spendBuiltin</a> <a id="2493" href="Untyped.CEKWithCost.html#2493" class="Bound">b</a> <a id="2495" href="Untyped.CEKWithCost.html#2495" class="Bound">bapp</a> <a id="2500" class="Symbol">=</a> <a id="2502" href="Utils.html#4277" class="Function">tell</a> <a id="2507" class="Symbol">(</a><a id="2508" href="Cost.Base.html#2112" class="Field">cekMachineCost</a> <a id="2523" class="Symbol">(</a><a id="2524" href="Cost.Base.html#1818" class="InductiveConstructor">BBuiltinApp</a> <a id="2536" href="Untyped.CEKWithCost.html#2493" class="Bound">b</a> <a id="2538" href="Untyped.CEKWithCost.html#2560" class="Function">argsizes</a><a id="2546" class="Symbol">))</a>
     <a id="2554" class="Keyword">where</a> <a id="2560" href="Untyped.CEKWithCost.html#2560" class="Function">argsizes</a> <a id="2569" class="Symbol">=</a> <a id="2571" href="Data.Vec.Base.html#8862" class="Function">reverse</a> <a id="2579" class="Symbol">(</a><a id="2580" href="Untyped.CEKWithCost.html#2098" class="Function">extractConstants</a> <a id="2597" href="Untyped.CEKWithCost.html#2495" class="Bound">bapp</a><a id="2601" class="Symbol">)</a>
</pre>
<h2 id="step-with-costs">Step with costs</h2>

<p>Function <code class="language-plaintext highlighter-rouge">step</code> performs a single step in the CEK machine.</p>

<pre class="Agda"><a id="stepC"></a><a id="2692" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="2698" class="Symbol">:</a> <a id="2700" href="Untyped.CEK.html#3620" class="Datatype">State</a> <a id="2706" class="Symbol">→</a> <a id="2708" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="2713" href="Untyped.CEK.html#3620" class="Datatype">State</a>
<a id="2719" class="Comment">-- computeCEK in the Haskell implementation</a>
<a id="2763" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="2769" class="Symbol">(</a><a id="2770" href="Untyped.CEKWithCost.html#2770" class="Bound">s</a> <a id="2772" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="2774" href="Untyped.CEKWithCost.html#2774" class="Bound">ρ</a> <a id="2776" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="2778" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="2780" href="Untyped.CEKWithCost.html#2780" class="Bound">x</a><a id="2781" class="Symbol">)</a>               <a id="2797" class="Symbol">=</a> <a id="2799" class="Keyword">do</a>
    <a id="2806" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="2812" href="Cost.Base.html#936" class="InductiveConstructor">BVar</a>
    <a id="2821" href="Utils.html#2917" class="Field">return</a> <a id="2828" class="Symbol">(</a><a id="2829" href="Untyped.CEKWithCost.html#2770" class="Bound">s</a> <a id="2831" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="2833" href="Untyped.CEK.html#3820" class="Function">lookup</a> <a id="2840" href="Untyped.CEKWithCost.html#2774" class="Bound">ρ</a> <a id="2842" href="Untyped.CEKWithCost.html#2780" class="Bound">x</a><a id="2843" class="Symbol">)</a>
<a id="2845" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="2851" class="Symbol">(</a><a id="2852" href="Untyped.CEKWithCost.html#2852" class="Bound">s</a> <a id="2854" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="2856" href="Untyped.CEKWithCost.html#2856" class="Bound">ρ</a> <a id="2858" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="2860" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="2862" href="Untyped.CEKWithCost.html#2862" class="Bound">t</a><a id="2863" class="Symbol">)</a>               <a id="2879" class="Symbol">=</a> <a id="2881" class="Keyword">do</a>
    <a id="2888" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="2894" href="Cost.Base.html#947" class="InductiveConstructor">BLamAbs</a>
    <a id="2906" href="Utils.html#2917" class="Field">return</a> <a id="2913" class="Symbol">(</a><a id="2914" href="Untyped.CEKWithCost.html#2852" class="Bound">s</a> <a id="2916" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="2918" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="2922" href="Untyped.CEKWithCost.html#2856" class="Bound">ρ</a> <a id="2924" href="Untyped.CEKWithCost.html#2862" class="Bound">t</a><a id="2925" class="Symbol">)</a>
<a id="2927" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="2933" class="Symbol">(</a><a id="2934" href="Untyped.CEKWithCost.html#2934" class="Bound">s</a> <a id="2936" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="2938" href="Untyped.CEKWithCost.html#2938" class="Bound">ρ</a> <a id="2940" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Untyped.CEKWithCost.html#2943" class="Bound">t</a> <a id="2945" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="2947" href="Untyped.CEKWithCost.html#2947" class="Bound">u</a><a id="2948" class="Symbol">))</a>           <a id="2961" class="Symbol">=</a> <a id="2963" class="Keyword">do</a>
    <a id="2970" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="2976" href="Cost.Base.html#961" class="InductiveConstructor">BApply</a>
    <a id="2987" href="Utils.html#2917" class="Field">return</a> <a id="2994" class="Symbol">((</a><a id="2996" href="Untyped.CEKWithCost.html#2934" class="Bound">s</a> <a id="2998" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3000" href="Untyped.CEK.html#3403" class="InductiveConstructor">-·</a> <a id="3003" href="Untyped.CEKWithCost.html#2938" class="Bound">ρ</a> <a id="3005" href="Untyped.CEKWithCost.html#2947" class="Bound">u</a><a id="3006" class="Symbol">)</a> <a id="3008" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3010" href="Untyped.CEKWithCost.html#2938" class="Bound">ρ</a> <a id="3012" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3014" href="Untyped.CEKWithCost.html#2943" class="Bound">t</a><a id="3015" class="Symbol">)</a>
<a id="3017" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3023" class="Symbol">(</a><a id="3024" href="Untyped.CEKWithCost.html#3024" class="Bound">s</a> <a id="3026" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3028" href="Untyped.CEKWithCost.html#3028" class="Bound">ρ</a> <a id="3030" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3032" href="Untyped.html#1768" class="InductiveConstructor">force</a> <a id="3038" href="Untyped.CEKWithCost.html#3038" class="Bound">t</a><a id="3039" class="Symbol">)</a>           <a id="3051" class="Symbol">=</a> <a id="3053" class="Keyword">do</a>
    <a id="3060" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3066" href="Cost.Base.html#987" class="InductiveConstructor">BForce</a>
    <a id="3077" href="Utils.html#2917" class="Field">return</a> <a id="3084" class="Symbol">((</a><a id="3086" href="Untyped.CEKWithCost.html#3024" class="Bound">s</a> <a id="3088" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3090" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="3096" class="Symbol">)</a> <a id="3098" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3100" href="Untyped.CEKWithCost.html#3028" class="Bound">ρ</a> <a id="3102" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3104" href="Untyped.CEKWithCost.html#3038" class="Bound">t</a><a id="3105" class="Symbol">)</a>
<a id="3107" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3113" class="Symbol">(</a><a id="3114" href="Untyped.CEKWithCost.html#3114" class="Bound">s</a> <a id="3116" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3118" href="Untyped.CEKWithCost.html#3118" class="Bound">ρ</a> <a id="3120" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3122" href="Untyped.html#1788" class="InductiveConstructor">delay</a> <a id="3128" href="Untyped.CEKWithCost.html#3128" class="Bound">t</a><a id="3129" class="Symbol">)</a>           <a id="3141" class="Symbol">=</a> <a id="3143" class="Keyword">do</a>
    <a id="3150" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3156" href="Cost.Base.html#974" class="InductiveConstructor">BDelay</a>
    <a id="3167" href="Utils.html#2917" class="Field">return</a> <a id="3174" class="Symbol">(</a><a id="3175" href="Untyped.CEKWithCost.html#3114" class="Bound">s</a> <a id="3177" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3179" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="3187" href="Untyped.CEKWithCost.html#3118" class="Bound">ρ</a> <a id="3189" href="Untyped.CEKWithCost.html#3128" class="Bound">t</a><a id="3190" class="Symbol">)</a>
<a id="3192" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3198" class="Symbol">(</a><a id="3199" href="Untyped.CEKWithCost.html#3199" class="Bound">s</a> <a id="3201" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3203" href="Untyped.CEKWithCost.html#3203" class="Bound">ρ</a> <a id="3205" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3207" href="Untyped.html#1808" class="InductiveConstructor">con</a> <a id="3211" class="Symbol">(</a><a id="3212" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="3218" href="Untyped.CEKWithCost.html#3218" class="Bound">t</a> <a id="3220" href="Untyped.CEKWithCost.html#3220" class="Bound">c</a><a id="3221" class="Symbol">))</a>   <a id="3226" class="Symbol">=</a> <a id="3228" class="Keyword">do</a>
    <a id="3235" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3241" href="Cost.Base.html#923" class="InductiveConstructor">BConst</a>
    <a id="3252" href="Utils.html#2917" class="Field">return</a> <a id="3259" class="Symbol">(</a><a id="3260" href="Untyped.CEKWithCost.html#3199" class="Bound">s</a> <a id="3262" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3264" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="3270" href="Untyped.CEKWithCost.html#3218" class="Bound">t</a> <a id="3272" href="Untyped.CEKWithCost.html#3220" class="Bound">c</a><a id="3273" class="Symbol">)</a>
<a id="3275" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3281" class="Symbol">(</a><a id="3282" href="Untyped.CEKWithCost.html#3282" class="Bound">s</a> <a id="3284" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3286" href="Untyped.CEKWithCost.html#3286" class="Bound">ρ</a> <a id="3288" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3290" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="3297" href="Untyped.CEKWithCost.html#3297" class="Bound">i</a> <a id="3299" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3301" class="Symbol">)</a>       <a id="3309" class="Symbol">=</a> <a id="3311" class="Keyword">do</a>
    <a id="3318" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3324" href="Cost.Base.html#1081" class="InductiveConstructor">BConstr</a>
    <a id="3336" href="Utils.html#2917" class="Field">return</a> <a id="3343" class="Symbol">(</a><a id="3344" href="Untyped.CEKWithCost.html#3282" class="Bound">s</a> <a id="3346" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3348" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="3357" href="Untyped.CEKWithCost.html#3297" class="Bound">i</a> <a id="3359" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a><a id="3360" class="Symbol">)</a>
<a id="3362" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3368" class="Symbol">(</a><a id="3369" href="Untyped.CEKWithCost.html#3369" class="Bound">s</a> <a id="3371" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3373" href="Untyped.CEKWithCost.html#3373" class="Bound">ρ</a> <a id="3375" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3377" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="3384" href="Untyped.CEKWithCost.html#3384" class="Bound">i</a> <a id="3386" class="Symbol">(</a><a id="3387" href="Untyped.CEKWithCost.html#3387" class="Bound">x</a> <a id="3389" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3391" href="Untyped.CEKWithCost.html#3391" class="Bound">xs</a><a id="3393" class="Symbol">))</a> <a id="3396" class="Symbol">=</a> <a id="3398" class="Keyword">do</a>
    <a id="3405" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3411" href="Cost.Base.html#1081" class="InductiveConstructor">BConstr</a>
    <a id="3423" href="Utils.html#2917" class="Field">return</a> <a id="3430" class="Symbol">((</a><a id="3432" href="Untyped.CEKWithCost.html#3369" class="Bound">s</a> <a id="3434" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3436" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="3444" href="Untyped.CEKWithCost.html#3384" class="Bound">i</a> <a id="3446" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="3448" href="Untyped.CEKWithCost.html#3373" class="Bound">ρ</a> <a id="3450" href="Untyped.CEKWithCost.html#3391" class="Bound">xs</a><a id="3452" class="Symbol">)</a><a id="3453" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3455" href="Untyped.CEKWithCost.html#3373" class="Bound">ρ</a> <a id="3457" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3459" href="Untyped.CEKWithCost.html#3387" class="Bound">x</a><a id="3460" class="Symbol">)</a>
<a id="3462" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3468" class="Symbol">(</a><a id="3469" href="Untyped.CEKWithCost.html#3469" class="Bound">s</a> <a id="3471" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3473" href="Untyped.CEKWithCost.html#3473" class="Bound">ρ</a> <a id="3475" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3477" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="3482" href="Untyped.CEKWithCost.html#3482" class="Bound">t</a> <a id="3484" href="Untyped.CEKWithCost.html#3484" class="Bound">ts</a><a id="3486" class="Symbol">)</a>         <a id="3496" class="Symbol">=</a> <a id="3498" class="Keyword">do</a>
    <a id="3505" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3511" href="Cost.Base.html#1095" class="InductiveConstructor">BCase</a>
    <a id="3521" href="Utils.html#2917" class="Field">return</a> <a id="3528" class="Symbol">((</a><a id="3530" href="Untyped.CEKWithCost.html#3469" class="Bound">s</a> <a id="3532" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3534" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="3540" href="Untyped.CEKWithCost.html#3473" class="Bound">ρ</a> <a id="3542" href="Untyped.CEKWithCost.html#3484" class="Bound">ts</a><a id="3544" class="Symbol">)</a> <a id="3546" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3548" href="Untyped.CEKWithCost.html#3473" class="Bound">ρ</a> <a id="3550" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3552" href="Untyped.CEKWithCost.html#3482" class="Bound">t</a><a id="3553" class="Symbol">)</a>
<a id="3555" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3561" class="Symbol">(</a><a id="3562" href="Untyped.CEKWithCost.html#3562" class="Bound">s</a> <a id="3564" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3566" href="Untyped.CEKWithCost.html#3566" class="Bound">ρ</a> <a id="3568" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3570" href="Untyped.html#1923" class="InductiveConstructor">builtin</a> <a id="3578" href="Untyped.CEKWithCost.html#3578" class="Bound">b</a><a id="3579" class="Symbol">)</a>         <a id="3589" class="Symbol">=</a> <a id="3591" class="Keyword">do</a>
    <a id="3598" href="Untyped.CEKWithCost.html#1499" class="Function">spend</a> <a id="3604" href="Cost.Base.html#1000" class="InductiveConstructor">BBuiltin</a>
    <a id="3617" href="Utils.html#2917" class="Field">return</a> <a id="3624" class="Symbol">(</a><a id="3625" href="Untyped.CEKWithCost.html#3562" class="Bound">s</a> <a id="3627" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3629" href="Untyped.CEK.html#21656" class="Function">ival</a> <a id="3634" href="Untyped.CEKWithCost.html#3578" class="Bound">b</a><a id="3635" class="Symbol">)</a>
<a id="3637" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3643" class="Symbol">(</a><a id="3644" href="Untyped.CEKWithCost.html#3644" class="Bound">s</a> <a id="3646" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3648" href="Untyped.CEKWithCost.html#3648" class="Bound">ρ</a> <a id="3650" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3652" href="Untyped.html#1955" class="InductiveConstructor">error</a><a id="3657" class="Symbol">)</a>             <a id="3671" class="Symbol">=</a> <a id="3673" href="Utils.html#2917" class="Field">return</a> <a id="3680" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>

<a id="3683" class="Comment">-- return∁EK in the Haskell implementation</a>
<a id="3726" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3732" class="Symbol">(</a><a id="3733" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="3735" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3737" href="Untyped.CEKWithCost.html#3737" class="Bound">v</a><a id="3738" class="Symbol">)</a>                               <a id="3770" class="Symbol">=</a> <a id="3772" href="Utils.html#2917" class="Field">return</a> <a id="3779" class="Symbol">(</a><a id="3780" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="3782" href="Untyped.CEKWithCost.html#3737" class="Bound">v</a><a id="3783" class="Symbol">)</a>
<a id="3785" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3791" class="Symbol">((</a><a id="3793" href="Untyped.CEKWithCost.html#3793" class="Bound">s</a> <a id="3795" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3797" href="Untyped.CEK.html#3403" class="InductiveConstructor">-·</a> <a id="3800" href="Untyped.CEKWithCost.html#3800" class="Bound">ρ</a> <a id="3802" href="Untyped.CEKWithCost.html#3802" class="Bound">u</a><a id="3803" class="Symbol">)</a> <a id="3805" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3807" href="Untyped.CEKWithCost.html#3807" class="Bound">v</a><a id="3808" class="Symbol">)</a>                    <a id="3829" class="Symbol">=</a> <a id="3831" href="Utils.html#2917" class="Field">return</a> <a id="3838" class="Symbol">((</a><a id="3840" href="Untyped.CEKWithCost.html#3793" class="Bound">s</a> <a id="3842" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3844" class="Symbol">(</a><a id="3845" href="Untyped.CEKWithCost.html#3807" class="Bound">v</a> <a id="3847" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="3849" class="Symbol">))</a> <a id="3852" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3854" href="Untyped.CEKWithCost.html#3800" class="Bound">ρ</a> <a id="3856" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3858" href="Untyped.CEKWithCost.html#3802" class="Bound">u</a><a id="3859" class="Symbol">)</a>
<a id="3861" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3867" class="Symbol">((</a><a id="3869" href="Untyped.CEKWithCost.html#3869" class="Bound">s</a> <a id="3871" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3873" href="Untyped.CEK.html#3438" class="InductiveConstructor">-·v</a> <a id="3877" href="Untyped.CEKWithCost.html#3877" class="Bound">v</a><a id="3878" class="Symbol">)</a> <a id="3880" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3882" href="Untyped.CEKWithCost.html#3882" class="Bound">vf</a><a id="3884" class="Symbol">)</a>                    <a id="3905" class="Symbol">=</a> <a id="3907" href="Utils.html#2917" class="Field">return</a> <a id="3914" class="Symbol">((</a><a id="3916" href="Untyped.CEKWithCost.html#3869" class="Bound">s</a> <a id="3918" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3920" href="Untyped.CEKWithCost.html#3882" class="Bound">vf</a> <a id="3923" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="3925" class="Symbol">)</a> <a id="3927" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3929" href="Untyped.CEKWithCost.html#3877" class="Bound">v</a><a id="3930" class="Symbol">)</a>
<a id="3932" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="3938" class="Symbol">((</a><a id="3940" href="Untyped.CEKWithCost.html#3940" class="Bound">s</a> <a id="3942" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="3949" href="Untyped.CEKWithCost.html#3949" class="Bound">ρ</a> <a id="3951" href="Untyped.CEKWithCost.html#3951" class="Bound">t</a> <a id="3953" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="3955" class="Symbol">))</a> <a id="3958" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="3960" href="Untyped.CEKWithCost.html#3960" class="Bound">v</a><a id="3961" class="Symbol">)</a>              <a id="3976" class="Symbol">=</a> <a id="3978" href="Utils.html#2917" class="Field">return</a> <a id="3985" class="Symbol">(</a><a id="3986" href="Untyped.CEKWithCost.html#3940" class="Bound">s</a> <a id="3988" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="3990" href="Untyped.CEKWithCost.html#3949" class="Bound">ρ</a> <a id="3992" href="Untyped.CEK.html#1398" class="InductiveConstructor Operator">∷</a> <a id="3994" href="Untyped.CEKWithCost.html#3960" class="Bound">v</a> <a id="3996" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="3998" href="Untyped.CEKWithCost.html#3951" class="Bound">t</a><a id="3999" class="Symbol">)</a>
<a id="4001" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4007" class="Symbol">((</a><a id="4009" href="Untyped.CEKWithCost.html#4009" class="Bound">s</a> <a id="4011" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4013" class="Symbol">(</a><a id="4014" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="4020" class="Symbol">_</a> <a id="4022" class="Symbol">_</a>   <a id="4026" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="4028" class="Symbol">))</a> <a id="4031" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4033" href="Untyped.CEKWithCost.html#4033" class="Bound">v</a><a id="4034" class="Symbol">)</a>          <a id="4045" class="Symbol">=</a> <a id="4047" href="Utils.html#2917" class="Field">return</a> <a id="4054" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4056" class="Comment">-- constant in function position</a>
<a id="4089" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4095" class="Symbol">((</a><a id="4097" href="Untyped.CEKWithCost.html#4097" class="Bound">s</a> <a id="4099" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4101" class="Symbol">(</a><a id="4102" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="4110" class="Symbol">_</a> <a id="4112" class="Symbol">_</a> <a id="4114" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="4116" class="Symbol">))</a> <a id="4119" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4121" href="Untyped.CEKWithCost.html#4121" class="Bound">v</a><a id="4122" class="Symbol">)</a>          <a id="4133" class="Symbol">=</a> <a id="4135" href="Utils.html#2917" class="Field">return</a> <a id="4142" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4144" class="Comment">-- delay in function position</a>
<a id="4174" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4180" class="Symbol">((</a><a id="4182" href="Untyped.CEKWithCost.html#4182" class="Bound">s</a> <a id="4184" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4186" class="Symbol">(</a><a id="4187" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="4192" href="Untyped.CEKWithCost.html#4192" class="Bound">b</a> <a id="4194" href="Untyped.CEKWithCost.html#4194" class="Bound">bapp</a> <a id="4199" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="4201" class="Symbol">))</a> <a id="4204" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4206" href="Untyped.CEKWithCost.html#4206" class="Bound">v</a><a id="4207" class="Symbol">)</a>          <a id="4218" class="Symbol">=</a> <a id="4220" href="Utils.html#2917" class="Field">return</a> <a id="4227" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4229" class="Comment">-- delayed builtin in function position</a>
<a id="4269" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4275" class="Symbol">((</a><a id="4277" href="Untyped.CEKWithCost.html#4277" class="Bound">s</a> <a id="4279" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4281" class="Symbol">(</a><a id="4282" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="4291" href="Untyped.CEKWithCost.html#4291" class="Bound">i</a> <a id="4293" href="Untyped.CEKWithCost.html#4293" class="Bound">vs</a> <a id="4296" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="4298" class="Symbol">))</a> <a id="4301" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4303" href="Untyped.CEKWithCost.html#4303" class="Bound">v</a><a id="4304" class="Symbol">)</a>        <a id="4313" class="Symbol">=</a> <a id="4315" href="Utils.html#2917" class="Field">return</a> <a id="4322" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4324" class="Comment">-- SOP in function position</a>
<a id="4352" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4358" class="Symbol">((</a><a id="4360" href="Untyped.CEKWithCost.html#4360" class="Bound">s</a> <a id="4362" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4364" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="4370" class="Symbol">)</a> <a id="4372" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4374" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="4379" href="Untyped.CEKWithCost.html#4379" class="Bound">b</a> <a id="4381" href="Untyped.CEKWithCost.html#4381" class="Bound">bapp</a><a id="4385" class="Symbol">)</a>          <a id="4396" class="Symbol">=</a> <a id="4398" href="Utils.html#2917" class="Field">return</a> <a id="4405" class="Symbol">(</a><a id="4406" href="Untyped.CEKWithCost.html#4360" class="Bound">s</a> <a id="4408" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4410" href="Untyped.CEK.html#3920" class="Function">V-I</a> <a id="4414" href="Untyped.CEKWithCost.html#4379" class="Bound">b</a> <a id="4416" class="Symbol">(</a><a id="4417" href="Untyped.CEK.html#2326" class="InductiveConstructor">app⋆</a> <a id="4422" href="Untyped.CEKWithCost.html#4381" class="Bound">bapp</a><a id="4426" class="Symbol">))</a>
<a id="4429" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4435" class="Symbol">((</a><a id="4437" href="Untyped.CEKWithCost.html#4437" class="Bound">s</a> <a id="4439" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4441" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="4447" class="Symbol">)</a> <a id="4449" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4451" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="4459" href="Untyped.CEKWithCost.html#4459" class="Bound">ρ</a> <a id="4461" href="Untyped.CEKWithCost.html#4461" class="Bound">t</a><a id="4462" class="Symbol">)</a>          <a id="4473" class="Symbol">=</a> <a id="4475" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4481" class="Symbol">(</a><a id="4482" href="Untyped.CEKWithCost.html#4437" class="Bound">s</a> <a id="4484" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="4486" href="Untyped.CEKWithCost.html#4459" class="Bound">ρ</a> <a id="4488" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="4490" href="Untyped.CEKWithCost.html#4461" class="Bound">t</a><a id="4491" class="Symbol">)</a> <a id="4493" class="Comment">-- this recursive call could be inlined</a>
                                                                <a id="4597" class="Comment">-- in order to make evident that this is a single step</a>
                                                                <a id="4716" class="Comment">-- but this would make the definition much longer.</a>
<a id="4767" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4773" class="Symbol">((</a><a id="4775" href="Untyped.CEKWithCost.html#4775" class="Bound">s</a> <a id="4777" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4779" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="4785" class="Symbol">)</a> <a id="4787" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4789" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="4793" class="Symbol">_</a> <a id="4795" class="Symbol">_)</a>              <a id="4811" class="Symbol">=</a> <a id="4813" href="Utils.html#2917" class="Field">return</a> <a id="4820" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4822" class="Comment">-- lambda in delay position</a>
<a id="4850" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4856" class="Symbol">((</a><a id="4858" href="Untyped.CEKWithCost.html#4858" class="Bound">s</a> <a id="4860" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4862" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="4868" class="Symbol">)</a> <a id="4870" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4872" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="4878" class="Symbol">_</a> <a id="4880" class="Symbol">_)</a>            <a id="4894" class="Symbol">=</a> <a id="4896" href="Utils.html#2917" class="Field">return</a> <a id="4903" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4905" class="Comment">-- constant in delay position</a>
<a id="4935" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="4941" class="Symbol">((</a><a id="4943" href="Untyped.CEKWithCost.html#4943" class="Bound">s</a> <a id="4945" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="4947" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="4953" class="Symbol">)</a> <a id="4955" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="4957" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="4962" href="Untyped.CEKWithCost.html#4962" class="Bound">b</a> <a id="4964" href="Untyped.CEKWithCost.html#4964" class="Bound">bapp</a><a id="4968" class="Symbol">)</a>          <a id="4979" class="Symbol">=</a> <a id="4981" href="Utils.html#2917" class="Field">return</a> <a id="4988" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="4990" class="Comment">-- function in delay position</a>
<a id="5020" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5026" class="Symbol">((</a><a id="5028" href="Untyped.CEKWithCost.html#5028" class="Bound">s</a> <a id="5030" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5032" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="5038" class="Symbol">)</a> <a id="5040" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5042" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="5051" href="Untyped.CEKWithCost.html#5051" class="Bound">i</a> <a id="5053" href="Untyped.CEKWithCost.html#5053" class="Bound">vs</a><a id="5055" class="Symbol">)</a>        <a id="5064" class="Symbol">=</a> <a id="5066" href="Utils.html#2917" class="Field">return</a> <a id="5073" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5075" class="Comment">-- SOP in delay position</a>
<a id="5100" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5106" class="Symbol">((</a><a id="5108" href="Untyped.CEKWithCost.html#5108" class="Bound">s</a> <a id="5110" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5112" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="5120" href="Untyped.CEKWithCost.html#5120" class="Bound">i</a> <a id="5122" href="Untyped.CEKWithCost.html#5122" class="Bound">vs</a> <a id="5125" href="Untyped.CEKWithCost.html#5125" class="Bound">ρ</a> <a id="5127" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5129" class="Symbol">)</a> <a id="5131" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5133" href="Untyped.CEKWithCost.html#5133" class="Bound">v</a><a id="5134" class="Symbol">)</a>         <a id="5144" class="Symbol">=</a> <a id="5146" href="Utils.html#2917" class="Field">return</a> <a id="5153" class="Symbol">(</a><a id="5154" href="Untyped.CEKWithCost.html#5108" class="Bound">s</a> <a id="5156" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5158" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="5167" href="Untyped.CEKWithCost.html#5120" class="Bound">i</a> <a id="5169" class="Symbol">(</a><a id="5170" href="Untyped.CEKWithCost.html#5122" class="Bound">vs</a> <a id="5173" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5175" href="Untyped.CEKWithCost.html#5133" class="Bound">v</a><a id="5176" class="Symbol">))</a>
<a id="5179" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5185" class="Symbol">((</a><a id="5187" href="Untyped.CEKWithCost.html#5187" class="Bound">s</a> <a id="5189" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5191" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="5199" href="Untyped.CEKWithCost.html#5199" class="Bound">i</a> <a id="5201" href="Untyped.CEKWithCost.html#5201" class="Bound">vs</a> <a id="5204" href="Untyped.CEKWithCost.html#5204" class="Bound">ρ</a> <a id="5206" class="Symbol">(</a><a id="5207" href="Untyped.CEKWithCost.html#5207" class="Bound">x</a> <a id="5209" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5211" href="Untyped.CEKWithCost.html#5211" class="Bound">ts</a><a id="5213" class="Symbol">))</a> <a id="5216" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5218" href="Untyped.CEKWithCost.html#5218" class="Bound">v</a><a id="5219" class="Symbol">)</a>   <a id="5223" class="Symbol">=</a> <a id="5225" href="Utils.html#2917" class="Field">return</a> <a id="5232" class="Symbol">((</a><a id="5234" href="Untyped.CEKWithCost.html#5187" class="Bound">s</a> <a id="5236" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5238" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="5246" href="Untyped.CEKWithCost.html#5199" class="Bound">i</a> <a id="5248" class="Symbol">(</a><a id="5249" href="Untyped.CEKWithCost.html#5201" class="Bound">vs</a> <a id="5252" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5254" href="Untyped.CEKWithCost.html#5218" class="Bound">v</a><a id="5255" class="Symbol">)</a> <a id="5257" href="Untyped.CEKWithCost.html#5204" class="Bound">ρ</a> <a id="5259" href="Untyped.CEKWithCost.html#5211" class="Bound">ts</a><a id="5261" class="Symbol">)</a><a id="5262" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="5264" href="Untyped.CEKWithCost.html#5204" class="Bound">ρ</a> <a id="5266" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="5268" href="Untyped.CEKWithCost.html#5207" class="Bound">x</a><a id="5269" class="Symbol">)</a>
<a id="5271" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5277" class="Symbol">((</a><a id="5279" href="Untyped.CEKWithCost.html#5279" class="Bound">s</a> <a id="5281" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5283" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5289" href="Untyped.CEKWithCost.html#5289" class="Bound">ρ</a> <a id="5291" href="Untyped.CEKWithCost.html#5291" class="Bound">ts</a><a id="5293" class="Symbol">)</a> <a id="5295" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5297" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="5306" href="Untyped.CEKWithCost.html#5306" class="Bound">i</a> <a id="5308" href="Untyped.CEKWithCost.html#5308" class="Bound">vs</a><a id="5310" class="Symbol">)</a>    <a id="5315" class="Symbol">=</a> <a id="5317" href="Utils.html#2917" class="Field">return</a> <a id="5324" class="Symbol">(</a><a id="5325" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="5331" class="Symbol">(</a><a id="5332" href="Untyped.CEK.html#21700" class="Function">pushValueFrames</a> <a id="5348" href="Untyped.CEKWithCost.html#5279" class="Bound">s</a> <a id="5350" href="Untyped.CEKWithCost.html#5308" class="Bound">vs</a> <a id="5353" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="5355" href="Untyped.CEKWithCost.html#5289" class="Bound">ρ</a> <a id="5357" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻_</a><a id="5359" class="Symbol">)</a> <a id="5361" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5363" class="Symbol">(</a><a id="5364" href="Untyped.CEK.html#21843" class="Function">lookup?</a> <a id="5372" href="Untyped.CEKWithCost.html#5306" class="Bound">i</a> <a id="5374" href="Untyped.CEKWithCost.html#5291" class="Bound">ts</a><a id="5376" class="Symbol">))</a>
<a id="5379" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5385" class="Symbol">((</a><a id="5387" href="Untyped.CEKWithCost.html#5387" class="Bound">s</a> <a id="5389" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5391" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5397" href="Untyped.CEKWithCost.html#5397" class="Bound">ρ</a> <a id="5399" href="Untyped.CEKWithCost.html#5399" class="Bound">ts</a><a id="5401" class="Symbol">)</a> <a id="5403" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5405" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="5409" class="Symbol">_</a> <a id="5411" class="Symbol">_)</a>          <a id="5423" class="Symbol">=</a> <a id="5425" href="Utils.html#2917" class="Field">return</a> <a id="5432" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5434" class="Comment">-- case of lambda</a>
<a id="5452" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5458" class="Symbol">((</a><a id="5460" href="Untyped.CEKWithCost.html#5460" class="Bound">s</a> <a id="5462" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5464" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5470" href="Untyped.CEKWithCost.html#5470" class="Bound">ρ</a> <a id="5472" href="Untyped.CEKWithCost.html#5472" class="Bound">ts</a><a id="5474" class="Symbol">)</a> <a id="5476" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5478" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="5484" class="Symbol">_</a> <a id="5486" class="Symbol">_)</a>        <a id="5496" class="Symbol">=</a> <a id="5498" href="Utils.html#2917" class="Field">return</a> <a id="5505" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5507" class="Comment">-- case of constant</a>
<a id="5527" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5533" class="Symbol">((</a><a id="5535" href="Untyped.CEKWithCost.html#5535" class="Bound">s</a> <a id="5537" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5539" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5545" href="Untyped.CEKWithCost.html#5545" class="Bound">ρ</a> <a id="5547" href="Untyped.CEKWithCost.html#5547" class="Bound">ts</a><a id="5549" class="Symbol">)</a> <a id="5551" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5553" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="5561" class="Symbol">_</a> <a id="5563" class="Symbol">_)</a>      <a id="5571" class="Symbol">=</a> <a id="5573" href="Utils.html#2917" class="Field">return</a> <a id="5580" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5582" class="Comment">-- case of delay</a>
<a id="5599" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5605" class="Symbol">((</a><a id="5607" href="Untyped.CEKWithCost.html#5607" class="Bound">s</a> <a id="5609" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5611" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5617" href="Untyped.CEKWithCost.html#5617" class="Bound">ρ</a> <a id="5619" href="Untyped.CEKWithCost.html#5619" class="Bound">ts</a><a id="5621" class="Symbol">)</a> <a id="5623" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5625" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="5630" class="Symbol">_</a> <a id="5632" class="Symbol">_)</a>         <a id="5643" class="Symbol">=</a> <a id="5645" href="Utils.html#2917" class="Field">return</a> <a id="5652" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5654" class="Comment">-- case of builtin value</a>
<a id="5679" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5685" class="Symbol">((</a><a id="5687" href="Untyped.CEKWithCost.html#5687" class="Bound">s</a> <a id="5689" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5691" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="5697" href="Untyped.CEKWithCost.html#5697" class="Bound">ρ</a> <a id="5699" href="Untyped.CEKWithCost.html#5699" class="Bound">ts</a><a id="5701" class="Symbol">)</a> <a id="5703" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5705" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="5710" class="Symbol">_</a> <a id="5712" class="Symbol">_)</a>         <a id="5723" class="Symbol">=</a> <a id="5725" href="Utils.html#2917" class="Field">return</a> <a id="5732" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="5734" class="Comment">-- case of delayed builtin</a>
<a id="5761" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="5767" class="Symbol">((</a><a id="5769" href="Untyped.CEKWithCost.html#5769" class="Bound">s</a> <a id="5771" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="5773" class="Symbol">(</a><a id="5774" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="5779" href="Untyped.CEKWithCost.html#5779" class="Bound">b</a> <a id="5781" class="Symbol">{</a><a id="5782" class="Argument">am</a> <a id="5785" class="Symbol">=</a> <a id="5787" class="Number">0</a><a id="5788" class="Symbol">}</a> <a id="5790" href="Untyped.CEKWithCost.html#5790" class="Bound">bapp</a> <a id="5795" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="5797" class="Symbol">))</a> <a id="5800" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="5802" href="Untyped.CEKWithCost.html#5802" class="Bound">v</a><a id="5803" class="Symbol">)</a> <a id="5805" class="Symbol">=</a> <a id="5807" class="Keyword">do</a> <a id="5810" class="Comment">--fully applied builtin function</a>
          <a id="5853" class="Keyword">let</a> <a id="5857" href="Untyped.CEKWithCost.html#5857" class="Bound">bapp&#39;</a> <a id="5863" class="Symbol">=</a> <a id="5865" href="Untyped.CEK.html#21016" class="Function">mkFullyAppliedBuiltin</a> <a id="5887" class="Symbol">(</a><a id="5888" href="Untyped.CEK.html#2159" class="InductiveConstructor">app</a> <a id="5892" href="Untyped.CEKWithCost.html#5790" class="Bound">bapp</a> <a id="5897" href="Untyped.CEKWithCost.html#5802" class="Bound">v</a><a id="5898" class="Symbol">)</a> <a id="5900" class="Comment">-- proof that b is fully applied</a>
          <a id="5943" href="Untyped.CEKWithCost.html#2418" class="Function">spendBuiltin</a> <a id="5956" href="Untyped.CEKWithCost.html#5779" class="Bound">b</a> <a id="5958" href="Untyped.CEKWithCost.html#5857" class="Bound">bapp&#39;</a>
          <a id="5974" href="Utils.html#2917" class="Field">return</a> <a id="5981" class="Symbol">(</a><a id="5982" href="Utils.html#1270" class="Function">either</a> <a id="5989" class="Symbol">(</a><a id="5990" href="Untyped.CEK.html#4335" class="Function">BUILTIN</a> <a id="5998" href="Untyped.CEKWithCost.html#5779" class="Bound">b</a> <a id="6000" href="Untyped.CEKWithCost.html#5857" class="Bound">bapp&#39;</a><a id="6005" class="Symbol">)</a> <a id="6007" class="Symbol">(λ</a> <a id="6010" href="Untyped.CEKWithCost.html#6010" class="Bound">_</a> <a id="6012" class="Symbol">→</a>  <a id="6015" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a><a id="6016" class="Symbol">)</a> <a id="6018" class="Symbol">(</a><a id="6019" href="Untyped.CEKWithCost.html#5769" class="Bound">s</a> <a id="6021" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅_</a><a id="6023" class="Symbol">))</a>
<a id="6026" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="6032" class="Symbol">((</a><a id="6034" href="Untyped.CEKWithCost.html#6034" class="Bound">s</a> <a id="6036" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="6038" class="Symbol">(</a><a id="6039" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="6044" href="Untyped.CEKWithCost.html#6044" class="Bound">b</a> <a id="6046" class="Symbol">{</a><a id="6047" class="Argument">am</a> <a id="6050" class="Symbol">=</a> <a id="6052" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6056" class="Symbol">_}</a> <a id="6059" href="Untyped.CEKWithCost.html#6059" class="Bound">bapp</a> <a id="6064" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="6066" class="Symbol">))</a> <a id="6069" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="6071" href="Untyped.CEKWithCost.html#6071" class="Bound">v</a><a id="6072" class="Symbol">)</a> <a id="6074" class="Symbol">=</a>  <a id="6077" class="Comment">--partially applied builtin function</a>
          <a id="6124" href="Utils.html#2917" class="Field">return</a> <a id="6131" class="Symbol">(</a><a id="6132" href="Untyped.CEKWithCost.html#6034" class="Bound">s</a> <a id="6134" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="6136" href="Untyped.CEK.html#3920" class="Function">V-I</a> <a id="6140" href="Untyped.CEKWithCost.html#6044" class="Bound">b</a> <a id="6142" class="Symbol">(</a><a id="6143" href="Untyped.CEK.html#2159" class="InductiveConstructor">app</a> <a id="6147" href="Untyped.CEKWithCost.html#6059" class="Bound">bapp</a> <a id="6152" href="Untyped.CEKWithCost.html#6071" class="Bound">v</a><a id="6153" class="Symbol">))</a>

<a id="6157" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="6163" class="Symbol">(</a><a id="6164" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="6166" href="Untyped.CEKWithCost.html#6166" class="Bound">v</a><a id="6167" class="Symbol">)</a>               <a id="6183" class="Symbol">=</a> <a id="6185" href="Utils.html#2917" class="Field">return</a> <a id="6192" class="Symbol">(</a><a id="6193" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="6195" href="Untyped.CEKWithCost.html#6166" class="Bound">v</a><a id="6196" class="Symbol">)</a>
<a id="6198" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="6204" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>                   <a id="6224" class="Symbol">=</a> <a id="6226" href="Utils.html#2917" class="Field">return</a> <a id="6233" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>

<a id="stepperC-internal"></a><a id="6236" href="Untyped.CEKWithCost.html#6236" class="Function">stepperC-internal</a> <a id="6254" class="Symbol">:</a> <a id="6256" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6258" class="Symbol">→</a> <a id="6260" class="Symbol">(</a><a id="6261" href="Untyped.CEKWithCost.html#6261" class="Bound">s</a> <a id="6263" class="Symbol">:</a> <a id="6265" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6270" class="Symbol">)</a> <a id="6272" class="Symbol">→</a> <a id="6274" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6279" class="Symbol">(</a><a id="6280" href="Utils.html#1133" class="Datatype">Either</a> <a id="6287" href="Utils.html#4363" class="Datatype">RuntimeError</a> <a id="6300" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6305" class="Symbol">)</a>
<a id="6307" href="Untyped.CEKWithCost.html#6236" class="Function">stepperC-internal</a> <a id="6325" class="Number">0</a>       <a id="6333" href="Untyped.CEKWithCost.html#6333" class="Bound">s</a> <a id="6335" class="Symbol">=</a> <a id="6337" href="Utils.html#2917" class="Field">return</a> <a id="6344" class="Symbol">(</a><a id="6345" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="6350" href="Utils.html#4390" class="InductiveConstructor">gasError</a><a id="6358" class="Symbol">)</a>
<a id="6360" href="Untyped.CEKWithCost.html#6236" class="Function">stepperC-internal</a> <a id="6378" class="Symbol">(</a><a id="6379" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6383" href="Untyped.CEKWithCost.html#6383" class="Bound">n</a><a id="6384" class="Symbol">)</a> <a id="6386" href="Untyped.CEKWithCost.html#6386" class="Bound">s</a> <a id="6388" class="Symbol">=</a> <a id="6390" class="Keyword">do</a>
       <a id="6400" href="Untyped.CEKWithCost.html#6400" class="Bound">s&#39;</a> <a id="6403" href="Utils.html#2945" class="Field Operator">←</a> <a id="6405" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="6411" href="Untyped.CEKWithCost.html#6386" class="Bound">s</a>
       <a id="6420" href="Untyped.CEKWithCost.html#6443" class="Function">go</a> <a id="6423" href="Untyped.CEKWithCost.html#6400" class="Bound">s&#39;</a>
    <a id="6430" class="Keyword">where</a>
       <a id="6443" href="Untyped.CEKWithCost.html#6443" class="Function">go</a> <a id="6446" class="Symbol">:</a> <a id="6448" class="Symbol">(</a><a id="6449" href="Untyped.CEKWithCost.html#6449" class="Bound">t</a> <a id="6451" class="Symbol">:</a> <a id="6453" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6458" class="Symbol">)</a> <a id="6460" class="Symbol">→</a> <a id="6462" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6467" class="Symbol">(</a><a id="6468" href="Utils.html#1133" class="Datatype">Either</a> <a id="6475" href="Utils.html#4363" class="Datatype">RuntimeError</a> <a id="6488" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6493" class="Symbol">)</a>
       <a id="6502" href="Untyped.CEKWithCost.html#6443" class="Function">go</a> <a id="6505" class="Symbol">(</a><a id="6506" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="6508" href="Untyped.CEKWithCost.html#6508" class="Bound">v</a><a id="6509" class="Symbol">)</a> <a id="6511" class="Symbol">=</a> <a id="6513" href="Utils.html#2917" class="Field">return</a> <a id="6520" class="Symbol">(</a><a id="6521" href="Utils.html#1190" class="InductiveConstructor">inj₂</a> <a id="6526" class="Symbol">(</a><a id="6527" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="6529" href="Untyped.CEKWithCost.html#6508" class="Bound">v</a><a id="6530" class="Symbol">))</a>
       <a id="6540" href="Untyped.CEKWithCost.html#6443" class="Function">go</a> <a id="6543" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a>     <a id="6549" class="Symbol">=</a> <a id="6551" href="Utils.html#2917" class="Field">return</a> <a id="6558" class="Symbol">(</a><a id="6559" href="Utils.html#1190" class="InductiveConstructor">inj₂</a> <a id="6564" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a><a id="6565" class="Symbol">)</a>
       <a id="6574" href="Untyped.CEKWithCost.html#6443" class="CatchallClause Function">go</a><a id="6576" class="CatchallClause"> </a><a id="6577" href="Untyped.CEKWithCost.html#6577" class="CatchallClause Bound">s&#39;</a>    <a id="6583" class="Symbol">=</a> <a id="6585" href="Untyped.CEKWithCost.html#6236" class="Function">stepperC-internal</a> <a id="6603" href="Untyped.CEKWithCost.html#6383" class="Bound">n</a> <a id="6605" href="Untyped.CEKWithCost.html#6577" class="Bound">s&#39;</a>

<a id="stepperC"></a><a id="6609" href="Untyped.CEKWithCost.html#6609" class="Function">stepperC</a> <a id="6618" class="Symbol">:</a> <a id="6620" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6622" class="Symbol">→</a> <a id="6624" class="Symbol">(</a><a id="6625" href="Untyped.CEKWithCost.html#6625" class="Bound">s</a> <a id="6627" class="Symbol">:</a> <a id="6629" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6634" class="Symbol">)</a> <a id="6636" class="Symbol">→</a> <a id="6638" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6643" class="Symbol">(</a><a id="6644" href="Utils.html#1133" class="Datatype">Either</a> <a id="6651" href="Utils.html#4363" class="Datatype">RuntimeError</a> <a id="6664" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6669" class="Symbol">)</a>
<a id="6671" href="Untyped.CEKWithCost.html#6609" class="Function">stepperC</a> <a id="6680" href="Untyped.CEKWithCost.html#6680" class="Bound">n</a> <a id="6682" href="Untyped.CEKWithCost.html#6682" class="Bound">s</a> <a id="6684" class="Symbol">=</a> <a id="6686" class="Keyword">do</a>
       <a id="6696" href="Untyped.CEKWithCost.html#1570" class="Function">spendStartupCost</a>
       <a id="6720" href="Untyped.CEKWithCost.html#6236" class="Function">stepperC-internal</a> <a id="6738" href="Untyped.CEKWithCost.html#6680" class="Bound">n</a> <a id="6740" href="Untyped.CEKWithCost.html#6682" class="Bound">s</a>
</pre>
<h2 id="proof-of-equivalence-between-cek-machine-with-and-without-costs">Proof of equivalence between CEK machine with and without costs</h2>

<pre class="Agda"><a id="cekStepEquivalence"></a><a id="6819" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="6838" class="Symbol">:</a> <a id="6840" class="Symbol">∀</a> <a id="6842" class="Symbol">(</a><a id="6843" href="Untyped.CEKWithCost.html#6843" class="Bound">s</a> <a id="6845" class="Symbol">:</a> <a id="6847" href="Untyped.CEK.html#3620" class="Datatype">State</a><a id="6852" class="Symbol">)</a> <a id="6854" class="Symbol">→</a> <a id="6856" href="Untyped.CEK.html#22183" class="Function">step</a> <a id="6861" href="Untyped.CEKWithCost.html#6843" class="Bound">s</a> <a id="6863" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6865" href="Utils.html#4027" class="Field">wrvalue</a> <a id="6873" class="Symbol">(</a><a id="6874" href="Untyped.CEKWithCost.html#2692" class="Function">stepC</a> <a id="6880" href="Untyped.CEKWithCost.html#6843" class="Bound">s</a><a id="6881" class="Symbol">)</a>
<a id="6883" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="6902" class="Symbol">(</a><a id="6903" href="Untyped.CEKWithCost.html#6903" class="Bound">s</a> <a id="6905" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="6907" href="Untyped.CEKWithCost.html#6907" class="Bound">ρ</a> <a id="6909" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="6911" href="Untyped.html#1704" class="InductiveConstructor">`</a> <a id="6913" class="Symbol">_)</a> <a id="6916" class="Symbol">=</a> <a id="6918" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6923" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="6942" class="Symbol">(</a><a id="6943" href="Untyped.CEKWithCost.html#6943" class="Bound">s</a> <a id="6945" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="6947" href="Untyped.CEKWithCost.html#6947" class="Bound">ρ</a> <a id="6949" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="6951" href="Untyped.html#1720" class="InductiveConstructor">ƛ</a> <a id="6953" class="Symbol">_)</a> <a id="6956" class="Symbol">=</a> <a id="6958" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6963" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="6982" class="Symbol">(</a><a id="6983" href="Untyped.CEKWithCost.html#6983" class="Bound">s</a> <a id="6985" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="6987" href="Untyped.CEKWithCost.html#6987" class="Bound">ρ</a> <a id="6989" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="6991" class="Symbol">(_</a> <a id="6994" href="Untyped.html#1744" class="InductiveConstructor Operator">·</a> <a id="6996" class="Symbol">_))</a> <a id="7000" class="Symbol">=</a> <a id="7002" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7007" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7026" class="Symbol">(</a><a id="7027" href="Untyped.CEKWithCost.html#7027" class="Bound">s</a> <a id="7029" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7031" href="Untyped.CEKWithCost.html#7031" class="Bound">ρ</a> <a id="7033" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7035" href="Untyped.html#1768" class="InductiveConstructor">force</a> <a id="7041" class="Symbol">_)</a> <a id="7044" class="Symbol">=</a> <a id="7046" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7051" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7070" class="Symbol">(</a><a id="7071" href="Untyped.CEKWithCost.html#7071" class="Bound">s</a> <a id="7073" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7075" href="Untyped.CEKWithCost.html#7075" class="Bound">ρ</a> <a id="7077" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7079" href="Untyped.html#1788" class="InductiveConstructor">delay</a> <a id="7085" class="Symbol">_)</a> <a id="7088" class="Symbol">=</a> <a id="7090" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7095" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7114" class="Symbol">(</a><a id="7115" href="Untyped.CEKWithCost.html#7115" class="Bound">s</a> <a id="7117" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7119" href="Untyped.CEKWithCost.html#7119" class="Bound">ρ</a> <a id="7121" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7123" href="Untyped.html#1808" class="InductiveConstructor">con</a> <a id="7127" class="Symbol">(</a><a id="7128" href="RawU.html#8032" class="InductiveConstructor">tmCon</a> <a id="7134" class="Symbol">_</a> <a id="7136" class="Symbol">_))</a> <a id="7140" class="Symbol">=</a> <a id="7142" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7147" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7166" class="Symbol">(</a><a id="7167" href="Untyped.CEKWithCost.html#7167" class="Bound">s</a> <a id="7169" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7171" href="Untyped.CEKWithCost.html#7171" class="Bound">ρ</a> <a id="7173" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7175" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="7182" class="Symbol">_</a> <a id="7184" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7186" class="Symbol">)</a> <a id="7188" class="Symbol">=</a> <a id="7190" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7195" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7214" class="Symbol">(</a><a id="7215" href="Untyped.CEKWithCost.html#7215" class="Bound">s</a> <a id="7217" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7219" href="Untyped.CEKWithCost.html#7219" class="Bound">ρ</a> <a id="7221" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7223" href="Untyped.html#1828" class="InductiveConstructor">constr</a> <a id="7230" class="Symbol">_</a> <a id="7232" class="Symbol">(_</a> <a id="7235" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7237" class="Symbol">_))</a> <a id="7241" class="Symbol">=</a> <a id="7243" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7248" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7267" class="Symbol">(</a><a id="7268" href="Untyped.CEKWithCost.html#7268" class="Bound">s</a> <a id="7270" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7272" href="Untyped.CEKWithCost.html#7272" class="Bound">ρ</a> <a id="7274" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7276" href="Untyped.html#1875" class="InductiveConstructor">case</a> <a id="7281" class="Symbol">_</a> <a id="7283" class="Symbol">_)</a> <a id="7286" class="Symbol">=</a> <a id="7288" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7293" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7312" class="Symbol">(</a><a id="7313" href="Untyped.CEKWithCost.html#7313" class="Bound">s</a> <a id="7315" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7317" href="Untyped.CEKWithCost.html#7317" class="Bound">ρ</a> <a id="7319" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7321" href="Untyped.html#1923" class="InductiveConstructor">builtin</a> <a id="7329" class="Symbol">_)</a> <a id="7332" class="Symbol">=</a> <a id="7334" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7339" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7358" class="Symbol">(</a><a id="7359" href="Untyped.CEKWithCost.html#7359" class="Bound">s</a> <a id="7361" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="7363" href="Untyped.CEKWithCost.html#7363" class="Bound">ρ</a> <a id="7365" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="7367" href="Untyped.html#1955" class="InductiveConstructor">error</a><a id="7372" class="Symbol">)</a> <a id="7374" class="Symbol">=</a> <a id="7376" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7381" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7400" class="Symbol">(</a><a id="7401" href="Untyped.CEK.html#1288" class="InductiveConstructor">ε</a> <a id="7403" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7405" class="Symbol">_)</a> <a id="7408" class="Symbol">=</a> <a id="7410" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7415" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7434" class="Symbol">((</a><a id="7436" href="Untyped.CEKWithCost.html#7436" class="Bound">s</a> <a id="7438" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7440" href="Untyped.CEK.html#3403" class="InductiveConstructor">-·</a> <a id="7443" class="Symbol">_</a> <a id="7445" class="Symbol">_)</a> <a id="7448" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7450" class="Symbol">_)</a> <a id="7453" class="Symbol">=</a> <a id="7455" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7460" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7479" class="Symbol">((</a><a id="7481" href="Untyped.CEKWithCost.html#7481" class="Bound">s</a> <a id="7483" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7485" href="Untyped.CEK.html#3438" class="InductiveConstructor">-·v</a> <a id="7489" class="Symbol">_)</a> <a id="7492" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7494" class="Symbol">_)</a> <a id="7497" class="Symbol">=</a> <a id="7499" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7504" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7523" class="Symbol">((</a><a id="7525" href="Untyped.CEKWithCost.html#7525" class="Bound">s</a> <a id="7527" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7529" class="Symbol">(</a><a id="7530" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="7534" class="Symbol">_</a> <a id="7536" class="Symbol">_</a> <a id="7538" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7540" class="Symbol">))</a> <a id="7543" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7545" class="Symbol">_)</a> <a id="7548" class="Symbol">=</a> <a id="7550" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7555" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7574" class="Symbol">((</a><a id="7576" href="Untyped.CEKWithCost.html#7576" class="Bound">s</a> <a id="7578" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7580" class="Symbol">(</a><a id="7581" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="7587" class="Symbol">_</a> <a id="7589" class="Symbol">_</a> <a id="7591" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7593" class="Symbol">))</a> <a id="7596" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7598" class="Symbol">_)</a> <a id="7601" class="Symbol">=</a> <a id="7603" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7608" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7627" class="Symbol">((</a><a id="7629" href="Untyped.CEKWithCost.html#7629" class="Bound">s</a> <a id="7631" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7633" class="Symbol">(</a><a id="7634" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="7642" class="Symbol">_</a> <a id="7644" class="Symbol">_</a> <a id="7646" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7648" class="Symbol">))</a> <a id="7651" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7653" class="Symbol">_)</a> <a id="7656" class="Symbol">=</a> <a id="7658" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7663" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7682" class="Symbol">((</a><a id="7684" href="Untyped.CEKWithCost.html#7684" class="Bound">s</a> <a id="7686" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7688" class="Symbol">(</a><a id="7689" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="7698" class="Symbol">_</a> <a id="7700" class="Symbol">_</a> <a id="7702" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7704" class="Symbol">))</a> <a id="7707" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7709" class="Symbol">_)</a> <a id="7712" class="Symbol">=</a> <a id="7714" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7719" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7738" class="Symbol">((</a><a id="7740" href="Untyped.CEKWithCost.html#7740" class="Bound">s</a> <a id="7742" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7744" class="Symbol">(</a><a id="7745" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="7750" href="Untyped.CEKWithCost.html#7750" class="Bound">b</a> <a id="7752" class="Symbol">{</a><a id="7753" class="Argument">am</a> <a id="7756" class="Symbol">=</a> <a id="7758" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="7762" class="Symbol">}</a> <a id="7764" href="Untyped.CEKWithCost.html#7764" class="Bound">x</a> <a id="7766" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7768" class="Symbol">))</a> <a id="7771" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7773" href="Untyped.CEKWithCost.html#7773" class="Bound">V</a><a id="7774" class="Symbol">)</a> <a id="7776" class="Keyword">with</a> <a id="7781" href="Untyped.CEK.html#21446" class="Function">BUILTIN&#39;</a> <a id="7790" href="Untyped.CEKWithCost.html#7750" class="Bound">b</a> <a id="7792" class="Symbol">(</a><a id="7793" href="Untyped.CEK.html#2159" class="InductiveConstructor">app</a> <a id="7797" href="Untyped.CEKWithCost.html#7764" class="Bound">x</a> <a id="7799" href="Untyped.CEKWithCost.html#7773" class="Bound">V</a><a id="7800" class="Symbol">)</a>
<a id="7802" class="Symbol">...</a> <a id="7806" class="Symbol">|</a> <a id="7808" href="Utils.html#1166" class="InductiveConstructor">inj₁</a> <a id="7813" class="Symbol">_</a> <a id="7815" class="Symbol">=</a> <a id="7817" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7822" class="Symbol">...</a> <a id="7826" class="Symbol">|</a> <a id="7828" href="Utils.html#1190" class="InductiveConstructor">inj₂</a> <a id="7833" class="Symbol">_</a> <a id="7835" class="Symbol">=</a> <a id="7837" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7842" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7861" class="Symbol">((</a><a id="7863" href="Untyped.CEKWithCost.html#7863" class="Bound">s</a> <a id="7865" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7867" class="Symbol">(</a><a id="7868" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="7873" class="Symbol">_</a> <a id="7875" class="Symbol">{</a><a id="7876" class="Argument">am</a> <a id="7879" class="Symbol">=</a> <a id="7881" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7885" class="Symbol">_}</a> <a id="7888" class="Symbol">_</a> <a id="7890" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7892" class="Symbol">))</a> <a id="7895" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7897" class="Symbol">_)</a> <a id="7900" class="Symbol">=</a> <a id="7902" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7907" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7926" class="Symbol">((</a><a id="7928" href="Untyped.CEKWithCost.html#7928" class="Bound">s</a> <a id="7930" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7932" class="Symbol">(</a><a id="7933" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="7938" class="Symbol">_</a> <a id="7940" class="Symbol">_</a> <a id="7942" href="Untyped.CEK.html#3460" class="InductiveConstructor Operator">·-</a><a id="7944" class="Symbol">))</a> <a id="7947" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7949" class="Symbol">_)</a> <a id="7952" class="Symbol">=</a> <a id="7954" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7959" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="7978" class="Symbol">((</a><a id="7980" href="Untyped.CEKWithCost.html#7980" class="Bound">s</a> <a id="7982" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="7984" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="7990" class="Symbol">)</a> <a id="7992" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="7994" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="7998" class="Symbol">_</a> <a id="8000" class="Symbol">_)</a> <a id="8003" class="Symbol">=</a> <a id="8005" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8010" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8029" class="Symbol">((</a><a id="8031" href="Untyped.CEKWithCost.html#8031" class="Bound">s</a> <a id="8033" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8035" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="8041" class="Symbol">)</a> <a id="8043" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8045" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="8051" class="Symbol">_</a> <a id="8053" class="Symbol">_)</a> <a id="8056" class="Symbol">=</a> <a id="8058" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8063" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8082" class="Symbol">((</a><a id="8084" href="Untyped.CEKWithCost.html#8084" class="Bound">s</a> <a id="8086" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8088" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="8094" class="Symbol">)</a> <a id="8096" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8098" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="8106" href="Untyped.CEKWithCost.html#8106" class="Bound">ρ</a> <a id="8108" href="Untyped.CEKWithCost.html#8108" class="Bound">x</a><a id="8109" class="Symbol">)</a> <a id="8111" class="Symbol">=</a> <a id="8113" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8132" class="Symbol">(</a><a id="8133" href="Untyped.CEKWithCost.html#8084" class="Bound">s</a> <a id="8135" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="8137" href="Untyped.CEKWithCost.html#8106" class="Bound">ρ</a> <a id="8139" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="8141" href="Untyped.CEKWithCost.html#8108" class="Bound">x</a><a id="8142" class="Symbol">)</a>
<a id="8144" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8163" class="Symbol">((</a><a id="8165" href="Untyped.CEKWithCost.html#8165" class="Bound">s</a> <a id="8167" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8169" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="8175" class="Symbol">)</a> <a id="8177" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8179" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="8188" class="Symbol">_</a> <a id="8190" class="Symbol">_)</a> <a id="8193" class="Symbol">=</a> <a id="8195" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8200" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8219" class="Symbol">((</a><a id="8221" href="Untyped.CEKWithCost.html#8221" class="Bound">s</a> <a id="8223" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8225" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="8231" class="Symbol">)</a> <a id="8233" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8235" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="8240" class="Symbol">_</a> <a id="8242" class="Symbol">_)</a> <a id="8245" class="Symbol">=</a> <a id="8247" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8252" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8271" class="Symbol">((</a><a id="8273" href="Untyped.CEKWithCost.html#8273" class="Bound">s</a> <a id="8275" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8277" href="Untyped.CEK.html#3482" class="InductiveConstructor">force-</a><a id="8283" class="Symbol">)</a> <a id="8285" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8287" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="8292" class="Symbol">_</a> <a id="8294" class="Symbol">_)</a> <a id="8297" class="Symbol">=</a> <a id="8299" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8304" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8323" class="Symbol">((</a><a id="8325" href="Untyped.CEKWithCost.html#8325" class="Bound">s</a> <a id="8327" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8329" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="8337" class="Symbol">_</a> <a id="8339" class="Symbol">_</a> <a id="8341" class="Symbol">_</a> <a id="8343" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8345" class="Symbol">)</a> <a id="8347" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8349" class="Symbol">_)</a> <a id="8352" class="Symbol">=</a> <a id="8354" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8359" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8378" class="Symbol">((</a><a id="8380" href="Untyped.CEKWithCost.html#8380" class="Bound">s</a> <a id="8382" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8384" href="Untyped.CEK.html#3499" class="InductiveConstructor">constr-</a> <a id="8392" class="Symbol">_</a> <a id="8394" class="Symbol">_</a> <a id="8396" class="Symbol">_</a> <a id="8398" class="Symbol">(_</a> <a id="8401" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8403" class="Symbol">_))</a> <a id="8407" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8409" class="Symbol">_)</a> <a id="8412" class="Symbol">=</a> <a id="8414" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8419" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8438" class="Symbol">((</a><a id="8440" href="Untyped.CEKWithCost.html#8440" class="Bound">s</a> <a id="8442" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8444" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8450" class="Symbol">_</a> <a id="8452" class="Symbol">_)</a> <a id="8455" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8457" href="Untyped.CEK.html#1572" class="InductiveConstructor">V-ƛ</a> <a id="8461" class="Symbol">_</a> <a id="8463" class="Symbol">_)</a> <a id="8466" class="Symbol">=</a> <a id="8468" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8473" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8492" class="Symbol">((</a><a id="8494" href="Untyped.CEKWithCost.html#8494" class="Bound">s</a> <a id="8496" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8498" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8504" class="Symbol">_</a> <a id="8506" class="Symbol">_)</a> <a id="8509" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8511" href="Untyped.CEK.html#1613" class="InductiveConstructor">V-con</a> <a id="8517" class="Symbol">_</a> <a id="8519" class="Symbol">_)</a> <a id="8522" class="Symbol">=</a> <a id="8524" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8529" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8548" class="Symbol">((</a><a id="8550" href="Untyped.CEKWithCost.html#8550" class="Bound">s</a> <a id="8552" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8554" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8560" class="Symbol">_</a> <a id="8562" class="Symbol">_)</a> <a id="8565" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8567" href="Untyped.CEK.html#1656" class="InductiveConstructor">V-delay</a> <a id="8575" class="Symbol">_</a> <a id="8577" class="Symbol">_)</a> <a id="8580" class="Symbol">=</a> <a id="8582" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8587" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8606" class="Symbol">((</a><a id="8608" href="Untyped.CEKWithCost.html#8608" class="Bound">s</a> <a id="8610" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8612" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8618" class="Symbol">_</a> <a id="8620" class="Symbol">_)</a> <a id="8623" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8625" href="Untyped.CEK.html#1695" class="InductiveConstructor">V-constr</a> <a id="8634" class="Symbol">_</a> <a id="8636" class="Symbol">_)</a> <a id="8639" class="Symbol">=</a> <a id="8641" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8646" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8665" class="Symbol">((</a><a id="8667" href="Untyped.CEKWithCost.html#8667" class="Bound">s</a> <a id="8669" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8671" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8677" class="Symbol">_</a> <a id="8679" class="Symbol">_)</a> <a id="8682" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8684" href="Untyped.CEK.html#1745" class="InductiveConstructor">V-I⇒</a> <a id="8689" class="Symbol">_</a> <a id="8691" class="Symbol">_)</a> <a id="8694" class="Symbol">=</a> <a id="8696" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8701" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8720" class="Symbol">((</a><a id="8722" href="Untyped.CEKWithCost.html#8722" class="Bound">s</a> <a id="8724" href="Untyped.CEK.html#1302" class="InductiveConstructor Operator">,</a> <a id="8726" href="Untyped.CEK.html#3565" class="InductiveConstructor">case-</a> <a id="8732" class="Symbol">_</a> <a id="8734" class="Symbol">_)</a> <a id="8737" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="8739" href="Untyped.CEK.html#1902" class="InductiveConstructor">V-IΠ</a> <a id="8744" class="Symbol">_</a> <a id="8746" class="Symbol">_)</a> <a id="8749" class="Symbol">=</a> <a id="8751" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8756" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8775" class="Symbol">(</a><a id="8776" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="8778" class="Symbol">_)</a> <a id="8781" class="Symbol">=</a> <a id="8783" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8788" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8807" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="8809" class="Symbol">=</a> <a id="8811" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="cekStepperEquivalence"></a><a id="8817" href="Untyped.CEKWithCost.html#8817" class="Function">cekStepperEquivalence</a> <a id="8839" class="Symbol">:</a> <a id="8841" class="Symbol">∀</a> <a id="8843" href="Untyped.CEKWithCost.html#8843" class="Bound">n</a> <a id="8845" href="Untyped.CEKWithCost.html#8845" class="Bound">s</a> <a id="8847" class="Symbol">→</a> <a id="8849" href="Untyped.CEK.html#24578" class="Function">stepper</a> <a id="8857" href="Untyped.CEKWithCost.html#8843" class="Bound">n</a> <a id="8859" href="Untyped.CEKWithCost.html#8845" class="Bound">s</a> <a id="8861" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8863" href="Utils.html#4027" class="Field">wrvalue</a> <a id="8871" class="Symbol">(</a><a id="8872" href="Untyped.CEKWithCost.html#6609" class="Function">stepperC</a> <a id="8881" href="Untyped.CEKWithCost.html#8843" class="Bound">n</a> <a id="8883" href="Untyped.CEKWithCost.html#8845" class="Bound">s</a><a id="8884" class="Symbol">)</a>
<a id="8886" href="Untyped.CEKWithCost.html#8817" class="Function">cekStepperEquivalence</a> <a id="8908" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="8913" href="Untyped.CEKWithCost.html#8913" class="Bound">s</a> <a id="8915" class="Symbol">=</a> <a id="8917" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8922" href="Untyped.CEKWithCost.html#8817" class="Function">cekStepperEquivalence</a> <a id="8944" class="Symbol">(</a><a id="8945" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8949" href="Untyped.CEKWithCost.html#8949" class="Bound">n</a><a id="8950" class="Symbol">)</a> <a id="8952" href="Untyped.CEKWithCost.html#8952" class="Bound">s</a> <a id="8954" class="Keyword">rewrite</a> <a id="8962" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="8966" class="Symbol">(</a><a id="8967" href="Untyped.CEKWithCost.html#6819" class="Function">cekStepEquivalence</a> <a id="8986" href="Untyped.CEKWithCost.html#8952" class="Bound">s</a><a id="8987" class="Symbol">)</a> <a id="8989" class="Keyword">with</a> <a id="8994" href="Untyped.CEK.html#22183" class="Function">step</a> <a id="8999" href="Untyped.CEKWithCost.html#8952" class="Bound">s</a>
<a id="9001" class="Symbol">...</a> <a id="9005" class="Symbol">|</a> <a id="9007" href="Untyped.CEKWithCost.html#9007" class="Bound">s</a> <a id="9009" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="9011" href="Untyped.CEKWithCost.html#9011" class="Bound">ρ</a> <a id="9013" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="9015" href="Untyped.CEKWithCost.html#9015" class="Bound">t</a> <a id="9017" class="Symbol">=</a> <a id="9019" href="Untyped.CEKWithCost.html#8817" class="Function">cekStepperEquivalence</a> <a id="9041" class="Bound">n</a> <a id="9043" class="Symbol">(</a><a id="9044" href="Untyped.CEKWithCost.html#9007" class="Bound">s</a> <a id="9046" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">;</a> <a id="9048" href="Untyped.CEKWithCost.html#9011" class="Bound">ρ</a> <a id="9050" href="Untyped.CEK.html#3640" class="InductiveConstructor Operator">▻</a> <a id="9052" href="Untyped.CEKWithCost.html#9015" class="Bound">t</a><a id="9053" class="Symbol">)</a>
<a id="9055" class="Symbol">...</a> <a id="9059" class="Symbol">|</a> <a id="9061" href="Untyped.CEKWithCost.html#9061" class="Bound">s</a> <a id="9063" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="9065" href="Untyped.CEKWithCost.html#9065" class="Bound">v</a> <a id="9067" class="Symbol">=</a> <a id="9069" href="Untyped.CEKWithCost.html#8817" class="Function">cekStepperEquivalence</a> <a id="9091" class="Bound">n</a>  <a id="9094" class="Symbol">(</a><a id="9095" href="Untyped.CEKWithCost.html#9061" class="Bound">s</a> <a id="9097" href="Untyped.CEK.html#3696" class="InductiveConstructor Operator">◅</a> <a id="9099" href="Untyped.CEKWithCost.html#9065" class="Bound">v</a><a id="9100" class="Symbol">)</a>
<a id="9102" class="Symbol">...</a> <a id="9106" class="Symbol">|</a> <a id="9108" href="Untyped.CEK.html#3734" class="InductiveConstructor">□</a> <a id="9110" href="Untyped.CEKWithCost.html#9110" class="Bound">x</a> <a id="9112" class="Symbol">=</a> <a id="9114" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="9119" class="Symbol">...</a> <a id="9123" class="Symbol">|</a> <a id="9125" href="Untyped.CEK.html#3754" class="InductiveConstructor">◆</a> <a id="9127" class="Symbol">=</a> <a id="9129" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre>

    </section>
  </body>
</html>
(* Oops: the code I used wasn't fully defunctionalised.
   I'll add this when I've fixed it. *)